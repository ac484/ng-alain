import{P as It,t as St}from"./chunk-QYQW6LNI.js";import{a as kt,c as wt,e as Mt,f as Rt,i as Dt}from"./chunk-GXWMFC4F.js";import{a as Nt}from"./chunk-7Y7O7VIX.js";import{b as ht,c as ve,i as mt,l as pt,m as se,n as ft}from"./chunk-OFJXGFWH.js";import{d as vt,i as zt,j as xt}from"./chunk-722TSEXM.js";import{d as Ct,r as yt}from"./chunk-JMK7RZ2K.js";import{c as Tt}from"./chunk-QOKX5S6E.js";import{c as ye}from"./chunk-VD65XSUD.js";import{$b as D,$c as Fe,Ae as bt,Be as Ve,Ca as it,Dd as Te,Ea as q,Fb as U,Gc as Le,Hb as M,Hc as Ce,J as Re,Jb as R,L as G,Lb as pe,M as De,Mb as Z,Nb as J,O as Ze,Oa as ue,Ob as f,Pb as T,Qb as v,Qc as ne,Qh as ze,Ra as W,Rb as H,Rh as xe,Sa as he,Sh as re,T as Ne,Th as le,U as Je,Va as st,Vb as ee,Vc as Pe,Wb as te,X as et,Yb as E,Zc as dt,_b as ot,b as ce,bf as gt,cb as b,cc as u,cd as ut,db as me,dc as Oe,df as ae,ea as Ee,ec as fe,ee as F,fc as V,g as Me,gc as P,h as Ge,hc as S,hd as ie,hf as _t,ic as I,j as qe,jc as rt,jd as x,jf as oe,lc as lt,m as Ke,ma as tt,mc as Q,na as nt,nc as be,oa as Ae,ob as O,oc as A,pb as Be,pc as ct,q as j,qa as $,qb as L,r as B,rc as ge,sa as d,se as We,tc as _e,ub as w,v as de,vb as at,wb as g,xb as K,ya as _,za as C,ze as He}from"./chunk-REO3NWNY.js";import{a as Ye,b as je,g as we}from"./chunk-57BLH6QZ.js";function Gt(i,c){if(i&1&&(ee(0),H(1,"nz-icon",1),te()),i&2){let e=c.$implicit;b(),f("nzType",e)}}var qt=["nz-tab-body",""];function Kt(i,c){}function Zt(i,c){if(i&1&&(ee(0),H(1,"nz-icon",1),te()),i&2){let e=c.$implicit;b(),f("nzType",e)}}var Jt=()=>({minWidth:"46px"}),en=()=>({visible:!1});function tn(i,c){if(i&1&&(ee(0),ge(1),te()),i&2){let e=u().$implicit;b(),_e(" ",e.tab.label," ")}}function nn(i,c){if(i&1){let e=E();T(0,"li",7),D("click",function(){let n=_(e).$implicit,s=u(2);return C(s.onSelect(n))})("contextmenu",function(n){let s=_(e).$implicit,r=u(2);return C(r.onContextmenu(s,n))}),w(1,tn,2,1,"ng-container",8),v()}if(i&2){let e=c.$implicit;A("ant-tabs-dropdown-menu-item-disabled",e.disabled),f("nzSelected",e.active)("nzDisabled",e.disabled),b(),f("nzStringTemplateOutlet",e.tab.label)("nzStringTemplateOutletContext",Ce(6,en))}}function sn(i,c){if(i&1&&(T(0,"ul",4),Z(1,nn,2,7,"li",6,pe),v()),i&2){let e=u();b(),J(e.items)}}function an(i,c){if(i&1){let e=E();T(0,"button",9),D("click",function(){_(e);let n=u();return C(n.addClicked.emit())}),v()}if(i&2){let e=u();f("addIcon",e.addIcon)}}var on=["navWrap"],rn=["navList"],ln=["*"];function cn(i,c){}function dn(i,c){if(i&1&&(T(0,"div",2),w(1,cn,0,0,"ng-template",8),v()),i&2){let e=u();b(),f("ngTemplateOutlet",e.startExtraContent().templateRef)}}function un(i,c){if(i&1){let e=E();T(0,"button",9),D("click",function(){_(e);let n=u();return C(n.addClicked.emit())}),v()}if(i&2){let e=u();f("addIcon",e.addIcon),U("tabindex",-1)}}function hn(i,c){}function mn(i,c){if(i&1&&(T(0,"div",2),w(1,hn,0,0,"ng-template",8),v()),i&2){let e=u();b(),f("ngTemplateOutlet",e.endExtraContent().templateRef)}}function pn(i,c){}function fn(i,c){if(i&1&&(T(0,"div",2),w(1,pn,0,0,"ng-template",8),v()),i&2){let e=u();b(),f("ngTemplateOutlet",e.extraTemplate)}}var bn=["contentTemplate"],gn=[[["","nz-tab-link",""]],"*"],_n=["[nz-tab-link]","*"];function Cn(i,c){i&1&&fe(0)}function Tn(i,c){i&1&&fe(0,1)}var vn=()=>({visible:!0});function zn(i,c){if(i&1&&(ee(0),ge(1),te()),i&2){let e=u().$implicit;b(),_e(" ",e.label," ")}}function xn(i,c){if(i&1){let e=E();T(0,"button",10),D("click",function(n){_(e);let s=u().$index,r=u(2);return C(r.onClose(s,n))}),v()}if(i&2){let e=u().$implicit;f("closeIcon",e.nzCloseIcon)}}function yn(i,c){if(i&1){let e=E();T(0,"div",6),D("click",function(n){let s=_(e),r=s.$implicit,h=s.$index,p=u(2);return C(p.clickNavItem(r,h,n))})("contextmenu",function(n){let s=_(e).$implicit,r=u(2);return C(r.contextmenuNavItem(s,n))}),T(1,"button",7),w(2,zn,2,1,"ng-container",8),M(3,xn,1,1,"button",9),v()()}if(i&2){let e=c.$implicit,t=c.$index,n=u(2);be("margin-right",n.position==="horizontal"?n.nzTabBarGutter:null,"px")("margin-bottom",n.position==="vertical"?n.nzTabBarGutter:null,"px"),A("ant-tabs-tab-active",n.nzSelectedIndex===t)("ant-tabs-tab-disabled",e.nzDisabled),b(),f("id",n.getTabContentId(t))("disabled",e.nzDisabled)("tab",e)("active",n.nzSelectedIndex===t),U("tabIndex",n.getTabIndex(e,t))("aria-disabled",e.nzDisabled)("aria-selected",n.nzSelectedIndex===t&&!n.nzHideAll)("aria-controls",n.getTabContentId(t)),b(),f("nzStringTemplateOutlet",e.label)("nzStringTemplateOutletContext",Ce(19,vn)),b(),R(e.nzClosable&&n.closable&&!e.nzDisabled?3:-1)}}function Sn(i,c){if(i&1){let e=E();T(0,"nz-tabs-nav",4),D("tabScroll",function(n){_(e);let s=u();return C(s.nzTabListScroll.emit(n))})("selectFocusedIndex",function(n){_(e);let s=u();return C(s.setSelectedIndex(n))})("addClicked",function(){_(e);let n=u();return C(n.onAdd())}),Z(1,yn,4,20,"div",5,pe),v()}if(i&2){let e=u();ct(e.nzTabBarStyle),f("selectedIndex",e.nzSelectedIndex||0)("inkBarAnimated",e.inkBarAnimated)("addable",e.addable)("addIcon",e.nzAddIcon)("hideBar",e.nzHideAll)("position",e.position)("extraTemplate",e.nzTabBarExtraContent)("extraContents",e.extraContents()),b(),J(e.tabs)}}function In(i,c){}function kn(i,c){if(i&1&&w(0,In,0,0,"ng-template",11),i&2){u();let e=Q(4);f("ngTemplateOutlet",e)}}function wn(i,c){}function Mn(i,c){if(i&1&&w(0,wn,0,0,"ng-template",11),i&2){u(2);let e=Q(4);f("ngTemplateOutlet",e)}}function Rn(i,c){if(i&1&&M(0,Mn,1,1,null,11),i&2){let e=u().$index,t=u(2);R(t.nzSelectedIndex===e?0:-1)}}function Dn(i,c){}function Nn(i,c){if(i&1&&w(0,Dn,0,0,"ng-template",11),i&2){u(2);let e=Q(4);f("ngTemplateOutlet",e)}}function En(i,c){if(i&1&&M(0,Nn,1,1,null,11),i&2){let e=u(),t=e.$implicit,n=e.$index,s=u(2);R(s.nzSelectedIndex===n||t.hasBeenActive?0:-1)}}function An(i,c){if(i&1&&H(0,"div",12),i&2){let e=u(),t=e.$implicit,n=e.$index,s=u(2);f("id",s.getTabContentId(n))("active",s.nzSelectedIndex===n)("content",t.content)("animated",s.tabPaneAnimated),U("aria-labelledby",s.getTabContentId(n))}}function Bn(i,c){if(i&1&&(M(0,kn,1,1,null,11)(1,Rn,1,1)(2,En,1,1),w(3,An,1,5,"ng-template",null,0,ne)),i&2){let e=c.$implicit,t=u(2);R(e.nzForceRender?0:t.nzDestroyInactiveTabPane?1:2)}}function On(i,c){if(i&1&&Z(0,Bn,5,1,null,null,pe),i&2){let e=u();J(e.tabs)}}var $e=class{index;tab},Ie=(()=>{class i{addIcon="plus";element=d(W).nativeElement;getElementWidth(){return this.element?.offsetWidth||0}getElementHeight(){return this.element?.offsetHeight||0}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["nz-tab-add-button"],["button","nz-tab-add-button",""]],hostAttrs:["aria-label","Add tab","type","button",1,"ant-tabs-nav-add"],inputs:{addIcon:"addIcon"},decls:1,vars:1,consts:[[4,"nzStringTemplateOutlet"],["nzTheme","outline",3,"nzType"]],template:function(t,n){t&1&&w(0,Gt,2,1,"ng-container",0),t&2&&f("nzStringTemplateOutlet",n.addIcon)},dependencies:[le,re,xe,ze],encapsulation:2})}return i})(),Et=(()=>{class i{position=Fe("end",{alias:"nzTabBarExtraContent"});templateRef=d(me);static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["","nzTabBarExtraContent","",5,"nz-tabset",5,"nz-tabs"]],inputs:{position:[1,"nzTabBarExtraContent","position"]}})}return i})(),Ln=(()=>{class i{content=null;active=!1;animated=!0;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["","nz-tab-body",""]],hostAttrs:[1,"ant-tabs-tabpane"],hostVars:10,hostBindings:function(t,n){t&2&&(ot("@tabSwitchMotion",n.active?"enter":"leave")("@.disabled",!n.animated),U("tabindex",n.active?0:-1)("aria-hidden",!n.active),be("overflow-y",n.animated?n.active?null:"none":null),A("ant-tabs-tabpane-active",n.active)("ant-tabs-tabpane-hidden",n.animated?null:!n.active))},inputs:{content:"content",active:"active",animated:"animated"},exportAs:["nzTabBody"],attrs:qt,decls:1,vars:1,consts:[[3,"ngTemplateOutlet"]],template:function(t,n){t&1&&w(0,Kt,0,0,"ng-template",0),t&2&&f("ngTemplateOutlet",n.content)},dependencies:[Te],encapsulation:2,data:{animation:[yt]},changeDetection:0})}return i})(),Pt=(()=>{class i{closeIcon="close";static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["nz-tab-close-button"],["button","nz-tab-close-button",""]],hostAttrs:["aria-label","Close tab","type","button",1,"ant-tabs-tab-remove"],inputs:{closeIcon:"closeIcon"},decls:1,vars:1,consts:[[4,"nzStringTemplateOutlet"],["nzTheme","outline",3,"nzType"]],template:function(t,n){t&1&&w(0,Zt,2,1,"ng-container",0),t&2&&f("nzStringTemplateOutlet",n.closeIcon)},dependencies:[le,re,xe,ze],encapsulation:2})}return i})(),Pn=(()=>{class i{templateRef=d(me,{host:!0});static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["ng-template","nzTabLink",""]],exportAs:["nzTabLinkTemplate"]})}return i})(),Ft=(()=>{class i{elementRef=d(W);routerLink=d(ft,{self:!0,optional:!0});static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["a","nz-tab-link",""]],exportAs:["nzTabLink"]})}return i})(),Wt=(()=>{class i{disabled=!1;tab;active=!1;elementRef=d(W);el=this.elementRef.nativeElement;parentElement=this.el.parentElement;focus(){this.el.focus({preventScroll:!0})}get width(){return this.parentElement.offsetWidth}get height(){return this.parentElement.offsetHeight}get left(){return this.parentElement.offsetLeft}get top(){return this.parentElement.offsetTop}static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["","nzTabNavItem",""]],inputs:{disabled:[2,"disabled","disabled",x],tab:"tab",active:[2,"active","active",x]}})}return i})(),Ue=(()=>{class i{items=[];addable=!1;addIcon="plus";addClicked=new g;selected=new g;closeAnimationWaitTimeoutId;menuOpened=!1;cdr=d(ie);element=d(W).nativeElement;onSelect(e){e.disabled||(e.tab.nzClick.emit(),this.selected.emit(e))}onContextmenu(e,t){e.disabled||e.tab.nzContextmenu.emit(t)}showItems(){clearTimeout(this.closeAnimationWaitTimeoutId),this.menuOpened=!0,this.cdr.markForCheck()}menuVisChange(e){e||(this.closeAnimationWaitTimeoutId=setTimeout(()=>{this.menuOpened=!1,this.cdr.markForCheck()},150))}getElementWidth(){return this.element?.offsetWidth||0}getElementHeight(){return this.element?.offsetHeight||0}ngOnDestroy(){clearTimeout(this.closeAnimationWaitTimeoutId)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["nz-tab-nav-operation"]],hostAttrs:[1,"ant-tabs-nav-operations"],hostVars:2,hostBindings:function(t,n){t&2&&A("ant-tabs-nav-operations-hidden",n.items.length===0)},inputs:{items:"items",addable:[2,"addable","addable",x],addIcon:"addIcon"},outputs:{addClicked:"addClicked",selected:"selected"},exportAs:["nzTabNavOperation"],decls:7,vars:6,consts:[["dropdownTrigger","nzDropdown"],["menu","nzDropdownMenu"],["nz-dropdown","","type","button","tabindex","-1","aria-hidden","true","nzOverlayClassName","nz-tabs-dropdown",1,"ant-tabs-nav-more",3,"nzVisibleChange","mouseenter","nzDropdownMenu","nzOverlayStyle","nzMatchWidthElement"],["nzType","ellipsis"],["nz-menu",""],["nz-tab-add-button","",3,"addIcon"],["nz-menu-item","",1,"ant-tabs-dropdown-menu-item",3,"ant-tabs-dropdown-menu-item-disabled","nzSelected","nzDisabled"],["nz-menu-item","",1,"ant-tabs-dropdown-menu-item",3,"click","contextmenu","nzSelected","nzDisabled"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["nz-tab-add-button","",3,"click","addIcon"]],template:function(t,n){if(t&1){let s=E();T(0,"button",2,0),D("nzVisibleChange",function(h){return _(s),C(n.menuVisChange(h))})("mouseenter",function(){return _(s),C(n.showItems())}),H(2,"nz-icon",3),v(),T(3,"nz-dropdown-menu",null,1),M(5,sn,3,0,"ul",4),v(),M(6,an,1,1,"button",5)}if(t&2){let s=Q(4);f("nzDropdownMenu",s)("nzOverlayStyle",Ce(5,Jt))("nzMatchWidthElement",null),b(5),R(n.menuOpened?5:-1),b(),R(n.addable?6:-1)}},dependencies:[xe,ze,le,re,Ie,Dt,Mt,wt,kt,Rt],encapsulation:2,changeDetection:0})}return i})(),Fn=.1,At=.01,Se=20,Bt=.995**Se,Wn=(()=>{class i{ngZone=d(K);destroyRef=d(q);el=d(W).nativeElement;lastWheelDirection=null;lastWheelTimestamp=0;lastTimestamp=0;lastTimeDiff=0;lastMixedWheel=0;lastWheelPrevent=!1;touchPosition=null;lastOffset=null;motion=-1;offsetChange=new g;tabScroll=new g;ngOnInit(){let e=ae(this.el,"wheel"),t=ae(this.el,"touchstart"),n=ae(this.el,"touchmove"),s=ae(this.el,"touchend");this.subscribeWrap("wheel",e,this.onWheel),this.subscribeWrap("touchstart",t,this.onTouchStart),this.subscribeWrap("touchmove",n,this.onTouchMove),this.subscribeWrap("touchend",s,this.onTouchEnd)}subscribeWrap(e,t,n){return t.pipe(F(this.destroyRef)).subscribe(s=>{this.tabScroll.emit({type:e,event:s}),s.defaultPrevented||n(s)})}onTouchEnd=e=>{if(!this.touchPosition)return;let t=this.lastOffset,n=this.lastTimeDiff;if(this.lastOffset=this.touchPosition=null,t){let s=t.x/n,r=t.y/n,h=Math.abs(s),p=Math.abs(r);if(Math.max(h,p)<Fn)return;let z=s,k=r;this.motion=window.setInterval(()=>{if(Math.abs(z)<At&&Math.abs(k)<At){window.clearInterval(this.motion);return}z*=Bt,k*=Bt,this.onOffset(z*Se,k*Se,e)},Se)}};onTouchMove=e=>{if(!this.touchPosition)return;e.preventDefault();let{screenX:t,screenY:n}=e.touches[0],s=t-this.touchPosition.x,r=n-this.touchPosition.y;this.onOffset(s,r,e);let h=Date.now();this.lastTimeDiff=h-this.lastTimestamp,this.lastTimestamp=h,this.lastOffset={x:s,y:r},this.touchPosition={x:t,y:n}};onTouchStart=e=>{let{screenX:t,screenY:n}=e.touches[0];this.touchPosition={x:t,y:n},window.clearInterval(this.motion)};onWheel=e=>{let{deltaX:t,deltaY:n}=e,s,r=Math.abs(t),h=Math.abs(n);r===h?s=this.lastWheelDirection==="x"?t:n:r>h?(s=t,this.lastWheelDirection="x"):(s=n,this.lastWheelDirection="y");let p=Date.now(),z=Math.abs(s);(p-this.lastWheelTimestamp>100||z-this.lastMixedWheel>10)&&(this.lastWheelPrevent=!1),this.onOffset(-s,-s,e),(e.defaultPrevented||this.lastWheelPrevent)&&(this.lastWheelPrevent=!0),this.lastWheelTimestamp=p,this.lastMixedWheel=z};onOffset(e,t,n){this.offsetChange.observers.length&&this.ngZone.run(()=>{this.offsetChange.emit({x:e,y:t,event:n})})}static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["","nzTabScrollList",""]],outputs:{offsetChange:"offsetChange",tabScroll:"tabScroll"}})}return i})(),Ot=(()=>{class i{ngZone=d(K);el=d(W).nativeElement;position="horizontal";animated=!0;animationMode=d(st,{optional:!0});get _animated(){return this.animationMode!=="NoopAnimations"&&this.animated}alignToElement(e){this.ngZone.runOutsideAngular(()=>{ye(()=>this.setStyles(e))})}setStyles(e){this.position==="horizontal"?(this.el.style.top="",this.el.style.height="",this.el.style.left=this.getLeftPosition(e),this.el.style.width=this.getElementWidth(e)):(this.el.style.left="",this.el.style.width="",this.el.style.top=this.getTopPosition(e),this.el.style.height=this.getElementHeight(e))}getLeftPosition(e){return e?`${e.offsetLeft||0}px`:"0"}getElementWidth(e){return e?`${e.offsetWidth||0}px`:"0"}getTopPosition(e){return e?`${e.offsetTop||0}px`:"0"}getElementHeight(e){return e?`${e.offsetHeight||0}px`:"0"}static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["nz-tabs-ink-bar"],["","nz-tabs-ink-bar",""]],hostAttrs:[1,"ant-tabs-ink-bar"],hostVars:2,hostBindings:function(t,n){t&2&&A("ant-tabs-ink-bar-animated",n._animated)},inputs:{position:"position",animated:"animated"}})}return i})(),Hn=typeof ye<"u"?Ke:qe,Lt=150,Qe=(()=>{class i{cdr=d(ie);ngZone=d(K);viewportRuler=d(Ct);nzResizeObserver=d(Nt);dir=d(We);destroyRef=d(q);indexFocused=new g;selectFocusedIndex=new g;addClicked=new g;tabScroll=new g;position="horizontal";addable=!1;hideBar=!1;addIcon="plus";inkBarAnimated=!0;extraTemplate;extraContents=Fe.required();startExtraContent=Pe(()=>this.extraContents().find(e=>e.position()==="start"));endExtraContent=Pe(()=>this.extraContents().find(e=>e.position()==="end"));get selectedIndex(){return this._selectedIndex}set selectedIndex(e){let t=Ve(e);this._selectedIndex!==t&&(this._selectedIndex=e,this.selectedIndexChanged=!0,this.keyManager&&this.keyManager.updateActiveItem(e))}navWrapRef;navListRef;operationRef;addBtnRef;inkBar;items;get focusIndex(){return this.keyManager?this.keyManager.activeItemIndex:0}set focusIndex(e){!this.isValidIndex(e)||this.focusIndex===e||!this.keyManager||this.keyManager.setActiveItem(e)}get showAddButton(){return this.hiddenItems.length===0&&this.addable}translate=null;transformX=0;transformY=0;pingLeft=!1;pingRight=!1;pingTop=!1;pingBottom=!1;hiddenItems=[];keyManager;_selectedIndex=0;wrapperWidth=0;wrapperHeight=0;scrollListWidth=0;scrollListHeight=0;operationWidth=0;operationHeight=0;addButtonWidth=0;addButtonHeight=0;selectedIndexChanged=!1;lockAnimationTimeoutId;cssTransformTimeWaitingId;constructor(){this.destroyRef.onDestroy(()=>{clearTimeout(this.lockAnimationTimeoutId),clearTimeout(this.cssTransformTimeWaitingId)})}ngAfterViewInit(){let e=this.dir?this.dir.change.asObservable():de(null),t=this.viewportRuler.change(150),n=()=>{this.updateScrollListPosition(),this.alignInkBarToSelectedTab()};this.keyManager=new xt(this.items).withHorizontalOrientation(this.getLayoutDirection()).withWrap(),this.keyManager.updateActiveItem(this.selectedIndex),ye(n),G(this.nzResizeObserver.observe(this.navWrapRef),this.nzResizeObserver.observe(this.navListRef)).pipe(F(this.destroyRef),Ze(16,Hn)).subscribe(()=>{n()}),G(e,t,this.items.changes).pipe(F(this.destroyRef)).subscribe(()=>{Promise.resolve().then(n),this.keyManager.withHorizontalOrientation(this.getLayoutDirection())}),this.keyManager.change.pipe(F(this.destroyRef)).subscribe(s=>{this.indexFocused.emit(s),this.scrollToTab(this.keyManager.activeItem)})}ngAfterContentChecked(){this.selectedIndexChanged&&(this.updateScrollListPosition(),this.alignInkBarToSelectedTab(),this.selectedIndexChanged=!1,this.cdr.markForCheck())}onSelectedFromMenu(e){let t=this.items.toArray().findIndex(n=>n===e);t!==-1&&(this.keyManager.updateActiveItem(t),this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this.scrollToTab(e)))}onOffsetChange(e){if(this.position==="horizontal"){if(!this.lockAnimationTimeoutId&&(this.transformX>=0&&e.x>0||this.transformX<=this.wrapperWidth-this.scrollListWidth&&e.x<0))return;e.event.preventDefault(),this.transformX=this.clampTransformX(this.transformX+e.x),this.setTransform(this.transformX,0)}else{if(!this.lockAnimationTimeoutId&&(this.transformY>=0&&e.y>0||this.transformY<=this.wrapperHeight-this.scrollListHeight&&e.y<0))return;e.event.preventDefault(),this.transformY=this.clampTransformY(this.transformY+e.y),this.setTransform(0,this.transformY)}this.lockAnimation(),this.setVisibleRange(),this.setPingStatus()}handleKeydown(e){let t=this.navWrapRef.nativeElement.contains(e.target);if(!(Tt(e)||!t))switch(e.keyCode){case 37:case 38:case 39:case 40:this.lockAnimation(),this.keyManager.onKeydown(e);break;case 13:case 32:this.focusIndex!==this.selectedIndex&&this.selectFocusedIndex.emit(this.focusIndex);break;default:this.keyManager.onKeydown(e)}}isValidIndex(e){if(!this.items)return!0;let t=this.items?this.items.toArray()[e]:null;return!!t&&!t.disabled}scrollToTab(e){if(!this.items.find(n=>n===e))return;let t=this.items.toArray();if(this.position==="horizontal"){let n=this.transformX;if(this.getLayoutDirection()==="rtl"){let s=t[0].left+t[0].width-e.left-e.width;s<this.transformX?n=s:s+e.width>this.transformX+this.wrapperWidth&&(n=s+e.width-this.wrapperWidth)}else e.left<-this.transformX?n=-e.left:e.left+e.width>-this.transformX+this.wrapperWidth&&(n=-(e.left+e.width-this.wrapperWidth));this.transformX=n,this.transformY=0,this.setTransform(n,0)}else{let n=this.transformY;e.top<-this.transformY?n=-e.top:e.top+e.height>-this.transformY+this.wrapperHeight&&(n=-(e.top+e.height-this.wrapperHeight)),this.transformY=n,this.transformX=0,this.setTransform(0,n)}clearTimeout(this.cssTransformTimeWaitingId),this.cssTransformTimeWaitingId=setTimeout(()=>{this.setVisibleRange()},Lt)}lockAnimation(){this.lockAnimationTimeoutId||this.ngZone.runOutsideAngular(()=>{this.navListRef.nativeElement.style.transition="none",this.lockAnimationTimeoutId=setTimeout(()=>{this.navListRef.nativeElement.style.transition="",this.lockAnimationTimeoutId=void 0},Lt)})}setTransform(e,t){this.navListRef.nativeElement.style.transform=`translate(${e}px, ${t}px)`}clampTransformX(e){let t=this.wrapperWidth-this.scrollListWidth;return this.getLayoutDirection()==="rtl"?Math.max(Math.min(t,e),0):Math.min(Math.max(t,e),0)}clampTransformY(e){return Math.min(Math.max(this.wrapperHeight-this.scrollListHeight,e),0)}updateScrollListPosition(){this.resetSizes(),this.transformX=this.clampTransformX(this.transformX),this.transformY=this.clampTransformY(this.transformY),this.setVisibleRange(),this.setPingStatus(),this.keyManager&&(this.keyManager.updateActiveItem(this.keyManager.activeItemIndex),this.keyManager.activeItem&&this.scrollToTab(this.keyManager.activeItem))}resetSizes(){this.addButtonWidth=this.addBtnRef?this.addBtnRef.getElementWidth():0,this.addButtonHeight=this.addBtnRef?this.addBtnRef.getElementHeight():0,this.operationWidth=this.operationRef.getElementWidth(),this.operationHeight=this.operationRef.getElementHeight(),this.wrapperWidth=this.navWrapRef.nativeElement.offsetWidth||0,this.wrapperHeight=this.navWrapRef.nativeElement.offsetHeight||0,this.scrollListHeight=this.navListRef.nativeElement.offsetHeight||0,this.scrollListWidth=this.navListRef.nativeElement.offsetWidth||0}alignInkBarToSelectedTab(){let e=this.items&&this.items.length?this.items.toArray()[this.selectedIndex]:null,t=e?e.elementRef.nativeElement:null;t&&this.inkBar.alignToElement(t.parentElement)}setPingStatus(){let e={top:!1,right:!1,bottom:!1,left:!1},t=this.navWrapRef.nativeElement;this.position==="horizontal"?this.getLayoutDirection()==="rtl"?(e.right=this.transformX>0,e.left=this.transformX+this.wrapperWidth<this.scrollListWidth):(e.left=this.transformX<0,e.right=-this.transformX+this.wrapperWidth<this.scrollListWidth):(e.top=this.transformY<0,e.bottom=-this.transformY+this.wrapperHeight<this.scrollListHeight),Object.keys(e).forEach(n=>{let s=`ant-tabs-nav-wrap-ping-${n}`;e[n]?t.classList.add(s):t.classList.remove(s)})}setVisibleRange(){let e,t,n,s,r,h,p=this.items.toArray(),z={width:0,height:0,left:0,top:0,right:0},k=m=>{let N,ke=p[m]||z;return t==="right"?N=p[0].left+p[0].width-p[m].left-p[m].width:N=ke[t],N};this.position==="horizontal"?(e="width",s=this.wrapperWidth,r=this.scrollListWidth-(this.hiddenItems.length?this.operationWidth:0),h=this.addButtonWidth,n=Math.abs(this.transformX),this.getLayoutDirection()==="rtl"?(t="right",this.pingRight=this.transformX>0,this.pingLeft=this.transformX+this.wrapperWidth<this.scrollListWidth):(this.pingLeft=this.transformX<0,this.pingRight=-this.transformX+this.wrapperWidth<this.scrollListWidth,t="left")):(e="height",s=this.wrapperHeight,r=this.scrollListHeight-(this.hiddenItems.length?this.operationHeight:0),h=this.addButtonHeight,t="top",n=-this.transformY,this.pingTop=this.transformY<0,this.pingBottom=-this.transformY+this.wrapperHeight<this.scrollListHeight);let Y=s;if(r+h>s&&(Y=s-h),!p.length){this.hiddenItems=[],this.cdr.markForCheck();return}let y=p.length,Xe=y;for(let m=0;m<y;m+=1){let N=k(m),ke=p[m]||z;if(N+ke[e]>n+Y){Xe=m-1;break}}let o=0;for(let m=y-1;m>=0;m-=1)if(k(m)<n){o=m+1;break}let a=p.slice(0,o),l=p.slice(Xe+1);this.hiddenItems=[...a,...l],this.cdr.markForCheck()}getLayoutDirection(){return this.dir&&this.dir.value==="rtl"?"rtl":"ltr"}ngOnChanges(e){let{position:t}=e;t&&!t.isFirstChange()&&(this.alignInkBarToSelectedTab(),this.lockAnimation(),this.updateScrollListPosition())}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["nz-tabs-nav"]],contentQueries:function(t,n,s){if(t&1&&V(s,Wt,5),t&2){let r;S(r=I())&&(n.items=r)}},viewQuery:function(t,n){if(t&1&&(P(on,7),P(rn,7),P(Ue,7),P(Ie,5),P(Ot,7)),t&2){let s;S(s=I())&&(n.navWrapRef=s.first),S(s=I())&&(n.navListRef=s.first),S(s=I())&&(n.operationRef=s.first),S(s=I())&&(n.addBtnRef=s.first),S(s=I())&&(n.inkBar=s.first)}},hostAttrs:[1,"ant-tabs-nav"],hostBindings:function(t,n){t&1&&D("keydown",function(r){return n.handleKeydown(r)})},inputs:{position:"position",addable:[2,"addable","addable",x],hideBar:[2,"hideBar","hideBar",x],addIcon:"addIcon",inkBarAnimated:"inkBarAnimated",extraTemplate:"extraTemplate",extraContents:[1,"extraContents"],selectedIndex:"selectedIndex"},outputs:{indexFocused:"indexFocused",selectFocusedIndex:"selectFocusedIndex",addClicked:"addClicked",tabScroll:"tabScroll"},exportAs:["nzTabsNav"],features:[ue],ngContentSelectors:ln,decls:11,vars:17,consts:[["navWrap",""],["navList",""],[1,"ant-tabs-extra-content"],[1,"ant-tabs-nav-wrap"],["nzTabScrollList","","role","tablist",1,"ant-tabs-nav-list",3,"offsetChange","tabScroll"],["role","tab","nz-tab-add-button","",3,"addIcon"],["nz-tabs-ink-bar","",3,"hidden","position","animated"],[3,"addClicked","selected","addIcon","addable","items"],[3,"ngTemplateOutlet"],["role","tab","nz-tab-add-button","",3,"click","addIcon"]],template:function(t,n){if(t&1){let s=E();Oe(),M(0,dn,2,1,"div",2),T(1,"div",3,0)(3,"div",4,1),D("offsetChange",function(h){return _(s),C(n.onOffsetChange(h))})("tabScroll",function(h){return _(s),C(n.tabScroll.emit(h))}),fe(5),M(6,un,1,2,"button",5),H(7,"div",6),v()(),T(8,"nz-tab-nav-operation",7),D("addClicked",function(){return _(s),C(n.addClicked.emit())})("selected",function(h){return _(s),C(n.onSelectedFromMenu(h))}),v(),M(9,mn,2,1,"div",2)(10,fn,2,1,"div",2)}t&2&&(R(n.startExtraContent()?0:-1),b(),A("ant-tabs-nav-wrap-ping-left",n.pingLeft)("ant-tabs-nav-wrap-ping-right",n.pingRight)("ant-tabs-nav-wrap-ping-top",n.pingTop)("ant-tabs-nav-wrap-ping-bottom",n.pingBottom),b(5),R(n.showAddButton?6:-1),b(),f("hidden",n.hideBar)("position",n.position)("animated",n.inkBarAnimated),b(),f("addIcon",n.addIcon)("addable",n.addable)("items",n.hiddenItems),b(),R(n.endExtraContent()?9:n.extraTemplate?10:-1))},dependencies:[Wn,Ie,Ot,Ue,Te],encapsulation:2,changeDetection:0})}return i})(),Vn=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275dir=L({type:i,selectors:[["","nz-tab",""]],exportAs:["nzTab"]})}return i})(),Ht=new $("NZ_TAB_SET"),$n=(()=>{class i{nzTitle="";nzClosable=!1;nzCloseIcon="close";nzDisabled=!1;nzForceRender=!1;nzSelect=new g;nzDeselect=new g;nzClick=new g;nzContextmenu=new g;nzTabLinkTemplateDirective;template=null;linkDirective;contentTemplate;isActive=!1;hasBeenActive=!1;position=null;origin=null;closestTabSet=d(Ht);stateChanges=new Me;get content(){return this.template||this.contentTemplate}get label(){return this.nzTitle||this.nzTabLinkTemplateDirective?.templateRef}ngOnChanges(e){let{nzTitle:t,nzDisabled:n,nzForceRender:s}=e;(t||n||s)&&this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete()}setActive(e){this.isActive=e,e&&(this.hasBeenActive=!0)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=O({type:i,selectors:[["nz-tab"]],contentQueries:function(t,n,s){if(t&1&&(V(s,Pn,5),V(s,Vn,5,me),V(s,Ft,5)),t&2){let r;S(r=I())&&(n.nzTabLinkTemplateDirective=r.first),S(r=I())&&(n.template=r.first),S(r=I())&&(n.linkDirective=r.first)}},viewQuery:function(t,n){if(t&1&&P(bn,7),t&2){let s;S(s=I())&&(n.contentTemplate=s.first)}},inputs:{nzTitle:"nzTitle",nzClosable:[2,"nzClosable","nzClosable",x],nzCloseIcon:"nzCloseIcon",nzDisabled:[2,"nzDisabled","nzDisabled",x],nzForceRender:[2,"nzForceRender","nzForceRender",x]},outputs:{nzSelect:"nzSelect",nzDeselect:"nzDeselect",nzClick:"nzClick",nzContextmenu:"nzContextmenu"},exportAs:["nzTab"],features:[ue],ngContentSelectors:_n,decls:4,vars:0,consts:[["tabLinkTemplate",""],["contentTemplate",""]],template:function(t,n){t&1&&(Oe(gn),at(0,Cn,1,0,"ng-template",null,0,ne)(2,Tn,1,0,"ng-template",null,1,ne))},encapsulation:2,changeDetection:0})}return i})(),Un="tabs",Qn=0,Xn=(()=>{var y;let i,c=[],e=[],t,n=[],s=[],r,h=[],p=[],z,k=[],Y=[];return y=class{_nzModuleName=Un;nzConfigService=d(_t);ngZone=d(K);cdr=d(ie);directionality=d(We);destroyRef=d(q);get nzSelectedIndex(){return this.selectedIndex}set nzSelectedIndex(o){this.indexToSelect=Ve(o,null)}nzTabPosition="top";nzTabBarExtraContent;nzCanDeactivate=null;nzAddIcon="plus";nzTabBarStyle=null;nzType=B(this,c,"line");nzSize=(B(this,e),B(this,n,"default"));nzAnimated=(B(this,s),B(this,h,!0));nzTabBarGutter=(B(this,p),B(this,k,void 0));nzHideAdd=(B(this,Y),!1);nzCentered=!1;nzHideAll=!1;nzLinkRouter=!1;nzLinkExact=!0;nzDestroyInactiveTabPane=!1;nzSelectChange=new g(!0);nzSelectedIndexChange=new g;nzTabListScroll=new g;nzClose=new g;nzAdd=new g;get position(){return["top","bottom"].indexOf(this.nzTabPosition)===-1?"vertical":"horizontal"}get addable(){return this.nzType==="editable-card"&&!this.nzHideAdd}get closable(){return this.nzType==="editable-card"}get line(){return this.nzType==="line"}get inkBarAnimated(){return this.line&&(typeof this.nzAnimated=="boolean"?this.nzAnimated:this.nzAnimated.inkBar)}get tabPaneAnimated(){return typeof this.nzAnimated=="boolean"?this.nzAnimated:this.nzAnimated.tabPane}allTabs=new he;tabLinks=new he;tabNavBarRef;tabs=new he;extraContents=ut(Et);dir="ltr";tabSetId;indexToSelect=0;selectedIndex=null;tabLabelSubscription=ce.EMPTY;canDeactivateSubscription=ce.EMPTY;router=d(se,{optional:!0});constructor(){this.tabSetId=Qn++,d(dt)==="nz-tabset"&&bt(`${He} <nz-tabset> is deprecated, please use <nz-tabs> instead.`),this.destroyRef.onDestroy(()=>{this.tabs.destroy(),this.tabLabelSubscription.unsubscribe(),this.canDeactivateSubscription.unsubscribe()})}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe(F(this.destroyRef)).subscribe(o=>{this.dir=o,this.cdr.detectChanges()})}ngAfterContentInit(){this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.setUpRouter())}),this.subscribeToTabLabels(),this.subscribeToAllTabChanges(),this.tabs.changes.pipe(F(this.destroyRef)).subscribe(()=>{if(this.clampTabIndex(this.indexToSelect)===this.selectedIndex){let a=this.tabs.toArray();for(let l=0;l<a.length;l++)if(a[l].isActive){this.indexToSelect=this.selectedIndex=l;break}}this.subscribeToTabLabels(),this.cdr.markForCheck()})}ngAfterContentChecked(){let o=this.indexToSelect=this.clampTabIndex(this.indexToSelect);if(this.selectedIndex!==o){let a=this.selectedIndex==null;a||this.nzSelectChange.emit(this.createChangeEvent(o)),Promise.resolve().then(()=>{this.tabs.forEach((l,m)=>l.setActive(m===o)),a||this.nzSelectedIndexChange.emit(o)})}this.tabs.forEach((a,l)=>{a.position=l-o,this.selectedIndex!=null&&a.position===0&&!a.origin&&(a.origin=o-this.selectedIndex)}),this.selectedIndex!==o&&(this.selectedIndex=o,this.cdr.markForCheck())}onClose(o,a){a.preventDefault(),a.stopPropagation(),this.nzClose.emit({index:o})}onAdd(){this.nzAdd.emit()}clampTabIndex(o){return Math.min(this.tabs.length-1,Math.max(o||0,0))}createChangeEvent(o){let a=new $e;return a.index=o,this.tabs&&this.tabs.length&&(a.tab=this.tabs.toArray()[o],this.tabs.forEach((l,m)=>{m!==o&&l.nzDeselect.emit()}),a.tab.nzSelect.emit()),a}subscribeToTabLabels(){this.tabLabelSubscription&&this.tabLabelSubscription.unsubscribe(),this.tabLabelSubscription=G(...this.tabs.map(o=>o.stateChanges)).subscribe(()=>this.cdr.markForCheck())}subscribeToAllTabChanges(){this.allTabs.changes.pipe(Ee(this.allTabs)).subscribe(o=>{this.tabs.reset(o.filter(a=>a.closestTabSet===this)),this.tabs.notifyOnChanges()})}canDeactivateFun(o,a){return typeof this.nzCanDeactivate=="function"?gt(this.nzCanDeactivate(o,a)).pipe(et(),F(this.destroyRef)):de(!0)}clickNavItem(o,a,l){o.nzDisabled||(o.nzClick.emit(),this.isRouterLinkClickEvent(a,l)||this.setSelectedIndex(a))}isRouterLinkClickEvent(o,a){let l=a.target;return this.nzLinkRouter?!!this.tabs.toArray()[o]?.linkDirective?.elementRef.nativeElement.contains(l):!1}contextmenuNavItem(o,a){o.nzDisabled||o.nzContextmenu.emit(a)}setSelectedIndex(o){this.canDeactivateSubscription.unsubscribe(),this.canDeactivateSubscription=this.canDeactivateFun(this.selectedIndex,o).subscribe(a=>{a&&(this.nzSelectedIndex=o,this.tabNavBarRef.focusIndex=o,this.cdr.markForCheck())})}getTabIndex(o,a){return o.nzDisabled?null:this.selectedIndex===a?0:-1}getTabContentId(o){return`nz-tabs-${this.tabSetId}-tab-${o}`}setUpRouter(){if(this.nzLinkRouter){if(!this.router)throw new Error(`${He} you should import 'RouterModule' if you want to use 'nzLinkRouter'!`);G(this.router.events.pipe(De(o=>o instanceof ve)),this.tabLinks.changes).pipe(Ee(!0),Je(0),F(this.destroyRef)).subscribe(()=>{this.updateRouterActive(),this.cdr.markForCheck()})}}updateRouterActive(){if(this.router?.navigated){let o=this.findShouldActiveTabIndex();o!==this.selectedIndex&&this.setSelectedIndex(o),Promise.resolve().then(()=>this.nzHideAll=o===-1)}}findShouldActiveTabIndex(){let o=this.tabs.toArray(),a=this.isLinkActive(this.router);return o.findIndex(l=>{let m=l.linkDirective;return m?a(m.routerLink):!1})}isLinkActive(o){return a=>a?!!o?.isActive(a.urlTree||"",{paths:this.nzLinkExact?"exact":"subset",queryParams:this.nzLinkExact?"exact":"subset",fragment:"ignored",matrixParams:"ignored"}):!1}},(()=>{let o=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[oe()],t=[oe()],r=[oe()],z=[oe()],j(null,null,i,{kind:"field",name:"nzType",static:!1,private:!1,access:{has:a=>"nzType"in a,get:a=>a.nzType,set:(a,l)=>{a.nzType=l}},metadata:o},c,e),j(null,null,t,{kind:"field",name:"nzSize",static:!1,private:!1,access:{has:a=>"nzSize"in a,get:a=>a.nzSize,set:(a,l)=>{a.nzSize=l}},metadata:o},n,s),j(null,null,r,{kind:"field",name:"nzAnimated",static:!1,private:!1,access:{has:a=>"nzAnimated"in a,get:a=>a.nzAnimated,set:(a,l)=>{a.nzAnimated=l}},metadata:o},h,p),j(null,null,z,{kind:"field",name:"nzTabBarGutter",static:!1,private:!1,access:{has:a=>"nzTabBarGutter"in a,get:a=>a.nzTabBarGutter,set:(a,l)=>{a.nzTabBarGutter=l}},metadata:o},k,Y),o&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o})})(),we(y,"\u0275fac",function(a){return new(a||y)}),we(y,"\u0275cmp",O({type:y,selectors:[["nz-tabs"],["nz-tabset"]],contentQueries:function(a,l,m){if(a&1&&(rt(m,l.extraContents,Et,4),V(m,$n,5),V(m,Ft,5)),a&2){lt();let N;S(N=I())&&(l.allTabs=N),S(N=I())&&(l.tabLinks=N)}},viewQuery:function(a,l){if(a&1&&P(Qe,5),a&2){let m;S(m=I())&&(l.tabNavBarRef=m.first)}},hostAttrs:[1,"ant-tabs"],hostVars:24,hostBindings:function(a,l){a&2&&A("ant-tabs-card",l.nzType==="card"||l.nzType==="editable-card")("ant-tabs-editable",l.nzType==="editable-card")("ant-tabs-editable-card",l.nzType==="editable-card")("ant-tabs-centered",l.nzCentered)("ant-tabs-rtl",l.dir==="rtl")("ant-tabs-top",l.nzTabPosition==="top")("ant-tabs-bottom",l.nzTabPosition==="bottom")("ant-tabs-left",l.nzTabPosition==="left")("ant-tabs-right",l.nzTabPosition==="right")("ant-tabs-default",l.nzSize==="default")("ant-tabs-small",l.nzSize==="small")("ant-tabs-large",l.nzSize==="large")},inputs:{nzSelectedIndex:"nzSelectedIndex",nzTabPosition:"nzTabPosition",nzTabBarExtraContent:"nzTabBarExtraContent",nzCanDeactivate:"nzCanDeactivate",nzAddIcon:"nzAddIcon",nzTabBarStyle:"nzTabBarStyle",nzType:"nzType",nzSize:"nzSize",nzAnimated:"nzAnimated",nzTabBarGutter:"nzTabBarGutter",nzHideAdd:[2,"nzHideAdd","nzHideAdd",x],nzCentered:[2,"nzCentered","nzCentered",x],nzHideAll:[2,"nzHideAll","nzHideAll",x],nzLinkRouter:[2,"nzLinkRouter","nzLinkRouter",x],nzLinkExact:[2,"nzLinkExact","nzLinkExact",x],nzDestroyInactiveTabPane:[2,"nzDestroyInactiveTabPane","nzDestroyInactiveTabPane",x]},outputs:{nzSelectChange:"nzSelectChange",nzSelectedIndexChange:"nzSelectedIndexChange",nzTabListScroll:"nzTabListScroll",nzClose:"nzClose",nzAdd:"nzAdd"},exportAs:["nzTabs"],features:[Le([{provide:Ht,useExisting:tt(()=>y)}])],decls:4,vars:12,consts:[["tabpaneTmpl",""],[3,"style","selectedIndex","inkBarAnimated","addable","addIcon","hideBar","position","extraTemplate","extraContents"],[1,"ant-tabs-content-holder"],[1,"ant-tabs-content"],[3,"tabScroll","selectFocusedIndex","addClicked","selectedIndex","inkBarAnimated","addable","addIcon","hideBar","position","extraTemplate","extraContents"],[1,"ant-tabs-tab",3,"margin-right","margin-bottom","ant-tabs-tab-active","ant-tabs-tab-disabled"],[1,"ant-tabs-tab",3,"click","contextmenu"],["type","button","role","tab","nzTabNavItem","","cdkMonitorElementFocus","",1,"ant-tabs-tab-btn",3,"id","disabled","tab","active"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["type","button","nz-tab-close-button","",3,"closeIcon"],["type","button","nz-tab-close-button","",3,"click","closeIcon"],[3,"ngTemplateOutlet"],["role","tabpanel","nz-tab-body","",3,"id","active","content","animated"]],template:function(a,l){a&1&&(M(0,Sn,3,10,"nz-tabs-nav",1),T(1,"div",2)(2,"div",3),M(3,On,2,0),v()()),a&2&&(R(l.tabs.length||l.addable?0:-1),b(2),A("ant-tabs-content-top",l.nzTabPosition==="top")("ant-tabs-content-bottom",l.nzTabPosition==="bottom")("ant-tabs-content-left",l.nzTabPosition==="left")("ant-tabs-content-right",l.nzTabPosition==="right")("ant-tabs-content-animated",l.tabPaneAnimated),b(),R(l.nzHideAll?-1:3))},dependencies:[Qe,Te,Wt,zt,vt,le,re,Pt,Ln],encapsulation:2})),y})();var Ei=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=Be({type:i});static \u0275inj=Ae({imports:[Xn,Qe,Ue,Ie,Pt]})}return i})();var X=function(i){return i[i.Menu=0]="Menu",i[i.MenuForce=1]="MenuForce",i[i.URL=2]="URL",i}(X||{}),Yn=new $("REUSE_TAB_CACHED_MANAGER");var jn=new $("REUSE_TAB_STORAGE_KEY"),Gn=new $("REUSE_TAB_STORAGE_STATE");var cs=(()=>{class i{injector=d(it);menuService=d(St);cached=d(Yn);stateKey=d(jn);stateSrv=d(Gn);_inited=!1;_max=10;_keepingScroll=!1;_cachedChange=new Ge(null);_router$;removeUrlBuffer=null;positionBuffer={};componentRef;debug=!1;routeParamMatchMode="strict";mode=X.Menu;excludes=[];storageState=!1;get snapshot(){return this.injector.get(mt).snapshot}get inited(){return this._inited}get curUrl(){return this.getUrl(this.snapshot)}set max(e){this._max=Math.min(Math.max(e,2),100);for(let t=this.cached.list.length;t>this._max;t--)this.cached.list.pop()}set keepingScroll(e){this._keepingScroll=e,this.initScroll()}get keepingScroll(){return this._keepingScroll}keepingScrollContainer;get items(){return this.cached.list}get count(){return this.cached.list.length}get change(){return this._cachedChange.asObservable()}set title(e){let t=this.curUrl;typeof e=="string"&&(e={text:e}),this.cached.title[t]=e,this.di("update current tag title: ",e),this._cachedChange.next({active:"title",url:t,title:e,list:this.cached.list})}index(e){return this.cached.list.findIndex(t=>t.url===e)}exists(e){return this.index(e)!==-1}get(e){return e&&this.cached.list.find(t=>t.url===e)||null}remove(e,t){let n=typeof e=="string"?this.index(e):e,s=n!==-1?this.cached.list[n]:null;return!s||!t&&!s.closable?!1:(this.destroy(s._handle),this.cached.list.splice(n,1),delete this.cached.title[e],!0)}close(e,t=!1){return this.removeUrlBuffer=e,this.remove(e,t),this._cachedChange.next({active:"close",url:e,list:this.cached.list}),this.di("close tag",e),!0}closeRight(e,t=!1){let n=this.index(e);for(let s=this.count-1;s>n;s--)this.remove(s,t);return this.removeUrlBuffer=null,this._cachedChange.next({active:"closeRight",url:e,list:this.cached.list}),this.di("close right tages",e),!0}clear(e=!1){this.cached.list.forEach(t=>{!e&&t.closable&&this.destroy(t._handle)}),this.cached.list=this.cached.list.filter(t=>!e&&!t.closable),this.removeUrlBuffer=null,this._cachedChange.next({active:"clear",list:this.cached.list}),this.di("clear all catch")}move(e,t){let n=this.cached.list.findIndex(r=>r.url===e);if(n===-1)return;let s=this.cached.list.slice();s.splice(t<0?s.length+t:t,0,s.splice(n,1)[0]),this.cached.list=s,this._cachedChange.next({active:"move",url:e,position:t,list:this.cached.list})}replace(e){let t=this.curUrl;this.injector.get(se).navigateByUrl(e).then(()=>{this.exists(t)?this.close(t,!0):this.removeUrlBuffer=t})}getTitle(e,t){if(this.cached.title[e])return this.cached.title[e];if(t&&t.data&&(t.data.titleI18n||t.data.title))return{text:t.data.title,i18n:t.data.titleI18n};let n=this.getMenu(e);return n?{text:n.text,i18n:n.i18n}:{text:e}}clearTitleCached(){this.cached.title={}}set closable(e){let t=this.curUrl;this.cached.closable[t]=e,this.di("update current tag closable: ",e),this._cachedChange.next({active:"closable",closable:e,list:this.cached.list})}getClosable(e,t){if(typeof this.cached.closable[e]<"u")return this.cached.closable[e];if(t&&t.data&&typeof t.data.reuseClosable=="boolean")return t.data.reuseClosable;let n=this.mode!==X.URL?this.getMenu(e):null;return n&&typeof n.reuseClosable=="boolean"?n.reuseClosable:!0}clearClosableCached(){this.cached.closable={}}getTruthRoute(e){let t=e;for(;t.firstChild;)t=t.firstChild;return t}getUrl(e){let t=this.getTruthRoute(e),n=[];for(;t;)n.push(t.url.join("/")),t=t.parent;return`/${n.filter(r=>r).reverse().join("/")}`}can(e){let t=this.getUrl(e);if(t===this.removeUrlBuffer)return!1;if(e.data&&typeof e.data.reuse=="boolean")return e.data.reuse;if(this.mode!==X.URL){let n=this.getMenu(t);if(!n)return!1;if(this.mode===X.Menu){if(n.reuse===!1)return!1}else if(!n.reuse||n.reuse!==!0)return!1;return!0}return!this.isExclude(t)}isExclude(e){return this.excludes.findIndex(t=>t.test(e))!==-1}refresh(e){this._cachedChange.next({active:"refresh",data:e})}destroy(e){e&&e.componentRef&&e.componentRef.destroy&&e.componentRef.destroy()}di(...e){}constructor(){this.cached==null&&(this.cached={list:[],title:{},closable:{}})}init(){this.initScroll(),this._inited=!0,this.loadState()}loadState(){this.storageState&&(this.cached.list=this.stateSrv.get(this.stateKey).map(e=>je(Ye({},e),{title:{text:e.title},url:e.url,position:e.position})),this._cachedChange.next({active:"loadState"}))}getMenu(e){let t=this.menuService.getPathByUrl(e);return!t||t.length===0?null:t.pop()}runHook(e,t,n="init"){if(typeof t=="number"&&(t=this.cached.list[t]._handle?.componentRef),t==null||!t.instance)return;let s=t.instance,r=s[e];typeof r=="function"&&(e==="_onReuseInit"?r.call(s,n):r.call(s))}hasInValidRoute(e){return!e.routeConfig||!!e.routeConfig.loadChildren||!!e.routeConfig.children}shouldDetach(e){return this.hasInValidRoute(e)?!1:(this.di("#shouldDetach",this.can(e),this.getUrl(e)),this.can(e))}saveCache(e,t,n){let s=this.getTruthRoute(e),r=this.getUrl(e),h=this.index(r),p={title:this.getTitle(r,s),url:r,closable:this.getClosable(r,e),_snapshot:e,_handle:t};if(h<0){if(this.items.splice(n??this.items.length,0,p),this.count>this._max){let z=this.items.findIndex(k=>k.url!==r&&k.closable);if(z!==-1){let k=this.items[z];this.remove(z,!1),Re(1).pipe(Ne(1)).subscribe(()=>this._cachedChange.next({active:"close",url:k.url,list:this.cached.list}))}}}else this.items[h]=p}store(e,t){let n=this.getUrl(e);t!=null&&this.saveCache(e,t);let s=this.cached.list,r={title:this.getTitle(n,e),closable:this.getClosable(n,e),position:this.getKeepingScroll(n,e)?this.positionBuffer[n]:null,url:n,_snapshot:e,_handle:t},h=this.index(n),p=s[h]?._handle?.componentRef;t==null&&p!=null&&Re(100).pipe(Ne(1)).subscribe(()=>this.runHook("_onReuseInit",p)),s[h]=r,this.removeUrlBuffer=null,this.di("#store","[override]",n),t&&t.componentRef&&this.runHook("_onReuseDestroy",t.componentRef),this._cachedChange.next({active:"override",item:r,list:s})}shouldAttach(e){if(this.hasInValidRoute(e))return!1;let t=this.getUrl(e),n=this.get(t),s=!!(n&&n._handle);return this.di("#shouldAttach",s,t),s||this._cachedChange.next({active:"add",url:t,list:this.cached.list}),s}retrieve(e){if(this.hasInValidRoute(e))return null;let t=this.getUrl(e),n=this.get(t),s=n&&n._handle||null;return this.di("#retrieve",t,s),s}shouldReuseRoute(e,t){let n=e.routeConfig===t.routeConfig;if(!n)return!1;let s=e.routeConfig&&e.routeConfig.path||"";return s.length>0&&~s.indexOf(":")&&(this.routeParamMatchMode==="strict"?n=this.getUrl(e)===this.getUrl(t):n=s===(t.routeConfig&&t.routeConfig.path||"")),this.di("====================="),this.di("#shouldReuseRoute",n,`${this.getUrl(t)}=>${this.getUrl(e)}`,e,t),n}getKeepingScroll(e,t){if(t&&t.data&&typeof t.data.keepingScroll=="boolean")return t.data.keepingScroll;let n=this.mode!==X.URL?this.getMenu(e):null;return n&&typeof n.keepingScroll=="boolean"?n.keepingScroll:this.keepingScroll}get isDisabledInRouter(){return this.injector.get(pt,{}).scrollPositionRestoration==="disabled"}get ss(){return this.injector.get(It)}initScroll(){this._router$&&this._router$.unsubscribe(),this._router$=this.injector.get(se).events.subscribe(e=>{if(e instanceof ht){let t=this.curUrl;this.getKeepingScroll(t,this.getTruthRoute(this.snapshot))?this.positionBuffer[t]=this.ss.getScrollPosition(this.keepingScrollContainer):delete this.positionBuffer[t]}else if(e instanceof ve){let t=this.curUrl,n=this.get(t);n&&n.position&&this.getKeepingScroll(t,this.getTruthRoute(this.snapshot))&&(this.isDisabledInRouter?this.ss.scrollToPosition(this.keepingScrollContainer,n.position):setTimeout(()=>this.ss.scrollToPosition(this.keepingScrollContainer,n.position),1))}})}ngOnDestroy(){let{_cachedChange:e,_router$:t}=this;this.clear(),this.cached.list=[],e.complete(),t&&t.unsubscribe()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=nt({token:i,factory:i.\u0275fac})}return i})();export{Vn as a,$n as b,Xn as c,Ei as d,cs as e};

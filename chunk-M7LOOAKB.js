import{a as de,b as fe}from"./chunk-LVG2LAOY.js";import{b as ce}from"./chunk-GNOZ56CG.js";import{a as ue,b as pe}from"./chunk-XN3SUAHC.js";import"./chunk-RUD7LQCH.js";import"./chunk-ETYDZIHM.js";import{a as re,c as oe,d as ae,e as se}from"./chunk-JPGT6HBL.js";import{a as ie,b as ne}from"./chunk-45BKQ37Q.js";import{d as W}from"./chunk-LFVXFGPE.js";import{a as G,b as H}from"./chunk-3D5LO4YN.js";import"./chunk-66HWRA4I.js";import{a as $,f as ee,k as te}from"./chunk-RGYXGWNO.js";import{b as X,c as Y,d as Z}from"./chunk-ISYEZVQ3.js";import"./chunk-VIGI73B6.js";import"./chunk-O3DGGP5O.js";import{d as R,g as U,m as Q,z as q}from"./chunk-7GKVL75V.js";import{i as P,j as J,k as j}from"./chunk-X5G25CLX.js";import"./chunk-PAIB6VMN.js";import"./chunk-YMEC4OFG.js";import"./chunk-5KPRUAKG.js";import{f as le,g as me}from"./chunk-ZK6GJMMP.js";import"./chunk-W6Z6A3Q5.js";import"./chunk-FJXMRBDK.js";import"./chunk-5V3RUN7K.js";import{a as L,b as O,d as B,e as K}from"./chunk-2DZ25YRQ.js";import"./chunk-PR6SM3R4.js";import"./chunk-5NB44RP4.js";import"./chunk-M2FMHT2I.js";import"./chunk-BA2SIH6H.js";import{f as b,g as A}from"./chunk-AEDV7UUM.js";import{Ad as V,Gc as E,Jd as D,Nb as g,Ob as a,Oh as I,Pb as s,Ph as M,Qb as f,Xb as w,_b as C,bb as d,bc as y,gb as S,nb as T,qc as l,tb as _,tc as v,vc as F,wc as N,xa as m,xc as x,ya as u,zd as k}from"./chunk-GM6XQ5SX.js";import"./chunk-57BLH6QZ.js";var he=()=>({minRows:8,maxRows:12});function ze(p,t){if(p&1&&(a(0,"li"),l(1),s()),p&2){let e=t.$implicit;d(),v(" ",e.title," (",e.key,") ")}}function ge(p,t){if(p&1&&(a(0,"div")(1,"h4"),l(2,"\u9810\u89BD (\u524D 5 \u500B\u7BC0\u9EDE):"),s(),a(3,"ul"),_(4,ze,2,2,"li",19),s()()),p&2){let e=y(2);d(4),g("ngForOf",e.importPreview.slice(0,5))}}function ye(p,t){if(p&1){let e=w();a(0,"div"),f(1,"nz-alert",13),a(2,"nz-form-item")(3,"nz-form-label"),l(4,"\u532F\u5165\u683C\u5F0F"),s(),a(5,"nz-form-control")(6,"nz-select",14),x("ngModelChange",function(r){m(e);let i=y();return N(i.importFormat,r)||(i.importFormat=r),u(r)}),f(7,"nz-option",15)(8,"nz-option",16),s()()(),a(9,"nz-form-item")(10,"nz-form-label"),l(11,"\u532F\u5165\u8CC7\u6599"),s(),a(12,"nz-form-control")(13,"textarea",17),x("ngModelChange",function(r){m(e);let i=y();return N(i.importData,r)||(i.importData=r),u(r)}),s()()(),f(14,"nz-divider"),_(15,ge,5,1,"div",18),s()}if(p&2){let e=y();d(6),F("ngModel",e.importFormat),d(7),F("ngModel",e.importData),g("nzAutosize",E(4,he)),d(2),g("ngIf",e.importPreview.length>0)}}var z=class z{constructor(t){this.message=t;this.treeData=[{title:"\u5C08\u6848\u7BA1\u7406",key:"0-0",icon:"anticon-cluster",children:[{title:"\u524D\u7AEF\u958B\u767C",key:"0-0-0",icon:"anticon-node-index",children:[{title:"Angular \u5C08\u6848",key:"0-0-0-0",isLeaf:!0,icon:"anticon-html5"},{title:"React \u5C08\u6848",key:"0-0-0-1",isLeaf:!0,icon:"anticon-code"},{title:"Vue \u5C08\u6848",key:"0-0-0-2",isLeaf:!0,icon:"anticon-code"}]},{title:"\u5F8C\u7AEF\u958B\u767C",key:"0-0-1",icon:"anticon-tree",children:[{title:"Node.js API",key:"0-0-1-0",isLeaf:!0,icon:"anticon-api"},{title:"Python \u670D\u52D9",key:"0-0-1-1",isLeaf:!0,icon:"anticon-code"}]}]},{title:"\u6587\u6A94\u7BA1\u7406",key:"0-1",icon:"anticon-branches",children:[{title:"\u6280\u8853\u6587\u6A94",key:"0-1-0",icon:"anticon-node-index",children:[{title:"API \u6587\u6A94",key:"0-1-0-0",isLeaf:!0,icon:"anticon-file-text"},{title:"\u4F7F\u7528\u624B\u518A",key:"0-1-0-1",isLeaf:!0,icon:"anticon-file-text"}]}]}];this.expandedKeys=["0-0","0-0-0","0-0-1","0-1","0-1-0"];this.selectedKeys=[];this.isImportModalVisible=!1;this.importFormat="json";this.importData="";this.importPreview=[]}exportToJSON(){try{let t=JSON.stringify(this.treeData,null,2);this.downloadFile(t,"tree-data.json","application/json"),this.message.success("JSON \u6A94\u6848\u532F\u51FA\u6210\u529F")}catch(t){this.message.error("\u532F\u51FA\u5931\u6557: "+t)}}exportToCSV(){try{let t=this.convertTreeToCSV(this.treeData);this.downloadFile(t,"tree-data.csv","text/csv"),this.message.success("CSV \u6A94\u6848\u532F\u51FA\u6210\u529F")}catch(t){this.message.error("\u532F\u51FA\u5931\u6557: "+t)}}convertTreeToCSV(t,e=0,n=""){let r=`Title,Key,Level,ParentKey,IsLeaf
`;return t.forEach(i=>{r+=`"${i.title}","${i.key}",${e},"${n}",${i.isLeaf?"true":"false"}
`,i.children&&(r+=this.convertTreeToCSV(i.children,e+1,i.key))}),r}downloadFile(t,e,n){let r=new Blob([t],{type:n}),i=window.URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,o.click(),window.URL.revokeObjectURL(i)}showImportModal(){this.isImportModalVisible=!0,this.importData="",this.importPreview=[]}cancelImport(){this.isImportModalVisible=!1,this.importData="",this.importPreview=[]}confirmImport(){if(!this.importData.trim()){this.message.warning("\u8ACB\u8F38\u5165\u8981\u532F\u5165\u7684\u8CC7\u6599");return}try{let t=[];this.importFormat==="json"?t=this.parseJSONData(this.importData):this.importFormat==="csv"&&(t=this.parseCSVData(this.importData)),t.length>0?(this.treeData=t,this.expandedKeys=this.getAllKeys(t),this.message.success("\u8CC7\u6599\u532F\u5165\u6210\u529F"),this.isImportModalVisible=!1):this.message.error("\u532F\u5165\u7684\u8CC7\u6599\u683C\u5F0F\u4E0D\u6B63\u78BA")}catch(t){this.message.error("\u532F\u5165\u5931\u6557: "+t)}}parseJSONData(t){try{let e=JSON.parse(t);if(Array.isArray(e))return e;if(e.data&&Array.isArray(e.data))return e.data;throw new Error("JSON \u683C\u5F0F\u4E0D\u6B63\u78BA")}catch(e){throw new Error("JSON \u89E3\u6790\u5931\u6557: "+e)}}parseCSVData(t){try{let e=t.trim().split(`
`);if(e[0].split(",").map(o=>o.replace(/"/g,"")).length<3)throw new Error("CSV \u683C\u5F0F\u4E0D\u6B63\u78BA");let r=[],i=new Map;for(let o=1;o<e.length;o++){let c=this.parseCSVLine(e[o]);if(c.length>=3){let h={title:c[0].replace(/"/g,""),key:c[1].replace(/"/g,""),isLeaf:c[4]==="true"};i.set(h.key,h)}}return i.forEach(o=>{let c=this.getParentKeyFromCSV(o.key);if(c&&i.has(c)){let h=i.get(c);h.children||(h.children=[]),h.children.push(o)}else r.push(o)}),r}catch(e){throw new Error("CSV \u89E3\u6790\u5931\u6557: "+e)}}parseCSVLine(t){let e=[],n="",r=!1;for(let i=0;i<t.length;i++){let o=t[i];o==='"'?r=!r:o===","&&!r?(e.push(n),n=""):n+=o}return e.push(n),e}getParentKeyFromCSV(t){let e=t.split("-");return e.length>1?(e.pop(),e.join("-")):""}onExpandChange(t){this.expandedKeys=t.keys}onNodeClick(t){console.log("\u7BC0\u9EDE\u9EDE\u64CA:",t),this.selectedKeys=[t.node.key]}resetTree(){this.treeData=[{title:"\u5C08\u6848\u7BA1\u7406",key:"0-0",icon:"anticon-cluster",children:[{title:"\u524D\u7AEF\u958B\u767C",key:"0-0-0",icon:"anticon-node-index",children:[{title:"Angular \u5C08\u6848",key:"0-0-0-0",isLeaf:!0,icon:"anticon-html5"},{title:"React \u5C08\u6848",key:"0-0-0-1",isLeaf:!0,icon:"anticon-code"},{title:"Vue \u5C08\u6848",key:"0-0-0-2",isLeaf:!0,icon:"anticon-code"}]},{title:"\u5F8C\u7AEF\u958B\u767C",key:"0-0-1",icon:"anticon-tree",children:[{title:"Node.js API",key:"0-0-1-0",isLeaf:!0,icon:"anticon-api"},{title:"Python \u670D\u52D9",key:"0-0-1-1",isLeaf:!0,icon:"anticon-code"}]}]},{title:"\u6587\u6A94\u7BA1\u7406",key:"0-1",icon:"anticon-branches",children:[{title:"\u6280\u8853\u6587\u6A94",key:"0-1-0",icon:"anticon-node-index",children:[{title:"API \u6587\u6A94",key:"0-1-0-0",isLeaf:!0,icon:"anticon-file-text"},{title:"\u4F7F\u7528\u624B\u518A",key:"0-1-0-1",isLeaf:!0,icon:"anticon-file-text"}]}]}],this.expandedKeys=["0-0","0-0-0","0-0-1","0-1","0-1-0"],this.message.success("\u6A39\u72C0\u7D50\u69CB\u5DF2\u91CD\u7F6E")}getAllKeys(t){let e=[];return t.forEach(n=>{e.push(n.key),n.children&&e.push(...this.getAllKeys(n.children))}),e}};z.\u0275fac=function(e){return new(e||z)(S(W))},z.\u0275cmp=T({type:z,selectors:[["app-tree-import-export"]],decls:33,vars:7,consts:[["tree",""],["title","\u6A39\u72C0\u532F\u5165\u532F\u51FA\u529F\u80FD"],[2,"margin-bottom","16px"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","download"],["nz-icon","","nzType","file-excel"],["nz-button","","nzType","default",3,"click"],["nz-icon","","nzType","upload"],["nz-icon","","nzType","reload"],[3,"nzExpandChange","nzClick","nzData","nzBlockNode","nzShowLine","nzShowIcon","nzExpandedKeys","nzSelectedKeys"],["nzTitle","\u532F\u5165\u6A39\u72C0\u8CC7\u6599",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible"],[4,"nzModalContent"],[2,"margin-top","16px","padding","16px","background-color","#f5f5f5","border-radius","4px"],["nzType","info","nzMessage","\u652F\u63F4 JSON \u548C CSV \u683C\u5F0F\u7684\u6A39\u72C0\u8CC7\u6599\u532F\u5165",2,"margin-bottom","16px"],["placeholder","\u9078\u64C7\u532F\u5165\u683C\u5F0F",3,"ngModelChange","ngModel"],["nzValue","json","nzLabel","JSON \u683C\u5F0F"],["nzValue","csv","nzLabel","CSV \u683C\u5F0F"],["nz-input","","placeholder","\u8ACB\u8CBC\u4E0A\u8981\u532F\u5165\u7684\u8CC7\u6599...",3,"ngModelChange","ngModel","nzAutosize"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,n){if(e&1){let r=w();a(0,"nz-card",1)(1,"div",2)(2,"nz-space")(3,"button",3),C("click",function(){return m(r),u(n.exportToJSON())}),f(4,"span",4),l(5," \u532F\u51FA JSON "),s(),a(6,"button",3),C("click",function(){return m(r),u(n.exportToCSV())}),f(7,"span",5),l(8," \u532F\u51FA CSV "),s(),a(9,"button",6),C("click",function(){return m(r),u(n.showImportModal())}),f(10,"span",7),l(11," \u532F\u5165\u8CC7\u6599 "),s(),a(12,"button",6),C("click",function(){return m(r),u(n.resetTree())}),f(13,"span",8),l(14," \u91CD\u7F6E "),s()()(),a(15,"nz-tree",9,0),C("nzExpandChange",function(o){return m(r),u(n.onExpandChange(o))})("nzClick",function(o){return m(r),u(n.onNodeClick(o))}),s(),a(17,"nz-modal",10),x("nzVisibleChange",function(o){return m(r),N(n.isImportModalVisible,o)||(n.isImportModalVisible=o),u(o)}),C("nzOnCancel",function(){return m(r),u(n.cancelImport())})("nzOnOk",function(){return m(r),u(n.confirmImport())}),_(18,ye,16,5,"div",11),s(),a(19,"div",12)(20,"h4"),l(21,"\u532F\u5165\u532F\u51FA\u529F\u80FD\u8AAA\u660E\uFF1A"),s(),a(22,"ul")(23,"li"),l(24,"\u652F\u63F4 JSON \u683C\u5F0F\u7684\u5B8C\u6574\u6A39\u72C0\u7D50\u69CB\u532F\u51FA"),s(),a(25,"li"),l(26,"\u652F\u63F4 CSV \u683C\u5F0F\u7684\u6241\u5E73\u5316\u7BC0\u9EDE\u532F\u51FA"),s(),a(27,"li"),l(28,"\u532F\u5165\u6642\u6703\u9A57\u8B49\u8CC7\u6599\u683C\u5F0F\u4E26\u63D0\u4F9B\u9810\u89BD"),s(),a(29,"li"),l(30,"\u532F\u5165\u6703\u8986\u84CB\u73FE\u6709\u7684\u6A39\u72C0\u7D50\u69CB"),s(),a(31,"li"),l(32,"\u5EFA\u8B70\u5728\u532F\u5165\u524D\u5148\u532F\u51FA\u5099\u4EFD"),s()()()()}e&2&&(d(15),g("nzData",n.treeData)("nzBlockNode",!0)("nzShowLine",!0)("nzShowIcon",!0)("nzExpandedKeys",n.expandedKeys)("nzSelectedKeys",n.selectedKeys),d(2),F("nzVisible",n.isImportModalVisible))},dependencies:[D,k,V,me,le,fe,de,K,B,L,O,A,b,M,I,ce,j,J,P,te,ee,$,se,ne,ie,re,ae,oe,Z,X,Y,H,G,pe,ue,q,R,U,Q],encapsulation:2});var Ce=z;export{Ce as TreeImportExportComponent};

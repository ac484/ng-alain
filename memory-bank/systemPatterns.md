# System Patterns

## 架構原則
- 父/子元件分離：合約清單（父）與多次請款（子）完全分離。
- Service/型別/資料流分層：UI 只依賴對應 service，型別安全。
- 設定頁/流程模板/業主清單皆可 CRUD，資料存於 Firestore。
- OnPush 策略、RxJS 資料流、Firestore 結構化資料。

## 主要設計模式
- 動態狀態機（請款流程）：每筆請款根據業主自動選用流程模板，狀態流轉由 service 控制。
- 嵌套表格：合約展開顯示多次請款，子表格支援行內編輯。
- 設定頁設計器：流程模板支援拖拉排序、條件分支、節點 CRUD。 

## UI 標準化設計模式（2024-更新）
- 所有表單、表格、彈窗、通知、分頁、選單、進度條等 UI 元件，**優先使用 ng-zorro-antd 官方元件**。
- 僅在官方元件無法滿足需求時，才自訂元件，並需於設計審查時說明理由。
- UI/UX 設計、重構、審查時，需主動檢查 ng-zorro-antd 是否有現成元件可用。 

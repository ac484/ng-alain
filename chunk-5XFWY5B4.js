import{a as mt}from"./chunk-4YA7LIZZ.js";import{a as Xs}from"./chunk-QVMMJORH.js";import{a as Km,b as Qm}from"./chunk-6FAOYGSK.js";import{C as Ys,E as ut,F as Io,G as Um,H as qm,I as Zs,J as jm,K as Xi,L as Hm,M as $m,N as Yi,O as ea,Q as mn,R as ri,S as ta,T as Bt,U as So,V as Pl,W as Gm,X as Wm,Y as xo,o as Lm,v as Bm}from"./chunk-RTWP4S5F.js";import{I as Fm}from"./chunk-VAGS5EVQ.js";import{b as ua,c as ha,d as da}from"./chunk-PYTCVI2D.js";import{a as cp}from"./chunk-54SOX2ZU.js";import{a as la,b as ap}from"./chunk-XL3LSW66.js";import{a as nr,c as Nn,f as lp,j as up,k as hp,l as dp}from"./chunk-LJN6UZUT.js";import{a as sa,b as aa,c as ca}from"./chunk-3XJPIDKW.js";import{a as km,b as Mm,c as Om,d as xt}from"./chunk-FNQFXT4L.js";import{a as ia,f as Ro}from"./chunk-NI3ZOK2Y.js";import{A as Rm,B as Pm,H as Vm,K as zm,a as om,e as Nl,f as bm,g as Rl,l as Ji,m as Em,n as Qs,o as $e,q as Im,r as Sm,s as St,v as xm,w as Am,x as Dm,y as Js,z as Nm}from"./chunk-LSOUIONA.js";import{a as Zi,b as er}from"./chunk-R3GMTCLS.js";import{b as nm,e as im,g as rm}from"./chunk-TYPW2VOQ.js";import{a as Zm,b as ep}from"./chunk-BP5QTQZC.js";import{a as rp}from"./chunk-4XJX3Z43.js";import{c as tr,e as Vl}from"./chunk-2AKQOGSQ.js";import{f as ra,g as oa,h as np,k as ip}from"./chunk-IKXE7RY5.js";import{a as Be,d as Ue,e as Me}from"./chunk-BDB47AP6.js";import{c as Yt,e as tt,f as tp,g as At}from"./chunk-X4BKJH5O.js";import{a as Dl}from"./chunk-PUYN37MU.js";import{a as Jm,d as na,g as Ao,m as Do,y as No}from"./chunk-Q4M6B46D.js";import{h as wm}from"./chunk-ZUQ3JNJU.js";import{a as Xm,b as Ym}from"./chunk-JAU2U3S7.js";import{a as An,b as Dn}from"./chunk-LGE3RKIU.js";import{c as Cl,d as Zf,e as bl,f as em,g as tm,j as Gi,m as Lt,n as Wi,t as $s}from"./chunk-XKNLJG3X.js";import{H as gm,I as _m,L as Ks,P as ym,a as fm,c as Eo,p as xl,q as xn,r as Et,s as It,t as Ws,u as Al,w as mm,x as pm}from"./chunk-67AL53VY.js";import{i as um,j as Sl,m as hm,w as Tm,x as Cm}from"./chunk-VECD6G7R.js";import{b as lm}from"./chunk-JKCE4WUB.js";import{v as dm}from"./chunk-HFO44OZB.js";import{$b as U,$c as Kf,$h as op,A as wf,Aa as j,Ac as ni,B as at,Ba as Nf,Bd as ft,Ca as Rf,Cb as Ls,Cc as vl,D as Tf,Da as Bi,Dd as Jf,Ea as zt,Fa as Xn,Fb as ct,Fc as $f,G as fl,Gc as ji,H as Cf,Hb as X,Hc as ot,Ia as pl,Ic as wl,Id as ii,Ie as sm,Jb as Y,Jd as Xf,Kb as He,L as ml,Lb as ei,Lc as Fe,Le as El,M as jt,Mb as me,Mc as Le,N as bf,Nb as pe,Ob as S,Oh as se,P as Li,Pa as Pf,Pb as v,Pc as Se,Ph as de,Qa as Vf,Qb as b,Qh as Ki,R as Ef,Rb as V,Rh as Qi,Sa as Yn,Sb as Bf,T as If,Tb as Uf,Th as vm,U as Sf,Uc as Gf,Ue as am,V as xf,Vb as $t,Vc as Wf,Vd as Yf,Wb as Gt,Xb as Wt,Xd as Tl,Ya as Ht,Yb as ee,Yd as $i,Zc as Hi,_a as Ui,_c as lt,aa as Af,ab as zf,ae as Hs,ai as sp,b as ks,bb as kf,bd as Qf,be as et,bf as Il,cb as y,cc as R,d as un,db as Mf,dc as Kt,ec as Qt,fc as Bs,fd as qs,fe as Gs,g as dl,ga as Ct,gb as bo,gc as ti,gd as Ze,gf as cm,h as Oi,hc as hn,ic as dn,id as Ne,ja as Ms,jb as Of,jc as qf,jd as js,kc as jf,lc as _l,mc as ne,na as Df,nc as fn,oa as bt,ob as Q,oc as ie,p as Co,pa as Vt,pb as kt,pc as qi,pe as Xt,qb as Fs,qc as Jt,ra as Os,rc as k,sb as gl,sc as Te,ta as N,tc as ye,u as Qn,ub as J,uc as Hf,v as Jn,vb as Ff,vc as Mt,w as Fi,wb as dt,wc as Ot,xb as Zn,xc as Ft,yc as yl,za as q,zb as Lf,zc as Us}from"./chunk-C2TUN3UK.js";import{a as we,b as Mi,h as vf,i as B}from"./chunk-57BLH6QZ.js";var Iy=["host"],mp=["*"];function Sy(i,e){i&1&&Qt(0)}function xy(i,e){if(i&1){let t=ee();v(0,"a",4),U("click",function(){let r=q(t).$implicit,o=R(2);return j(o.to(r))}),b()}if(i&2){let t=e.$implicit;S("innerHTML",t.title,Ht)}}function Ay(i,e){i&1&&Wt(0)}function Dy(i,e){if(i&1){let t=ee();v(0,"a",5),U("click",function(){let r=q(t).$implicit,o=R(2);return j(o.to(r))}),J(1,Ay,1,0,"ng-container",6),b()}if(i&2){let t=e.$implicit;y(),S("ngTemplateOutlet",t.host())}}function Ny(i,e){if(i&1&&(v(0,"div",0),me(1,xy,1,1,"a",2,He),me(3,Dy,2,1,"a",3,He),b()),i&2){let t=R();y(),pe(t.linkHtmls()),y(2),pe(t.items())}}var fp=(()=>{class i{host=Kf.required("host");href=lt();blankTarget=lt(!1,{transform:Ne});static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["global-footer-item"]],viewQuery:function(n,r){n&1&&jf(r.host,Iy,5),n&2&&_l()},inputs:{href:[1,"href"],blankTarget:[1,"blankTarget"]},exportAs:["globalFooterItem"],ngContentSelectors:mp,decls:2,vars:0,consts:[["host",""]],template:function(n,r){n&1&&(Kt(),Ff(0,Sy,1,0,"ng-template",null,0,Se))},encapsulation:2,changeDetection:0})}return i})(),pp=(()=>{class i{router=N(Lt);win=N(ia);dom=N(Hs);dir=N(Xt).valueSignal;links=lt([]);items=Qf(fp);linkHtmls=Gf(()=>this.links().map(t=>(typeof t.title=="string"&&(t.title=this.dom.bypassSecurityTrustHtml(t.title)),t)));to(t){let n=typeof t.href=="string"?t.href:t.href();if(!n)return;if(typeof t.blankTarget=="boolean"?t.blankTarget:t.blankTarget?.()){this.win.open(n);return}/^https?:\/\//.test(n)?this.win.location.href=n:this.router.navigateByUrl(n)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["global-footer"]],contentQueries:function(n,r,o){n&1&&qf(o,r.items,fp,4),n&2&&_l()},hostVars:4,hostBindings:function(n,r){n&2&&ie("global-footer",!0)("global-footer-rtl",r.dir()==="rtl")},inputs:{links:[1,"links"]},exportAs:["globalFooter"],ngContentSelectors:mp,decls:3,vars:1,consts:[[1,"global-footer__links"],[1,"global-footer__copyright"],[1,"global-footer__links-item",3,"innerHTML"],[1,"global-footer__links-item"],[1,"global-footer__links-item",3,"click","innerHTML"],[1,"global-footer__links-item",3,"click"],[4,"ngTemplateOutlet"]],template:function(n,r){n&1&&(Kt(),X(0,Ny,5,0,"div",0),v(1,"div",1),Qt(2),b()),n&2&&Y(r.linkHtmls().length>0||r.items().length>0?0:-1)},dependencies:[ft],encapsulation:2,changeDetection:0})}return i})();var gp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=kt({type:i});static \u0275inj=Vt({imports:[ii,$s]})}return i})();function Py(i,e){if(i&1){let t=ee();v(0,"li",8),U("click",function(){let r=q(t).$implicit,o=R();return j(o.onThemeChange(r.key))}),k(1),b()}if(i&2){let t=e.$implicit;y(),Te(t.text)}}var Vy=new Os("ALAIN_THEME_BTN_KEYS"),fa=(()=>{class i{doc=N(zt);platform=N(Gs);renderer=N(bo);configSrv=N(rm);theme="default";isDev=qs();types=[{key:"default",text:"Default Theme"},{key:"dark",text:"Dark Theme"},{key:"compact",text:"Compact Theme"}];devTips="When the dark.css file can't be found, you need to run it once: npm run theme";deployUrl="";themeChange=new dt;dir=N(Xt).valueSignal;key=N(Vy,{optional:!0})??"site-theme";ngOnInit(){this.initTheme()}initTheme(){this.platform.isBrowser&&(this.theme=localStorage.getItem(this.key)||"default",this.updateChartTheme(),this.onThemeChange(this.theme))}updateChartTheme(){this.configSrv.set("chart",{theme:this.theme==="dark"?"dark":""})}onThemeChange(t){if(!this.platform.isBrowser)return;this.theme=t,this.themeChange.emit(t),this.renderer.setAttribute(this.doc.body,"data-theme",t);let n=this.doc.getElementById(this.key);if(n&&n.remove(),localStorage.removeItem(this.key),t!=="default"){let r=this.doc.createElement("link");r.type="text/css",r.rel="stylesheet",r.id=this.key,r.href=`${this.deployUrl}assets/style.${t}.css`,localStorage.setItem(this.key,t),this.doc.body.append(r)}this.updateChartTheme()}ngOnDestroy(){let t=this.doc.getElementById(this.key);t!=null&&this.doc.body.removeChild(t)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["theme-btn"]],hostVars:4,hostBindings:function(n,r){n&2&&ie("theme-btn",!0)("theme-btn-rtl",r.dir()==="rtl")},inputs:{types:"types",devTips:"devTips",deployUrl:"deployUrl"},outputs:{themeChange:"themeChange"},decls:10,vars:2,consts:[["menu","nzDropdownMenu"],["nz-dropdown","","nzPlacement","topCenter",1,"ant-avatar","ant-avatar-circle","ant-avatar-icon",3,"nzDropdownMenu"],["nz-tooltip","","role","img","width","21","height","21","viewBox","0 0 21 21","fill","currentColor",1,"anticon",3,"nzTooltipTitle"],["fill-rule","evenodd"],["fill-rule","nonzero"],["d","M7.02 3.635l12.518 12.518a1.863 1.863 0 010 2.635l-1.317 1.318a1.863 1.863 0 01-2.635 0L3.068 7.588A2.795 2.795 0 117.02 3.635zm2.09 14.428a.932.932 0 110 1.864.932.932 0 010-1.864zm-.043-9.747L7.75 9.635l9.154 9.153 1.318-1.317-9.154-9.155zM3.52 12.473c.514 0 .931.417.931.931v.932h.932a.932.932 0 110 1.864h-.932v.931a.932.932 0 01-1.863 0l-.001-.931h-.93a.932.932 0 010-1.864h.93v-.932c0-.514.418-.931.933-.931zm15.374-3.727a1.398 1.398 0 110 2.795 1.398 1.398 0 010-2.795zM4.385 4.953a.932.932 0 000 1.317l2.046 2.047L7.75 7 5.703 4.953a.932.932 0 00-1.318 0zM14.701.36a.932.932 0 01.931.932v.931h.932a.932.932 0 010 1.864h-.933l.001.932a.932.932 0 11-1.863 0l-.001-.932h-.93a.932.932 0 110-1.864h.93v-.931a.932.932 0 01.933-.932z"],["nz-menu","","nzSelectable",""],["nz-menu-item",""],["nz-menu-item","",3,"click"]],template:function(n,r){if(n&1&&(v(0,"div",1),Nf(),v(1,"svg",2)(2,"g",3)(3,"g",4),V(4,"path",5),b()()(),Rf(),v(5,"nz-dropdown-menu",null,0)(7,"ul",6),me(8,Py,2,1,"li",7,He),b()()()),n&2){let o=ne(6);S("nzDropdownMenu",r.types.length>0?o:null),y(),S("nzTooltipTitle",r.isDev?r.devTips:null),y(7),pe(r.types)}},dependencies:[Be,Ue,tt,Yt,tr],encapsulation:2,changeDetection:0})}return i})();function zy(i,e){if(i&1&&(v(0,"div",1),V(1,"i",5),k(2),Fe(3,"i18n"),V(4,"i",6),b()),i&2){R();let t=ne(3);S("nzDropdownMenu",t),y(2),ye(" ",Le(3,2,"menu.lang")," ")}}function ky(i,e){if(i&1&&V(0,"i",2),i&2){R();let t=ne(3);S("nzDropdownMenu",t)}}function My(i,e){if(i&1){let t=ee();v(0,"li",7),U("click",function(){let r=q(t).$implicit,o=R();return j(o.change(r.code))}),v(1,"span",8),k(2),b(),k(3),b()}if(i&2){let t=e.$implicit,n=R();S("nzSelected",t.code===n.curLangCode),y(),ct("aria-label",t.text),y(),Te(t.abbr),y(),ye(" ",t.text," ")}}var ir=class ir{constructor(){this.settings=N($e);this.i18n=N(Ji);this.doc=N(zt);this.showLangText=!0}get langs(){return this.i18n.getLangs()}get curLangCode(){return this.settings.layout.lang}change(e){let t=this.doc.createElement("div");t.setAttribute("class","page-loading ant-spin ant-spin-lg ant-spin-spinning"),t.innerHTML='<span class="ant-spin-dot ant-spin-dot-spin"><i></i><i></i><i></i><i></i></span>',this.doc.body.appendChild(t),this.i18n.loadLangData(e).subscribe(n=>{this.i18n.use(e,n),this.settings.setLayout("lang",e),setTimeout(()=>this.doc.location.reload())})}};ir.\u0275fac=function(t){return new(t||ir)},ir.\u0275cmp=Q({type:ir,selectors:[["header-i18n"]],hostVars:2,hostBindings:function(t,n){t&2&&ie("flex-1",!0)},inputs:{showLangText:[2,"showLangText","showLangText",Ne]},decls:7,vars:1,consts:[["langMenu","nzDropdownMenu"],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-dropdown","","nzPlacement","bottomRight","nz-icon","","nzType","global",3,"nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"nzSelected"],["nz-icon","","nzType","global"],["nz-icon","","nzType","down"],["nz-menu-item","",3,"click","nzSelected"],["role","img",1,"pr-xs"]],template:function(t,n){t&1&&(X(0,zy,5,4,"div",1)(1,ky,1,1,"i",2),v(2,"nz-dropdown-menu",null,0)(4,"ul",3),me(5,My,4,4,"li",4,He),b()()),t&2&&(Y(n.showLangText?0:1),y(5),pe(n.langs))},dependencies:[Me,tt,Yt,Be,Ue,de,se,At,St],encapsulation:2,changeDetection:0});var rr=ir;var ar=class ar{constructor(){this.tokenService=N(mt);this.links=[{title:"\u5E2E\u52A9",href:""},{title:"\u9690\u79C1",href:""},{title:"\u6761\u6B3E",href:""}]}ngOnInit(){this.tokenService.clear()}};ar.\u0275fac=function(t){return new(t||ar)},ar.\u0275cmp=Q({type:ar,selectors:[["layout-passport"]],decls:19,vars:1,consts:[[1,"container"],["showLangText","false",1,"langs"],[1,"wrap"],[1,"top"],[1,"head"],["src","./assets/logo-color.svg",1,"logo"],[1,"title"],[1,"desc"],[3,"links"],["nz-icon","","nzType","copyright"],["href","//github.com/cipchk","target","_blank"]],template:function(t,n){t&1&&(v(0,"div",0),V(1,"header-i18n",1),v(2,"div",2)(3,"div",3)(4,"div",4),V(5,"img",5),v(6,"span",6),k(7,"NG-ALAIN"),b()(),v(8,"div",7),k(9,"\u6B66\u6797\u4E2D\u6700\u6709\u5F71\u54CD\u529B\u7684\u300A\u8475\u82B1\u5B9D\u5178\u300B\uFF1B\u6B32\u7EC3\u795E\u529F\uFF0C\u6325\u5200\u81EA\u5BAB"),b()(),V(10,"router-outlet"),v(11,"global-footer",8),k(12," Copyright "),V(13,"i",9),k(14," 2023 "),v(15,"a",10),k(16,"\u5361\u8272"),b(),k(17,"\u51FA\u54C1 "),b()()(),V(18,"theme-btn")),t&2&&(y(11),S("links",n.links))},dependencies:[Gi,rr,gp,pp,de,se,fa],styles:["[_nghost-%COMP%]     .container{display:flex;flex-direction:column;min-height:100%;background:#f0f2f5}[_nghost-%COMP%]     .langs{width:100%;height:40px;line-height:44px;text-align:right}[_nghost-%COMP%]     .langs .anticon{cursor:pointer;margin-top:24px;margin-right:24px;font-size:14px;vertical-align:top}[_nghost-%COMP%]     .wrap{flex:1;padding:32px 0}[_nghost-%COMP%]     .ant-form-item{display:flex;justify-content:space-between;margin-bottom:24px}[_nghost-%COMP%]     .top{text-align:center}[_nghost-%COMP%]     .header{height:44px;line-height:44px}[_nghost-%COMP%]     .header a{text-decoration:none}[_nghost-%COMP%]     .logo{height:44px;margin-right:16px}[_nghost-%COMP%]     .title{position:relative;font-family:Myriad Pro,Helvetica Neue,Arial,Helvetica,sans-serif;font-size:33px;font-weight:600;color:#000000d9;vertical-align:middle}[_nghost-%COMP%]     .desc{margin-top:12px;margin-bottom:40px;font-size:14px;color:#00000073}@media (min-width: 768px){[_nghost-%COMP%]     .container{background-image:url(https://gw.alipayobjects.com/zos/rmsportal/TVYTbAXWheQpRcWDaDMu.svg);background-repeat:no-repeat;background-position:center 110px;background-size:100%}[_nghost-%COMP%]     .wrap{padding:32px 0 24px}}[data-theme=dark]   [_nghost-%COMP%]     .container{background:#141414}[data-theme=dark]   [_nghost-%COMP%]     .title{color:#ffffffd9}[data-theme=dark]   [_nghost-%COMP%]     .desc{color:#ffffff73}@media (min-width: 768px){[data-theme=dark]   [_nghost-%COMP%]     .container{background-image:none}}[data-theme=compact]   [_nghost-%COMP%]     .ant-form-item{margin-bottom:16px}"]});var _p=ar;var Fy=["host"],yp=["*"];function Ly(i,e){i&1&&Qt(0)}var oi=i=>({$implicit:i});function By(i,e){if(i&1&&V(0,"nz-icon",3),i&2){let t=R(2).$implicit;S("nzType",t.value)("nzTheme",t.theme)("nzSpin",t.spin)("nzTwotoneColor",t.twoToneColor)("nzIconfont",t.iconfont)("nzRotate",t.rotate)}}function Uy(i,e){if(i&1&&V(0,"nz-icon",4),i&2){let t=R(2).$implicit;S("nzIconfont",t.iconfont)}}function qy(i,e){if(i&1&&V(0,"img",5),i&2){let t=R(2).$implicit;S("src",t.value,Ui)}}function jy(i,e){if(i&1&&V(0,"span",6),i&2){let t=R(2).$implicit;S("innerHTML",t.value,Ht)}}function Hy(i,e){if(i&1&&V(0,"i"),i&2){let t=R(2).$implicit;Jt(vl("sidebar-nav__item-icon ",t.value))}}function $y(i,e){if(i&1&&X(0,By,1,6,"nz-icon",3)(1,Uy,1,1,"nz-icon",4)(2,qy,1,1,"img",5)(3,jy,1,1,"span",6)(4,Hy,1,3,"i",7),i&2){let t,n=R().$implicit;Y((t=n.type)==="icon"?0:t==="iconfont"?1:t==="img"?2:t==="svg"?3:4)}}function Gy(i,e){if(i&1&&X(0,$y,5,1),i&2){let t=e.$implicit;Y(t?0:-1)}}function Wy(i,e){i&1&&V(0,"li",8)}function Ky(i,e){}function Qy(i,e){if(i&1&&(v(0,"span",16),J(1,Ky,0,0,"ng-template",17),b()),i&2){let t=R(5).$implicit;R(2);let n=ne(1);S("nzTooltipTitle",t.text),y(),S("ngTemplateOutlet",n)("ngTemplateOutletContext",ot(3,oi,t.icon))}}function Jy(i,e){}function Xy(i,e){if(i&1&&J(0,Jy,0,0,"ng-template",17),i&2){let t=R(5).$implicit;R(2);let n=ne(1);S("ngTemplateOutlet",n)("ngTemplateOutletContext",ot(2,oi,t.icon))}}function Yy(i,e){if(i&1&&X(0,Qy,2,5,"span",16)(1,Xy,1,4,null,17),i&2){let t=R(6);Y(t.collapsed?0:1)}}function Zy(i,e){if(i&1){let t=ee();v(0,"a",14),U("click",function(){q(t);let r=R(3).$implicit,o=R(2);return j(o.to(r))})("mouseenter",function(){q(t);let r=R(5);return j(r.closeSubMenu())}),X(1,Yy,2,1),V(2,"span",15),b()}if(i&2){let t=R(3).$implicit;ie("sidebar-nav__item-disabled",t.disabled),ct("data-id",t._id),y(),Y(t._needIcon?1:-1),y(),S("innerHTML",t._text,Ht),ct("title",t.text)}}function ev(i,e){}function tv(i,e){if(i&1){let t=ee();v(0,"a",14),U("click",function(){q(t);let r=R(3).$implicit,o=R(2);return j(o.toggleOpen(r))})("mouseenter",function(r){q(t);let o=R(3).$implicit,a=R(2);return j(a.showSubMenu(r,o))}),J(1,ev,0,0,"ng-template",17),V(2,"span",15)(3,"i",18),b()}if(i&2){let t=R(3).$implicit;R(2);let n=ne(1);y(),S("ngTemplateOutlet",n)("ngTemplateOutletContext",ot(4,oi,t.icon)),y(),S("innerHTML",t._text,Ht),ct("title",t.text)}}function nv(i,e){if(i&1&&V(0,"nz-badge",13),i&2){let t=R(3).$implicit;S("nzCount",t.badge)("nzDot",t.badgeDot)("nzOverflowCount",t.badgeOverflowCount?t.badgeOverflowCount:9)}}function iv(i,e){}function rv(i,e){if(i&1&&(v(0,"ul"),J(1,iv,0,0,"ng-template",17),b()),i&2){let t=R(3).$implicit;R(2);let n=ne(3);Jt(vl("sidebar-nav sidebar-nav__sub sidebar-nav__depth",t._depth)),y(),S("ngTemplateOutlet",n)("ngTemplateOutletContext",ot(5,oi,t.children))}}function ov(i,e){if(i&1&&(v(0,"li",10),X(1,Zy,3,6,"a",11),X(2,tv,4,6,"a",12),X(3,nv,1,3,"nz-badge",13),X(4,rv,2,7,"ul",7),b()),i&2){let t=R(2).$implicit;ie("sidebar-nav__selected",t._selected)("sidebar-nav__open",t.open),y(),Y(t.children.length===0?1:-1),y(),Y(t.children.length>0?2:-1),y(),Y(t.badge?3:-1),y(),Y(t.children.length>0?4:-1)}}function sv(i,e){if(i&1&&X(0,Wy,1,0,"li",8)(1,ov,5,8,"li",9),i&2){let t=R().$implicit;Y(t.render_type==="divider"?0:1)}}function av(i,e){if(i&1&&X(0,sv,2,1),i&2){let t=e.$implicit;Y(t._hidden!==!0?0:-1)}}function cv(i,e){if(i&1&&me(0,av,1,1,null,null,He),i&2){let t=e.$implicit;pe(t)}}function lv(i,e){if(i&1&&(v(0,"li",19),V(1,"span",20),b()),i&2){let t=R().$implicit;y(),S("innerHTML",t._text,Ht)}}function uv(i,e){}function hv(i,e){if(i&1&&(X(0,lv,2,1,"li",19),J(1,uv,0,0,"ng-template",17)),i&2){let t=e.$implicit;R();let n=ne(3);Y(t.group?0:-1),y(),S("ngTemplateOutlet",n)("ngTemplateOutletContext",ot(3,oi,t.children))}}function dv(i,e){i&1&&Wt(0)}function fv(i,e){if(i&1&&(v(0,"li"),J(1,dv,1,0,"ng-container",8),b()),i&2){let t=e.$implicit;ie("hidden-mobile",t.hidden==="mobile")("hidden-pc",t.hidden==="pc"),y(),S("ngTemplateOutlet",t.host)}}function mv(i,e){if(i&1&&me(0,fv,2,5,"li",7,He),i&2){let t=e.$implicit;pe(t)}}function pv(i,e){i&1&&Wt(0)}function gv(i,e){if(i&1&&J(0,pv,1,0,"ng-container",8),i&2){let t=R();S("ngTemplateOutlet",t.opt.logo)}}function _v(i,e){if(i&1&&(v(0,"a",2),V(1,"img",9)(2,"img",10),b()),i&2){let t=R();S("routerLink",t.opt.logoLink),y(),ct("src",t.opt.logoExpanded,Ui)("alt",t.app.name),y(),ct("src",t.opt.logoCollapsed,Ui)("alt",t.app.name)}}function yv(i,e){if(i&1){let t=ee();v(0,"li")(1,"div",11),U("click",function(){q(t);let r=R();return j(r.toggleCollapsed())}),V(2,"nz-icon",12),b()()}if(i&2){let t=R();y(2),S("nzType",t.collapsedIcon)}}function vv(i,e){}function wv(i,e){i&1&&Wt(0)}function Tv(i,e){if(i&1&&(v(0,"div",6),J(1,wv,1,0,"ng-container",8),b()),i&2){let t=R();y(),S("ngTemplateOutlet",t.middle[0].host)}}function Cv(i,e){}function bv(i,e){i&1&&V(0,"div",0)}function Ev(i,e){if(i&1&&V(0,"layout-default-header",1),i&2){let t=R();S("items",t.headerItems)}}function Iv(i,e){i&1&&Wt(0)}function Sv(i,e){i&1&&Wt(0)}function xv(i,e){i&1&&V(0,"layout-default-nav")}function Av(i,e){i&1&&Wt(0)}function Dv(i,e){if(i&1&&J(0,Av,1,0,"ng-container",4),i&2){let t=R(3);S("ngTemplateOutlet",t.asideBottom)}}function Nv(i,e){if(i&1){let t=ee();v(0,"div",9),U("click",function(){q(t);let r=R(3);return j(r.toggleCollapsed())}),V(1,"nz-icon",10),b()}if(i&2){let t=R(3);y(),S("nzType",t.collapsedIcon)}}function Rv(i,e){if(i&1&&(v(0,"div",7),X(1,Dv,1,1,"ng-container")(2,Nv,2,1,"div",8),b()),i&2){let t=R(2);y(),Y(t.asideBottom?1:2)}}function Pv(i,e){if(i&1&&(v(0,"div",2)(1,"div",5)(2,"div",6),J(3,Iv,1,0,"ng-container",4)(4,Sv,1,0,"ng-container",4),X(5,xv,1,0,"layout-default-nav"),b(),X(6,Rv,3,1,"div",7),b()()),i&2){let t=R();y(3),S("ngTemplateOutlet",t.asideUser),y(),S("ngTemplateOutlet",t.nav),y(),Y(t.nav?-1:5),y(),Y(t.opt.showSiderCollapse?6:-1)}}function Vv(i,e){i&1&&Wt(0)}var Ol=(()=>{class i{host;hidden="none";direction="right";static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["layout-default-header-item"]],viewQuery:function(n,r){if(n&1&&ti(Fy,7),n&2){let o;hn(o=dn())&&(r.host=o.first)}},inputs:{hidden:"hidden",direction:"direction"},standalone:!1,ngContentSelectors:yp,decls:2,vars:0,consts:[["host",""]],template:function(n,r){n&1&&(Kt(),J(0,Ly,1,0,"ng-template",null,0,Se))},encapsulation:2})}return i})(),zl={logoExpanded:"./assets/logo-full.svg",logoCollapsed:"./assets/logo.svg",logoLink:"/",showHeaderCollapse:!0,showSiderCollapse:!1,hideAside:!1,hideHeader:!1},vp=(()=>{class i{settings=N($e);bm=N(vm);_options$=new Oi(zl);_options=zl;get options(){return this._options}get options$(){return this._options$.asObservable()}get collapsedIcon(){let t=this.settings.layout.collapsed,n=t?"unfold":"fold";return this.settings.layout.direction==="rtl"&&(n=t?"fold":"unfold"),`menu-${n}`}constructor(){let t="only screen and (max-width: 767.99px)";this.bm.observe(t).pipe(et()).subscribe(n=>this.checkMedia(n.matches)),this.checkMedia(this.bm.isMatched(t))}checkMedia(t){this.settings.setLayout("collapsed",t)}notify(){this._options$.next(this._options)}setOptions(t){this._options=we(we({},zl),t),this.notify()}toggleCollapsed(t){this.settings.setLayout("collapsed",t??!this.settings.layout.collapsed),this.notify()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=bt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),kl="sidebar-nav__floating-show",Ml="sidebar-nav__floating",zv=(()=>{class i{doc=N(zt);win=N(ia);router=N(Lt);render=N(bo);menuSrv=N(Qs);settings=N($e);cdr=N(Ze);ngZone=N(Zn);sanitizer=N(Hs);bodyEl;destroy$=N(Xn);floatingEl;dir=N(Xt).valueSignal;list=[];disabledAcl=!1;autoCloseUnderPad=!0;recursivePath=!0;hideEmptyChildren=!0;set openStrictly(t){this.menuSrv.openStrictly=t}maxLevelIcon=3;select=new dt;get collapsed(){return this.settings.layout.collapsed}getLinkNode(t){return t=t.nodeName==="A"?t:t.parentNode,t.nodeName!=="A"?null:t}floatingClickHandle(t){t.stopPropagation();let n=this.getLinkNode(t.target);if(n==null)return!1;let r=+n.dataset.id;if(isNaN(r))return!1;let o;return this.menuSrv.visit(this.list,a=>{!o&&a._id===r&&(o=a)}),this.to(o),this.hideAll(),t.preventDefault(),!1}clearFloating(){this.floatingEl&&(this.floatingEl.removeEventListener("click",this.floatingClickHandle.bind(this)),this.floatingEl.parentNode?.removeChild(this.floatingEl))}genFloating(){this.clearFloating(),this.floatingEl=this.render.createElement("div"),this.floatingEl.classList.add(`${Ml}-container`),this.floatingEl.addEventListener("click",this.floatingClickHandle.bind(this),!1),this.bodyEl.appendChild(this.floatingEl)}genSubNode(t,n){let r=`_sidebar-nav-${n._id}`,a=(n.badge?t.nextElementSibling.nextElementSibling:t.nextElementSibling).cloneNode(!0);return a.id=r,a.classList.add(Ml),a.addEventListener("mouseleave",()=>{a.classList.remove(kl)},!1),this.floatingEl.appendChild(a),a}hideAll(){this.floatingEl.querySelectorAll(`.${Ml}`).forEach(n=>n.classList.remove(kl))}calPos(t,n){let r=t.getBoundingClientRect(),o=Math.max(this.doc.documentElement.scrollTop,this.bodyEl.scrollTop),a=Math.max(this.doc.documentElement.clientHeight,this.bodyEl.clientHeight),l=5,h=-l;a<r.top+n.clientHeight&&(h=r.top+n.clientHeight-a+l),n.style.top=`${r.top+o-h}px`,this.dir()==="rtl"?n.style.right=`${r.width+l}px`:n.style.left=`${r.right+l}px`}showSubMenu(t,n){if(this.collapsed!==!0)return;t.preventDefault();let r=t.target;this.genFloating();let o=this.genSubNode(r,n);this.hideAll(),o.classList.add(kl),this.calPos(r,o)}to(t){if(this.select.emit(t),!t.disabled){if(t.externalLink){t.target==="_blank"?this.win.open(t.externalLink):this.win.location.href=t.externalLink;return}this.ngZone.run(()=>this.router.navigateByUrl(t.link))}}toggleOpen(t){this.menuSrv.toggleOpen(t)}_click(){this.isPad&&this.collapsed&&(this.openAside(!1),this.hideAll())}closeSubMenu(){this.collapsed&&this.hideAll()}openByUrl(t){let{menuSrv:n,recursivePath:r}=this;this.menuSrv.open(n.find({url:t,recursive:r}))}ngOnInit(){let{doc:t,router:n,menuSrv:r,settings:o,cdr:a}=this;this.bodyEl=t.querySelector("body"),r.change.pipe(et(this.destroy$)).subscribe(l=>{r.visit(l,(h,d,_)=>{h._text=this.sanitizer.bypassSecurityTrustHtml(h.text),h._needIcon=_<=this.maxLevelIcon&&!!h.icon,h._aclResult||(this.disabledAcl?h.disabled=!0:h._hidden=!0);let w=h.icon;w&&w.type==="svg"&&typeof w.value=="string"&&(w.value=this.sanitizer.bypassSecurityTrustHtml(w.value))}),this.hideEmptyChildren&&this.fixHide(l),this.list=l.filter(h=>h._hidden!==!0),a.detectChanges()}),n.events.pipe(et(this.destroy$)).subscribe(l=>{l instanceof Cl&&(this.openByUrl(l.urlAfterRedirects),this.underPad(),this.cdr.detectChanges())}),o.notify.pipe(et(this.destroy$),jt(l=>l.type==="layout"&&l.name==="collapsed")).subscribe(()=>this.clearFloating()),this.underPad(),this.openByUrl(n.url),this.ngZone.runOutsideAngular(()=>this.genFloating())}fixHide(t){let n=r=>{for(let o of r)o.children&&o.children.length>0&&(n(o.children),o._hidden||(o._hidden=o.children.every(a=>a._hidden)))};n(t)}ngOnDestroy(){this.clearFloating()}get isPad(){return this.doc.defaultView.innerWidth<768}underPad(){this.autoCloseUnderPad&&this.isPad&&!this.collapsed&&setTimeout(()=>this.openAside(!0))}openAside(t){this.settings.setLayout("collapsed",t)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["layout-default-nav"]],hostVars:2,hostBindings:function(n,r){n&1&&U("click",function(){return r._click()})("click",function(){return r.closeSubMenu()},kf),n&2&&ie("d-block",!0)},inputs:{disabledAcl:[2,"disabledAcl","disabledAcl",Ne],autoCloseUnderPad:[2,"autoCloseUnderPad","autoCloseUnderPad",Ne],recursivePath:[2,"recursivePath","recursivePath",Ne],hideEmptyChildren:[2,"hideEmptyChildren","hideEmptyChildren",Ne],openStrictly:[2,"openStrictly","openStrictly",Ne],maxLevelIcon:[2,"maxLevelIcon","maxLevelIcon",js]},outputs:{select:"select"},standalone:!1,decls:7,vars:0,consts:[["icon",""],["tree",""],[1,"sidebar-nav"],[1,"sidebar-nav__item-icon",3,"nzType","nzTheme","nzSpin","nzTwotoneColor","nzIconfont","nzRotate"],[1,"sidebar-nav__item-icon",3,"nzIconfont"],[1,"sidebar-nav__item-icon","sidebar-nav__item-img",3,"src"],[1,"sidebar-nav__item-icon","sidebar-nav__item-svg",3,"innerHTML"],[3,"class"],[1,"sidebar-nav__divider"],[1,"sidebar-nav__item",3,"sidebar-nav__selected","sidebar-nav__open"],[1,"sidebar-nav__item"],[1,"sidebar-nav__item-link",3,"sidebar-nav__item-disabled"],[1,"sidebar-nav__item-link"],["nzStandalone","",3,"nzCount","nzDot","nzOverflowCount"],[1,"sidebar-nav__item-link",3,"click","mouseenter"],[1,"sidebar-nav__item-text",3,"innerHTML"],["nz-tooltip","","nzTooltipPlacement","right",3,"nzTooltipTitle"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"sidebar-nav__sub-arrow"],[1,"sidebar-nav__item","sidebar-nav__group-title"],[3,"innerHTML"]],template:function(n,r){n&1&&(J(0,Gy,1,1,"ng-template",null,0,Se)(2,cv,2,0,"ng-template",null,1,Se),v(4,"ul",2),me(5,hv,2,5,null,null,He),b()),n&2&&(y(5),pe(r.list))},dependencies:[ft,tr,se,Zi],encapsulation:2,changeDetection:0})}return Co([Ro()],i.prototype,"showSubMenu",null),i})(),kv=(()=>{class i{settings=N($e);srv=N(vp);cdr=N(Ze);destroy$=N(Xn);items;left=[];middle=[];right=[];get opt(){return this.srv.options}get app(){return this.settings.app}get collapsed(){return this.settings.layout.collapsed}get collapsedIcon(){return this.srv.collapsedIcon}refresh(){let t=this.items.toArray();this.left=t.filter(n=>n.direction==="left"),this.middle=t.filter(n=>n.direction==="middle"),this.right=t.filter(n=>n.direction==="right"),this.cdr.detectChanges()}ngAfterViewInit(){this.items.changes.pipe(et(this.destroy$)).subscribe(()=>this.refresh()),this.srv.options$.pipe(et(this.destroy$)).subscribe(()=>this.cdr.detectChanges()),this.refresh()}toggleCollapsed(){this.srv.toggleCollapsed()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["layout-default-header"]],hostVars:2,hostBindings:function(n,r){n&2&&ie("alain-default__header",!0)},inputs:{items:"items"},standalone:!1,decls:12,vars:13,consts:[["render",""],[1,"alain-default__header-logo"],[1,"alain-default__header-logo-link",3,"routerLink"],[1,"alain-default__nav-wrap"],[1,"alain-default__nav"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"alain-default__nav","alain-default__nav-middle"],[3,"hidden-mobile","hidden-pc"],[4,"ngTemplateOutlet"],[1,"alain-default__header-logo-expanded"],[1,"alain-default__header-logo-collapsed"],[1,"alain-default__nav-item","alain-default__nav-item--collapse",3,"click"],[3,"nzType"]],template:function(n,r){if(n&1&&(J(0,mv,2,0,"ng-template",null,0,Se),v(2,"div",1),X(3,gv,1,1,"ng-container")(4,_v,3,5,"a",2),b(),v(5,"div",3)(6,"ul",4),X(7,yv,3,1,"li"),J(8,vv,0,0,"ng-template",5),b(),X(9,Tv,2,1,"div",6),v(10,"ul",4),J(11,Cv,0,0,"ng-template",5),b()()),n&2){let o=ne(1);y(2),fn("width",r.opt.logoFixWidth,"px"),y(),Y(r.opt.logo?3:4),y(4),Y(!r.opt.hideAside&&r.opt.showHeaderCollapse?7:-1),y(),S("ngTemplateOutlet",o)("ngTemplateOutletContext",ot(9,oi,r.left)),y(),Y(r.middle.length>0?9:-1),y(2),S("ngTemplateOutlet",o)("ngTemplateOutletContext",ot(11,oi,r.right))}},dependencies:[ft,Wi,se],encapsulation:2,changeDetection:0})}return i})(),wp=(()=>{class i{headerItems;get opt(){return this.srv.options}set options(t){this.srv.setOptions(t)}asideUser=null;asideBottom=null;nav=null;content=null;customError;fetchingStrictly=!1;fetching=!1;isFetching=!1;get showFetching(){return this.fetchingStrictly?this.fetching:this.isFetching}get collapsed(){return this.settings.layout.collapsed}get collapsedIcon(){return this.srv.collapsedIcon}toggleCollapsed(){this.srv.toggleCollapsed()}router=N(Lt);msgSrv=N(xt);settings=N($e);el=N(Yn);renderer=N(bo);doc=N(zt);srv=N(vp);constructor(){this.router.events.pipe(et(),jt(()=>!this.fetchingStrictly)).subscribe(t=>this.processEv(t)),this.srv.options$.pipe(et()).subscribe(()=>this.setClass()),this.settings.notify.pipe(et()).subscribe(()=>this.setClass())}processEv(t){if(!this.isFetching&&t instanceof em&&(this.isFetching=!0),t instanceof bl||t instanceof Zf){this.isFetching=!1;let n=this.customError===null?null:this.customError??`Could not load ${t.url} route`;n&&t instanceof bl&&this.msgSrv.error(n,{nzDuration:1e3*3});return}(t instanceof Cl||t instanceof tm)&&this.isFetching&&setTimeout(()=>{this.isFetching=!1},100)}setClass(){let{el:t,doc:n,renderer:r,settings:o}=this,a=o.layout;zm(t.nativeElement,r,{"alain-default":!0,"alain-default__fixed":a.fixed,"alain-default__collapsed":a.collapsed,"alain-default__hide-aside":this.opt.hideAside,"alain-default__hide-header":this.opt.hideHeader}),n.body.classList[a.colorWeak?"add":"remove"]("color-weak")}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["layout-default"]],contentQueries:function(n,r,o){if(n&1&&Bs(o,Ol,4),n&2){let a;hn(a=dn())&&(r.headerItems=a)}},inputs:{options:"options",asideUser:"asideUser",asideBottom:"asideBottom",nav:"nav",content:"content",customError:"customError",fetchingStrictly:[2,"fetchingStrictly","fetchingStrictly",Ne],fetching:[2,"fetching","fetching",Ne]},exportAs:["layoutDefault"],standalone:!1,ngContentSelectors:yp,decls:6,vars:4,consts:[[1,"alain-default__progress-bar"],[3,"items"],[1,"alain-default__aside"],[1,"alain-default__content"],[4,"ngTemplateOutlet"],[1,"alain-default__aside-wrap"],[1,"alain-default__aside-inner"],[1,"alain-default__aside-link"],[1,"alain-default__aside-link-collapsed"],[1,"alain-default__aside-link-collapsed",3,"click"],[3,"nzType"]],template:function(n,r){n&1&&(Kt(),X(0,bv,1,0,"div",0),X(1,Ev,1,1,"layout-default-header",1),X(2,Pv,7,4,"div",2),v(3,"section",3),J(4,Vv,1,0,"ng-container",4),Qt(5),b()),n&2&&(Y(r.showFetching?0:-1),y(),Y(r.opt.hideHeader?-1:1),y(),Y(r.opt.hideAside?-1:2),y(2),S("ngTemplateOutlet",r.content))},dependencies:[ft,se,zv,kv],encapsulation:2})}return i})(),Tp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=Fs({type:i,selectors:[["","layout-default-header-item-trigger",""]],hostVars:2,hostBindings:function(n,r){n&2&&ie("alain-default__nav-item",!0)},standalone:!1})}return i})();var Cp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=kt({type:i});static \u0275inj=Vt({imports:[ii,$s,Vl,de,Nn,Me,er]})}return i})();var Ll=()=>({standalone:!0});function Fv(i,e){if(i&1){let t=ee();v(0,"input",6),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.i.value,r)||(o.i.value=r),j(r)}),b()}if(i&2){let t=R();Mt("ngModel",t.i.value),S("ngModelOptions",ji(2,Ll))}}function Lv(i,e){if(i&1){let t=ee();v(0,"input",7),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.i.value,r)||(o.i.value=r),j(r)}),b()}if(i&2){let t=R();Mt("ngModel",t.i.value),S("ngModelOptions",ji(2,Ll))}}function Bv(i,e){if(i&1){let t=ee();v(0,"nz-input-number",8),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.pxVal,r)||(o.pxVal=r),j(r)}),U("ngModelChange",function(r){q(t);let o=R();return j(o.pxChange(r))}),b()}if(i&2){let t=R();Mt("ngModel",t.pxVal),S("nzMin",t.i.min)("nzMax",t.i.max)("nzStep",t.i.step||2)("nzFormatter",t.format)}}function Uv(i,e){if(i&1){let t=ee();v(0,"nz-switch",9),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.i.value,r)||(o.i.value=r),j(r)}),b()}if(i&2){let t=R();Mt("ngModel",t.i.value),S("ngModelOptions",ji(2,Ll))}}function qv(i,e){}function jv(i,e){i&1&&J(0,qv,0,0,"ng-template",5)}var Hv=i=>({"background-color":i});function $v(i,e){i&1&&V(0,"nz-icon",20)}function Gv(i,e){if(i&1){let t=ee();v(0,"span",19),U("click",function(){let r=q(t).$implicit,o=R(2);return j(o.changeColor(r.color))}),X(1,$v,1,0,"nz-icon",20),b()}if(i&2){let t=e.$implicit,n=R(2);qi(ot(4,Hv,t.color)),S("nzTooltipTitle",t.key),y(),Y(n.color===t.color?1:-1)}}function Wv(i,e){if(i&1){let t=ee();v(0,"div",4)(1,"div",5)(2,"h3",6),k(3,"\u4E3B\u9898\u8272"),b(),me(4,Gv,2,6,"span",7,He),b(),V(6,"nz-divider"),v(7,"div",8)(8,"h3",6),k(9,"\u8BBE\u7F6E"),b(),v(10,"nz-tabs")(11,"nz-tab",9)(12,"div",8),V(13,"setting-drawer-item",10)(14,"setting-drawer-item",10)(15,"setting-drawer-item",10),b()(),v(16,"nz-tab",11),V(17,"setting-drawer-item",10)(18,"setting-drawer-item",10)(19,"setting-drawer-item",10)(20,"setting-drawer-item",10),b(),v(21,"nz-tab",12),V(22,"setting-drawer-item",10)(23,"setting-drawer-item",10)(24,"setting-drawer-item",10)(25,"setting-drawer-item",10),b(),v(26,"nz-tab",13),V(27,"setting-drawer-item",10)(28,"setting-drawer-item",10)(29,"setting-drawer-item",10)(30,"setting-drawer-item",10)(31,"setting-drawer-item",10)(32,"setting-drawer-item",10),b()()(),V(33,"nz-divider"),v(34,"div",8)(35,"div",14),k(36," \u56FA\u5B9A\u5934\u548C\u4FA7\u8FB9\u680F "),v(37,"nz-switch",15),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.layout.fixed,r)||(o.layout.fixed=r),j(r)}),U("ngModelChange",function(){q(t);let r=R();return j(r.setLayout("fixed",r.layout.fixed))}),b()(),v(38,"div",14),k(39," \u8272\u5F31\u6A21\u5F0F "),v(40,"nz-switch",15),Ft("ngModelChange",function(r){q(t);let o=R();return Ot(o.layout.colorWeak,r)||(o.layout.colorWeak=r),j(r)}),U("ngModelChange",function(){q(t);let r=R();return j(r.setLayout("colorWeak",r.layout.colorWeak))}),b()()(),V(41,"nz-divider"),v(42,"button",16),U("click",function(){q(t);let r=R();return j(r.apply())}),k(43,"\u9884\u89C8"),b(),v(44,"button",17),U("click",function(){q(t);let r=R();return j(r.reset())}),k(45,"\u91CD\u7F6E"),b(),v(46,"button",17),U("click",function(){q(t);let r=R();return j(r.copyVar())}),k(47,"\u62F7\u8D1D"),b(),V(48,"nz-alert",18),b()}if(i&2){let t=R();y(4),pe(t.colors),y(9),S("data",t.data["alain-default-header-hg"]),y(),S("data",t.data["alain-default-header-bg"]),y(),S("data",t.data["alain-default-header-padding"]),y(2),S("data",t.data["alain-default-aside-wd"]),y(),S("data",t.data["alain-default-aside-bg"]),y(),S("data",t.data["alain-default-aside-collapsed-wd"]),y(),S("data",t.data["alain-default-aside-nav-padding-top-bottom"]),y(2),S("data",t.data["alain-default-content-bg"]),y(),S("data",t.data["alain-default-content-heading-bg"]),y(),S("data",t.data["alain-default-content-heading-border"]),y(),S("data",t.data["alain-default-content-padding"]),y(2),S("data",t.data["form-state-visual-feedback-enabled"]),y(),S("data",t.data["preserve-white-spaces-enabled"]),y(),S("data",t.data["nz-table-img-radius"]),y(),S("data",t.data["nz-table-img-margin-right"]),y(),S("data",t.data["nz-table-img-max-width"]),y(),S("data",t.data["nz-table-img-max-height"]),y(5),Mt("ngModel",t.layout.fixed),y(3),Mt("ngModel",t.layout.colorWeak)}}var bp=(()=>{class i{i={};set data(t){this.i=t,t.type==="px"&&(this.pxVal=+t.value.replace("px",""))}pxVal=0;pxChange(t){this.i.value=`${t}px`}format=t=>`${t} px`;static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["setting-drawer-item"]],hostVars:2,hostBindings:function(n,r){n&2&&ie("setting-drawer__body-item",!0)},inputs:{data:"data"},decls:9,vars:3,consts:[[1,"pl-sm","text-grey"],["nz-input","","type","color",2,"width","88px",3,"ngModel","ngModelOptions"],["nz-input","",2,"width","88px",3,"ngModel","ngModelOptions"],[3,"ngModel","nzMin","nzMax","nzStep","nzFormatter"],["nzSize","small",3,"ngModel","ngModelOptions"],["nzDrawerContent",""],["nz-input","","type","color",2,"width","88px",3,"ngModelChange","ngModel","ngModelOptions"],["nz-input","",2,"width","88px",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","nzMin","nzMax","nzStep","nzFormatter"],["nzSize","small",3,"ngModelChange","ngModel","ngModelOptions"]],template:function(n,r){if(n&1&&(v(0,"span"),k(1),v(2,"span",0),k(3),b()(),X(4,Fv,1,3,"input",1)(5,Lv,1,3,"input",2)(6,Bv,1,5,"nz-input-number",3)(7,Uv,1,3,"nz-switch",4)(8,jv,1,0,null,5)),n&2){let o;y(),ye(" ",r.i.label," "),y(2),Te(r.i.tip),y(),Y((o=r.i.type)==="color"?4:o==="input"?5:o==="px"?6:o==="switch"?7:8)}},dependencies:[No,na,Ao,Do,ra,rp,la,Rl,Nl],encapsulation:2})}return i})(),Fl="alain-default-vars",Kv=[{key:"dust",color:"#F5222D"},{key:"volcano",color:"#FA541C"},{key:"sunset",color:"#FAAD14"},{key:"cyan",color:"#13C2C2"},{key:"green",color:"#52C41A"},{key:"daybreak",color:"#1890ff"},{key:"geekblue",color:"#2F54EB"},{key:"purple",color:"#722ED1"},{key:"black",color:"#001529"}],ma={"primary-color":{label:"\u4E3B\u989C\u8272",type:"color",default:"#1890ff"},"alain-default-header-hg":{label:"\u9AD8",type:"px",default:"64px",max:300,min:24},"alain-default-header-bg":{label:"\u80CC\u666F\u8272",type:"color",default:"@primary-color",tip:"\u9ED8\u8BA4\u540C\u4E3B\u8272\u7CFB"},"alain-default-header-padding":{label:"\u9876\u90E8\u5DE6\u53F3\u5185\u8FB9\u8DDD",type:"px",default:"16px"},"alain-default-aside-wd":{label:"\u5BBD\u5EA6",type:"px",default:"200px"},"alain-default-aside-bg":{label:"\u80CC\u666F",type:"color",default:"#ffffff"},"alain-default-aside-collapsed-wd":{label:"\u6536\u7F29\u5BBD\u5EA6",type:"px",default:"64px"},"alain-default-aside-nav-padding-top-bottom":{label:"\u9879\u4E0A\u4E0B\u5185\u8FB9\u8DDD",type:"px",default:"8px",step:8},"alain-default-aside-nav-fs":{label:"\u83DC\u5355\u5B57\u53F7",type:"px",default:"14px",min:14,max:30},"alain-default-aside-collapsed-nav-fs":{label:"\u6536\u7F29\u83DC\u5355\u5B57\u53F7",type:"px",default:"24px",min:24,max:32},"alain-default-aside-nav-item-height":{label:"\u83DC\u5355\u9879\u9AD8\u5EA6",type:"px",default:"38px",min:24,max:64},"alain-default-aside-nav-text-color":{label:"\u83DC\u5355\u6587\u672C\u989C\u8272",type:"color",default:"rgba(0, 0, 0, 0.65)",rgba:!0},"alain-default-aside-nav-text-hover-color":{label:"\u83DC\u5355\u6587\u672C\u60AC\u505C\u989C\u8272",type:"color",default:"@primary-color",tip:"\u9ED8\u8BA4\u540C\u4E3B\u8272\u7CFB"},"alain-default-aside-nav-group-text-color":{label:"\u83DC\u5355\u5206\u7EC4\u6587\u672C\u989C\u8272",type:"color",default:"rgba(0, 0, 0, 0.43)",rgba:!0},"alain-default-aside-nav-selected-text-color":{label:"\u83DC\u5355\u6FC0\u6D3B\u65F6\u6587\u672C\u989C\u8272",type:"color",default:"@primary-color",tip:"\u9ED8\u8BA4\u540C\u4E3B\u8272\u7CFB"},"alain-default-aside-nav-selected-bg":{label:"\u83DC\u5355\u6FC0\u6D3B\u65F6\u80CC\u666F\u989C\u8272",type:"color",default:"#fcfcfc"},"alain-default-content-bg":{label:"\u80CC\u666F\u8272",type:"color",default:"#f5f7fa"},"alain-default-content-heading-bg":{label:"\u6807\u9898\u80CC\u666F\u8272",type:"color",default:"#fafbfc"},"alain-default-content-heading-border":{label:"\u6807\u9898\u5E95\u90E8\u8FB9\u6846\u8272",type:"color",default:"#efe3e5"},"alain-default-content-padding":{label:"\u5185\u8FB9\u8DDD",type:"px",default:"24px",min:0,max:128,step:8},"form-state-visual-feedback-enabled":{label:"\u5F00\u542F\u8868\u5355\u5143\u7D20\u7684\u89C6\u89C9\u53CD\u9988",type:"switch",default:!0},"preserve-white-spaces-enabled":{label:"\u5F00\u542F preserveWhitespaces",type:"switch",default:!0},"nz-table-img-radius":{label:"\u8868\u683C\u4E2D\uFF1A\u56FE\u7247\u5706\u89D2",type:"px",default:"4px",min:0,max:128},"nz-table-img-margin-right":{label:"\u8868\u683C\u4E2D\uFF1A\u56FE\u7247\u53F3\u5916\u8FB9\u8DDD",type:"px",default:"4px",min:0,max:128},"nz-table-img-max-width":{label:"\u8868\u683C\u4E2D\uFF1A\u56FE\u7247\u6700\u5927\u5BBD\u5EA6",type:"px",default:"32px",min:8,max:128},"nz-table-img-max-height":{label:"\u8868\u683C\u4E2D\uFF1A\u56FE\u7247\u6700\u5927\u9AD8\u5EA6",type:"px",default:"32px",min:8,max:128}},Bl=(()=>{class i{cdr=N(Ze);msg=N(xt);settingSrv=N($e);lazy=N(im);ngZone=N(Zn);doc=N(zt);autoApplyColor=!0;compilingText="Compiling...";devTips="When the color can't be switched, you need to run it once: npm run color-less";lessJs="https://cdn.jsdelivr.net/npm/less";loadedLess=!1;dir=N(Xt).valueSignal;isDev=qs();collapse=!1;get layout(){return this.settingSrv.layout}data={};color;colors=Kv;constructor(){this.color=this.cachedData["@primary-color"]||this.DEFAULT_PRIMARY,this.resetData(this.cachedData,!1)}get cachedData(){return this.settingSrv.layout[Fl]||{}}get DEFAULT_PRIMARY(){return ma["primary-color"].default}ngOnInit(){this.autoApplyColor&&this.color!==this.DEFAULT_PRIMARY&&(this.changeColor(this.color),this.runLess())}loadLess(){return B(this,null,function*(){return this.loadedLess?Promise.resolve():this.lazy.loadStyle("./assets/color.less",{rel:"stylesheet/less"}).then(()=>{let t=this.doc.createElement("script");t.innerHTML=`
          window.less = {
            async: true,
            env: 'production',
            javascriptEnabled: true
          };
        `,this.doc.body.appendChild(t)}).then(()=>this.lazy.loadScript(this.lessJs)).then(()=>{this.loadedLess=!0})})}genVars(){let{data:t,color:n,validKeys:r}=this,o={"@primary-color":n};return r.filter(a=>a!=="primary-color").forEach(a=>o[`@${a}`]=t[a].value),this.setLayout(Fl,o),o}runLess(){let{ngZone:t,msg:n,cdr:r}=this,o=n.loading(this.compilingText,{nzDuration:0}).messageId;setTimeout(()=>{this.loadLess().then(()=>{window.less.modifyVars(this.genVars()).then(()=>{n.success("\u6210\u529F"),n.remove(o),t.run(()=>r.detectChanges())})})},200)}toggle(){this.collapse=!this.collapse}changeColor(t){this.color=t,Object.keys(ma).filter(n=>ma[n].default==="@primary-color").forEach(n=>delete this.cachedData[`@${n}`]),this.resetData(this.cachedData,!1)}setLayout(t,n){this.settingSrv.setLayout(t,n)}resetData(t,n=!0){t=t||{};let r=nm(ma);Object.keys(r).forEach(o=>{let a=t[`@${o}`]||r[o].default||"";r[o].value=a==="@primary-color"?this.color:a}),this.data=r,n&&(this.cdr.detectChanges(),this.runLess())}get validKeys(){return Object.keys(this.data).filter(t=>this.data[t].value!==this.data[t].default)}apply(){this.runLess()}reset(){this.color=this.DEFAULT_PRIMARY,this.settingSrv.setLayout(Fl,{}),this.resetData({})}copyVar(){let t=this.genVars(),n=Object.keys(t).map(r=>`${r}: ${t[r]};`).join(`
`);Vm(n),this.msg.success("Copy success")}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["setting-drawer"]],hostVars:4,hostBindings:function(n,r){n&2&&ie("setting-drawer",!0)("setting-drawer-rtl",r.dir()==="rtl")},inputs:{autoApplyColor:[2,"autoApplyColor","autoApplyColor",Ne],compilingText:"compilingText",devTips:"devTips",lessJs:"lessJs"},decls:4,vars:7,consts:[[3,"nzOnClose","nzVisible","nzPlacement","nzWidth"],["class","setting-drawer__content",4,"nzDrawerContent"],["nz-tooltip","",1,"setting-drawer__handle",3,"click","nzTooltipTitle"],[1,"setting-drawer__handle-icon",3,"nzType"],[1,"setting-drawer__content"],[1,"setting-drawer__body","setting-drawer__theme"],[1,"setting-drawer__title"],["nz-tooltip","",1,"setting-drawer__theme-tag",3,"style","nzTooltipTitle"],[1,"setting-drawer__body"],["nzTitle","\u9876\u90E8"],[3,"data"],["nzTitle","\u4FA7\u8FB9\u680F"],["nzTitle","\u5185\u5BB9"],["nzTitle","\u5176\u5B83"],[1,"setting-drawer__body-item"],["nzSize","small",3,"ngModelChange","ngModel"],["type","button","nz-button","","nzType","primary",3,"click"],["type","button","nz-button","",3,"click"],["nzType","warning","nzMessage","\u914D\u7F6E\u680F\u53EA\u5728\u5F00\u53D1\u73AF\u5883\u7528\u4E8E\u9884\u89C8\uFF0C\u751F\u4EA7\u73AF\u5883\u4E0D\u4F1A\u5C55\u73B0\uFF0C\u8BF7\u62F7\u8D1D\u540E\u624B\u52A8\u4FEE\u6539\u53C2\u6570\u914D\u7F6E\u6587\u4EF6 src/styles/theme.less",1,"mt-md"],["nz-tooltip","",1,"setting-drawer__theme-tag",3,"click","nzTooltipTitle"],["nzType","check"]],template:function(n,r){n&1&&(v(0,"nz-drawer",0),U("nzOnClose",function(){return r.toggle()}),J(1,Wv,49,19,"div",1),b(),v(2,"div",2),U("click",function(){return r.toggle()}),V(3,"nz-icon",3),b()),n&2&&(S("nzVisible",r.collapse)("nzPlacement",r.dir()==="rtl"?"left":"right")("nzWidth",500),y(2),ie("setting-drawer__handle-opened",r.collapse),S("nzTooltipTitle",r.isDev?r.devTips:null),y(),S("nzType",r.collapse?"close":"setting"))},dependencies:[No,Ao,Do,Rl,bm,Nl,tr,se,ep,Zm,da,ha,ua,bp,ap,la,dm,cp],encapsulation:2,changeDetection:0})}return Co([Ro()],i.prototype,"loadLess",null),Co([Ro()],i.prototype,"runLess",null),i})(),Qv=[bp,Bl],Ep=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=kt({type:i});static \u0275inj=Vt({imports:[Qv]})}return i})();var cr=class cr{constructor(){this.modalSrv=N(wm);this.messageSrv=N(xt)}_click(){this.modalSrv.confirm({nzTitle:"Make sure clear all local storage?",nzOnOk:()=>{localStorage.clear(),this.messageSrv.success("Clear Finished!")}})}};cr.\u0275fac=function(t){return new(t||cr)},cr.\u0275cmp=Q({type:cr,selectors:[["header-clear-storage"]],hostVars:2,hostBindings:function(t,n){t&1&&U("click",function(){return n._click()}),t&2&&ie("flex-1",!0)},decls:3,vars:3,consts:[["nz-icon","","nzType","tool"]],template:function(t,n){t&1&&(V(0,"i",0),k(1),Fe(2,"i18n")),t&2&&(y(),ye(" ",Le(2,1,"menu.clear.local.storage")," "))},dependencies:[de,se,St],encapsulation:2,changeDetection:0});var pa=cr;var Ip=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],pn=(()=>{if(typeof document>"u")return!1;let i=Ip[0],e={};for(let t of Ip)if(t?.[1]in document){for(let[r,o]of t.entries())e[i[r]]=o;return e}return!1})(),Sp={change:pn.fullscreenchange,error:pn.fullscreenerror},_t={request(i=document.documentElement,e){return new Promise((t,n)=>{let r=()=>{_t.off("change",r),t()};_t.on("change",r);let o=i[pn.requestFullscreen](e);o instanceof Promise&&o.then(r).catch(n)})},exit(){return new Promise((i,e)=>{if(!_t.isFullscreen){i();return}let t=()=>{_t.off("change",t),i()};_t.on("change",t);let n=document[pn.exitFullscreen]();n instanceof Promise&&n.then(t).catch(e)})},toggle(i,e){return _t.isFullscreen?_t.exit():_t.request(i,e)},onchange(i){_t.on("change",i)},onerror(i){_t.on("error",i)},on(i,e){let t=Sp[i];t&&document.addEventListener(t,e,!1)},off(i,e){let t=Sp[i];t&&document.removeEventListener(t,e,!1)},raw:pn};Object.defineProperties(_t,{isFullscreen:{get:()=>!!document[pn.fullscreenElement]},element:{enumerable:!0,get:()=>document[pn.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>!!document[pn.fullscreenEnabled]}});pn||(_t={isEnabled:!1});var ga=_t;var lr=class lr{constructor(){this.status=!1}_resize(){this.status=ga.isFullscreen}_click(){ga.isEnabled&&ga.toggle()}};lr.\u0275fac=function(t){return new(t||lr)},lr.\u0275cmp=Q({type:lr,selectors:[["header-fullscreen"]],hostVars:2,hostBindings:function(t,n){t&1&&U("resize",function(){return n._resize()},zf)("click",function(){return n._click()}),t&2&&ie("flex-1",!0)},decls:3,vars:4,consts:[["nz-icon","",3,"nzType"]],template:function(t,n){t&1&&(V(0,"i",0),k(1),Fe(2,"i18n")),t&2&&(S("nzType",n.status?"fullscreen-exit":"fullscreen"),y(),ye(" ",Le(2,2,n.status?"menu.fullscreen.exit":"menu.fullscreen")," "))},dependencies:[de,se,St],encapsulation:2,changeDetection:0});var _a=lr;var Xv=(i,e)=>e.id;function Yv(i,e){if(i&1){let t=ee();v(0,"li",7),U("click",function(){let r=q(t).$implicit,o=R();return j(o.openDoc(r))}),V(1,"i",10),v(2,"span"),k(3),b(),v(4,"small"),k(5),b()()}if(i&2){let t=e.$implicit;y(3),Te(t.title),y(2),Te(t.lastModified)}}var ur=class ur{constructor(){this.msg=N(xt);this.recentDocs=[{id:"1",title:"\u5C08\u6848\u4F01\u5283\u66F8",lastModified:"2 \u5C0F\u6642\u524D",url:"https://docs.google.com/document/d/1"},{id:"2",title:"\u6703\u8B70\u8A18\u9304",lastModified:"\u6628\u5929",url:"https://docs.google.com/document/d/2"},{id:"3",title:"\u6280\u8853\u898F\u683C\u6587\u4EF6",lastModified:"3 \u5929\u524D",url:"https://docs.google.com/document/d/3"}]}onVisibleChange(){this.loadRecentDocs()}loadRecentDocs(){}openDoc(e){window.open(e.url,"_blank"),this.msg.success(`\u958B\u555F\u6587\u4EF6\uFF1A${e.title}`)}openNewDoc(){window.open("https://docs.google.com/document/create","_blank"),this.msg.success("\u958B\u555F\u65B0\u6587\u4EF6")}openDocsHome(){window.open("https://docs.google.com","_blank"),this.msg.success("\u958B\u555F Google Docs")}};ur.\u0275fac=function(t){return new(t||ur)},ur.\u0275cmp=Q({type:ur,selectors:[["header-google-docs"]],decls:19,vars:1,consts:[["menu","nzDropdownMenu"],["nz-dropdown","","nzTrigger","click",3,"nzVisibleChange","nzDropdownMenu"],[1,"alain-default__nav-item"],["nz-icon","","nzType","file-text",1,"alain-default__nav-item-icon"],["nz-menu",""],["nz-menu-item",""],["nz-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","plus"],["nz-icon","","nzType","folder-open"],["nz-icon","","nzType","file-text"]],template:function(t,n){if(t&1){let r=ee();v(0,"div",1),U("nzVisibleChange",function(){return q(r),j(n.onVisibleChange())}),v(1,"div",2),V(2,"i",3),v(3,"span"),k(4,"Google Docs"),b()()(),v(5,"nz-dropdown-menu",null,0)(7,"ul",4),me(8,Yv,6,2,"li",5,Xv),V(10,"li",6),v(11,"li",7),U("click",function(){return q(r),j(n.openNewDoc())}),V(12,"i",8),v(13,"span"),k(14,"\u65B0\u5EFA\u6587\u4EF6"),b()(),v(15,"li",7),U("click",function(){return q(r),j(n.openDocsHome())}),V(16,"i",9),v(17,"span"),k(18,"\u958B\u555F Google Docs"),b()()()()}if(t&2){let r=ne(6);S("nzDropdownMenu",r),y(8),pe(n.recentDocs)}},dependencies:[Me,tt,Yt,Be,Ue,de,se,At],styles:[".alain-default__nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;padding:0 12px;height:100%}.alain-default__nav-item-icon[_ngcontent-%COMP%]{font-size:16px}ul[nz-menu][_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}ul[nz-menu][_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-left:auto;color:#999;font-size:12px}"],changeDetection:0});var ya=ur;var hr=class hr{constructor(){this.cdr=N(Ze);this.loading=!0}change(){setTimeout(()=>{this.loading=!1,this.cdr.detectChanges()},500)}};hr.\u0275fac=function(t){return new(t||hr)},hr.\u0275cmp=Q({type:hr,selectors:[["header-icon"]],decls:39,vars:13,consts:[["iconMenu","nzDropdownMenu"],["nz-dropdown","","nzTrigger","click","nzPlacement","bottomRight",1,"alain-default__nav-item",3,"nzVisibleChange","nzDropdownMenu"],["nz-icon","","nzType","appstore"],["nz-menu","",1,"wd-xl","animated","jello"],[3,"nzSpinning","nzTip"],["nz-row","",1,"app-icons",3,"nzJustify","nzAlign"],["nz-col","",3,"nzSpan"],["nz-icon","","nzType","calendar",1,"bg-error","text-white"],["nz-icon","","nzType","file",1,"bg-geekblue","text-white"],["nz-icon","","nzType","cloud",1,"bg-success","text-white"],["nz-icon","","nzType","star",1,"bg-magenta","text-white"],["nz-icon","","nzType","team",1,"bg-purple","text-white"],["nz-icon","","nzType","scan",1,"bg-warning","text-white"],["nz-icon","","nzType","pay-circle",1,"bg-cyan","text-white"],["nz-icon","","nzType","printer",1,"bg-grey","text-white"]],template:function(t,n){if(t&1){let r=ee();v(0,"div",1),U("nzVisibleChange",function(){return q(r),j(n.change())}),V(1,"i",2),b(),v(2,"nz-dropdown-menu",null,0)(4,"div",3)(5,"nz-spin",4)(6,"div",5)(7,"div",6),V(8,"i",7),v(9,"small"),k(10,"Calendar"),b()(),v(11,"div",6),V(12,"i",8),v(13,"small"),k(14,"Files"),b()(),v(15,"div",6),V(16,"i",9),v(17,"small"),k(18,"Cloud"),b()(),v(19,"div",6),V(20,"i",10),v(21,"small"),k(22,"Star"),b()(),v(23,"div",6),V(24,"i",11),v(25,"small"),k(26,"Team"),b()(),v(27,"div",6),V(28,"i",12),v(29,"small"),k(30,"QR"),b()(),v(31,"div",6),V(32,"i",13),v(33,"small"),k(34,"Pay"),b()(),v(35,"div",6),V(36,"i",14),v(37,"small"),k(38,"Print"),b()()()()()()}if(t&2){let r=ne(3);S("nzDropdownMenu",r),y(5),S("nzSpinning",n.loading)("nzTip","\u6B63\u5728\u8BFB\u53D6\u6570\u636E..."),y(),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6),y(4),S("nzSpan",6)}},dependencies:[Me,tt,Be,Ue,de,se,At,ca,aa,sa,Dn,An],encapsulation:2,changeDetection:0});var va=hr;var Ap=i=>({$implicit:i});function e1(i,e){}function t1(i,e){if(i&1&&J(0,e1,0,0,"ng-template",4),i&2){R();let t=ne(5);S("ngTemplateOutlet",t)}}function n1(i,e){if(i&1&&V(0,"img",6),i&2){R(2);let t=ni(0);ct("src",t.emptyImage,Ui)}}function i1(i,e){if(i&1&&($t(0),k(1),Gt()),i&2){let t=R(2),n=ni(0);y(),ye(" ",n.emptyText||t.locale().emptyText," ")}}function r1(i,e){if(i&1&&(v(0,"div",5),X(1,n1,1,1,"img",6),v(2,"p"),J(3,i1,2,1,"ng-container",7),b()()),i&2){R();let t=ni(0);y(),Y(t.emptyImage?1:-1),y(2),S("nzStringTemplateOutlet",t.emptyText)}}function o1(i,e){if(i&1&&($t(0),k(1),Gt()),i&2){let t=R(2).$implicit;y(),ye(" ",t.title," ")}}function s1(i,e){if(i&1&&(v(0,"div",13)(1,"nz-tag",14),k(2),b()()),i&2){let t=R(2).$implicit;y(),S("nzColor",t.color),y(),Te(t.extra)}}function a1(i,e){if(i&1&&(J(0,o1,2,1,"ng-container",12),X(1,s1,3,2,"div",13)),i&2){let t=R().$implicit;S("nzStringTemplateOutlet",t.title)("nzStringTemplateOutletContext",ot(3,Ap,t)),y(),Y(t.extra?1:-1)}}function c1(i,e){if(i&1&&($t(0),k(1),Gt()),i&2){let t=R(3).$implicit;y(),ye(" ",t.description," ")}}function l1(i,e){if(i&1&&(v(0,"div",15),J(1,c1,2,1,"ng-container",12),b()),i&2){let t=R(2).$implicit;y(),S("nzStringTemplateOutlet",t.description)("nzStringTemplateOutletContext",ot(2,Ap,t))}}function u1(i,e){if(i&1&&(v(0,"div",16),k(1),b()),i&2){let t=R(2).$implicit;y(),Te(t.datetime)}}function h1(i,e){if(i&1&&(X(0,l1,2,4,"div",15),X(1,u1,2,1,"div",16)),i&2){let t=R().$implicit;Y(t.description?0:-1),y(),Y(t.datetime?1:-1)}}function d1(i,e){if(i&1){let t=ee();v(0,"nz-list-item",10),U("click",function(r){let o=q(t).$implicit,a=R(2);return j(a.onClick(o,r))}),v(1,"nz-list-item-meta",11),J(2,a1,2,5,"ng-template",null,2,Se)(4,h1,2,2,"ng-template",null,3,Se),b()()}if(i&2){let t=e.$implicit,n=ne(3),r=ne(5);ie("notice-icon__item-read",t.read),y(),S("nzTitle",n)("nzDescription",r)("nzAvatar",t.avatar)}}function f1(i,e){if(i&1){let t=ee();v(0,"nz-list",8),J(1,d1,6,5,"ng-template",null,1,Se),b(),v(3,"div",9),U("click",function(){q(t);let r=R();return j(r.onClear())}),k(4),b()}if(i&2){let t=ne(2),n=R(),r=ni(0),o=ni(1);S("nzDataSource",o)("nzRenderItem",t),y(4),Te(r.clearText||n.locale().clearText)}}var m1=()=>({"box-shadow":"none"});function p1(i,e){if(i&1&&(v(0,"nz-badge",3),V(1,"nz-icon",4),b()),i&2){let t=R();Jt(t.btnClass()),S("nzCount",t.count())("nzStyle",ji(6,m1)),y(),Jt(t.btnIconClass())}}function g1(i,e){}function _1(i,e){if(i&1&&J(0,g1,0,0,"ng-template",2),i&2){R();let t=ne(1);S("ngTemplateOutlet",t)}}function y1(i,e){}function v1(i,e){if(i&1){let t=ee();v(0,"nz-tab",8)(1,"notice-icon-tab",9),U("select",function(r){q(t);let o=R(3);return j(o.select.emit(r))})("clear",function(r){q(t);let o=R(3);return j(o.clear.emit(r))}),b()()}if(i&2){let t=e.$implicit,n=R(3);S("nzTitle",t.title),y(),S("locale",n.locale())("item",t)}}function w1(i,e){if(i&1&&(v(0,"nz-tabs",7),me(1,v1,2,3,"nz-tab",8,He),b()),i&2){let t=R(2),n=ni(2);S("nzSelectedIndex",0)("nzCentered",t.centered()),y(),pe(n)}}function T1(i,e){if(i&1){let t=ee();v(0,"div",5),U("nzVisibleChange",function(r){q(t);let o=R();return j(o.onVisibleChange(r))}),J(1,y1,0,0,"ng-template",2),b(),v(2,"nz-dropdown-menu",null,1)(4,"nz-spin",6),X(5,w1,3,2,"nz-tabs",7),b()()}if(i&2){let t=ne(3),n=R(),r=ne(1);S("nzVisible",n.popoverVisible())("nzOverlayClassName",n.overlayCls())("nzDropdownMenu",t),y(),S("ngTemplateOutlet",r),y(3),S("nzSpinning",n.loading())("nzDelay",0),y(),Y(n.delayShow()?5:-1)}}var Dp=(()=>{class i{locale=lt.required();item=lt.required();select=Hi();clear=Hi();onClick(t,n){this.select.emit({title:this.item().title,item:t,event:n})}onClear(){this.clear.emit(this.item().title)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["notice-icon-tab"]],inputs:{locale:[1,"locale"],item:[1,"item"]},outputs:{select:"select",clear:"clear"},exportAs:["noticeIconTab"],decls:6,vars:3,consts:[["listTpl",""],["item",""],["nzTitle",""],["nzDescription",""],[3,"ngTemplateOutlet"],[1,"notice-icon__notfound"],["alt","not found",1,"notice-icon__notfound-img"],[4,"nzStringTemplateOutlet"],[3,"nzDataSource","nzRenderItem"],[1,"notice-icon__clear",3,"click"],[3,"click"],[3,"nzTitle","nzDescription","nzAvatar"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],[1,"notice-icon__item-extra"],[3,"nzColor"],[1,"notice-icon__item-desc"],[1,"notice-icon__item-time"]],template:function(n,r){if(n&1&&(yl(0)(1),X(2,t1,1,1,null,4)(3,r1,4,2,"div",5),J(4,f1,5,3,"ng-template",null,0,Se)),n&2){let o=Us(r.item());y();let a=Us(o.list);y(),Y(a&&a.length>0?2:3)}},dependencies:[ft,Ki,up,hp,lp,Xm],encapsulation:2})}return i})(),Ul=(()=>{class i{locale=N(Js).valueSignal("noticeIcon");data=lt([]);count=lt(void 0,{transform:js});loading=lt(!1,{transform:Ne});popoverVisible=lt(!1,{transform:Ne});btnClass=lt();btnIconClass=lt();centered=lt(!1,{transform:Ne});select=Hi();clear=Hi();popoverVisibleChange=Hi();overlayCls=pl("");constructor(){Wf(()=>{this.overlayCls.set(`header-dropdown notice-icon${this.centered()?"":" notice-icon__tab-left"}`),this.popoverVisible()||this.delayShow.set(!1)})}delayShow=pl(!1);onVisibleChange(t){this.delayShow.set(t),this.popoverVisibleChange.emit(t)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["notice-icon"]],hostVars:2,hostBindings:function(n,r){n&2&&ie("notice-icon__btn",!0)},inputs:{data:[1,"data"],count:[1,"count"],loading:[1,"loading"],popoverVisible:[1,"popoverVisible"],btnClass:[1,"btnClass"],btnIconClass:[1,"btnIconClass"],centered:[1,"centered"]},outputs:{select:"select",clear:"clear",popoverVisibleChange:"popoverVisibleChange"},exportAs:["noticeIcon"],decls:5,vars:2,consts:[["badgeTpl",""],["noticeMenu","nzDropdownMenu"],[3,"ngTemplateOutlet"],[3,"nzCount","nzStyle"],["nzType","bell"],["nz-dropdown","","nzTrigger","click","nzPlacement","bottomRight",3,"nzVisibleChange","nzVisible","nzOverlayClassName","nzDropdownMenu"],[3,"nzSpinning","nzDelay"],[3,"nzSelectedIndex","nzCentered"],[3,"nzTitle"],[3,"select","clear","locale","item"]],template:function(n,r){if(n&1&&(J(0,p1,2,7,"ng-template",null,0,Se),yl(2),X(3,_1,1,1,null,2)(4,T1,6,7)),n&2){y(2);let o=Us(r.data());y(),Y(o.length<=0?3:4)}},dependencies:[ft,Zi,se,Be,Ue,An,ha,ua,Dp],encapsulation:2,changeDetection:0})}return i})(),C1=[Ul],Np=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=kt({type:i});static \u0275inj=Vt({imports:[ii,Nm,er,Me,de,dp,Dn,da,Ym,Qi,C1,Dp]})}return i})();var dr=class dr{constructor(){this.msg=N(xt);this.nzI18n=N(Ks);this.cdr=N(Ze);this.data=[{title:"\u901A\u77E5",list:[],emptyText:"\u4F60\u5DF2\u67E5\u770B\u6240\u6709\u901A\u77E5",emptyImage:"https://gw.alipayobjects.com/zos/rmsportal/wAhyIChODzsoKIOBHcBk.svg",clearText:"\u6E05\u7A7A\u901A\u77E5"},{title:"\u6D88\u606F",list:[],emptyText:"\u60A8\u5DF2\u8BFB\u5B8C\u6240\u6709\u6D88\u606F",emptyImage:"https://gw.alipayobjects.com/zos/rmsportal/sAuJeJzSKbUmHfBQRzmZ.svg",clearText:"\u6E05\u7A7A\u6D88\u606F"},{title:"\u5F85\u529E",list:[],emptyText:"\u4F60\u5DF2\u5B8C\u6210\u6240\u6709\u5F85\u529E",emptyImage:"https://gw.alipayobjects.com/zos/rmsportal/HsIsxMZiWKrNUavQUXqx.svg",clearText:"\u6E05\u7A7A\u5F85\u529E"}];this.count=5;this.loading=!1}updateNoticeData(e){let t=this.data.slice();return t.forEach(n=>n.list=[]),e.forEach(n=>{let r=we({},n);typeof r.datetime=="string"&&(r.datetime=pm(r.datetime,"yyyy-MM-dd",new Date)),r.datetime&&(r.datetime=mm(r.datetime,{locale:this.nzI18n.getDateLocale()})),r.extra&&r.status&&(r.color={todo:void 0,processing:"blue",urgent:"red",doing:"gold"}[r.status]),t.find(o=>o.title===r.type).list.push(r)}),t}loadData(){this.loading||(this.loading=!0,setTimeout(()=>{let e=new Date;this.data=this.updateNoticeData([{id:"000000001",avatar:"https://gw.alipayobjects.com/zos/rmsportal/ThXAXghbEsBCCSDihZxY.png",title:"\u4F60\u6536\u5230\u4E86 14 \u4EFD\u65B0\u5468\u62A5",datetime:Eo(e,{days:10}),type:"\u901A\u77E5"},{id:"000000002",avatar:"https://gw.alipayobjects.com/zos/rmsportal/OKJXDXrmkNshAMvwtvhu.png",title:"\u4F60\u63A8\u8350\u7684 \u66F2\u59AE\u59AE \u5DF2\u901A\u8FC7\u7B2C\u4E09\u8F6E\u9762\u8BD5",datetime:Eo(e,{days:-3}),type:"\u901A\u77E5"},{id:"000000003",avatar:"https://gw.alipayobjects.com/zos/rmsportal/kISTdvpyTAhtGxpovNWd.png",title:"\u8FD9\u79CD\u6A21\u677F\u53EF\u4EE5\u533A\u5206\u591A\u79CD\u901A\u77E5\u7C7B\u578B",datetime:Eo(e,{months:-3}),read:!0,type:"\u901A\u77E5"},{id:"000000004",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",datetime:Eo(e,{years:-1}),type:"\u901A\u77E5"},{id:"000000005",avatar:"https://gw.alipayobjects.com/zos/rmsportal/ThXAXghbEsBCCSDihZxY.png",title:"\u5185\u5BB9\u4E0D\u8981\u8D85\u8FC7\u4E24\u884C\u5B57\uFF0C\u8D85\u51FA\u65F6\u81EA\u52A8\u622A\u65AD",datetime:"2017-08-07",type:"\u901A\u77E5"},{id:"000000006",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u66F2\u4E3D\u4E3D \u8BC4\u8BBA\u4E86\u4F60",description:"\u63CF\u8FF0\u4FE1\u606F\u63CF\u8FF0\u4FE1\u606F\u63CF\u8FF0\u4FE1\u606F",datetime:"2017-08-07",type:"\u6D88\u606F"},{id:"000000007",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u6731\u504F\u53F3 \u56DE\u590D\u4E86\u4F60",description:"\u8FD9\u79CD\u6A21\u677F\u7528\u4E8E\u63D0\u9192\u8C01\u4E0E\u4F60\u53D1\u751F\u4E86\u4E92\u52A8\uFF0C\u5DE6\u4FA7\u653E\u300E\u8C01\u300F\u7684\u5934\u50CF",datetime:"2017-08-07",type:"\u6D88\u606F"},{id:"000000008",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u6807\u9898",description:"\u8FD9\u79CD\u6A21\u677F\u7528\u4E8E\u63D0\u9192\u8C01\u4E0E\u4F60\u53D1\u751F\u4E86\u4E92\u52A8\uFF0C\u5DE6\u4FA7\u653E\u300E\u8C01\u300F\u7684\u5934\u50CF",datetime:"2017-08-07",type:"\u6D88\u606F"},{id:"000000009",title:"\u4EFB\u52A1\u540D\u79F0",description:"\u4EFB\u52A1\u9700\u8981\u5728 2017-01-12 20:00 \u524D\u542F\u52A8",extra:"\u672A\u5F00\u59CB",status:"todo",type:"\u5F85\u529E"},{id:"000000010",title:"\u7B2C\u4E09\u65B9\u7D27\u6025\u4EE3\u7801\u53D8\u66F4",description:"\u51A0\u9716\u63D0\u4EA4\u4E8E 2017-01-06\uFF0C\u9700\u5728 2017-01-07 \u524D\u5B8C\u6210\u4EE3\u7801\u53D8\u66F4\u4EFB\u52A1",extra:"\u9A6C\u4E0A\u5230\u671F",status:"urgent",type:"\u5F85\u529E"},{id:"000000011",title:"\u4FE1\u606F\u5B89\u5168\u8003\u8BD5",description:"\u6307\u6D3E\u7AF9\u5C14\u4E8E 2017-01-09 \u524D\u5B8C\u6210\u66F4\u65B0\u5E76\u53D1\u5E03",extra:"\u5DF2\u8017\u65F6 8 \u5929",status:"doing",type:"\u5F85\u529E"},{id:"000000012",title:"ABCD \u7248\u672C\u53D1\u5E03",description:"\u51A0\u9716\u63D0\u4EA4\u4E8E 2017-01-06\uFF0C\u9700\u5728 2017-01-07 \u524D\u5B8C\u6210\u4EE3\u7801\u53D8\u66F4\u4EFB\u52A1",extra:"\u8FDB\u884C\u4E2D",status:"processing",type:"\u5F85\u529E"}]),this.loading=!1,this.cdr.detectChanges()},500))}clear(e){this.msg.success(`\u6E05\u7A7A\u4E86 ${e}`)}select(e){this.msg.success(`\u70B9\u51FB\u4E86 ${e.title} \u7684 ${e.item.title}`)}};dr.\u0275fac=function(t){return new(t||dr)},dr.\u0275cmp=Q({type:dr,selectors:[["header-notify"]],decls:1,vars:3,consts:[["btnClass","alain-default__nav-item","btnIconClass","alain-default__nav-item-icon",3,"select","clear","popoverVisibleChange","data","count","loading"]],template:function(t,n){t&1&&(v(0,"notice-icon",0),U("select",function(o){return n.select(o)})("clear",function(o){return n.clear(o)})("popoverVisibleChange",function(){return n.loadData()}),b()),t&2&&S("data",n.data)("count",n.count)("loading",n.loading)},dependencies:[Np,Ul],encapsulation:2,changeDetection:0});var wa=dr;var fr=class fr{constructor(){this.rtl=N(Im)}toggleDirection(){this.rtl.toggle()}};fr.\u0275fac=function(t){return new(t||fr)},fr.\u0275cmp=Q({type:fr,selectors:[["header-rtl"]],hostVars:2,hostBindings:function(t,n){t&1&&U("click",function(){return n.toggleDirection()}),t&2&&ie("flex-1",!0)},decls:3,vars:4,consts:[["nz-icon","",3,"nzType"]],template:function(t,n){t&1&&(V(0,"i",0),k(1),Fe(2,"uppercase")),t&2&&(S("nzType",n.rtl.nextDir==="rtl"?"border-left":"border-right"),y(),ye(" ",Le(2,2,n.rtl.nextDir)," "))},dependencies:[de,se,Jf],encapsulation:2,changeDetection:0});var Ta=fr;var Rp=new Os("nz-after-next-render",{providedIn:"root",factory:()=>{let i=N(Bi);return new un(e=>{let t=Lf(()=>{e.next(),e.complete()},{injector:i});return()=>t.destroy()})}});var x1=[[["nz-auto-option"]]],A1=["nz-auto-option"];function D1(i,e){if(i&1&&($t(0),k(1),Gt()),i&2){let t=R();y(),Te(t.nzLabel)}}var Pp=["*"],N1=["panel"],R1=["content"],P1=(i,e)=>e.value;function V1(i,e){}function z1(i,e){i&1&&J(0,V1,0,0,"ng-template")}function k1(i,e){i&1&&Qt(0)}function M1(i,e){if(i&1&&(v(0,"nz-auto-option",7),k(1),b()),i&2){let t=e.$implicit;S("nzValue",t.value)("nzLabel",t.label),y(),ye(" ",t.label," ")}}function O1(i,e){if(i&1&&me(0,M1,2,3,"nz-auto-option",7,P1),i&2){let t=R(2);pe(t.normalizedDataSource)}}function F1(i,e){if(i&1){let t=ee();v(0,"div",3,0),U("@slideMotion.done",function(r){q(t);let o=R();return j(o.onAnimationEvent(r))}),v(2,"div",4)(3,"div",5),J(4,z1,1,0,null,6),b()()(),J(5,k1,1,0,"ng-template",null,1,Se)(7,O1,2,0,"ng-template",null,2,Se)}if(i&2){let t=ne(6),n=ne(8),r=R();qi(r.nzOverlayStyle),Jt(r.nzOverlayClassName),ie("ant-select-dropdown-hidden",!r.showPanel)("ant-select-dropdown-rtl",r.dir==="rtl"),S("nzNoAnimation",r.noAnimation==null?null:r.noAnimation.nzNoAnimation)("@slideMotion",void 0)("@.disabled",!!(r.noAnimation!=null&&r.noAnimation.nzNoAnimation)),y(4),S("ngTemplateOutlet",r.nzDataSource?n:t)}}var Vp=(()=>{class i{nzLabel;static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["nz-auto-optgroup"]],inputs:{nzLabel:"nzLabel"},exportAs:["nzAutoOptgroup"],ngContentSelectors:A1,decls:3,vars:1,consts:[[1,"ant-select-item","ant-select-item-group"],[4,"nzStringTemplateOutlet"]],template:function(n,r){n&1&&(Kt(x1),v(0,"div",0),J(1,D1,2,1,"ng-container",1),b(),Qt(2)),n&2&&(y(),S("nzStringTemplateOutlet",r.nzLabel))},dependencies:[Qi,Ki],encapsulation:2,changeDetection:0})}return i})(),ql=class{source;isUserInput;constructor(e,t=!1){this.source=e,this.isUserInput=t}},Po=(()=>{class i{ngZone=N(Zn);changeDetectorRef=N(Ze);element=N(Yn);destroyRef=N(Xn);nzValue;nzLabel;nzDisabled=!1;selectionChange=new dt;mouseEntered=new dt;active=!1;selected=!1;nzAutocompleteOptgroupComponent=N(Vp,{optional:!0});ngOnInit(){Il(this.element.nativeElement,"mouseenter").pipe(jt(()=>this.mouseEntered.observers.length>0),et(this.destroyRef)).subscribe(()=>{this.ngZone.run(()=>this.mouseEntered.emit(this))}),Il(this.element.nativeElement,"mousedown").pipe(et(this.destroyRef)).subscribe(t=>t.preventDefault())}select(t=!0){this.selected=!0,this.changeDetectorRef.markForCheck(),t&&this.emitSelectionChangeEvent()}deselect(){this.selected=!1,this.changeDetectorRef.markForCheck(),this.emitSelectionChangeEvent()}getLabel(){return this.nzLabel||this.nzValue.toString()}setActiveStyles(){this.active||(this.active=!0,this.changeDetectorRef.markForCheck())}setInactiveStyles(){this.active&&(this.active=!1,this.changeDetectorRef.markForCheck())}scrollIntoViewIfNeeded(){am(this.element.nativeElement)}selectViaInteraction(){this.nzDisabled||(this.selected=!this.selected,this.selected?this.setActiveStyles():this.setInactiveStyles(),this.emitSelectionChangeEvent(!0),this.changeDetectorRef.markForCheck())}emitSelectionChangeEvent(t=!1){this.selectionChange.emit(new ql(this,t))}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["nz-auto-option"]],hostAttrs:["role","menuitem",1,"ant-select-item","ant-select-item-option"],hostVars:10,hostBindings:function(n,r){n&1&&U("click",function(){return r.selectViaInteraction()}),n&2&&(ct("aria-selected",r.selected.toString())("aria-disabled",r.nzDisabled.toString()),ie("ant-select-item-option-grouped",r.nzAutocompleteOptgroupComponent)("ant-select-item-option-selected",r.selected)("ant-select-item-option-active",r.active)("ant-select-item-option-disabled",r.nzDisabled))},inputs:{nzValue:"nzValue",nzLabel:"nzLabel",nzDisabled:[2,"nzDisabled","nzDisabled",Ne]},outputs:{selectionChange:"selectionChange",mouseEntered:"mouseEntered"},exportAs:["nzAutoOption"],ngContentSelectors:Pp,decls:2,vars:0,consts:[[1,"ant-select-item-option-content"]],template:function(n,r){n&1&&(Kt(),Bf(0,"div",0),Qt(1),Uf())},encapsulation:2,changeDetection:0})}return i})(),L1={provide:Jm,useExisting:Df(()=>jl),multi:!0};function B1(){return Error("Attempting to open an undefined instance of `nz-autocomplete`. Make sure that the id passed to the `nzAutocomplete` is correct and that you're attempting to open it after the ngAfterContentInit hook.")}var jl=(()=>{class i{ngZone=N(Zn);elementRef=N(Yn);overlay=N(hm);viewContainerRef=N(Of);destroyRef=N(Xn);nzAutocomplete;onChange=()=>{};onTouched=()=>{};panelOpen=!1;get activeOption(){return this.nzAutocomplete&&this.nzAutocomplete.options.length?this.nzAutocomplete.activeItem:null}overlayRef=null;portal=null;positionStrategy;previousValue=null;selectionChangeSubscription;optionsChangeSubscription;overlayOutsideClickSubscription;document=N(zt);nzInputGroupWhitSuffixOrPrefixDirective=N(oa,{optional:!0});constructor(){this.destroyRef.onDestroy(()=>{this.destroyPanel()})}ngAfterViewInit(){this.nzAutocomplete&&this.nzAutocomplete.animationStateChange.pipe(et(this.destroyRef)).subscribe(t=>{t.toState==="void"&&this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)})}writeValue(t){this.ngZone.runOutsideAngular(()=>{Promise.resolve(null).then(()=>this.setTriggerValue(t))})}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){let n=this.elementRef.nativeElement;n.disabled=t,this.closePanel()}openPanel(){this.previousValue=this.elementRef.nativeElement.value,this.attachOverlay(),this.updateStatus()}closePanel(){this.panelOpen&&(this.nzAutocomplete.isOpen=this.panelOpen=!1,this.overlayRef&&this.overlayRef.hasAttached()&&(this.overlayRef.detach(),this.selectionChangeSubscription.unsubscribe(),this.overlayOutsideClickSubscription.unsubscribe(),this.optionsChangeSubscription.unsubscribe(),this.portal=null))}handleKeydown(t){let n=t.keyCode,r=n===38||n===40;n===27&&t.preventDefault(),this.panelOpen&&(n===27||n===9)?(this.activeOption&&this.activeOption.getLabel()!==this.previousValue&&this.setTriggerValue(this.previousValue),this.closePanel()):this.panelOpen&&n===13?this.nzAutocomplete.showPanel&&(t.preventDefault(),this.activeOption?this.activeOption.selectViaInteraction():this.closePanel()):this.panelOpen&&r&&this.nzAutocomplete.showPanel&&(t.stopPropagation(),t.preventDefault(),n===38?this.nzAutocomplete.setPreviousItemActive():this.nzAutocomplete.setNextItemActive(),this.activeOption&&this.activeOption.scrollIntoViewIfNeeded(),this.doBackfill())}handleInput(t){let n=t.target,r=this.document,o=n.value;n.type==="number"&&(o=o===""?null:parseFloat(o)),this.previousValue!==o&&(this.previousValue=o,this.onChange(o),this.canOpen()&&r.activeElement===t.target&&this.openPanel())}handleFocus(){this.canOpen()&&this.openPanel()}handleClick(){this.canOpen()&&!this.panelOpen&&this.openPanel()}handleBlur(){this.onTouched()}subscribeOptionsChange(){return this.nzAutocomplete.options.changes.pipe(Ms(()=>this.positionStrategy.reapplyLastPosition()),Sf(0)).subscribe(()=>{this.resetActiveItem(),this.panelOpen&&this.overlayRef.updatePosition()})}subscribeSelectionChange(){return this.nzAutocomplete.selectionChange.subscribe(t=>{this.setValueAndClose(t)})}subscribeOverlayOutsideClick(){return this.overlayRef.outsidePointerEvents().pipe(jt(t=>!this.elementRef.nativeElement.contains(t.target))).subscribe(()=>{this.closePanel()})}attachOverlay(){if(!this.nzAutocomplete)throw B1();!this.portal&&this.nzAutocomplete.template&&(this.portal=new lm(this.nzAutocomplete.template,this.viewContainerRef)),this.overlayRef||(this.overlayRef=this.overlay.create(this.getOverlayConfig())),this.overlayRef&&!this.overlayRef.hasAttached()&&(this.overlayRef.attach(this.portal),this.selectionChangeSubscription=this.subscribeSelectionChange(),this.optionsChangeSubscription=this.subscribeOptionsChange(),this.overlayOutsideClickSubscription=this.subscribeOverlayOutsideClick(),this.overlayRef.detachments().pipe(et(this.destroyRef)).subscribe(()=>{this.closePanel()})),this.nzAutocomplete.isOpen=this.panelOpen=!0}updateStatus(){this.overlayRef&&this.overlayRef.updateSize({width:this.nzAutocomplete.nzWidth||this.getHostWidth()}),this.nzAutocomplete.setVisibility(),this.resetActiveItem(),this.activeOption&&this.activeOption.scrollIntoViewIfNeeded()}destroyPanel(){this.overlayRef&&this.closePanel()}getOverlayConfig(){return new um({positionStrategy:this.getOverlayPosition(),disposeOnNavigation:!0,scrollStrategy:this.overlay.scrollStrategies.reposition(),width:this.nzAutocomplete.nzWidth||this.getHostWidth()})}getConnectedElement(){return this.nzInputGroupWhitSuffixOrPrefixDirective?.elementRef??this.elementRef}getHostWidth(){return this.getConnectedElement().nativeElement.getBoundingClientRect().width}getOverlayPosition(){let t=[new Sl({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new Sl({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"})];return this.positionStrategy=this.overlay.position().flexibleConnectedTo(this.getConnectedElement()).withFlexibleDimensions(!1).withPush(!1).withPositions(t).withTransformOriginOn(".ant-select-dropdown"),this.positionStrategy}resetActiveItem(){let t=this.nzAutocomplete.getOptionIndex(this.previousValue);this.nzAutocomplete.clearSelectedOptions(null,!0),t!==-1?(this.nzAutocomplete.setActiveItem(t),this.nzAutocomplete.activeItem.select(!1)):this.nzAutocomplete.setActiveItem(this.nzAutocomplete.nzDefaultActiveFirstOption?0:-1)}setValueAndClose(t){let n=t.nzValue;this.setTriggerValue(t.getLabel()),this.onChange(n),this.elementRef.nativeElement.focus(),this.closePanel()}setTriggerValue(t){let n=this.nzAutocomplete.getOption(t),r=n?n.getLabel():t;this.elementRef.nativeElement.value=r??"",this.nzAutocomplete.nzBackfill||(this.previousValue=r)}doBackfill(){this.nzAutocomplete.nzBackfill&&this.nzAutocomplete.activeItem&&this.setTriggerValue(this.nzAutocomplete.activeItem.getLabel())}canOpen(){let t=this.elementRef.nativeElement;return!t.readOnly&&!t.disabled}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Fs({type:i,selectors:[["input","nzAutocomplete",""],["textarea","nzAutocomplete",""]],hostAttrs:["autocomplete","off","aria-autocomplete","list"],hostBindings:function(n,r){n&1&&U("focusin",function(){return r.handleFocus()})("blur",function(){return r.handleBlur()})("input",function(a){return r.handleInput(a)})("keydown",function(a){return r.handleKeydown(a)})("click",function(){return r.handleClick()})},inputs:{nzAutocomplete:"nzAutocomplete"},exportAs:["nzAutocompleteTrigger"],features:[$f([L1])]})}return i})();function U1(i){return i?.map(e=>typeof e=="number"||typeof e=="string"?{label:e.toString(),value:e.toString()}:e)}var zp=(()=>{class i{changeDetectorRef=N(Ze);directionality=N(Xt);destroyRef=N(Xn);nzWidth;nzOverlayClassName="";nzOverlayStyle={};nzDefaultActiveFirstOption=!0;nzBackfill=!1;compareWith=(t,n)=>t===n;nzDataSource;selectionChange=new dt;showPanel=!0;isOpen=!1;activeItem=null;dir="ltr";normalizedDataSource=[];animationStateChange=new dt;get options(){return this.nzDataSource?this.fromDataSourceOptions:this.fromContentOptions}fromContentOptions;fromDataSourceOptions;template;panel;content;activeItemIndex=-1;selectionChangeSubscription=ks.EMPTY;optionMouseEnterSubscription=ks.EMPTY;dataSourceChangeSubscription=ks.EMPTY;optionSelectionChanges=fl(()=>this.options?ml(...this.options.map(t=>t.selectionChange)):this.afterNextRender$.pipe(Ct(()=>this.optionSelectionChanges)));optionMouseEnter=fl(()=>this.options?ml(...this.options.map(t=>t.mouseEntered)):this.afterNextRender$.pipe(Ct(()=>this.optionMouseEnter)));afterNextRender$=N(Rp);noAnimation=N(Dl,{host:!0,optional:!0});constructor(){this.destroyRef.onDestroy(()=>{this.dataSourceChangeSubscription.unsubscribe(),this.selectionChangeSubscription.unsubscribe(),this.optionMouseEnterSubscription.unsubscribe(),this.dataSourceChangeSubscription=this.selectionChangeSubscription=this.optionMouseEnterSubscription=null})}ngOnInit(){this.directionality.change?.pipe(et(this.destroyRef)).subscribe(t=>{this.dir=t,this.changeDetectorRef.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(t){let{nzDataSource:n}=t;n&&(this.normalizedDataSource=U1(n.currentValue))}onAnimationEvent(t){this.animationStateChange.emit(t)}ngAfterContentInit(){this.nzDataSource||this.optionsInit()}ngAfterViewInit(){this.nzDataSource&&this.optionsInit()}setVisibility(){this.showPanel=!!this.options.length,this.changeDetectorRef.markForCheck()}setActiveItem(t){let n=this.options.get(t);n&&!n.active?(this.activeItem=n,this.activeItemIndex=t,this.clearSelectedOptions(this.activeItem),this.activeItem.setActiveStyles()):(this.activeItem=null,this.activeItemIndex=-1,this.clearSelectedOptions()),this.changeDetectorRef.markForCheck()}setNextItemActive(){let t=this.activeItemIndex+1<=this.options.length-1?this.activeItemIndex+1:0;this.setActiveItem(t)}setPreviousItemActive(){let t=this.activeItemIndex-1<0?this.options.length-1:this.activeItemIndex-1;this.setActiveItem(t)}getOptionIndex(t){return this.options.reduce((n,r,o)=>n===-1?this.compareWith(t,r.nzValue)?o:-1:n,-1)}getOption(t){return this.options.find(n=>this.compareWith(t,n.nzValue))||null}optionsInit(){this.setVisibility(),this.subscribeOptionChanges();let t=this.nzDataSource?this.fromDataSourceOptions.changes:this.fromContentOptions.changes;this.dataSourceChangeSubscription=t.subscribe(n=>{!n.dirty&&this.isOpen&&setTimeout(()=>this.setVisibility()),this.subscribeOptionChanges()})}clearSelectedOptions(t,n=!1){this.options.forEach(r=>{r!==t&&(n&&r.deselect(),r.setInactiveStyles())})}subscribeOptionChanges(){this.selectionChangeSubscription.unsubscribe(),this.selectionChangeSubscription=this.optionSelectionChanges.pipe(jt(t=>t.isUserInput)).subscribe(t=>{t.source.select(),t.source.setActiveStyles(),this.activeItem=t.source,this.activeItemIndex=this.getOptionIndex(this.activeItem.nzValue),this.clearSelectedOptions(t.source,!0),this.selectionChange.emit(t.source)}),this.optionMouseEnterSubscription.unsubscribe(),this.optionMouseEnterSubscription=this.optionMouseEnter.subscribe(t=>{t.setActiveStyles(),this.activeItem=t,this.activeItemIndex=this.getOptionIndex(this.activeItem.nzValue),this.clearSelectedOptions(t)})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["nz-autocomplete"]],contentQueries:function(n,r,o){if(n&1&&Bs(o,Po,5),n&2){let a;hn(a=dn())&&(r.fromContentOptions=a)}},viewQuery:function(n,r){if(n&1&&(ti(Mf,5),ti(N1,5),ti(R1,5),ti(Po,5)),n&2){let o;hn(o=dn())&&(r.template=o.first),hn(o=dn())&&(r.panel=o.first),hn(o=dn())&&(r.content=o.first),hn(o=dn())&&(r.fromDataSourceOptions=o)}},inputs:{nzWidth:[2,"nzWidth","nzWidth",sm],nzOverlayClassName:"nzOverlayClassName",nzOverlayStyle:"nzOverlayStyle",nzDefaultActiveFirstOption:[2,"nzDefaultActiveFirstOption","nzDefaultActiveFirstOption",Ne],nzBackfill:[2,"nzBackfill","nzBackfill",Ne],compareWith:"compareWith",nzDataSource:"nzDataSource"},outputs:{selectionChange:"selectionChange"},exportAs:["nzAutocomplete"],features:[Pf],ngContentSelectors:Pp,decls:1,vars:0,consts:[["panel",""],["contentTemplate",""],["optionsTemplate",""],[1,"ant-select-dropdown","ant-select-dropdown-placement-bottomLeft",3,"nzNoAnimation"],[1,"ant-select-dropdown-content-wrapper"],[1,"ant-select-dropdown-content"],[4,"ngTemplateOutlet"],[3,"nzValue","nzLabel"]],template:function(n,r){n&1&&(Kt(),J(0,F1,9,12,"ng-template"))},dependencies:[ft,Po,Dl],encapsulation:2,data:{animation:[Cm]},changeDetection:0})}return i})(),kp=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=kt({type:i});static \u0275inj=Vt({imports:[Vp]})}return i})();function j1(i,e){if(i&1&&V(0,"i",7),i&2){let t=R();S("nzType",t.focus?"arrow-down":"search")}}function H1(i,e){i&1&&V(0,"i",8)}function $1(i,e){if(i&1&&X(0,H1,1,0,"i",8),i&2){let t=R();Y(t.loading?0:-1)}}function G1(i,e){if(i&1&&(v(0,"nz-auto-option",6),k(1),b()),i&2){let t=e.$implicit;S("nzValue",t),y(),Te(t)}}var mr=class mr{constructor(){this.el=N(Yn).nativeElement;this.cdr=N(Ze);this.q="";this.qIpt=null;this.options=[];this.search$=new Oi("");this.loading=!1;this.focus=!1;this.searchToggled=!1;this.toggleChangeChange=new dt}set toggleChange(e){typeof e>"u"||(this.searchToggled=e,this.focus=e,e&&setTimeout(()=>this.qIpt.focus()))}ngAfterViewInit(){this.qIpt=this.el.querySelector(".ant-input"),this.search$.pipe(Ef(500),xf(),Ms({complete:()=>{this.loading=!0}})).subscribe(e=>{this.options=e?[e,e+e,e+e+e]:[],this.loading=!1,this.cdr.detectChanges()})}qFocus(){this.focus=!0}qBlur(){this.focus=!1,this.searchToggled=!1,this.options.length=0,this.toggleChangeChange.emit(!1)}search(e){this.search$.next(e.target.value)}ngOnDestroy(){this.search$.complete(),this.search$.unsubscribe()}};mr.\u0275fac=function(t){return new(t||mr)},mr.\u0275cmp=Q({type:mr,selectors:[["header-search"]],hostVars:4,hostBindings:function(t,n){t&2&&ie("alain-default__search-focus",n.focus)("alain-default__search-toggled",n.searchToggled)},inputs:{toggleChange:"toggleChange"},outputs:{toggleChangeChange:"toggleChangeChange"},decls:11,vars:7,consts:[["iconTpl",""],["loadingTpl",""],["auto",""],[3,"nzPrefix","nzSuffix"],["type","text","nz-input","","hotkey","F1",3,"ngModelChange","input","focus","blur","ngModel","nzAutocomplete"],["nzBackfill",""],[3,"nzValue"],["nz-icon","",3,"nzType"],["nz-icon","","nzType","loading"]],template:function(t,n){if(t&1){let r=ee();v(0,"nz-input-group",3),J(1,j1,1,1,"ng-template",null,0,Se)(3,$1,1,1,"ng-template",null,1,Se),v(5,"input",4),Fe(6,"i18n"),Ft("ngModelChange",function(a){return q(r),Ot(n.q,a)||(n.q=a),j(a)}),U("input",function(a){return q(r),j(n.search(a))})("focus",function(){return q(r),j(n.qFocus())})("blur",function(){return q(r),j(n.qBlur())}),b()(),v(7,"nz-autocomplete",5,2),me(9,G1,2,2,"nz-auto-option",6,He),b()}if(t&2){let r=ne(2),o=ne(4),a=ne(8);S("nzPrefix",r)("nzSuffix",o),y(5),Mt("ngModel",n.q),S("nzAutocomplete",a),ct("placeholder",Le(6,5,"menu.search.placeholder")),y(4),pe(n.options)}},dependencies:[No,na,Ao,Do,ip,ra,np,oa,de,se,kp,zp,Po,jl,St],encapsulation:2,changeDetection:0});var Ca=mr;function W1(i,e){i&1&&(v(0,"div",6),V(1,"nz-spin"),b())}function K1(i,e){i&1&&V(0,"i",15)}function Q1(i,e){i&1&&(v(0,"nz-card",7),J(1,K1,1,0,"ng-template",null,1,Se),v(3,"div",8)(4,"div",9),V(5,"nz-avatar",10),b(),v(6,"div",11)(7,"strong"),k(8,"cipchk"),b(),v(9,"p",12),k(10,"Please tell me what happened in a few words, don't go into details."),b()()(),v(11,"div",8)(12,"div",9),V(13,"nz-avatar",10),b(),v(14,"div",11)(15,"strong"),k(16,"\u306F\u306A\u3055\u304D"),b(),v(17,"p",12),k(18,"\u30CF\u30EB\u30AB\u30BD\u30E9\u30C8\u30AD\u30D8\u30C0\u30C4\u30D2\u30AB\u30EA"),b()()(),v(19,"div",8)(20,"div",9),V(21,"nz-avatar",10),b(),v(22,"div",11)(23,"strong"),k(24,"\u82CF\u5148\u751F"),b(),v(25,"p",12),k(26,"\u8BF7\u544A\u8BC9\u6211\uFF0C\u6211\u5E94\u8BE5\u8BF4\u70B9\u4EC0\u4E48\u597D\uFF1F"),b()()(),v(27,"div",8)(28,"div",9),V(29,"nz-avatar",10),b(),v(30,"div",11)(31,"strong"),k(32,"Kent"),b(),v(33,"p",12),k(34,"Please tell me what happened in a few words, don't go into details."),b()()(),v(35,"div",8)(36,"div",9),V(37,"nz-avatar",10),b(),v(38,"div",11)(39,"strong"),k(40,"Jefferson"),b(),v(41,"p",12),k(42,"Please tell me what happened in a few words, don't go into details."),b()()(),v(43,"div",13)(44,"div",14),k(45,"See All"),b()()()),i&2&&(y(3),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",4),y(),S("nzSrc","./assets/tmp/img/1.png"),y(),S("nzSpan",20),y(5),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",4),y(),S("nzSrc","./assets/tmp/img/2.png"),y(),S("nzSpan",20),y(5),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",4),y(),S("nzSrc","./assets/tmp/img/3.png"),y(),S("nzSpan",20),y(5),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",4),y(),S("nzSrc","./assets/tmp/img/4.png"),y(),S("nzSpan",20),y(5),S("nzJustify","center")("nzAlign","middle"),y(),S("nzSpan",4),y(),S("nzSrc","./assets/tmp/img/5.png"),y(),S("nzSpan",20),y(6),S("nzSpan",24))}var pr=class pr{constructor(){this.cdr=N(Ze);this.loading=!0}change(){setTimeout(()=>{this.loading=!1,this.cdr.detectChanges()},500)}};pr.\u0275fac=function(t){return new(t||pr)},pr.\u0275cmp=Q({type:pr,selectors:[["header-task"]],decls:8,vars:3,consts:[["taskMenu","nzDropdownMenu"],["extra",""],["nz-dropdown","","nzTrigger","click","nzPlacement","bottomRight",1,"alain-default__nav-item",3,"nzVisibleChange","nzDropdownMenu"],[3,"nzDot"],["nz-icon","","nzType","bell",1,"alain-default__nav-item-icon"],["nz-menu","",1,"wd-lg"],[1,"mx-lg","p-lg"],["nzTitle","Notifications","nzBordered","false",1,"ant-card__body-nopadding"],["nz-row","",1,"py-sm","pr-md","point","bg-grey-lighter-h",3,"nzJustify","nzAlign"],["nz-col","",1,"text-center",3,"nzSpan"],[3,"nzSrc"],["nz-col","",3,"nzSpan"],[1,"mb0"],["nz-row",""],["nz-col","",1,"pt-md","border-top-1","text-center","text-grey","point",3,"nzSpan"],["nz-icon","","nzType","plus"]],template:function(t,n){if(t&1){let r=ee();v(0,"div",2),U("nzVisibleChange",function(){return q(r),j(n.change())}),v(1,"nz-badge",3),V(2,"i",4),b()(),v(3,"nz-dropdown-menu",null,0)(5,"div",5),X(6,W1,2,0,"div",6)(7,Q1,46,26,"nz-card",7),b()()}if(t&2){let r=ne(4);S("nzDropdownMenu",r),y(),S("nzDot",!0),y(5),Y(n.loading?6:7)}},dependencies:[Me,tt,Be,Ue,er,Zi,de,se,Dn,An,ca,aa,sa,Nn,nr,sp,op],encapsulation:2,changeDetection:0});var ba=pr;var gr=class gr{constructor(){this.settings=N($e);this.router=N(Lt);this.tokenService=N(mt)}get user(){return this.settings.user}logout(){this.tokenService.clear(),this.router.navigateByUrl(this.tokenService.login_url)}};gr.\u0275fac=function(t){return new(t||gr)},gr.\u0275cmp=Q({type:gr,selectors:[["header-user"]],decls:23,vars:15,consts:[["userMenu","nzDropdownMenu"],["nz-dropdown","","nzPlacement","bottomRight",1,"alain-default__nav-item","d-flex","align-items-center","px-sm",3,"nzDropdownMenu"],["nzSize","small",1,"mr-sm",3,"nzSrc"],["nz-menu","",1,"width-sm"],["nz-menu-item","","routerLink","/pro/account/center"],["nz-icon","","nzType","user",1,"mr-sm"],["nz-menu-item","","routerLink","/pro/account/settings"],["nz-icon","","nzType","setting",1,"mr-sm"],["nz-menu-item","","routerLink","/exception/trigger"],["nz-icon","","nzType","close-circle",1,"mr-sm"],["nz-menu-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","logout",1,"mr-sm"]],template:function(t,n){if(t&1){let r=ee();v(0,"div",1),V(1,"nz-avatar",2),k(2),b(),v(3,"nz-dropdown-menu",null,0)(5,"div",3)(6,"div",4),V(7,"i",5),k(8),Fe(9,"i18n"),b(),v(10,"div",6),V(11,"i",7),k(12),Fe(13,"i18n"),b(),v(14,"div",8),V(15,"i",9),k(16),Fe(17,"i18n"),b(),V(18,"li",10),v(19,"div",11),U("click",function(){return q(r),j(n.logout())}),V(20,"i",12),k(21),Fe(22,"i18n"),b()()()}if(t&2){let r=ne(4);S("nzDropdownMenu",r),y(),S("nzSrc",n.user.avatar),y(),ye(" ",n.user.name," "),y(6),ye(" ",Le(9,7,"menu.account.center")," "),y(4),ye(" ",Le(13,9,"menu.account.settings")," "),y(4),ye(" ",Le(17,11,"menu.account.trigger")," "),y(5),ye(" ",Le(22,13,"menu.account.logout")," ")}},dependencies:[Wi,Me,tt,Yt,tp,Be,Ue,At,de,se,Nn,nr,St],encapsulation:2,changeDetection:0});var Ea=gr;function J1(i,e){i&1&&V(0,"nz-spin",3)}function X1(i,e){if(i&1&&(V(0,"i",7),v(1,"span"),k(2),b()),i&2){let t=R();S("nzType",t.getWeatherIcon()),y(2),Te(t.getTemperature())}}function Y1(i,e){if(i&1&&(v(0,"div",5)(1,"div",8)(2,"h4",9),k(3),b(),v(4,"div",10),k(5),b(),v(6,"div",11),k(7),b()(),v(8,"div",12)(9,"div"),V(10,"i",13),v(11,"span"),k(12),b()(),v(13,"div"),V(14,"i",14),v(15,"span"),k(16),b()()()()),i&2){let t=R();y(3),Hf("",t.weatherData.name,", ",t.weatherData.sys.country),y(2),ye("",t.Math.round(t.weatherData.main.temp),"\xB0C"),y(2),Te(t.weatherData.weather[0].description),y(5),ye("\u9AD4\u611F: ",t.Math.round(t.weatherData.main.feels_like),"\xB0C"),y(4),ye("\u6FD5\u5EA6: ",t.weatherData.main.humidity,"%")}}function Z1(i,e){if(i&1&&(v(0,"div",6),V(1,"i",15),v(2,"div",11),k(3),b()()),i&2){let t=R();y(3),Te(t.errorMessage||"\u7121\u6CD5\u7372\u53D6\u5929\u6C23")}}var _r=class _r{constructor(){this.http=N($i);this.msg=N(xt);this.weatherData=null;this.loading=!1;this.errorMessage="";this.Math=Math}ngOnInit(){this.loadWeather()}loadWeather(){this.loading=!0,this.errorMessage="";let r=`https://api.openweathermap.org/data/2.5/weather?lat=${25.033}&lon=${121.5654}&appid=75d07b2345362f4603a113aee9c6747c&units=metric&lang=zh_tw`;this.http.get(r).pipe(wf(1e4),Af({count:2,delay:1e3}),Li(o=>{console.error("\u5929\u6C23 API \u932F\u8AA4:",o);let a="\u7121\u6CD5\u7372\u53D6\u5929\u6C23\u8CC7\u8A0A";return o.status===0?a="\u7DB2\u8DEF\u9023\u63A5\u5931\u6557":o.status===401?a="API \u91D1\u9470\u7121\u6548":o.status===404?a="\u627E\u4E0D\u5230\u5929\u6C23\u8CC7\u6599":o.status===429?a="\u8ACB\u6C42\u6B21\u6578\u5DF2\u9054\u4E0A\u9650":o.status>=500&&(a="\u4F3A\u670D\u5668\u932F\u8AA4"),this.errorMessage=a,this.msg.error(a),Jn(null)})).subscribe(o=>{this.weatherData=o,this.loading=!1})}getTemperature(){return this.weatherData?`${Math.round(this.weatherData.main.temp)}\xB0C`:"--\xB0C"}getWeatherIcon(){if(!this.weatherData)return"cloud";let e=this.weatherData.weather[0].main.toLowerCase();return{clear:"sun",clouds:"cloud",rain:"cloud-rain",snow:"cloud-snow",thunderstorm:"thunderbolt",drizzle:"cloud-drizzle",mist:"cloud",smoke:"cloud",haze:"cloud",dust:"cloud",fog:"cloud",sand:"cloud",ash:"cloud",squall:"cloud",tornado:"thunderbolt"}[e]||"cloud"}};_r.\u0275fac=function(t){return new(t||_r)},_r.\u0275cmp=Q({type:_r,selectors:[["header-weather"]],decls:9,vars:3,consts:[["weatherMenu","nzDropdownMenu"],["nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu"],[1,"alain-default__nav-item"],["nzSize","small"],["nz-menu","",1,"wd-lg"],[1,"p-md"],[1,"p-md","text-center"],["nz-icon","",1,"alain-default__nav-item-icon",3,"nzType"],[1,"text-center","mb-md"],[1,"mb-sm"],[1,"text-lg"],[1,"text-grey"],[1,"d-flex","justify-content-between"],["nz-icon","","nzType","thermometer"],["nz-icon","","nzType","cloud"],["nz-icon","","nzType","cloud",1,"text-grey"]],template:function(t,n){if(t&1&&(v(0,"div",1)(1,"div",2),X(2,J1,1,0,"nz-spin",3)(3,X1,3,2),b()(),v(4,"nz-dropdown-menu",null,0)(6,"div",4),X(7,Y1,17,6,"div",5)(8,Z1,4,1,"div",6),b()()),t&2){let r=ne(5);S("nzDropdownMenu",r),y(2),Y(n.loading?2:3),y(5),Y(n.weatherData?7:8)}},dependencies:[Me,tt,Be,Ue,de,se,At,Dn,An],styles:[".alain-default__nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;padding:0 12px;height:100%}.alain-default__nav-item-icon[_ngcontent-%COMP%]{font-size:16px}.wd-lg[_ngcontent-%COMP%]{width:280px}.text-lg[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.text-grey[_ngcontent-%COMP%]{color:#999}.mb-sm[_ngcontent-%COMP%]{margin-bottom:8px}.mb-md[_ngcontent-%COMP%]{margin-bottom:16px}.p-md[_ngcontent-%COMP%]{padding:16px}.d-flex[_ngcontent-%COMP%]{display:flex}.justify-content-between[_ngcontent-%COMP%]{justify-content:space-between}.text-center[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0});var Ia=_r;function ew(i,e){if(i&1&&(v(0,"div",22),V(1,"nz-avatar",23),v(2,"div",24)(3,"strong"),k(4),b(),v(5,"p",25),k(6),b()()(),v(7,"nz-dropdown-menu",null,3)(9,"ul",26)(10,"li",27),k(11),Fe(12,"i18n"),b(),v(13,"li",28),k(14),Fe(15,"i18n"),b()()()),i&2){let t=ne(8),n=R();S("nzDropdownMenu",t),y(),S("nzSrc",n.user.avatar),y(3),Te(n.user.name),y(2),Te(n.user.email),y(5),Te(Le(12,6,"menu.account.center")),y(3),Te(Le(15,8,"menu.account.settings"))}}function tw(i,e){i&1&&V(0,"router-outlet")}function nw(i,e){i&1&&V(0,"setting-drawer")}var yr=class yr{constructor(){this.settings=N($e);this.options={logoExpanded:"./assets/logo-full.svg",logoCollapsed:"./assets/logo.svg"};this.searchToggleStatus=!1;this.showSettingDrawer=!0}get user(){return this.settings.user}};yr.\u0275fac=function(t){return new(t||yr)},yr.\u0275cmp=Q({type:yr,selectors:[["layout-basic"]],decls:44,vars:7,consts:[["settingsMenu","nzDropdownMenu"],["asideUserTpl",""],["contentTpl",""],["userMenu","nzDropdownMenu"],[3,"options","asideUser","content","customError"],["direction","left"],["layout-default-header-item-trigger","","href","//github.com/ng-alain/ng-alain","target","_blank"],["nz-icon","","nzType","github"],["direction","left","hidden","mobile"],["layout-default-header-item-trigger","","routerLink","/passport/lock"],["nz-icon","","nzType","lock"],["direction","left","hidden","pc"],["layout-default-header-item-trigger","",3,"click"],["nz-icon","","nzType","search"],["direction","middle"],[1,"alain-default__search",3,"toggleChangeChange","toggleChange"],["direction","right"],["direction","right","hidden","mobile"],["layout-default-header-item-trigger","","nz-dropdown","","nzTrigger","click","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","setting"],["nz-menu","",2,"width","200px"],["nz-menu-item",""],["nz-dropdown","","nzTrigger","click",1,"alain-default__aside-user",3,"nzDropdownMenu"],[1,"alain-default__aside-user-avatar",3,"nzSrc"],[1,"alain-default__aside-user-info"],[1,"mb0"],["nz-menu",""],["nz-menu-item","","routerLink","/pro/account/center"],["nz-menu-item","","routerLink","/pro/account/settings"]],template:function(t,n){if(t&1){let r=ee();v(0,"layout-default",4)(1,"layout-default-header-item",5)(2,"a",6),V(3,"i",7),b()(),v(4,"layout-default-header-item",8)(5,"a",9),V(6,"i",10),b()(),v(7,"layout-default-header-item",11)(8,"div",12),U("click",function(){return q(r),j(n.searchToggleStatus=!n.searchToggleStatus)}),V(9,"i",13),b()(),v(10,"layout-default-header-item",14)(11,"header-search",15),Ft("toggleChangeChange",function(a){return q(r),Ot(n.searchToggleStatus,a)||(n.searchToggleStatus=a),j(a)}),b()(),v(12,"layout-default-header-item",16),V(13,"header-notify"),b(),v(14,"layout-default-header-item",17),V(15,"header-task"),b(),v(16,"layout-default-header-item",17),V(17,"header-weather"),b(),v(18,"layout-default-header-item",17),V(19,"header-google-docs"),b(),v(20,"layout-default-header-item",17),V(21,"header-icon"),b(),v(22,"layout-default-header-item",17)(23,"div",18),V(24,"i",19),b(),v(25,"nz-dropdown-menu",null,0)(27,"div",20)(28,"div",21),V(29,"header-rtl"),b(),v(30,"div",21),V(31,"header-fullscreen"),b(),v(32,"div",21),V(33,"header-clear-storage"),b(),v(34,"div",21),V(35,"header-i18n"),b()()()(),v(36,"layout-default-header-item",16),V(37,"header-user"),b(),J(38,ew,16,10,"ng-template",null,1,Se)(40,tw,1,0,"ng-template",null,2,Se),b(),X(42,nw,1,0,"setting-drawer"),V(43,"theme-btn")}if(t&2){let r=ne(26),o=ne(39),a=ne(41);S("options",n.options)("asideUser",o)("content",a)("customError",null),y(11),Mt("toggleChange",n.searchToggleStatus),y(12),S("nzDropdownMenu",r),y(19),Y(n.showSettingDrawer?42:-1)}},dependencies:[Gi,Wi,Cp,wp,Ol,Tp,de,se,At,tt,Yt,Me,Be,Ue,Nn,nr,Ep,Bl,fa,Ca,wa,ba,Ia,ya,va,Ta,rr,pa,_a,Ea,St],encapsulation:2});var Op=yr;var vr=class vr{};vr.\u0275fac=function(t){return new(t||vr)},vr.\u0275cmp=Q({type:vr,selectors:[["layout-blank"]],hostVars:2,hostBindings:function(t,n){t&2&&ie("alain-blank",!0)},decls:1,vars:0,template:function(t,n){t&1&&V(0,"router-outlet")},dependencies:[Gi],encapsulation:2});var Fp=vr;function iw(i){let e=i;return 5}var Lp=["zh",[["\u4E0A\u5348","\u4E0B\u5348"],void 0,void 0],void 0,[["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"]],void 0,[["1","2","3","4","5","6","7","8","9","10","11","12"],["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]],void 0,[["\u516C\u5143\u524D","\u516C\u5143"],void 0,void 0],0,[6,0],["y/M/d","y\u5E74M\u6708d\u65E5",void 0,"y\u5E74M\u6708d\u65E5EEEE"],["HH:mm","HH:mm:ss","z HH:mm:ss","zzzz HH:mm:ss"],["{1} {0}",void 0,void 0,void 0],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"CNY","\xA5","\u4EBA\u6C11\u5E01",{AUD:["AU$","$"],BYN:[void 0,"\u0440."],CNY:["\xA5"],ILR:["ILS"],JPY:["JP\xA5","\xA5"],KRW:["\uFFE6","\u20A9"],PHP:[void 0,"\u20B1"],RUR:[void 0,"\u0440."],TWD:["NT$"],USD:["US$","$"],XXX:[]},"ltr",iw];var rw={lessThanXSeconds:{one:"\u4E0D\u5230 1 \u79D2",other:"\u4E0D\u5230 {{count}} \u79D2"},xSeconds:{one:"1 \u79D2",other:"{{count}} \u79D2"},halfAMinute:"\u534A\u5206\u949F",lessThanXMinutes:{one:"\u4E0D\u5230 1 \u5206\u949F",other:"\u4E0D\u5230 {{count}} \u5206\u949F"},xMinutes:{one:"1 \u5206\u949F",other:"{{count}} \u5206\u949F"},xHours:{one:"1 \u5C0F\u65F6",other:"{{count}} \u5C0F\u65F6"},aboutXHours:{one:"\u5927\u7EA6 1 \u5C0F\u65F6",other:"\u5927\u7EA6 {{count}} \u5C0F\u65F6"},xDays:{one:"1 \u5929",other:"{{count}} \u5929"},aboutXWeeks:{one:"\u5927\u7EA6 1 \u4E2A\u661F\u671F",other:"\u5927\u7EA6 {{count}} \u4E2A\u661F\u671F"},xWeeks:{one:"1 \u4E2A\u661F\u671F",other:"{{count}} \u4E2A\u661F\u671F"},aboutXMonths:{one:"\u5927\u7EA6 1 \u4E2A\u6708",other:"\u5927\u7EA6 {{count}} \u4E2A\u6708"},xMonths:{one:"1 \u4E2A\u6708",other:"{{count}} \u4E2A\u6708"},aboutXYears:{one:"\u5927\u7EA6 1 \u5E74",other:"\u5927\u7EA6 {{count}} \u5E74"},xYears:{one:"1 \u5E74",other:"{{count}} \u5E74"},overXYears:{one:"\u8D85\u8FC7 1 \u5E74",other:"\u8D85\u8FC7 {{count}} \u5E74"},almostXYears:{one:"\u5C06\u8FD1 1 \u5E74",other:"\u5C06\u8FD1 {{count}} \u5E74"}},ow=function(e,t,n){var r,o=rw[e];return typeof o=="string"?r=o:t===1?r=o.one:r=o.other.replace("{{count}}",String(t)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+"\u5185":r+"\u524D":r},Bp=ow;var sw={full:"y'\u5E74'M'\u6708'd'\u65E5' EEEE",long:"y'\u5E74'M'\u6708'd'\u65E5'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},aw={full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},cw={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},lw={date:xn({formats:sw,defaultWidth:"full"}),time:xn({formats:aw,defaultWidth:"full"}),dateTime:xn({formats:cw,defaultWidth:"full"})},Up=lw;function Hl(i,e,t){fm(2,arguments);var n=xl(i,t),r=xl(e,t);return n.getTime()===r.getTime()}function qp(i,e,t){var n="eeee p";return Hl(i,e,t)?n:i.getTime()>e.getTime()?"'\u4E0B\u4E2A'"+n:"'\u4E0A\u4E2A'"+n}var uw={lastWeek:qp,yesterday:"'\u6628\u5929' p",today:"'\u4ECA\u5929' p",tomorrow:"'\u660E\u5929' p",nextWeek:qp,other:"PP p"},hw=function(e,t,n,r){var o=uw[e];return typeof o=="function"?o(t,n,r):o},jp=hw;var dw={narrow:["\u524D","\u516C\u5143"],abbreviated:["\u524D","\u516C\u5143"],wide:["\u516C\u5143\u524D","\u516C\u5143"]},fw={narrow:["1","2","3","4"],abbreviated:["\u7B2C\u4E00\u5B63","\u7B2C\u4E8C\u5B63","\u7B2C\u4E09\u5B63","\u7B2C\u56DB\u5B63"],wide:["\u7B2C\u4E00\u5B63\u5EA6","\u7B2C\u4E8C\u5B63\u5EA6","\u7B2C\u4E09\u5B63\u5EA6","\u7B2C\u56DB\u5B63\u5EA6"]},mw={narrow:["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"],abbreviated:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],wide:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]},pw={narrow:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],short:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],abbreviated:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],wide:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"]},gw={narrow:{am:"\u4E0A",pm:"\u4E0B",midnight:"\u51CC\u6668",noon:"\u5348",morning:"\u65E9",afternoon:"\u4E0B\u5348",evening:"\u665A",night:"\u591C"},abbreviated:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u95F4"},wide:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u95F4"}},_w={narrow:{am:"\u4E0A",pm:"\u4E0B",midnight:"\u51CC\u6668",noon:"\u5348",morning:"\u65E9",afternoon:"\u4E0B\u5348",evening:"\u665A",night:"\u591C"},abbreviated:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u95F4"},wide:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u95F4"}},yw=function(e,t){var n=Number(e);switch(t?.unit){case"date":return n.toString()+"\u65E5";case"hour":return n.toString()+"\u65F6";case"minute":return n.toString()+"\u5206";case"second":return n.toString()+"\u79D2";default:return"\u7B2C "+n.toString()}},vw={ordinalNumber:yw,era:Et({values:dw,defaultWidth:"wide"}),quarter:Et({values:fw,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Et({values:mw,defaultWidth:"wide"}),day:Et({values:pw,defaultWidth:"wide"}),dayPeriod:Et({values:gw,defaultWidth:"wide",formattingValues:_w,defaultFormattingWidth:"wide"})},Hp=vw;var ww=/^(第\s*)?\d+(日|时|分|秒)?/i,Tw=/\d+/i,Cw={narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},bw={any:[/^(前)/i,/^(公元)/i]},Ew={narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},Iw={any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},Sw={narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},xw={narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},Aw={narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},Dw={any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},Nw={any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},Rw={any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},Pw={ordinalNumber:Ws({matchPattern:ww,parsePattern:Tw,valueCallback:function(e){return parseInt(e,10)}}),era:It({matchPatterns:Cw,defaultMatchWidth:"wide",parsePatterns:bw,defaultParseWidth:"any"}),quarter:It({matchPatterns:Ew,defaultMatchWidth:"wide",parsePatterns:Iw,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:It({matchPatterns:Sw,defaultMatchWidth:"wide",parsePatterns:xw,defaultParseWidth:"any"}),day:It({matchPatterns:Aw,defaultMatchWidth:"wide",parsePatterns:Dw,defaultParseWidth:"any"}),dayPeriod:It({matchPatterns:Nw,defaultMatchWidth:"any",parsePatterns:Rw,defaultParseWidth:"any"})},$p=Pw;var Vw={code:"zh-CN",formatDistance:Bp,formatLong:Up,formatRelative:jp,localize:Hp,match:$p,options:{weekStartsOn:1,firstWeekContainsDate:4}},$l=Vw;var zw={lessThanXSeconds:{one:"\u5C11\u65BC 1 \u79D2",other:"\u5C11\u65BC {{count}} \u79D2"},xSeconds:{one:"1 \u79D2",other:"{{count}} \u79D2"},halfAMinute:"\u534A\u5206\u9418",lessThanXMinutes:{one:"\u5C11\u65BC 1 \u5206\u9418",other:"\u5C11\u65BC {{count}} \u5206\u9418"},xMinutes:{one:"1 \u5206\u9418",other:"{{count}} \u5206\u9418"},xHours:{one:"1 \u5C0F\u6642",other:"{{count}} \u5C0F\u6642"},aboutXHours:{one:"\u5927\u7D04 1 \u5C0F\u6642",other:"\u5927\u7D04 {{count}} \u5C0F\u6642"},xDays:{one:"1 \u5929",other:"{{count}} \u5929"},aboutXWeeks:{one:"\u5927\u7D04 1 \u500B\u661F\u671F",other:"\u5927\u7D04 {{count}} \u500B\u661F\u671F"},xWeeks:{one:"1 \u500B\u661F\u671F",other:"{{count}} \u500B\u661F\u671F"},aboutXMonths:{one:"\u5927\u7D04 1 \u500B\u6708",other:"\u5927\u7D04 {{count}} \u500B\u6708"},xMonths:{one:"1 \u500B\u6708",other:"{{count}} \u500B\u6708"},aboutXYears:{one:"\u5927\u7D04 1 \u5E74",other:"\u5927\u7D04 {{count}} \u5E74"},xYears:{one:"1 \u5E74",other:"{{count}} \u5E74"},overXYears:{one:"\u8D85\u904E 1 \u5E74",other:"\u8D85\u904E {{count}} \u5E74"},almostXYears:{one:"\u5C07\u8FD1 1 \u5E74",other:"\u5C07\u8FD1 {{count}} \u5E74"}},kw=function(e,t,n){var r,o=zw[e];return typeof o=="string"?r=o:t===1?r=o.one:r=o.other.replace("{{count}}",String(t)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?r+"\u5167":r+"\u524D":r},Gp=kw;var Mw={full:"y'\u5E74'M'\u6708'd'\u65E5' EEEE",long:"y'\u5E74'M'\u6708'd'\u65E5'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},Ow={full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},Fw={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},Lw={date:xn({formats:Mw,defaultWidth:"full"}),time:xn({formats:Ow,defaultWidth:"full"}),dateTime:xn({formats:Fw,defaultWidth:"full"})},Wp=Lw;var Bw={lastWeek:"'\u4E0A\u500B'eeee p",yesterday:"'\u6628\u5929' p",today:"'\u4ECA\u5929' p",tomorrow:"'\u660E\u5929' p",nextWeek:"'\u4E0B\u500B'eeee p",other:"P"},Uw=function(e,t,n,r){return Bw[e]},Kp=Uw;var qw={narrow:["\u524D","\u516C\u5143"],abbreviated:["\u524D","\u516C\u5143"],wide:["\u516C\u5143\u524D","\u516C\u5143"]},jw={narrow:["1","2","3","4"],abbreviated:["\u7B2C\u4E00\u523B","\u7B2C\u4E8C\u523B","\u7B2C\u4E09\u523B","\u7B2C\u56DB\u523B"],wide:["\u7B2C\u4E00\u523B\u9418","\u7B2C\u4E8C\u523B\u9418","\u7B2C\u4E09\u523B\u9418","\u7B2C\u56DB\u523B\u9418"]},Hw={narrow:["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"],abbreviated:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],wide:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]},$w={narrow:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],short:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],abbreviated:["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],wide:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"]},Gw={narrow:{am:"\u4E0A",pm:"\u4E0B",midnight:"\u51CC\u6668",noon:"\u5348",morning:"\u65E9",afternoon:"\u4E0B\u5348",evening:"\u665A",night:"\u591C"},abbreviated:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u9593"},wide:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u9593"}},Ww={narrow:{am:"\u4E0A",pm:"\u4E0B",midnight:"\u51CC\u6668",noon:"\u5348",morning:"\u65E9",afternoon:"\u4E0B\u5348",evening:"\u665A",night:"\u591C"},abbreviated:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u9593"},wide:{am:"\u4E0A\u5348",pm:"\u4E0B\u5348",midnight:"\u51CC\u6668",noon:"\u4E2D\u5348",morning:"\u65E9\u6668",afternoon:"\u4E2D\u5348",evening:"\u665A\u4E0A",night:"\u591C\u9593"}},Kw=function(e,t){var n=Number(e);switch(t?.unit){case"date":return n+"\u65E5";case"hour":return n+"\u6642";case"minute":return n+"\u5206";case"second":return n+"\u79D2";default:return"\u7B2C "+n}},Qw={ordinalNumber:Kw,era:Et({values:qw,defaultWidth:"wide"}),quarter:Et({values:jw,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Et({values:Hw,defaultWidth:"wide"}),day:Et({values:$w,defaultWidth:"wide"}),dayPeriod:Et({values:Gw,defaultWidth:"wide",formattingValues:Ww,defaultFormattingWidth:"wide"})},Qp=Qw;var Jw=/^(第\s*)?\d+(日|時|分|秒)?/i,Xw=/\d+/i,Yw={narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},Zw={any:[/^(前)/i,/^(公元)/i]},eT={narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻鐘/i},tT={any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},nT={narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},iT={narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},rT={narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^週[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},oT={any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},sT={any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨)/i},aT={any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},cT={ordinalNumber:Ws({matchPattern:Jw,parsePattern:Xw,valueCallback:function(e){return parseInt(e,10)}}),era:It({matchPatterns:Yw,defaultMatchWidth:"wide",parsePatterns:Zw,defaultParseWidth:"any"}),quarter:It({matchPatterns:eT,defaultMatchWidth:"wide",parsePatterns:tT,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:It({matchPatterns:nT,defaultMatchWidth:"wide",parsePatterns:iT,defaultParseWidth:"any"}),day:It({matchPatterns:rT,defaultMatchWidth:"wide",parsePatterns:oT,defaultParseWidth:"any"}),dayPeriod:It({matchPatterns:sT,defaultMatchWidth:"any",parsePatterns:aT,defaultParseWidth:"any"})},Jp=cT;var lT={code:"zh-TW",formatDistance:Gp,formatLong:Wp,formatRelative:Kp,localize:Qp,match:Jp,options:{weekStartsOn:1,firstWeekContainsDate:4}},Gl=lT;function uT(i){let e=i,t=Math.floor(Math.abs(i)),n=i.toString().replace(/^[^.]*\.?/,"").length;return t===1&&n===0?1:5}var Xp=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",uT];function hT(i){let e=i;return 5}var Yp=["zh-Hant",[["\u4E0A\u5348","\u4E0B\u5348"],void 0,void 0],void 0,[["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"]],void 0,[["1","2","3","4","5","6","7","8","9","10","11","12"],["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],void 0],void 0,[["\u897F\u5143\u524D","\u897F\u5143"],void 0,void 0],0,[6,0],["y/M/d","y\u5E74M\u6708d\u65E5",void 0,"y\u5E74M\u6708d\u65E5 EEEE"],["Bh:mm","Bh:mm:ss","Bh:mm:ss [z]","Bh:mm:ss [zzzz]"],["{1} {0}",void 0,void 0,void 0],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","\u975E\u6578\u503C",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"TWD","$","\u65B0\u53F0\u5E63",{AUD:["AU$","$"],BYN:[void 0,"\u0440."],KRW:["\uFFE6","\u20A9"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],RUR:[void 0,"\u0440."],TWD:["$"],USD:["US$","$"],XXX:[]},"ltr",hT];var Wl="zh-CN",Kl={"zh-CN":{text:"\u7B80\u4F53\u4E2D\u6587",ng:Lp,zorro:_m,date:$l,delon:Dm,abbr:"\u{1F1E8}\u{1F1F3}"},"zh-TW":{text:"\u7E41\u4F53\u4E2D\u6587",ng:Yp,zorro:ym,date:Gl,delon:Pm,abbr:"\u{1F1ED}\u{1F1F0}"},"en-US":{text:"English",ng:Xp,zorro:gm,date:Al,delon:Rm,abbr:"\u{1F1EC}\u{1F1E7}"}},si=class si extends Em{constructor(){super();this.http=N(xm);this.settings=N($e);this.nzI18nService=N(Ks);this.delonLocaleService=N(Js);this.platform=N(Gs);this._defaultLang=Wl;this._langs=Object.keys(Kl).map(t=>{let n=Kl[t];return{code:t,text:n.text,abbr:n.abbr}});let t=this.getDefaultLang();this._defaultLang=this._langs.findIndex(n=>n.code===t)===-1?Wl:t}getDefaultLang(){if(!this.platform.isBrowser)return Wl;if(this.settings.layout.lang)return this.settings.layout.lang;let t=(navigator.languages?navigator.languages[0]:null)||navigator.language,n=t.split("-");return n.length<=1?t:`${n[0]}-${n[1].toUpperCase()}`}loadLangData(t){return this.http.get(`./assets/tmp/i18n/${t}.json`)}use(t,n){if(this._currentLang===t)return;this._data=this.flatData(n,[]);let r=Kl[t];Xf(r.ng),this.nzI18nService.setLocale(r.zorro),this.nzI18nService.setDateLocale(r.date),this.delonLocaleService.setLocale(r.delon),this._currentLang=t,this._change$.next(t)}getLangs(){return this._langs}};si.\u0275fac=function(n){return new(n||si)},si.\u0275prov=bt({token:si,factory:si.\u0275fac,providedIn:"root"});var Zp=si;var eg=(i,e)=>({$implicit:i,data:e}),dT=i=>({$implicit:i});function fT(i,e){}function mT(i,e){if(i&1&&J(0,fT,0,0,"ng-template",1),i&2){let t=R();S("ngTemplateOutlet",t.instance.template)("ngTemplateOutletContext",wl(2,eg,t,t.instance.options==null?null:t.instance.options.nzData))}}function pT(i,e){i&1&&V(0,"nz-icon",6)}function gT(i,e){i&1&&V(0,"nz-icon",7)}function _T(i,e){i&1&&V(0,"nz-icon",8)}function yT(i,e){i&1&&V(0,"nz-icon",9)}function vT(i,e){if(i&1&&($t(0),V(1,"div",15),Gt()),i&2){let t=R(2);y(),S("innerHTML",t.instance.title,Ht)}}function wT(i,e){if(i&1&&($t(0),V(1,"div",15),Gt()),i&2){let t=R(2);y(),S("innerHTML",t.instance.content,Ht)}}function TT(i,e){}function CT(i,e){if(i&1&&(v(0,"span",14),J(1,TT,0,0,"ng-template",1),b()),i&2){let t=R(2);y(),S("ngTemplateOutlet",e)("ngTemplateOutletContext",ot(2,dT,t))}}function bT(i,e){if(i&1&&(v(0,"div",2)(1,"div",2)(2,"div"),X(3,pT,1,0,"nz-icon",6)(4,gT,1,0,"nz-icon",7)(5,_T,1,0,"nz-icon",8)(6,yT,1,0,"nz-icon",9),v(7,"div",10),J(8,vT,2,1,"ng-container",11),b(),v(9,"div",12),J(10,wT,2,1,"ng-container",13),b(),X(11,CT,2,4,"span",14),b()()()),i&2){let t,n,r=R();y(2),ie("ant-notification-notice-with-icon",r.instance.type!=="blank"),y(),Y((t=r.instance.type)==="success"?3:t==="info"?4:t==="warning"?5:t==="error"?6:-1),y(5),S("nzStringTemplateOutlet",r.instance.title),y(2),S("nzStringTemplateOutlet",r.instance.content)("nzStringTemplateOutletContext",wl(7,eg,r,r.instance.options==null?null:r.instance.options.nzData)),y(),Y((n=r.instance.options==null?null:r.instance.options.nzButton)?11:-1,n)}}function ET(i,e){if(i&1&&($t(0),V(1,"nz-icon",16),Gt()),i&2){let t=e.$implicit;y(),S("nzType",t)}}function IT(i,e){if(i&1&&J(0,ET,2,1,"ng-container",11),i&2){let t=R();S("nzStringTemplateOutlet",t.instance.options==null?null:t.instance.options.nzCloseIcon)}}function ST(i,e){i&1&&V(0,"nz-icon",5)}function xT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","topLeft")}}function AT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","topRight")}}function DT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","bottomLeft")}}function NT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","bottomRight")}}function RT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","top")}}function PT(i,e){if(i&1){let t=ee();v(0,"nz-notification",7),U("destroyed",function(r){q(t);let o=R();return j(o.remove(r.id,r.userAction))}),b()}if(i&2){let t=e.$implicit;S("instance",t)("placement","bottom")}}var VT=(()=>{class i extends Om{instance;index;placement;destroyed=new dt;constructor(){super(),this.destroyRef.onDestroy(()=>{this.instance.onClick.complete()})}onClick(t){this.instance.onClick.next(t)}close(){this.destroy(!0)}get state(){if(this.instance.state==="enter")switch(this.placement){case"topLeft":case"bottomLeft":return"enterLeft";case"topRight":case"bottomRight":return"enterRight";case"top":return"enterTop";case"bottom":return"enterBottom";default:return"enterRight"}else return this.instance.state}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["nz-notification"]],inputs:{instance:"instance",index:"index",placement:"placement"},outputs:{destroyed:"destroyed"},exportAs:["nzNotification"],features:[gl],decls:7,vars:7,consts:[[1,"ant-notification-notice","ant-notification-notice-closable",3,"click","mouseenter","mouseleave"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-notification-notice-content"],["tabindex","0",1,"ant-notification-notice-close",3,"click"],[1,"ant-notification-notice-close-x"],["nzType","close",1,"ant-notification-close-icon"],["nzType","check-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-success"],["nzType","info-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-info"],["nzType","exclamation-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-warning"],["nzType","close-circle",1,"ant-notification-notice-icon","ant-notification-notice-icon-error"],[1,"ant-notification-notice-message"],[4,"nzStringTemplateOutlet"],[1,"ant-notification-notice-description"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],[1,"ant-notification-notice-btn"],[3,"innerHTML"],[3,"nzType"]],template:function(n,r){n&1&&(v(0,"div",0),U("@notificationMotion.done",function(a){return r.animationStateChanged.next(a)})("click",function(a){return r.onClick(a)})("mouseenter",function(){return r.onEnter()})("mouseleave",function(){return r.onLeave()}),X(1,mT,1,5,null,1)(2,bT,12,10,"div",2),v(3,"a",3),U("click",function(){return r.close()}),v(4,"span",4),X(5,IT,1,1,"ng-container")(6,ST,1,0,"nz-icon",5),b()()()),n&2&&(qi((r.instance.options==null?null:r.instance.options.nzStyle)||null),Jt((r.instance.options==null?null:r.instance.options.nzClass)||""),S("@notificationMotion",r.state),y(),Y(r.instance.template?1:2),y(4),Y(r.instance.options!=null&&r.instance.options.nzCloseIcon?5:6))},dependencies:[de,se,Qi,Ki,ft],encapsulation:2,data:{animation:[Tm]}})}return i})(),Sa="notification",zT={nzTop:"24px",nzBottom:"24px",nzPlacement:"topRight",nzDuration:4500,nzMaxStack:8,nzPauseOnHover:!0,nzAnimate:!0,nzDirection:"ltr"},kT=(()=>{class i extends Mm{dir=this.nzConfigService.getConfigForComponent(Sa)?.nzDirection||"ltr";bottom;top;topLeftInstances=[];topRightInstances=[];bottomLeftInstances=[];bottomRightInstances=[];topInstances=[];bottomInstances=[];constructor(){super(),this.updateConfig()}create(t){let n=this.onCreate(t),r=n.options.nzKey,o=this.instances.find(a=>a.options.nzKey===t.options.nzKey);return r&&o?this.replaceNotification(o,n):(this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,n]),this.readyInstances(),n}onCreate(t){return t.options=this.mergeOptions(t.options),t.onClose=new dl,t.onClick=new dl,t}subscribeConfigChange(){cm(Sa,()=>{this.updateConfig(),this.dir=this.nzConfigService.getConfigForComponent(Sa)?.nzDirection||this.dir})}updateConfig(){this.config=we(we(we({},zT),this.config),this.nzConfigService.getConfigForComponent(Sa)),this.top=El(this.config.nzTop),this.bottom=El(this.config.nzBottom),this.cdr.markForCheck()}replaceNotification(t,n){t.title=n.title,t.content=n.content,t.template=n.template,t.type=n.type,t.options=n.options}readyInstances(){let t={topLeft:[],topRight:[],bottomLeft:[],bottomRight:[],top:[],bottom:[]};this.instances.forEach(n=>{switch(n.options.nzPlacement){case"topLeft":t.topLeft.unshift(n);break;case"topRight":t.topRight.unshift(n);break;case"bottomLeft":t.bottomLeft.unshift(n);break;case"bottomRight":t.bottomRight.unshift(n);break;case"top":t.top.unshift(n);break;case"bottom":t.bottom.unshift(n);break;default:t.topRight.unshift(n)}}),this.topLeftInstances=t.topLeft,this.topRightInstances=t.topRight,this.bottomLeftInstances=t.bottomLeft,this.bottomRightInstances=t.bottomRight,this.topInstances=t.top,this.bottomInstances=t.bottom,this.cdr.detectChanges()}mergeOptions(t){let{nzDuration:n,nzAnimate:r,nzPauseOnHover:o,nzPlacement:a}=this.config;return we({nzDuration:n,nzAnimate:r,nzPauseOnHover:o,nzPlacement:a},t)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=Q({type:i,selectors:[["nz-notification-container"]],exportAs:["nzNotificationContainer"],features:[gl],decls:18,vars:40,consts:[[1,"ant-notification","ant-notification-topLeft"],[3,"instance","placement"],[1,"ant-notification","ant-notification-topRight"],[1,"ant-notification","ant-notification-bottomLeft"],[1,"ant-notification","ant-notification-bottomRight"],[1,"ant-notification","ant-notification-top"],[1,"ant-notification","ant-notification-bottom"],[3,"destroyed","instance","placement"]],template:function(n,r){n&1&&(v(0,"div",0),me(1,xT,1,2,"nz-notification",1,ei),b(),v(3,"div",2),me(4,AT,1,2,"nz-notification",1,ei),b(),v(6,"div",3),me(7,DT,1,2,"nz-notification",1,ei),b(),v(9,"div",4),me(10,NT,1,2,"nz-notification",1,ei),b(),v(12,"div",5),me(13,RT,1,2,"nz-notification",1,ei),b(),v(15,"div",6),me(16,PT,1,2,"nz-notification",1,ei),b()),n&2&&(fn("top",r.top)("left","0px"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.topLeftInstances),y(2),fn("top",r.top)("right","0px"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.topRightInstances),y(2),fn("bottom",r.bottom)("left","0px"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.bottomLeftInstances),y(2),fn("bottom",r.bottom)("right","0px"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.bottomRightInstances),y(2),fn("top",r.top)("left","50%")("transform","translateX(-50%)"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.topInstances),y(2),fn("bottom",r.bottom)("left","50%")("transform","translateX(-50%)"),ie("ant-notification-rtl",r.dir==="rtl"),y(),pe(r.bottomInstances))},dependencies:[VT],encapsulation:2,changeDetection:0})}return i})(),MT=0,Ql=(()=>{class i extends km{componentPrefix="notification-";success(t,n,r){return this.create("success",t,n,r)}error(t,n,r){return this.create("error",t,n,r)}info(t,n,r){return this.create("info",t,n,r)}warning(t,n,r){return this.create("warning",t,n,r)}blank(t,n,r){return this.create("blank",t,n,r)}create(t,n,r,o){return this.createInstance({type:t,title:n,content:r},o)}template(t,n){return this.createInstance({template:t},n)}generateMessageId(){return`${this.componentPrefix}-${MT++}`}createInstance(t,n){return this.container=this.withContainer(kT),this.container.create(Mi(we({},t),{createdAt:new Date,messageId:n?.nzKey||this.generateMessageId(),options:n}))}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vf(i)))(r||i)}})();static \u0275prov=bt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var OT={200:"\u670D\u52A1\u5668\u6210\u529F\u8FD4\u56DE\u8BF7\u6C42\u7684\u6570\u636E\u3002",201:"\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u6210\u529F\u3002",202:"\u4E00\u4E2A\u8BF7\u6C42\u5DF2\u7ECF\u8FDB\u5165\u540E\u53F0\u6392\u961F\uFF08\u5F02\u6B65\u4EFB\u52A1\uFF09\u3002",204:"\u5220\u9664\u6570\u636E\u6210\u529F\u3002",400:"\u53D1\u51FA\u7684\u8BF7\u6C42\u6709\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u7684\u64CD\u4F5C\u3002",401:"\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF08\u4EE4\u724C\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u9519\u8BEF\uFF09\u3002",403:"\u7528\u6237\u5F97\u5230\u6388\u6743\uFF0C\u4F46\u662F\u8BBF\u95EE\u662F\u88AB\u7981\u6B62\u7684\u3002",404:"\u53D1\u51FA\u7684\u8BF7\u6C42\u9488\u5BF9\u7684\u662F\u4E0D\u5B58\u5728\u7684\u8BB0\u5F55\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u64CD\u4F5C\u3002",406:"\u8BF7\u6C42\u7684\u683C\u5F0F\u4E0D\u53EF\u5F97\u3002",410:"\u8BF7\u6C42\u7684\u8D44\u6E90\u88AB\u6C38\u4E45\u5220\u9664\uFF0C\u4E14\u4E0D\u4F1A\u518D\u5F97\u5230\u7684\u3002",422:"\u5F53\u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u53D1\u751F\u4E00\u4E2A\u9A8C\u8BC1\u9519\u8BEF\u3002",500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u3002",502:"\u7F51\u5173\u9519\u8BEF\u3002",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4\u3002",504:"\u7F51\u5173\u8D85\u65F6\u3002"};function FT(i,e){setTimeout(()=>i.get(Lt).navigateByUrl(e))}function wr(i){i.get(Ql).error("\u672A\u767B\u5F55\u6216\u767B\u5F55\u5DF2\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55\u3002",""),FT(i,i.get(mt).login_url)}function tg(i){let e={},t=N(Ji).currentLang;return!i?.has("Accept-Language")&&t&&(e["Accept-Language"]=t),e}function ng(i,e){if(e.status>=200&&e.status<300||e.status===401)return;let t=OT[e.status]||e.statusText;i.get(Ql).error(`\u8BF7\u6C42\u9519\u8BEF ${e.status}: ${e.url}`,t)}var ai=!1,Jl=new Oi(null);function ig(i,e){let t=i.get(mt).get()?.token;return e.clone({setHeaders:{token:`Bearer ${t}`}})}function rg(i){let e=i.get(mt).get();return i.get($i).post("/api/auth/refresh",{headers:{refresh_token:e?.refresh_token||""}})}function og(i,e,t,n){return["/api/auth/refresh"].some(r=>t.url.includes(r))?(wr(i),Fi(()=>e)):ai?Jl.pipe(jt(r=>!!r),If(1),Ct(()=>n(ig(i,t)))):(ai=!0,Jl.next(null),rg(i).pipe(Ct(r=>(ai=!1,Jl.next(r),i.get(mt).set(r),n(ig(i,t)))),Li(r=>(ai=!1,wr(i),Fi(()=>r)))))}function LT(i){let e=i.get(mt);e.refresh.pipe(jt(()=>!ai),Ct(t=>(console.log(t),ai=!0,rg(i)))).subscribe({next:t=>{t.expired=+new Date+1e3*60*5,ai=!1,e.set(t)},error:()=>wr(i)})}function BT(){return[Ls(()=>(e=>()=>LT(e))(N(Bi))())]}function UT(i,e,t,n){switch(ng(i,e),e.status){case 200:break;case 401:if(Xs.api.refreshTokenEnabled&&Xs.api.refreshTokenType==="re-request")return og(i,e,t,n);wr(i);break;case 403:case 404:case 500:break;default:e instanceof Tl&&console.warn("\u672A\u53EF\u77E5\u9519\u8BEF\uFF0C\u5927\u90E8\u5206\u662F\u7531\u4E8E\u540E\u7AEF\u4E0D\u652F\u6301\u8DE8\u57DFCORS\u6216\u65E0\u6548\u914D\u7F6E\u5F15\u8D77\uFF0C\u8BF7\u53C2\u8003 https://ng-alain.com/docs/server \u89E3\u51B3\u8DE8\u57DF\u95EE\u9898",e);break}return e instanceof Tl?Fi(()=>e):e._throw===!0?Fi(()=>e.body):Jn(e)}var tR=(i,e)=>{let t=i.url;if(!i.context.get(Am)&&!t.startsWith("https://")&&!t.startsWith("http://")){let{baseUrl:o}=Xs.api;t=o+(o.endsWith("/")&&t.startsWith("/")?t.substring(1):t)}let n=i.clone({url:t,setHeaders:tg(i.headers)}),r=N(Bi);return e(n).pipe(Tf(o=>o instanceof Yf?UT(r,o,n,e):Jn(o)))};var ci=class ci{constructor(){this.firestore=N(Ys);this.defaultPermissions=[{id:"dashboard:read",name:"\u5100\u8868\u677F\u67E5\u770B",description:"\u67E5\u770B\u5100\u8868\u677F\u8CC7\u6599",resource:"dashboard",action:"read",isActive:!0},{id:"user:read",name:"\u7528\u6236\u67E5\u770B",description:"\u67E5\u770B\u7528\u6236\u8CC7\u6599",resource:"user",action:"read",isActive:!0},{id:"user:write",name:"\u7528\u6236\u7DE8\u8F2F",description:"\u7DE8\u8F2F\u7528\u6236\u8CC7\u6599",resource:"user",action:"write",isActive:!0},{id:"admin:access",name:"\u7BA1\u7406\u54E1\u8A2A\u554F",description:"\u8A2A\u554F\u7BA1\u7406\u54E1\u529F\u80FD",resource:"admin",action:"access",isActive:!0}];this.defaultRoles=[{id:"user",name:"\u4E00\u822C\u7528\u6236",description:"\u57FA\u672C\u7528\u6236\u6B0A\u9650",permissions:["dashboard:read","user:read"],isActive:!0},{id:"user1",name:"\u8A8D\u8B49\u7528\u6236",description:"\u5DF2\u8A8D\u8B49\u7528\u6236\u6B0A\u9650",permissions:["dashboard:read","user:read","user:write"],isActive:!0},{id:"admin",name:"\u7BA1\u7406\u54E1",description:"\u7BA1\u7406\u54E1\u6B0A\u9650",permissions:["dashboard:read","user:read","user:write","admin:access"],isActive:!0}]}initializeACL(){let e=this.defaultPermissions.map(n=>this.createPermissionIfNotExists(n)),t=this.defaultRoles.map(n=>this.createRoleIfNotExists(n));return Cf([...e,...t]).pipe(at(()=>{}))}createPermissionIfNotExists(e){let t=Xi(this.firestore,"acl_permissions",e.id);return Qn(Yi(t)).pipe(Ct(n=>{if(!n.exists()){let r=Mi(we({},e),{createdAt:new Date,updatedAt:new Date});return Qn(So(t,r))}return Qn(Promise.resolve())}),at(()=>{}))}createRoleIfNotExists(e){let t=Xi(this.firestore,"acl_roles",e.id);return Qn(Yi(t)).pipe(Ct(n=>{if(!n.exists()){let r=Mi(we({},e),{createdAt:new Date,updatedAt:new Date});return Qn(So(t,r))}return Qn(Promise.resolve())}),at(()=>{}))}};ci.\u0275fac=function(t){return new(t||ci)},ci.\u0275prov=bt({token:ci,factory:ci.\u0275fac,providedIn:"root"});var xa=ci;function DR(){return[Aa,Ls(()=>(e=>()=>e.load())(N(Aa))())]}var li=class li{constructor(){this.menuService=N(Qs);this.settingService=N($e);this.aclService=N(om);this.titleService=N(Sm);this.tokenService=N(mt);this.httpClient=N($i);this.router=N(Lt);this.i18n=N(Ji);this.auth=N(Lm);this.firebaseUserService=N(Km);this.firebaseACLService=N(Qm);this.firebaseACLInitService=N(xa)}load(){let e=this.i18n.defaultLang,t=this.tokenService.get(),n=t&&t.token;return console.log("StartupService: \u6AA2\u67E5 token:",n?"\u6709\u6548":"\u7121\u6548"),bf(this.i18n.loadLangData(e),this.httpClient.get("./assets/tmp/app-data.json"),this.firebaseACLInitService.initializeACL(),n?this.getFirebaseUser():Jn(null)).pipe(Li(r=>(console.warn("StartupService.load: Network request failed",r),setTimeout(()=>this.router.navigateByUrl("/exception/500")),[])),at(([r,o,,a])=>{this.i18n.use(e,r),this.settingService.setApp(o.app),a?(console.log("StartupService: \u4F7F\u7528 Firebase \u7528\u6236\u8CC7\u8A0A:",a),this.settingService.setUser({name:a.displayName||a.email||"Anonymous",avatar:a.photoURL||"./assets/logo-color.svg",email:a.email||"",id:a.uid})):(console.log("StartupService: \u4F7F\u7528\u975C\u614B\u7528\u6236\u914D\u7F6E"),this.settingService.setUser(o.user)),a||(console.log("StartupService: \u8A2D\u5B9A\u8A2A\u5BA2\u6B0A\u9650"),this.aclService.set({role:["guest"],ability:["dashboard:read"]})),this.menuService.add(o.menu),this.titleService.default="",this.titleService.suffix=o.app.name}))}getFirebaseUser(){return new un(e=>{let t=Bm(this.auth,n=>{n?this.firebaseUserService.getUserProfile(n.uid).subscribe({next:r=>{if(r){let o={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:r.emailVerified,role:r.role,permissions:r.permissions};e.next(o)}else{let o={uid:n.uid,email:n.email,displayName:n.displayName,photoURL:n.photoURL,emailVerified:n.emailVerified,role:"user",permissions:["dashboard"]};e.next(o)}e.complete()},error:r=>{console.error("\u7372\u53D6 Firestore \u7528\u6236\u8CC7\u6599\u5931\u6557:",r);let o={uid:n.uid,email:n.email,displayName:n.displayName,photoURL:n.photoURL,emailVerified:n.emailVerified,role:"user",permissions:["dashboard"]};e.next(o),e.complete()}}):(e.next(null),e.complete())});return()=>t()})}};li.\u0275fac=function(t){return new(t||li)},li.\u0275prov=bt({token:li,factory:li.\u0275fac});var Aa=li;var RR=()=>!0;var sg=()=>{};var ag=function(i){let e=[],t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},qT=function(i){let e=[],t=0,n=0;for(;t<i.length;){let r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){let o=i[t++];e[n++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){let o=i[t++],a=i[t++],l=i[t++],h=((r&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{let o=i[t++],a=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(o&63)<<6|a&63)}}return e.join("")},cg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){let o=i[r],a=r+1<i.length,l=a?i[r+1]:0,h=r+2<i.length,d=h?i[r+2]:0,_=o>>2,w=(o&3)<<4|l>>4,P=(l&15)<<2|d>>6,F=d&63;h||(F=64,a||(P=64)),n.push(t[_],t[w],t[P],t[F])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(ag(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):qT(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){let o=t[i.charAt(r++)],l=r<i.length?t[i.charAt(r)]:0;++r;let d=r<i.length?t[i.charAt(r)]:64;++r;let w=r<i.length?t[i.charAt(r)]:64;if(++r,o==null||l==null||d==null||w==null)throw new Xl;let P=o<<2|l>>4;if(n.push(P),d!==64){let F=l<<4&240|d>>2;if(n.push(F),w!==64){let L=d<<6&192|w;n.push(L)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},Xl=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},jT=function(i){let e=ag(i);return cg.encodeByteArray(e,!0)},Yl=function(i){return jT(i).replace(/\./g,"")},lg=function(i){try{return cg.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Zl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var HT=()=>Zl().__FIREBASE_DEFAULTS__,$T=()=>{if(typeof process>"u"||typeof process.env>"u")return;let i=process.env.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},GT=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=i&&lg(i[1]);return e&&JSON.parse(e)},WT=()=>{try{return sg()||HT()||$T()||GT()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}};function ug(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}function zo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hg(){let i=WT()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eu(){return!hg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tu(){return!hg()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Da(){try{return typeof indexedDB=="object"}catch{return!1}}function dg(){return new Promise((i,e)=>{try{let t=!0,n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}var KT="FirebaseError",gn=class i extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=KT,Object.setPrototypeOf(this,i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vo.prototype.create)}},Vo=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],a=o?QT(o,n):"Error",l=`${this.serviceName}: ${a} (${r}).`;return new gn(r,l,n)}};function QT(i,e){return i.replace(JT,(t,n)=>{let r=e[n];return r!=null?String(r):`<${n}?>`})}var JT=/\{\$([^}]+)}/g;var kR=4*60*60*1e3;var Rn=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var XT=[],ae=function(i){return i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT",i}(ae||{}),YT={debug:ae.DEBUG,verbose:ae.VERBOSE,info:ae.INFO,warn:ae.WARN,error:ae.ERROR,silent:ae.SILENT},ZT=ae.INFO,eC={[ae.DEBUG]:"log",[ae.VERBOSE]:"log",[ae.INFO]:"info",[ae.WARN]:"warn",[ae.ERROR]:"error"},tC=(i,e,...t)=>{if(e<i.logLevel)return;let n=new Date().toISOString(),r=eC[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Tr=class{constructor(e){this.name=e,this._logLevel=ZT,this._logHandler=tC,this._userLogHandler=null,XT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?YT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ae.DEBUG,...e),this._logHandler(this,ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ae.VERBOSE,...e),this._logHandler(this,ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ae.INFO,...e),this._logHandler(this,ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ae.WARN,...e),this._logHandler(this,ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ae.ERROR,...e),this._logHandler(this,ae.ERROR,...e)}};var iu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(iC(t)){let n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}};function iC(i){return i.getComponent()?.type==="VERSION"}var ru="@firebase/app",fg="0.14.0";var _n=new Tr("@firebase/app"),rC="@firebase/app-compat",oC="@firebase/analytics-compat",sC="@firebase/analytics",aC="@firebase/app-check-compat",cC="@firebase/app-check",lC="@firebase/auth",uC="@firebase/auth-compat",hC="@firebase/database",dC="@firebase/data-connect",fC="@firebase/database-compat",mC="@firebase/functions",pC="@firebase/functions-compat",gC="@firebase/installations",_C="@firebase/installations-compat",yC="@firebase/messaging",vC="@firebase/messaging-compat",wC="@firebase/performance",TC="@firebase/performance-compat",CC="@firebase/remote-config",bC="@firebase/remote-config-compat",EC="@firebase/storage",IC="@firebase/storage-compat",SC="@firebase/firestore",xC="@firebase/ai",AC="@firebase/firestore-compat",DC="firebase",NC="12.0.0";var RC={[ru]:"fire-core",[rC]:"fire-core-compat",[sC]:"fire-analytics",[oC]:"fire-analytics-compat",[cC]:"fire-app-check",[aC]:"fire-app-check-compat",[lC]:"fire-auth",[uC]:"fire-auth-compat",[hC]:"fire-rtdb",[dC]:"fire-data-connect",[fC]:"fire-rtdb-compat",[mC]:"fire-fn",[pC]:"fire-fn-compat",[gC]:"fire-iid",[_C]:"fire-iid-compat",[yC]:"fire-fcm",[vC]:"fire-fcm-compat",[wC]:"fire-perf",[TC]:"fire-perf-compat",[CC]:"fire-rc",[bC]:"fire-rc-compat",[EC]:"fire-gcs",[IC]:"fire-gcs-compat",[SC]:"fire-fst",[AC]:"fire-fst-compat",[xC]:"fire-vertex","fire-js":"fire-js",[DC]:"fire-js-all"};var PC=new Map,VC=new Map,mg=new Map;function pg(i,e){try{i.container.addComponent(e)}catch(t){_n.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function ko(i){let e=i.name;if(mg.has(e))return _n.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,i);for(let t of PC.values())pg(t,i);for(let t of VC.values())pg(t,i);return!0}function vg(i){return i==null?!1:i.settings!==void 0}var zC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},au=new Vo("app","Firebase",zC);var wg=NC;function Cr(i,e,t){let n=RC[i]??i;t&&(n+=`-${t}`);let r=n.match(/\s|\//),o=e.match(/\s|\//);if(r||o){let a=[`Unable to register library "${n}" with version "${e}":`];r&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_n.warn(a.join(" "));return}ko(new Rn(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}var kC="firebase-heartbeat-database",MC=1,Mo="firebase-heartbeat-store",nu=null;function Tg(){return nu||(nu=Fm(kC,MC,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Mo)}catch(t){console.warn(t)}}}}).catch(i=>{throw au.create("idb-open",{originalErrorMessage:i.message})})),nu}function OC(i){return B(this,null,function*(){try{let t=(yield Tg()).transaction(Mo),n=yield t.objectStore(Mo).get(Cg(i));return yield t.done,n}catch(e){if(e instanceof gn)_n.warn(e.message);else{let t=au.create("idb-get",{originalErrorMessage:e?.message});_n.warn(t.message)}}})}function gg(i,e){return B(this,null,function*(){try{let n=(yield Tg()).transaction(Mo,"readwrite");yield n.objectStore(Mo).put(e,Cg(i)),yield n.done}catch(t){if(t instanceof gn)_n.warn(t.message);else{let n=au.create("idb-set",{originalErrorMessage:t?.message});_n.warn(n.message)}}})}function Cg(i){return`${i.name}!${i.options.appId}`}var FC=1024,LC=30,ou=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new su(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){return B(this,null,function*(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=_g();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(r=>r.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>LC){let r=UC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_n.warn(e)}})}getHeartbeatsHeader(){return B(this,null,function*(){try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=_g(),{heartbeatsToSend:t,unsentEntries:n}=BC(this._heartbeatsCache.heartbeats),r=Yl(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return _n.warn(e),""}})}};function _g(){return new Date().toISOString().substring(0,10)}function BC(i,e=FC){let t=[],n=i.slice();for(let r of i){let o=t.find(a=>a.agent===r.agent);if(o){if(o.dates.push(r.date),yg(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),yg(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}var su=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return B(this,null,function*(){return Da()?dg().then(()=>!0).catch(()=>!1):!1})}read(){return B(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield OC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return B(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield this.read();return gg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return B(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield this.read();return gg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return})}};function yg(i){return Yl(JSON.stringify({version:2,heartbeats:i})).length}function UC(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}function qC(i){ko(new Rn("platform-logger",e=>new iu(e),"PRIVATE")),ko(new Rn("heartbeat",e=>new ou(e),"PRIVATE")),Cr(ru,fg,i),Cr(ru,fg,"esm2020"),Cr("fire-js","")}qC("");var bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Eg={};var Na,Ig;(function(){var i;function e(C,m){function g(){}g.prototype=m.prototype,C.D=m.prototype,C.prototype=new g,C.prototype.constructor=C,C.C=function(T,E,x){for(var p=Array(arguments.length-2),an=2;an<arguments.length;an++)p[an-2]=arguments[an];return m.prototype[E].apply(T,p)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,m,g){g||(g=0);var T=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)T[E]=m.charCodeAt(g++)|m.charCodeAt(g++)<<8|m.charCodeAt(g++)<<16|m.charCodeAt(g++)<<24;else for(E=0;16>E;++E)T[E]=m[g++]|m[g++]<<8|m[g++]<<16|m[g++]<<24;m=C.g[0],g=C.g[1],E=C.g[2];var x=C.g[3],p=m+(x^g&(E^x))+T[0]+3614090360&4294967295;m=g+(p<<7&4294967295|p>>>25),p=x+(E^m&(g^E))+T[1]+3905402710&4294967295,x=m+(p<<12&4294967295|p>>>20),p=E+(g^x&(m^g))+T[2]+606105819&4294967295,E=x+(p<<17&4294967295|p>>>15),p=g+(m^E&(x^m))+T[3]+3250441966&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(x^g&(E^x))+T[4]+4118548399&4294967295,m=g+(p<<7&4294967295|p>>>25),p=x+(E^m&(g^E))+T[5]+1200080426&4294967295,x=m+(p<<12&4294967295|p>>>20),p=E+(g^x&(m^g))+T[6]+2821735955&4294967295,E=x+(p<<17&4294967295|p>>>15),p=g+(m^E&(x^m))+T[7]+4249261313&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(x^g&(E^x))+T[8]+1770035416&4294967295,m=g+(p<<7&4294967295|p>>>25),p=x+(E^m&(g^E))+T[9]+2336552879&4294967295,x=m+(p<<12&4294967295|p>>>20),p=E+(g^x&(m^g))+T[10]+4294925233&4294967295,E=x+(p<<17&4294967295|p>>>15),p=g+(m^E&(x^m))+T[11]+2304563134&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(x^g&(E^x))+T[12]+1804603682&4294967295,m=g+(p<<7&4294967295|p>>>25),p=x+(E^m&(g^E))+T[13]+4254626195&4294967295,x=m+(p<<12&4294967295|p>>>20),p=E+(g^x&(m^g))+T[14]+2792965006&4294967295,E=x+(p<<17&4294967295|p>>>15),p=g+(m^E&(x^m))+T[15]+1236535329&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(E^x&(g^E))+T[1]+4129170786&4294967295,m=g+(p<<5&4294967295|p>>>27),p=x+(g^E&(m^g))+T[6]+3225465664&4294967295,x=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(x^m))+T[11]+643717713&4294967295,E=x+(p<<14&4294967295|p>>>18),p=g+(x^m&(E^x))+T[0]+3921069994&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^x&(g^E))+T[5]+3593408605&4294967295,m=g+(p<<5&4294967295|p>>>27),p=x+(g^E&(m^g))+T[10]+38016083&4294967295,x=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(x^m))+T[15]+3634488961&4294967295,E=x+(p<<14&4294967295|p>>>18),p=g+(x^m&(E^x))+T[4]+3889429448&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^x&(g^E))+T[9]+568446438&4294967295,m=g+(p<<5&4294967295|p>>>27),p=x+(g^E&(m^g))+T[14]+3275163606&4294967295,x=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(x^m))+T[3]+4107603335&4294967295,E=x+(p<<14&4294967295|p>>>18),p=g+(x^m&(E^x))+T[8]+1163531501&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^x&(g^E))+T[13]+2850285829&4294967295,m=g+(p<<5&4294967295|p>>>27),p=x+(g^E&(m^g))+T[2]+4243563512&4294967295,x=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(x^m))+T[7]+1735328473&4294967295,E=x+(p<<14&4294967295|p>>>18),p=g+(x^m&(E^x))+T[12]+2368359562&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(g^E^x)+T[5]+4294588738&4294967295,m=g+(p<<4&4294967295|p>>>28),p=x+(m^g^E)+T[8]+2272392833&4294967295,x=m+(p<<11&4294967295|p>>>21),p=E+(x^m^g)+T[11]+1839030562&4294967295,E=x+(p<<16&4294967295|p>>>16),p=g+(E^x^m)+T[14]+4259657740&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^x)+T[1]+2763975236&4294967295,m=g+(p<<4&4294967295|p>>>28),p=x+(m^g^E)+T[4]+1272893353&4294967295,x=m+(p<<11&4294967295|p>>>21),p=E+(x^m^g)+T[7]+4139469664&4294967295,E=x+(p<<16&4294967295|p>>>16),p=g+(E^x^m)+T[10]+3200236656&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^x)+T[13]+681279174&4294967295,m=g+(p<<4&4294967295|p>>>28),p=x+(m^g^E)+T[0]+3936430074&4294967295,x=m+(p<<11&4294967295|p>>>21),p=E+(x^m^g)+T[3]+3572445317&4294967295,E=x+(p<<16&4294967295|p>>>16),p=g+(E^x^m)+T[6]+76029189&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^x)+T[9]+3654602809&4294967295,m=g+(p<<4&4294967295|p>>>28),p=x+(m^g^E)+T[12]+3873151461&4294967295,x=m+(p<<11&4294967295|p>>>21),p=E+(x^m^g)+T[15]+530742520&4294967295,E=x+(p<<16&4294967295|p>>>16),p=g+(E^x^m)+T[2]+3299628645&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(E^(g|~x))+T[0]+4096336452&4294967295,m=g+(p<<6&4294967295|p>>>26),p=x+(g^(m|~E))+T[7]+1126891415&4294967295,x=m+(p<<10&4294967295|p>>>22),p=E+(m^(x|~g))+T[14]+2878612391&4294967295,E=x+(p<<15&4294967295|p>>>17),p=g+(x^(E|~m))+T[5]+4237533241&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~x))+T[12]+1700485571&4294967295,m=g+(p<<6&4294967295|p>>>26),p=x+(g^(m|~E))+T[3]+2399980690&4294967295,x=m+(p<<10&4294967295|p>>>22),p=E+(m^(x|~g))+T[10]+4293915773&4294967295,E=x+(p<<15&4294967295|p>>>17),p=g+(x^(E|~m))+T[1]+2240044497&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~x))+T[8]+1873313359&4294967295,m=g+(p<<6&4294967295|p>>>26),p=x+(g^(m|~E))+T[15]+4264355552&4294967295,x=m+(p<<10&4294967295|p>>>22),p=E+(m^(x|~g))+T[6]+2734768916&4294967295,E=x+(p<<15&4294967295|p>>>17),p=g+(x^(E|~m))+T[13]+1309151649&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~x))+T[4]+4149444226&4294967295,m=g+(p<<6&4294967295|p>>>26),p=x+(g^(m|~E))+T[11]+3174756917&4294967295,x=m+(p<<10&4294967295|p>>>22),p=E+(m^(x|~g))+T[2]+718787259&4294967295,E=x+(p<<15&4294967295|p>>>17),p=g+(x^(E|~m))+T[9]+3951481745&4294967295,C.g[0]=C.g[0]+m&4294967295,C.g[1]=C.g[1]+(E+(p<<21&4294967295|p>>>11))&4294967295,C.g[2]=C.g[2]+E&4294967295,C.g[3]=C.g[3]+x&4294967295}n.prototype.u=function(C,m){m===void 0&&(m=C.length);for(var g=m-this.blockSize,T=this.B,E=this.h,x=0;x<m;){if(E==0)for(;x<=g;)r(this,C,x),x+=this.blockSize;if(typeof C=="string"){for(;x<m;)if(T[E++]=C.charCodeAt(x++),E==this.blockSize){r(this,T),E=0;break}}else for(;x<m;)if(T[E++]=C[x++],E==this.blockSize){r(this,T),E=0;break}}this.h=E,this.o+=m},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var m=1;m<C.length-8;++m)C[m]=0;var g=8*this.o;for(m=C.length-8;m<C.length;++m)C[m]=g&255,g/=256;for(this.u(C),C=Array(16),m=g=0;4>m;++m)for(var T=0;32>T;T+=8)C[g++]=this.g[m]>>>T&255;return C};function o(C,m){var g=l;return Object.prototype.hasOwnProperty.call(g,C)?g[C]:g[C]=m(C)}function a(C,m){this.h=m;for(var g=[],T=!0,E=C.length-1;0<=E;E--){var x=C[E]|0;T&&x==m||(g[E]=x,T=!1)}this.g=g}var l={};function h(C){return-128<=C&&128>C?o(C,function(m){return new a([m|0],0>m?-1:0)}):new a([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return w;if(0>C)return W(d(-C));for(var m=[],g=1,T=0;C>=g;T++)m[T]=C/g|0,g*=4294967296;return new a(m,0)}function _(C,m){if(C.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(C.charAt(0)=="-")return W(_(C.substring(1),m));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var g=d(Math.pow(m,8)),T=w,E=0;E<C.length;E+=8){var x=Math.min(8,C.length-E),p=parseInt(C.substring(E,E+x),m);8>x?(x=d(Math.pow(m,x)),T=T.j(x).add(d(p))):(T=T.j(g),T=T.add(d(p)))}return T}var w=h(0),P=h(1),F=h(16777216);i=a.prototype,i.m=function(){if(G(this))return-W(this).m();for(var C=0,m=1,g=0;g<this.g.length;g++){var T=this.i(g);C+=(0<=T?T:4294967296+T)*m,m*=4294967296}return C},i.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(L(this))return"0";if(G(this))return"-"+W(this).toString(C);for(var m=d(Math.pow(C,6)),g=this,T="";;){var E=ve(g,m).g;g=Ae(g,E.j(m));var x=((0<g.g.length?g.g[0]:g.h)>>>0).toString(C);if(g=E,L(g))return x+T;for(;6>x.length;)x="0"+x;T=x+T}},i.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function L(C){if(C.h!=0)return!1;for(var m=0;m<C.g.length;m++)if(C.g[m]!=0)return!1;return!0}function G(C){return C.h==-1}i.l=function(C){return C=Ae(this,C),G(C)?-1:L(C)?0:1};function W(C){for(var m=C.g.length,g=[],T=0;T<m;T++)g[T]=~C.g[T];return new a(g,~C.h).add(P)}i.abs=function(){return G(this)?W(this):this},i.add=function(C){for(var m=Math.max(this.g.length,C.g.length),g=[],T=0,E=0;E<=m;E++){var x=T+(this.i(E)&65535)+(C.i(E)&65535),p=(x>>>16)+(this.i(E)>>>16)+(C.i(E)>>>16);T=p>>>16,x&=65535,p&=65535,g[E]=p<<16|x}return new a(g,g[g.length-1]&-2147483648?-1:0)};function Ae(C,m){return C.add(W(m))}i.j=function(C){if(L(this)||L(C))return w;if(G(this))return G(C)?W(this).j(W(C)):W(W(this).j(C));if(G(C))return W(this.j(W(C)));if(0>this.l(F)&&0>C.l(F))return d(this.m()*C.m());for(var m=this.g.length+C.g.length,g=[],T=0;T<2*m;T++)g[T]=0;for(T=0;T<this.g.length;T++)for(var E=0;E<C.g.length;E++){var x=this.i(T)>>>16,p=this.i(T)&65535,an=C.i(E)>>>16,no=C.i(E)&65535;g[2*T+2*E]+=p*no,le(g,2*T+2*E),g[2*T+2*E+1]+=x*no,le(g,2*T+2*E+1),g[2*T+2*E+1]+=p*an,le(g,2*T+2*E+1),g[2*T+2*E+2]+=x*an,le(g,2*T+2*E+2)}for(T=0;T<m;T++)g[T]=g[2*T+1]<<16|g[2*T];for(T=m;T<2*m;T++)g[T]=0;return new a(g,0)};function le(C,m){for(;(C[m]&65535)!=C[m];)C[m+1]+=C[m]>>>16,C[m]&=65535,m++}function te(C,m){this.g=C,this.h=m}function ve(C,m){if(L(m))throw Error("division by zero");if(L(C))return new te(w,w);if(G(C))return m=ve(W(C),m),new te(W(m.g),W(m.h));if(G(m))return m=ve(C,W(m)),new te(W(m.g),m.h);if(30<C.g.length){if(G(C)||G(m))throw Error("slowDivide_ only works with positive integers.");for(var g=P,T=m;0>=T.l(C);)g=be(g),T=be(T);var E=fe(g,1),x=fe(T,1);for(T=fe(T,2),g=fe(g,2);!L(T);){var p=x.add(T);0>=p.l(C)&&(E=E.add(g),x=p),T=fe(T,1),g=fe(g,1)}return m=Ae(C,E.j(m)),new te(E,m)}for(E=w;0<=C.l(m);){for(g=Math.max(1,Math.floor(C.m()/m.m())),T=Math.ceil(Math.log(g)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),x=d(g),p=x.j(m);G(p)||0<p.l(C);)g-=T,x=d(g),p=x.j(m);L(x)&&(x=P),E=E.add(x),C=Ae(C,p)}return new te(E,C)}i.A=function(C){return ve(this,C).h},i.and=function(C){for(var m=Math.max(this.g.length,C.g.length),g=[],T=0;T<m;T++)g[T]=this.i(T)&C.i(T);return new a(g,this.h&C.h)},i.or=function(C){for(var m=Math.max(this.g.length,C.g.length),g=[],T=0;T<m;T++)g[T]=this.i(T)|C.i(T);return new a(g,this.h|C.h)},i.xor=function(C){for(var m=Math.max(this.g.length,C.g.length),g=[],T=0;T<m;T++)g[T]=this.i(T)^C.i(T);return new a(g,this.h^C.h)};function be(C){for(var m=C.g.length+1,g=[],T=0;T<m;T++)g[T]=C.i(T)<<1|C.i(T-1)>>>31;return new a(g,C.h)}function fe(C,m){var g=m>>5;m%=32;for(var T=C.g.length-g,E=[],x=0;x<T;x++)E[x]=0<m?C.i(x+g)>>>m|C.i(x+g+1)<<32-m:C.i(x+g);return new a(E,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Ig=Eg.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=_,Na=Eg.Integer=a}).apply(typeof bg<"u"?bg:typeof self<"u"?self:typeof window<"u"?window:{});var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yn={};var cu,jC,br,lu,Oo,Pa,uu,hu,du;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,u){return s==Array.prototype||s==Object.prototype||(s[c]=u.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ra=="object"&&Ra];for(var c=0;c<s.length;++c){var u=s[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var n=t(this);function r(s,c){if(c)e:{var u=n;s=s.split(".");for(var f=0;f<s.length-1;f++){var I=s[f];if(!(I in u))break e;u=u[I]}s=s[s.length-1],f=u[s],c=c(f),c!=f&&c!=null&&e(u,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var u=0,f=!1,I={next:function(){if(!f&&u<s.length){var D=u++;return{value:c(D,s[D]),done:!1}}return f=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}r("Array.prototype.values",function(s){return s||function(){return o(this,function(c,u){return u})}});var a=a||{},l=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function _(s,c,u){return s.call.apply(s.bind,arguments)}function w(s,c,u){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,f),s.apply(c,I)}}return function(){return s.apply(c,arguments)}}function P(s,c,u){return P=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:w,P.apply(null,arguments)}function F(s,c){var u=Array.prototype.slice.call(arguments,1);return function(){var f=u.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function L(s,c){function u(){}u.prototype=c.prototype,s.aa=c.prototype,s.prototype=new u,s.prototype.constructor=s,s.Qb=function(f,I,D){for(var M=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)M[_e-2]=arguments[_e];return c.prototype[I].apply(f,M)}}function G(s){let c=s.length;if(0<c){let u=Array(c);for(let f=0;f<c;f++)u[f]=s[f];return u}return[]}function W(s,c){for(let u=1;u<arguments.length;u++){let f=arguments[u];if(h(f)){let I=s.length||0,D=f.length||0;s.length=I+D;for(let M=0;M<D;M++)s[I+M]=f[M]}else s.push(f)}}class Ae{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function le(s){return/^[\s\xa0]*$/.test(s)}function te(){var s=l.navigator;return s&&(s=s.userAgent)?s:""}function ve(s){return ve[" "](s),s}ve[" "]=function(){};var be=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function fe(s,c,u){for(let f in s)c.call(u,s[f],f,s)}function C(s,c){for(let u in s)c.call(void 0,s[u],u,s)}function m(s){let c={};for(let u in s)c[u]=s[u];return c}let g="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(s,c){let u,f;for(let I=1;I<arguments.length;I++){f=arguments[I];for(u in f)s[u]=f[u];for(let D=0;D<g.length;D++)u=g[D],Object.prototype.hasOwnProperty.call(f,u)&&(s[u]=f[u])}}function E(s){var c=1;s=s.split(":");let u=[];for(;0<c&&s.length;)u.push(s.shift()),c--;return s.length&&u.push(s.join(":")),u}function x(s){l.setTimeout(()=>{throw s},0)}function p(){var s=Uc;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class an{constructor(){this.h=this.g=null}add(c,u){let f=no.get();f.set(c,u),this.h?this.h.next=f:this.g=f,this.h=f}}var no=new Ae(()=>new $0,s=>s.reset());class $0{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let io,ro=!1,Uc=new an,_d=()=>{let s=l.Promise.resolve(void 0);io=()=>{s.then(G0)}};var G0=()=>{for(var s;s=p();){try{s.h.call(s.g)}catch(u){x(u)}var c=no;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}ro=!1};function bn(){this.s=this.s,this.C=this.C}bn.prototype.s=!1,bn.prototype.ma=function(){this.s||(this.s=!0,this.N())},bn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Qe(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Qe.prototype.h=function(){this.defaultPrevented=!0};var W0=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let u=()=>{};l.addEventListener("test",u,c),l.removeEventListener("test",u,c)}catch{}return s}();function oo(s,c){if(Qe.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var u=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(be){e:{try{ve(c.nodeName);var I=!0;break e}catch{}I=!1}I||(c=null)}}else u=="mouseover"?c=s.fromElement:u=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:K0[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&oo.aa.h.call(this)}}L(oo,Qe);var K0={2:"touch",3:"pen",4:"mouse"};oo.prototype.h=function(){oo.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var so="closure_listenable_"+(1e6*Math.random()|0),Q0=0;function J0(s,c,u,f,I){this.listener=s,this.proxy=null,this.src=c,this.type=u,this.capture=!!f,this.ha=I,this.key=++Q0,this.da=this.fa=!1}function ys(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function vs(s){this.src=s,this.g={},this.h=0}vs.prototype.add=function(s,c,u,f,I){var D=s.toString();s=this.g[D],s||(s=this.g[D]=[],this.h++);var M=jc(s,c,f,I);return-1<M?(c=s[M],u||(c.fa=!1)):(c=new J0(c,this.src,D,!!f,I),c.fa=u,s.push(c)),c};function qc(s,c){var u=c.type;if(u in s.g){var f=s.g[u],I=Array.prototype.indexOf.call(f,c,void 0),D;(D=0<=I)&&Array.prototype.splice.call(f,I,1),D&&(ys(c),s.g[u].length==0&&(delete s.g[u],s.h--))}}function jc(s,c,u,f){for(var I=0;I<s.length;++I){var D=s[I];if(!D.da&&D.listener==c&&D.capture==!!u&&D.ha==f)return I}return-1}var Hc="closure_lm_"+(1e6*Math.random()|0),$c={};function yd(s,c,u,f,I){if(f&&f.once)return wd(s,c,u,f,I);if(Array.isArray(c)){for(var D=0;D<c.length;D++)yd(s,c[D],u,f,I);return null}return u=Qc(u),s&&s[so]?s.K(c,u,d(f)?!!f.capture:!!f,I):vd(s,c,u,!1,f,I)}function vd(s,c,u,f,I,D){if(!c)throw Error("Invalid event type");var M=d(I)?!!I.capture:!!I,_e=Wc(s);if(_e||(s[Hc]=_e=new vs(s)),u=_e.add(c,u,f,M,D),u.proxy)return u;if(f=X0(),u.proxy=f,f.src=s,f.listener=u,s.addEventListener)W0||(I=M),I===void 0&&(I=!1),s.addEventListener(c.toString(),f,I);else if(s.attachEvent)s.attachEvent(Cd(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return u}function X0(){function s(u){return c.call(s.src,s.listener,u)}let c=Y0;return s}function wd(s,c,u,f,I){if(Array.isArray(c)){for(var D=0;D<c.length;D++)wd(s,c[D],u,f,I);return null}return u=Qc(u),s&&s[so]?s.L(c,u,d(f)?!!f.capture:!!f,I):vd(s,c,u,!0,f,I)}function Td(s,c,u,f,I){if(Array.isArray(c))for(var D=0;D<c.length;D++)Td(s,c[D],u,f,I);else f=d(f)?!!f.capture:!!f,u=Qc(u),s&&s[so]?(s=s.i,c=String(c).toString(),c in s.g&&(D=s.g[c],u=jc(D,u,f,I),-1<u&&(ys(D[u]),Array.prototype.splice.call(D,u,1),D.length==0&&(delete s.g[c],s.h--)))):s&&(s=Wc(s))&&(c=s.g[c.toString()],s=-1,c&&(s=jc(c,u,f,I)),(u=-1<s?c[s]:null)&&Gc(u))}function Gc(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[so])qc(c.i,s);else{var u=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(u,f,s.capture):c.detachEvent?c.detachEvent(Cd(u),f):c.addListener&&c.removeListener&&c.removeListener(f),(u=Wc(c))?(qc(u,s),u.h==0&&(u.src=null,c[Hc]=null)):ys(s)}}}function Cd(s){return s in $c?$c[s]:$c[s]="on"+s}function Y0(s,c){if(s.da)s=!0;else{c=new oo(c,this);var u=s.listener,f=s.ha||s.src;s.fa&&Gc(s),s=u.call(f,c)}return s}function Wc(s){return s=s[Hc],s instanceof vs?s:null}var Kc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qc(s){return typeof s=="function"?s:(s[Kc]||(s[Kc]=function(c){return s.handleEvent(c)}),s[Kc])}function Je(){bn.call(this),this.i=new vs(this),this.M=this,this.F=null}L(Je,bn),Je.prototype[so]=!0,Je.prototype.removeEventListener=function(s,c,u,f){Td(this,s,c,u,f)};function it(s,c){var u,f=s.F;if(f)for(u=[];f;f=f.F)u.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Qe(c,s);else if(c instanceof Qe)c.target=c.target||s;else{var I=c;c=new Qe(f,s),T(c,I)}if(I=!0,u)for(var D=u.length-1;0<=D;D--){var M=c.g=u[D];I=ws(M,f,!0,c)&&I}if(M=c.g=s,I=ws(M,f,!0,c)&&I,I=ws(M,f,!1,c)&&I,u)for(D=0;D<u.length;D++)M=c.g=u[D],I=ws(M,f,!1,c)&&I}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var u=s.g[c],f=0;f<u.length;f++)ys(u[f]);delete s.g[c],s.h--}}this.F=null},Je.prototype.K=function(s,c,u,f){return this.i.add(String(s),c,!1,u,f)},Je.prototype.L=function(s,c,u,f){return this.i.add(String(s),c,!0,u,f)};function ws(s,c,u,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var I=!0,D=0;D<c.length;++D){var M=c[D];if(M&&!M.da&&M.capture==u){var _e=M.listener,je=M.ha||M.src;M.fa&&qc(s.i,M),I=_e.call(je,f)!==!1&&I}}return I&&!f.defaultPrevented}function bd(s,c,u){if(typeof s=="function")u&&(s=P(s,u));else if(s&&typeof s.handleEvent=="function")s=P(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(s,c||0)}function Ed(s){s.g=bd(()=>{s.g=null,s.i&&(s.i=!1,Ed(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Z0 extends bn{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ed(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ao(s){bn.call(this),this.h=s,this.g={}}L(ao,bn);var Id=[];function Sd(s){fe(s.g,function(c,u){this.g.hasOwnProperty(u)&&Gc(c)},s),s.g={}}ao.prototype.N=function(){ao.aa.N.call(this),Sd(this)},ao.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jc=l.JSON.stringify,ey=l.JSON.parse,ty=class{stringify(s){return l.JSON.stringify(s,void 0)}parse(s){return l.JSON.parse(s,void 0)}};function Xc(){}Xc.prototype.h=null;function xd(s){return s.h||(s.h=s.i())}function Ad(){}var co={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Yc(){Qe.call(this,"d")}L(Yc,Qe);function Zc(){Qe.call(this,"c")}L(Zc,Qe);var $n={},Dd=null;function Ts(){return Dd=Dd||new Je}$n.La="serverreachability";function Nd(s){Qe.call(this,$n.La,s)}L(Nd,Qe);function lo(s){let c=Ts();it(c,new Nd(c))}$n.STAT_EVENT="statevent";function Rd(s,c){Qe.call(this,$n.STAT_EVENT,s),this.stat=c}L(Rd,Qe);function rt(s){let c=Ts();it(c,new Rd(c,s))}$n.Ma="timingevent";function Pd(s,c){Qe.call(this,$n.Ma,s),this.size=c}L(Pd,Qe);function uo(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){s()},c)}function ho(){this.g=!0}ho.prototype.xa=function(){this.g=!1};function ny(s,c,u,f,I,D){s.info(function(){if(s.g)if(D)for(var M="",_e=D.split("&"),je=0;je<_e.length;je++){var ue=_e[je].split("=");if(1<ue.length){var Xe=ue[0];ue=ue[1];var Ye=Xe.split("_");M=2<=Ye.length&&Ye[1]=="type"?M+(Xe+"="+ue+"&"):M+(Xe+"=redacted&")}}else M=null;else M=D;return"XMLHTTP REQ ("+f+") [attempt "+I+"]: "+c+`
`+u+`
`+M})}function iy(s,c,u,f,I,D,M){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+I+"]: "+c+`
`+u+`
`+D+" "+M})}function Pi(s,c,u,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+oy(s,u)+(f?" "+f:"")})}function ry(s,c){s.info(function(){return"TIMEOUT: "+c})}ho.prototype.info=function(){};function oy(s,c){if(!s.g)return c;if(!c)return null;try{var u=JSON.parse(c);if(u){for(s=0;s<u.length;s++)if(Array.isArray(u[s])){var f=u[s];if(!(2>f.length)){var I=f[1];if(Array.isArray(I)&&!(1>I.length)){var D=I[0];if(D!="noop"&&D!="stop"&&D!="close")for(var M=1;M<I.length;M++)I[M]=""}}}}return Jc(u)}catch{return c}}var Cs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Vd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},el;function bs(){}L(bs,Xc),bs.prototype.g=function(){return new XMLHttpRequest},bs.prototype.i=function(){return{}},el=new bs;function En(s,c,u,f){this.j=s,this.i=c,this.l=u,this.R=f||1,this.U=new ao(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zd}function zd(){this.i=null,this.g="",this.h=!1}var kd={},tl={};function nl(s,c,u){s.L=1,s.v=xs(cn(c)),s.m=u,s.P=!0,Md(s,null)}function Md(s,c){s.F=Date.now(),Es(s),s.A=cn(s.v);var u=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Jd(u.i,"t",f),s.C=0,u=s.j.J,s.h=new zd,s.g=pf(s.j,u?c:null,!s.m),0<s.O&&(s.M=new Z0(P(s.Y,s,s.g),s.O)),c=s.U,u=s.g,f=s.ca;var I="readystatechange";Array.isArray(I)||(I&&(Id[0]=I.toString()),I=Id);for(var D=0;D<I.length;D++){var M=yd(u,I[D],f||c.handleEvent,!1,c.h||c);if(!M)break;c.g[M.key]=M}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),lo(),ny(s.i,s.u,s.A,s.l,s.R,s.m)}En.prototype.ca=function(s){s=s.target;let c=this.M;c&&ln(s)==3?c.j():this.Y(s)},En.prototype.Y=function(s){try{if(s==this.g)e:{let Ye=ln(this.g);var c=this.g.Ba();let ki=this.g.Z();if(!(3>Ye)&&(Ye!=3||this.g&&(this.h.h||this.g.oa()||rf(this.g)))){this.J||Ye!=4||c==7||(c==8||0>=ki?lo(3):lo(2)),il(this);var u=this.g.Z();this.X=u;t:if(Od(this)){var f=rf(this.g);s="";var I=f.length,D=ln(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gn(this),fo(this);var M="";break t}this.h.i=new l.TextDecoder}for(c=0;c<I;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(D&&c==I-1)});f.length=0,this.h.g+=s,this.C=0,M=this.h.g}else M=this.g.oa();if(this.o=u==200,iy(this.i,this.u,this.A,this.l,this.R,Ye,u),this.o){if(this.T&&!this.K){t:{if(this.g){var _e,je=this.g;if((_e=je.g?je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!le(_e)){var ue=_e;break t}}ue=null}if(u=ue)Pi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rl(this,u);else{this.o=!1,this.s=3,rt(12),Gn(this),fo(this);break e}}if(this.P){u=!0;let Pt;for(;!this.J&&this.C<M.length;)if(Pt=sy(this,M),Pt==tl){Ye==4&&(this.s=4,rt(14),u=!1),Pi(this.i,this.l,null,"[Incomplete Response]");break}else if(Pt==kd){this.s=4,rt(15),Pi(this.i,this.l,M,"[Invalid Chunk]"),u=!1;break}else Pi(this.i,this.l,Pt,null),rl(this,Pt);if(Od(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ye!=4||M.length!=0||this.h.h||(this.s=1,rt(16),u=!1),this.o=this.o&&u,!u)Pi(this.i,this.l,M,"[Invalid Chunked Response]"),Gn(this),fo(this);else if(0<M.length&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.ba&&!Xe.M&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),ul(Xe),Xe.M=!0,rt(11))}}else Pi(this.i,this.l,M,null),rl(this,M);Ye==4&&Gn(this),this.o&&!this.J&&(Ye==4?hf(this.j,this):(this.o=!1,Es(this)))}else by(this.g),u==400&&0<M.indexOf("Unknown SID")?(this.s=3,rt(12)):(this.s=0,rt(13)),Gn(this),fo(this)}}}catch{}finally{}};function Od(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function sy(s,c){var u=s.C,f=c.indexOf(`
`,u);return f==-1?tl:(u=Number(c.substring(u,f)),isNaN(u)?kd:(f+=1,f+u>c.length?tl:(c=c.slice(f,f+u),s.C=f+u,c)))}En.prototype.cancel=function(){this.J=!0,Gn(this)};function Es(s){s.S=Date.now()+s.I,Fd(s,s.I)}function Fd(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=uo(P(s.ba,s),c)}function il(s){s.B&&(l.clearTimeout(s.B),s.B=null)}En.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(ry(this.i,this.A),this.L!=2&&(lo(),rt(17)),Gn(this),this.s=2,fo(this)):Fd(this,this.S-s)};function fo(s){s.j.G==0||s.J||hf(s.j,s)}function Gn(s){il(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,Sd(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function rl(s,c){try{var u=s.j;if(u.G!=0&&(u.g==s||ol(u.h,s))){if(!s.K&&ol(u.h,s)&&u.G==3){try{var f=u.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var I=f;if(I[0]==0){e:if(!u.u){if(u.g)if(u.g.F+3e3<s.F)Ps(u),Ns(u);else break e;ll(u),rt(18)}}else u.za=I[1],0<u.za-u.T&&37500>I[2]&&u.F&&u.v==0&&!u.C&&(u.C=uo(P(u.Za,u),6e3));if(1>=Ud(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else Kn(u,11)}else if((s.K||u.g==s)&&Ps(u),!le(c))for(I=u.Da.g.parse(c),c=0;c<I.length;c++){let ue=I[c];if(u.T=ue[0],ue=ue[1],u.G==2)if(ue[0]=="c"){u.K=ue[1],u.ia=ue[2];let Xe=ue[3];Xe!=null&&(u.la=Xe,u.j.info("VER="+u.la));let Ye=ue[4];Ye!=null&&(u.Aa=Ye,u.j.info("SVER="+u.Aa));let ki=ue[5];ki!=null&&typeof ki=="number"&&0<ki&&(f=1.5*ki,u.L=f,u.j.info("backChannelRequestTimeoutMs_="+f)),f=u;let Pt=s.g;if(Pt){let zs=Pt.g?Pt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zs){var D=f.h;D.g||zs.indexOf("spdy")==-1&&zs.indexOf("quic")==-1&&zs.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(sl(D,D.h),D.h=null))}if(f.D){let hl=Pt.g?Pt.g.getResponseHeader("X-HTTP-Session-Id"):null;hl&&(f.ya=hl,Ee(f.I,f.D,hl))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-s.F,u.j.info("Handshake RTT: "+u.R+"ms")),f=u;var M=s;if(f.qa=mf(f,f.J?f.ia:null,f.W),M.K){qd(f.h,M);var _e=M,je=f.L;je&&(_e.I=je),_e.B&&(il(_e),Es(_e)),f.g=M}else lf(f);0<u.i.length&&Rs(u)}else ue[0]!="stop"&&ue[0]!="close"||Kn(u,7);else u.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?Kn(u,7):cl(u):ue[0]!="noop"&&u.l&&u.l.ta(ue),u.v=0)}}lo(4)}catch{}}var ay=class{constructor(s,c){this.g=s,this.map=c}};function Ld(s){this.l=s||10,l.PerformanceNavigationTiming?(s=l.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bd(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Ud(s){return s.h?1:s.g?s.g.size:0}function ol(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function sl(s,c){s.g?s.g.add(c):s.h=c}function qd(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Ld.prototype.cancel=function(){if(this.i=jd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function jd(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let u of s.g.values())c=c.concat(u.D);return c}return G(s.i)}function cy(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],u=s.length,f=0;f<u;f++)c.push(s[f]);return c}c=[],u=0;for(f in s)c[u++]=s[f];return c}function ly(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var u=0;u<s;u++)c.push(u);return c}c=[],u=0;for(let f in s)c[u++]=f;return c}}}function Hd(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var u=ly(s),f=cy(s),I=f.length,D=0;D<I;D++)c.call(void 0,f[D],u&&u[D],s)}var $d=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uy(s,c){if(s){s=s.split("&");for(var u=0;u<s.length;u++){var f=s[u].indexOf("="),I=null;if(0<=f){var D=s[u].substring(0,f);I=s[u].substring(f+1)}else D=s[u];c(D,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function Wn(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Wn){this.h=s.h,Is(this,s.j),this.o=s.o,this.g=s.g,Ss(this,s.s),this.l=s.l;var c=s.i,u=new go;u.i=c.i,c.g&&(u.g=new Map(c.g),u.h=c.h),Gd(this,u),this.m=s.m}else s&&(c=String(s).match($d))?(this.h=!1,Is(this,c[1]||"",!0),this.o=mo(c[2]||""),this.g=mo(c[3]||"",!0),Ss(this,c[4]),this.l=mo(c[5]||"",!0),Gd(this,c[6]||"",!0),this.m=mo(c[7]||"")):(this.h=!1,this.i=new go(null,this.h))}Wn.prototype.toString=function(){var s=[],c=this.j;c&&s.push(po(c,Wd,!0),":");var u=this.g;return(u||c=="file")&&(s.push("//"),(c=this.o)&&s.push(po(c,Wd,!0),"@"),s.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&s.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&s.push("/"),s.push(po(u,u.charAt(0)=="/"?fy:dy,!0))),(u=this.i.toString())&&s.push("?",u),(u=this.m)&&s.push("#",po(u,py)),s.join("")};function cn(s){return new Wn(s)}function Is(s,c,u){s.j=u?mo(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Ss(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Gd(s,c,u){c instanceof go?(s.i=c,gy(s.i,s.h)):(u||(c=po(c,my)),s.i=new go(c,s.h))}function Ee(s,c,u){s.i.set(c,u)}function xs(s){return Ee(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function mo(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function po(s,c,u){return typeof s=="string"?(s=encodeURI(s).replace(c,hy),u&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function hy(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Wd=/[#\/\?@]/g,dy=/[#\?:]/g,fy=/[#\?]/g,my=/[#\?@]/g,py=/#/g;function go(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function In(s){s.g||(s.g=new Map,s.h=0,s.i&&uy(s.i,function(c,u){s.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}i=go.prototype,i.add=function(s,c){In(this),this.i=null,s=Vi(this,s);var u=this.g.get(s);return u||this.g.set(s,u=[]),u.push(c),this.h+=1,this};function Kd(s,c){In(s),c=Vi(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Qd(s,c){return In(s),c=Vi(s,c),s.g.has(c)}i.forEach=function(s,c){In(this),this.g.forEach(function(u,f){u.forEach(function(I){s.call(c,I,f,this)},this)},this)},i.na=function(){In(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),u=[];for(let f=0;f<c.length;f++){let I=s[f];for(let D=0;D<I.length;D++)u.push(c[f])}return u},i.V=function(s){In(this);let c=[];if(typeof s=="string")Qd(this,s)&&(c=c.concat(this.g.get(Vi(this,s))));else{s=Array.from(this.g.values());for(let u=0;u<s.length;u++)c=c.concat(s[u])}return c},i.set=function(s,c){return In(this),this.i=null,s=Vi(this,s),Qd(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},i.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Jd(s,c,u){Kd(s,c),0<u.length&&(s.i=null,s.g.set(Vi(s,c),G(u)),s.h+=u.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var u=0;u<c.length;u++){var f=c[u];let D=encodeURIComponent(String(f)),M=this.V(f);for(f=0;f<M.length;f++){var I=D;M[f]!==""&&(I+="="+encodeURIComponent(String(M[f]))),s.push(I)}}return this.i=s.join("&")};function Vi(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function gy(s,c){c&&!s.j&&(In(s),s.i=null,s.g.forEach(function(u,f){var I=f.toLowerCase();f!=I&&(Kd(this,f),Jd(this,I,u))},s)),s.j=c}function _y(s,c){let u=new ho;if(l.Image){let f=new Image;f.onload=F(Sn,u,"TestLoadImage: loaded",!0,c,f),f.onerror=F(Sn,u,"TestLoadImage: error",!1,c,f),f.onabort=F(Sn,u,"TestLoadImage: abort",!1,c,f),f.ontimeout=F(Sn,u,"TestLoadImage: timeout",!1,c,f),l.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function yy(s,c){let u=new ho,f=new AbortController,I=setTimeout(()=>{f.abort(),Sn(u,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(D=>{clearTimeout(I),D.ok?Sn(u,"TestPingServer: ok",!0,c):Sn(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(I),Sn(u,"TestPingServer: error",!1,c)})}function Sn(s,c,u,f,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),f(u)}catch{}}function vy(){this.g=new ty}function wy(s,c,u){let f=u||"";try{Hd(s,function(I,D){let M=I;d(I)&&(M=Jc(I)),c.push(f+D+"="+encodeURIComponent(M))})}catch(I){throw c.push(f+"type="+encodeURIComponent("_badmap")),I}}function _o(s){this.l=s.Ub||null,this.j=s.eb||!1}L(_o,Xc),_o.prototype.g=function(){return new As(this.l,this.j)},_o.prototype.i=function(s){return function(){return s}}({});function As(s,c){Je.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(As,Je),i=As.prototype,i.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,vo(this)},i.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yo(this)),this.readyState=0},i.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,vo(this)),this.g&&(this.readyState=3,vo(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xd(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xd(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}i.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?yo(this):vo(this),this.readyState==3&&Xd(this)}},i.Ra=function(s){this.g&&(this.response=this.responseText=s,yo(this))},i.Qa=function(s){this.g&&(this.response=s,yo(this))},i.ga=function(){this.g&&yo(this)};function yo(s){s.readyState=4,s.l=null,s.j=null,s.v=null,vo(s)}i.setRequestHeader=function(s,c){this.u.append(s,c)},i.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,s.push(u[0]+": "+u[1]),u=c.next();return s.join(`\r
`)};function vo(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(As.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Yd(s){let c="";return fe(s,function(u,f){c+=f,c+=":",c+=u,c+=`\r
`}),c}function al(s,c,u){e:{for(f in u){var f=!1;break e}f=!0}f||(u=Yd(u),typeof s=="string"?u!=null&&encodeURIComponent(String(u)):Ee(s,c,u))}function De(s){Je.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(De,Je);var Ty=/^https?$/i,Cy=["POST","PUT"];i=De.prototype,i.Ha=function(s){this.J=s},i.ea=function(s,c,u,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():el.g(),this.v=this.o?xd(this.o):xd(el),this.g.onreadystatechange=P(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(D){Zd(this,D);return}if(s=u||"",u=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var I in f)u.set(I,f[I]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let D of f.keys())u.set(D,f.get(D));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(u.keys()).find(D=>D.toLowerCase()=="content-type"),I=l.FormData&&s instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Cy,c,void 0))||f||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[D,M]of u)this.g.setRequestHeader(D,M);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nf(this),this.u=!0,this.g.send(s),this.u=!1}catch(D){Zd(this,D)}};function Zd(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,ef(s),Ds(s)}function ef(s){s.A||(s.A=!0,it(s,"complete"),it(s,"error"))}i.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,it(this,"complete"),it(this,"abort"),Ds(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ds(this,!0)),De.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?tf(this):this.bb())},i.bb=function(){tf(this)};function tf(s){if(s.h&&typeof a<"u"&&(!s.v[1]||ln(s)!=4||s.Z()!=2)){if(s.u&&ln(s)==4)bd(s.Ea,0,s);else if(it(s,"readystatechange"),ln(s)==4){s.h=!1;try{let M=s.Z();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var f;if(f=M===0){var I=String(s.D).match($d)[1]||null;!I&&l.self&&l.self.location&&(I=l.self.location.protocol.slice(0,-1)),f=!Ty.test(I?I.toLowerCase():"")}u=f}if(u)it(s,"complete"),it(s,"success");else{s.m=6;try{var D=2<ln(s)?s.g.statusText:""}catch{D=""}s.l=D+" ["+s.Z()+"]",ef(s)}}finally{Ds(s)}}}}function Ds(s,c){if(s.g){nf(s);let u=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||it(s,"ready");try{u.onreadystatechange=f}catch{}}}function nf(s){s.I&&(l.clearTimeout(s.I),s.I=null)}i.isActive=function(){return!!this.g};function ln(s){return s.g?s.g.readyState:0}i.Z=function(){try{return 2<ln(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),ey(c)}};function rf(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function by(s){let c={};s=(s.g&&2<=ln(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(le(s[f]))continue;var u=E(s[f]);let I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let D=c[I]||[];c[I]=D,D.push(u)}C(c,function(f){return f.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wo(s,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[s]||c}function of(s){this.Aa=0,this.i=[],this.j=new ho,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wo("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wo("baseRetryDelayMs",5e3,s),this.cb=wo("retryDelaySeedMs",1e4,s),this.Wa=wo("forwardChannelMaxRetries",2,s),this.wa=wo("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Ld(s&&s.concurrentRequestLimit),this.Da=new vy,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=of.prototype,i.la=8,i.G=1,i.connect=function(s,c,u,f){rt(0),this.W=s,this.H=c||{},u&&f!==void 0&&(this.H.OSID=u,this.H.OAID=f),this.F=this.X,this.I=mf(this,null,this.W),Rs(this)};function cl(s){if(sf(s),s.G==3){var c=s.U++,u=cn(s.I);if(Ee(u,"SID",s.K),Ee(u,"RID",c),Ee(u,"TYPE","terminate"),To(s,u),c=new En(s,s.j,c),c.L=2,c.v=xs(cn(u)),u=!1,l.navigator&&l.navigator.sendBeacon)try{u=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!u&&l.Image&&(new Image().src=c.v,u=!0),u||(c.g=pf(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Es(c)}ff(s)}function Ns(s){s.g&&(ul(s),s.g.cancel(),s.g=null)}function sf(s){Ns(s),s.u&&(l.clearTimeout(s.u),s.u=null),Ps(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&l.clearTimeout(s.s),s.s=null)}function Rs(s){if(!Bd(s.h)&&!s.s){s.s=!0;var c=s.Ga;io||_d(),ro||(io(),ro=!0),Uc.add(c,s),s.B=0}}function Ey(s,c){return Ud(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=uo(P(s.Ga,s,c),df(s,s.B)),s.B++,!0)}i.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let I=new En(this,this.j,s),D=this.o;if(this.S&&(D?(D=m(D),T(D,this.S)):D=this.S),this.m!==null||this.O||(I.H=D,D=null),this.P)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var f=this.i[u];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=cf(this,I,c),u=cn(this.I),Ee(u,"RID",s),Ee(u,"CVER",22),this.D&&Ee(u,"X-HTTP-Session-Id",this.D),To(this,u),D&&(this.O?c="headers="+encodeURIComponent(String(Yd(D)))+"&"+c:this.m&&al(u,this.m,D)),sl(this.h,I),this.Ua&&Ee(u,"TYPE","init"),this.P?(Ee(u,"$req",c),Ee(u,"SID","null"),I.T=!0,nl(I,u,null)):nl(I,u,c),this.G=2}}else this.G==3&&(s?af(this,s):this.i.length==0||Bd(this.h)||af(this))};function af(s,c){var u;c?u=c.l:u=s.U++;let f=cn(s.I);Ee(f,"SID",s.K),Ee(f,"RID",u),Ee(f,"AID",s.T),To(s,f),s.m&&s.o&&al(f,s.m,s.o),u=new En(s,s.j,u,s.B+1),s.m===null&&(u.H=s.o),c&&(s.i=c.D.concat(s.i)),c=cf(s,u,1e3),u.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),sl(s.h,u),nl(u,f,c)}function To(s,c){s.H&&fe(s.H,function(u,f){Ee(c,f,u)}),s.l&&Hd({},function(u,f){Ee(c,f,u)})}function cf(s,c,u){u=Math.min(s.i.length,u);var f=s.l?P(s.l.Na,s.l,s):null;e:{var I=s.i;let D=-1;for(;;){let M=["count="+u];D==-1?0<u?(D=I[0].g,M.push("ofs="+D)):D=0:M.push("ofs="+D);let _e=!0;for(let je=0;je<u;je++){let ue=I[je].g,Xe=I[je].map;if(ue-=D,0>ue)D=Math.max(0,I[je].g-100),_e=!1;else try{wy(Xe,M,"req"+ue+"_")}catch{f&&f(Xe)}}if(_e){f=M.join("&");break e}}}return s=s.i.splice(0,u),c.D=s,f}function lf(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;io||_d(),ro||(io(),ro=!0),Uc.add(c,s),s.v=0}}function ll(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=uo(P(s.Fa,s),df(s,s.v)),s.v++,!0)}i.Fa=function(){if(this.u=null,uf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=uo(P(this.ab,this),s)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rt(10),Ns(this),uf(this))};function ul(s){s.A!=null&&(l.clearTimeout(s.A),s.A=null)}function uf(s){s.g=new En(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=cn(s.qa);Ee(c,"RID","rpc"),Ee(c,"SID",s.K),Ee(c,"AID",s.T),Ee(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&Ee(c,"TO",s.ja),Ee(c,"TYPE","xmlhttp"),To(s,c),s.m&&s.o&&al(c,s.m,s.o),s.L&&(s.g.I=s.L);var u=s.g;s=s.ia,u.L=1,u.v=xs(cn(c)),u.m=null,u.P=!0,Md(u,s)}i.Za=function(){this.C!=null&&(this.C=null,Ns(this),ll(this),rt(19))};function Ps(s){s.C!=null&&(l.clearTimeout(s.C),s.C=null)}function hf(s,c){var u=null;if(s.g==c){Ps(s),ul(s),s.g=null;var f=2}else if(ol(s.h,c))u=c.D,qd(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){u=c.m?c.m.length:0,c=Date.now()-c.F;var I=s.B;f=Ts(),it(f,new Pd(f,u)),Rs(s)}else lf(s);else if(I=c.s,I==3||I==0&&0<c.X||!(f==1&&Ey(s,c)||f==2&&ll(s)))switch(u&&0<u.length&&(c=s.h,c.i=c.i.concat(u)),I){case 1:Kn(s,5);break;case 4:Kn(s,10);break;case 3:Kn(s,6);break;default:Kn(s,2)}}}function df(s,c){let u=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(u*=2),u*c}function Kn(s,c){if(s.j.info("Error code "+c),c==2){var u=P(s.fb,s),f=s.Xa;let I=!f;f=new Wn(f||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Is(f,"https"),xs(f),I?_y(f.toString(),u):yy(f.toString(),u)}else rt(2);s.G=0,s.l&&s.l.sa(c),ff(s),sf(s)}i.fb=function(s){s?(this.j.info("Successfully pinged google.com"),rt(2)):(this.j.info("Failed to ping google.com"),rt(1))};function ff(s){if(s.G=0,s.ka=[],s.l){let c=jd(s.h);(c.length!=0||s.i.length!=0)&&(W(s.ka,c),W(s.ka,s.i),s.h.i.length=0,G(s.i),s.i.length=0),s.l.ra()}}function mf(s,c,u){var f=u instanceof Wn?cn(u):new Wn(u);if(f.g!="")c&&(f.g=c+"."+f.g),Ss(f,f.s);else{var I=l.location;f=I.protocol,c=c?c+"."+I.hostname:I.hostname,I=+I.port;var D=new Wn(null);f&&Is(D,f),c&&(D.g=c),I&&Ss(D,I),u&&(D.l=u),f=D}return u=s.D,c=s.ya,u&&c&&Ee(f,u,c),Ee(f,"VER",s.la),To(s,f),f}function pf(s,c,u){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new De(new _o({eb:u})):new De(s.pa),c.Ha(s.J),c}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function gf(){}i=gf.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Vs(){}Vs.prototype.g=function(s,c){return new ht(s,c)};function ht(s,c){Je.call(this),this.g=new of(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!le(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!le(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new zi(this)}L(ht,Je),ht.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ht.prototype.close=function(){cl(this.g)},ht.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var u={};u.__data__=s,s=u}else this.u&&(u={},u.__data__=Jc(s),s=u);c.i.push(new ay(c.Ya++,s)),c.G==3&&Rs(c)},ht.prototype.N=function(){this.g.l=null,delete this.j,cl(this.g),delete this.g,ht.aa.N.call(this)};function _f(s){Yc.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let u in c){s=u;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}L(_f,Yc);function yf(){Zc.call(this),this.status=1}L(yf,Zc);function zi(s){this.g=s}L(zi,gf),zi.prototype.ua=function(){it(this.g,"a")},zi.prototype.ta=function(s){it(this.g,new _f(s))},zi.prototype.sa=function(s){it(this.g,new yf)},zi.prototype.ra=function(){it(this.g,"b")},Vs.prototype.createWebChannel=Vs.prototype.g,ht.prototype.send=ht.prototype.o,ht.prototype.open=ht.prototype.m,ht.prototype.close=ht.prototype.close,du=yn.createWebChannelTransport=function(){return new Vs},hu=yn.getStatEventTarget=function(){return Ts()},uu=yn.Event=$n,Pa=yn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cs.NO_ERROR=0,Cs.TIMEOUT=8,Cs.HTTP_ERROR=6,Oo=yn.ErrorCode=Cs,Vd.COMPLETE="complete",lu=yn.EventType=Vd,Ad.EventType=co,co.OPEN="a",co.CLOSE="b",co.ERROR="c",co.MESSAGE="d",Je.prototype.listen=Je.prototype.K,br=yn.WebChannel=Ad,jC=yn.FetchXmlHttpFactory=_o,De.prototype.listenOnce=De.prototype.L,De.prototype.getLastError=De.prototype.Ka,De.prototype.getLastErrorCode=De.prototype.Ba,De.prototype.getStatus=De.prototype.Z,De.prototype.getResponseJson=De.prototype.Oa,De.prototype.getResponseText=De.prototype.oa,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Ha,cu=yn.XhrIo=De}).apply(typeof Ra<"u"?Ra:typeof self<"u"?self:typeof window<"u"?window:{});var Sg="@firebase/firestore",xg="4.9.0";var Ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ge.UNAUTHENTICATED=new Ge(null),Ge.GOOGLE_CREDENTIALS=new Ge("google-credentials-uid"),Ge.FIRST_PARTY=new Ge("first-party-uid"),Ge.MOCK_USER=new Ge("mock-user");var to="12.0.0";var bi=new Tr("@firebase/firestore");function Nr(){return bi.logLevel}function O(i,...e){if(bi.logLevel<=ae.DEBUG){let t=e.map(id);bi.debug(`Firestore (${to}): ${i}`,...t)}}function vt(i,...e){if(bi.logLevel<=ae.ERROR){let t=e.map(id);bi.error(`Firestore (${to}): ${i}`,...t)}}function nd(i,...e){if(bi.logLevel<=ae.WARN){let t=e.map(id);bi.warn(`Firestore (${to}): ${i}`,...t)}}function id(i){if(typeof i=="string")return i;try{return function(t){return JSON.stringify(t)}(i)}catch{return i}}function K(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,N_(i,n,t)}function N_(i,e,t){let n=`FIRESTORE (${to}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw vt(n),new Error(n)}function Z(i,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,i||N_(e,r,n)}function Ie(i,e){return i}var z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},H=class extends gn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Tn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var wu=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Tu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ge.UNAUTHENTICATED))}shutdown(){}};var Cu=class{constructor(e){this.t=e,this.currentUser=Ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Z(this.o===void 0,42304);let n=this.i,r=h=>this.i!==n?(n=this.i,t(h)):Promise.resolve(),o=new Tn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Tn,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>B(this,null,function*(){yield h.promise,yield r(this.currentUser)}))},l=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Tn)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Z(typeof n.accessToken=="string",31837,{l:n}),new wu(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string",2055,{h:e}),new Ge(e)}},bu=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ge.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Eu=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new bu(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},$a=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Iu=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vg(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Z(this.o===void 0,3512);let n=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};let r=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?r(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new $a(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $a(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function HC(i){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}var Ga=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),n="";for(;n.length<20;){let r=HC(40);for(let o=0;o<r.length;++o)n.length<20&&r[o]<t&&(n+=e.charAt(r[o]%62))}return n}};function re(i,e){return i<e?-1:i>e?1:0}function Su(i,e){let t=Math.min(i.length,e.length);for(let n=0;n<t;n++){let r=i.charAt(n),o=e.charAt(n);if(r!==o)return fu(r)===fu(o)?re(r,o):fu(r)?1:-1}return re(i.length,e.length)}var $C=55296,GC=57343;function fu(i){let e=i.charCodeAt(0);return e>=$C&&e<=GC}function Lr(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}function R_(i){return i+"\0"}var Ag="__name__",Wa=class i{constructor(e,t,n){t===void 0?t=0:t>e.length&&K(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&K(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return i.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof i?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let o=i.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return re(e.length,t.length)}static compareSegments(e,t){let n=i.isNumericId(e),r=i.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?i.extractNumericId(e).compare(i.extractNumericId(t)):Su(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Na.fromString(e.substring(4,e.length-2))}},Re=class i extends Wa{construct(e,t,n){return new i(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new H(z.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new i(t)}static emptyPath(){return new i([])}},WC=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ke=class i extends Wa{construct(e,t,n){return new i(e,t,n)}static isValidIdentifier(e){return WC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),i.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ag}static keyField(){return new i([Ag])}static fromServerFormat(e){let t=[],n="",r=0,o=()=>{if(n.length===0)throw new H(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},a=!1;for(;r<e.length;){let l=e[r];if(l==="\\"){if(r+1===e.length)throw new H(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new H(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,r+=2}else l==="`"?(a=!a,r++):l!=="."||a?(n+=l,r++):(o(),r++)}if(o(),a)throw new H(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new i(t)}static emptyPath(){return new i([])}};var $=class i{constructor(e){this.path=e}static fromPath(e){return new i(Re.fromString(e))}static fromName(e){return new i(Re.fromString(e).popFirst(5))}static empty(){return new i(Re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new i(new Re(e.slice()))}};function KC(i,e,t,n){if(e===!0&&n===!0)throw new H(z.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function QC(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function JC(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":K(12329,{type:typeof i})}function XC(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new H(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=JC(i);throw new H(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function ke(i,e){let t={typeString:i};return e&&(t.value=e),t}function ps(i,e){if(!QC(i))throw new H(z.INVALID_ARGUMENT,"JSON must be an object");let t;for(let n in e)if(e[n]){let r=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}let a=i[n];if(r&&typeof a!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${n}' field to equal '${o.value}'`;break}}if(t)throw new H(z.INVALID_ARGUMENT,t);return!0}var Dg=-62135596800,Ng=1e6,qe=class i{static now(){return i.fromMillis(Date.now())}static fromDate(e){return i.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Ng);return new i(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new H(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new H(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Dg)throw new H(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ng}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:i._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ps(e,i._jsonSchema))return new i(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Dg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:ke("string",qe._jsonSchemaVersion),seconds:ke("number"),nanoseconds:ke("number")};var he=class i{static fromTimestamp(e){return new i(e)}static min(){return new i(new qe(0,0))}static max(){return new i(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ts=-1,Br=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};function xu(i){return i.fields.find(e=>e.kind===2)}function hi(i){return i.fields.filter(e=>e.kind!==2)}Br.UNKNOWN_ID=-1;var Mr=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var ns=class i{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new i(0,Rt.min())}};function YC(i,e){let t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=he.fromTimestamp(n===1e9?new qe(t+1,0):new qe(t,n));return new Rt(r,$.empty(),e)}function P_(i){return new Rt(i.readTime,i.key,ts)}var Rt=class i{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new i(he.min(),$.empty(),ts)}static max(){return new i(he.max(),$.empty(),ts)}};function rd(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(i.documentKey,e.documentKey),t!==0?t:re(i.largestBatchId,e.largestBatchId))}var V_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ka=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Nc(i){return B(this,null,function*(){if(i.code!==z.FAILED_PRECONDITION||i.message!==V_)throw i;O("LocalStore","Unexpectedly lost primary lease")})}var A=class i{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new i((n,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof i?t:i.resolve(t)}catch(t){return i.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):i.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):i.reject(t)}static resolve(e){return new i((t,n)=>{t(e)})}static reject(e){return new i((t,n)=>{n(e)})}static waitFor(e){return new i((t,n)=>{let r=0,o=0,a=!1;e.forEach(l=>{++r,l.next(()=>{++o,a&&o===r&&t()},h=>n(h))}),a=!0,o===r&&t()})}static or(e){let t=i.resolve(!1);for(let n of e)t=t.next(r=>r?i.resolve(r):n());return t}static forEach(e,t){let n=[];return e.forEach((r,o)=>{n.push(t.call(this,r,o))}),this.waitFor(n)}static mapArray(e,t){return new i((n,r)=>{let o=e.length,a=new Array(o),l=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(_=>{a[d]=_,++l,l===o&&n(a)},_=>r(_))}})}static doWhile(e,t){return new i((n,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):n()};o()})}};var yt="SimpleDb",Qa=class i{static open(e,t,n,r){try{return new i(t,e.transaction(r,n))}catch(o){throw new vi(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Tn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vi(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{let r=od(n.target.error);this.S.reject(new vi(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(O(yt,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Du(t)}},Ur=class i{static delete(e){return O(yt,"Removing database:",e),fi(Zl().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Da())return!1;if(i.F())return!0;let e=zo(),t=i.M(e),n=0<t&&t<10,r=z_(e),o=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,i.M(zo())===12.2&&vt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}L(e){return B(this,null,function*(){return this.db||(O(yt,"Opening database:",this.name),this.db=yield new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=o=>{let a=o.target.result;t(a)},r.onblocked=()=>{n(new vi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=o=>{let a=o.target.error;a.name==="VersionError"?n(new H(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?n(new H(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):n(new vi(e,a))},r.onupgradeneeded=o=>{O(yt,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let a=o.target.result;this.N.k(a,r.transaction,o.oldVersion,this.version).next(()=>{O(yt,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db})}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){return B(this,null,function*(){let o=t==="readonly",a=0;for(;;){++a;try{this.db=yield this.L(e);let l=Qa.open(this.db,e,o?"readonly":"readwrite",n),h=r(l).next(d=>(l.C(),d)).catch(d=>(l.abort(d),A.reject(d))).toPromise();return h.catch(()=>{}),yield l.D,h}catch(l){let h=l,d=h.name!=="FirebaseError"&&a<3;if(O(yt,"Transaction failed with error:",h.message,"Retrying:",d),this.close(),!d)return Promise.reject(h)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function z_(i){let e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Au=class{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return fi(this.U.delete())}},vi=class extends H{constructor(e,t){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ni(i){return i.name==="IndexedDbTransactionError"}var Du=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(O(yt,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(O(yt,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),fi(n)}add(e){return O(yt,"ADD",this.store.name,e,e),fi(this.store.add(e))}get(e){return fi(this.store.get(e)).next(t=>(t===void 0&&(t=null),O(yt,"GET",this.store.name,e,t),t))}delete(e){return O(yt,"DELETE",this.store.name,e),fi(this.store.delete(e))}count(){return O(yt,"COUNT",this.store.name),fi(this.store.count())}J(e,t){let n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if(typeof r.getAll=="function"){let o=r.getAll(n.range);return new A((a,l)=>{o.onerror=h=>{l(h.target.error)},o.onsuccess=h=>{a(h.target.result)}})}{let o=this.cursor(n),a=[];return this.H(o,(l,h)=>{a.push(h)}).next(()=>a)}}Y(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new A((r,o)=>{n.onerror=a=>{o(a.target.error)},n.onsuccess=a=>{r(a.target.result)}})}Z(e,t){O(yt,"DELETE ALL",this.store.name);let n=this.options(e,t);n.X=!1;let r=this.cursor(n);return this.H(r,(o,a,l)=>l.delete())}ee(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.H(r,t)}te(e){let t=this.cursor({});return new A((n,r)=>{t.onerror=o=>{let a=od(o.target.error);r(a)},t.onsuccess=o=>{let a=o.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():n()}):n()}})}H(e,t){let n=[];return new A((r,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{let l=a.target.result;if(!l)return void r();let h=new Au(l),d=t(l.primaryKey,l.value,h);if(d instanceof A){let _=d.catch(w=>(h.done(),A.reject(w)));n.push(_)}h.isDone?r():h.G===null?l.continue():l.continue(h.G)}}).next(()=>A.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function fi(i){return new A((e,t)=>{i.onsuccess=n=>{let r=n.target.result;e(r)},i.onerror=n=>{let r=od(n.target.error);t(r)}})}var Rg=!1;function od(i){let e=Ur.M(zo());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){let n=new H("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Rg||(Rg=!0,setTimeout(()=>{throw n},0)),n}}return i}var Ho="IndexBackfiller",Nu=class{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){O(Ho,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>B(this,null,function*(){this.task=null;try{let t=yield this.ne.ie();O(Ho,`Documents written: ${t}`)}catch(t){Ni(t)?O(Ho,"Ignoring IndexedDB error during index backfill: ",t):yield Nc(t)}yield this.re(6e4)}))}},Ru=class{constructor(e,t){this.localStore=e,this.persistence=t}ie(e=50){return B(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))})}se(e,t){let n=new Set,r=t,o=!0;return A.doWhile(()=>o===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!n.has(a))return O(Ho,`Processing collection: ${a}`),this.oe(e,a,r).next(l=>{r-=l,n.add(a)});o=!1})).next(()=>t-r)}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(o=>{let a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this._e(r,o)).next(l=>(O(Ho,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}_e(e,t){let n=e;return t.changes.forEach((r,o)=>{let a=P_(o);rd(a,n)>0&&(n=a)}),new Rt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var en=(()=>{class i{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}i.ce=-1;return i})(),wi=-1;function Rc(i){return i==null}function Ja(i){return i===0&&1/i==-1/0}var Xa="";function st(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=Pg(e)),e=ZC(i.get(t),e);return Pg(e)}function ZC(i,e){let t=e,n=i.length;for(let r=0;r<n;r++){let o=i.charAt(r);switch(o){case"\0":t+="";break;case Xa:t+="";break;default:t+=o}}return t}function Pg(i){return i+Xa+""}function tn(i){let e=i.length;if(Z(e>=2,64408,{path:i}),e===2)return Z(i.charAt(0)===Xa&&i.charAt(1)==="",56145,{path:i}),Re.emptyPath();let t=e-2,n=[],r="";for(let o=0;o<e;){let a=i.indexOf(Xa,o);switch((a<0||a>t)&&K(50515,{path:i}),i.charAt(a+1)){case"":let l=i.substring(o,a),h;r.length===0?h=l:(r+=l,h=r,r=""),n.push(h);break;case"":r+=i.substring(o,a),r+="\0";break;case"":r+=i.substring(o,a+1);break;default:K(61167,{path:i})}o=a+2}return new Re(n)}var di="remoteDocuments",gs="owner",Er="owner",is="mutationQueues",eb="userId",Ut="mutations",Vg="batchId",_i="userMutationsIndex",zg=["userId","batchId"];function Fa(i,e){return[i,st(e)]}function k_(i,e,t){return[i,st(e),t]}var tb={},qr="documentMutations",Ya="remoteDocumentsV14",nb=["prefixPath","collectionGroup","readTime","documentId"],La="documentKeyIndex",ib=["prefixPath","collectionGroup","documentId"],M_="collectionGroupIndex",rb=["collectionGroup","readTime","prefixPath","documentId"],rs="remoteDocumentGlobal",Pu="remoteDocumentGlobalKey",jr="targets",O_="queryTargetsIndex",ob=["canonicalId","targetId"],Hr="targetDocuments",sb=["targetId","path"],sd="documentTargetsIndex",ab=["path","targetId"],Za="targetGlobalKey",Ti="targetGlobal",os="collectionParents",cb=["collectionId","parent"],$r="clientMetadata",lb="clientId",Pc="bundles",ub="bundleId",Vc="namedQueries",hb="name",ad="indexConfiguration",db="indexId",Vu="collectionGroupIndex",fb="collectionGroup",$o="indexState",mb=["indexId","uid"],F_="sequenceNumberIndex",pb=["uid","sequenceNumber"],Go="indexEntries",gb=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],L_="documentKeyIndex",_b=["indexId","uid","orderedDocumentKey"],zc="documentOverlays",yb=["userId","collectionPath","documentId"],zu="collectionPathOverlayIndex",vb=["userId","collectionPath","largestBatchId"],B_="collectionGroupOverlayIndex",wb=["userId","collectionGroup","largestBatchId"],cd="globals",Tb="name",U_=[is,Ut,qr,di,jr,gs,Ti,Hr,$r,rs,os,Pc,Vc],Cb=[...U_,zc],q_=[is,Ut,qr,Ya,jr,gs,Ti,Hr,$r,rs,os,Pc,Vc,zc],j_=q_,ld=[...j_,ad,$o,Go],bb=ld,H_=[...ld,cd],Eb=H_;var ss=class extends Ka{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}};function Oe(i,e){let t=Ie(i);return Ur.O(t.le,e)}function kg(i){let e=0;for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function ud(i,e){for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function Ib(i){for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}var wt=class i{constructor(e,t){this.comparator=e,this.root=t||rn.EMPTY}insert(e,t){return new i(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new i(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zr(this.root,e,this.comparator,!1)}getReverseIterator(){return new zr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zr(this.root,e,this.comparator,!0)}},zr=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},rn=class i{constructor(e,t,n,r,o){this.key=e,this.value=t,this.color=n??i.RED,this.left=r??i.EMPTY,this.right=o??i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,o){return new i(e??this.key,t??this.value,n??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,o=n(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,n),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw K(43730,{key:this.key,value:this.value});if(this.right.isRed())throw K(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw K(27949);return e+(this.isRed()?0:1)}};rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw K(57766)}get value(){throw K(16141)}get color(){throw K(16727)}get left(){throw K(29726)}get right(){throw K(36894)}copy(e,t,n,r,o){return this}insert(e,t,n){return new rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class i{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ec(this.data.getIterator())}getIteratorFrom(e){return new ec(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof i)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=n.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new i(this.comparator);return t.data=e,t}},ec=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ir(i){return i.hasNext()?i.getNext():void 0}var Mn=class i{constructor(e){this.fields=e,e.sort(Ke.comparator)}static empty(){return new i([])}unionWith(e){let t=new Ce(Ke.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new i(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lr(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var ku=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Tt=class i{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ku("Invalid base64 string: "+o):o}}(e);return new i(t)}static fromUint8Array(e){let t=function(r){let o="";for(let a=0;a<r.length;++a)o+=String.fromCharCode(r[a]);return o}(e);return new i(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Tt.EMPTY_BYTE_STRING=new Tt("");var Sb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fn(i){if(Z(!!i,39018),typeof i=="string"){let e=0,t=Sb.exec(i);if(Z(!!t,46558,{timestamp:i}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ze(i.seconds),nanos:ze(i.nanos)}}function ze(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Gr(i){return typeof i=="string"?Tt.fromBase64String(i):Tt.fromUint8Array(i)}var $_="server_timestamp",G_="__type__",W_="__previous_value__",K_="__local_write_time__";function hd(i){return(i?.mapValue?.fields||{})[G_]?.stringValue===$_}function Q_(i){let e=i.mapValue.fields[W_];return hd(e)?Q_(e):e}function tc(i){let e=Fn(i.mapValue.fields[K_].timestampValue);return new qe(e.seconds,e.nanos)}var Mu=class{constructor(e,t,n,r,o,a,l,h,d,_){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=_}},Ou="(default)",as=class i{constructor(e,t){this.projectId=e,this.database=t||Ou}static empty(){return new i("","")}get isDefaultDatabase(){return this.database===Ou}isEqual(e){return e instanceof i&&e.projectId===this.projectId&&e.database===this.database}};var J_="__type__",X_="__max__",On={mapValue:{fields:{__type__:{stringValue:X_}}}},Y_="__vector__",nc="value",Ba={nullValue:"NULL_VALUE"};function Wr(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?hd(i)?4:Z_(i)?9007199254740991:kc(i)?10:11:K(28295,{value:i})}function on(i,e){if(i===e)return!0;let t=Wr(i);if(t!==Wr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return tc(i).isEqual(tc(e));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let a=Fn(r.timestampValue),l=Fn(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(r,o){return Gr(r.bytesValue).isEqual(Gr(o.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(r,o){return ze(r.geoPointValue.latitude)===ze(o.geoPointValue.latitude)&&ze(r.geoPointValue.longitude)===ze(o.geoPointValue.longitude)}(i,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return ze(r.integerValue)===ze(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let a=ze(r.doubleValue),l=ze(o.doubleValue);return a===l?Ja(a)===Ja(l):isNaN(a)&&isNaN(l)}return!1}(i,e);case 9:return Lr(i.arrayValue.values||[],e.arrayValue.values||[],on);case 10:case 11:return function(r,o){let a=r.mapValue.fields||{},l=o.mapValue.fields||{};if(kg(a)!==kg(l))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!on(a[h],l[h])))return!1;return!0}(i,e);default:return K(52216,{left:i})}}function cs(i,e){return(i.values||[]).find(t=>on(t,e))!==void 0}function Ln(i,e){if(i===e)return 0;let t=Wr(i),n=Wr(e);if(t!==n)return re(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(i.booleanValue,e.booleanValue);case 2:return function(o,a){let l=ze(o.integerValue||o.doubleValue),h=ze(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(i,e);case 3:return Mg(i.timestampValue,e.timestampValue);case 4:return Mg(tc(i),tc(e));case 5:return Su(i.stringValue,e.stringValue);case 6:return function(o,a){let l=Gr(o),h=Gr(a);return l.compareTo(h)}(i.bytesValue,e.bytesValue);case 7:return function(o,a){let l=o.split("/"),h=a.split("/");for(let d=0;d<l.length&&d<h.length;d++){let _=re(l[d],h[d]);if(_!==0)return _}return re(l.length,h.length)}(i.referenceValue,e.referenceValue);case 8:return function(o,a){let l=re(ze(o.latitude),ze(a.latitude));return l!==0?l:re(ze(o.longitude),ze(a.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return Og(i.arrayValue,e.arrayValue);case 10:return function(o,a){let l=o.fields||{},h=a.fields||{},d=l[nc]?.arrayValue,_=h[nc]?.arrayValue,w=re(d?.values?.length||0,_?.values?.length||0);return w!==0?w:Og(d,_)}(i.mapValue,e.mapValue);case 11:return function(o,a){if(o===On.mapValue&&a===On.mapValue)return 0;if(o===On.mapValue)return 1;if(a===On.mapValue)return-1;let l=o.fields||{},h=Object.keys(l),d=a.fields||{},_=Object.keys(d);h.sort(),_.sort();for(let w=0;w<h.length&&w<_.length;++w){let P=Su(h[w],_[w]);if(P!==0)return P;let F=Ln(l[h[w]],d[_[w]]);if(F!==0)return F}return re(h.length,_.length)}(i.mapValue,e.mapValue);default:throw K(23264,{he:t})}}function Mg(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return re(i,e);let t=Fn(i),n=Fn(e),r=re(t.seconds,n.seconds);return r!==0?r:re(t.nanos,n.nanos)}function Og(i,e){let t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){let o=Ln(t[r],n[r]);if(o)return o}return re(t.length,n.length)}function Kr(i){return Fu(i)}function Fu(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){let n=Fn(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return Gr(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return $.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",r=!0;for(let o of t.values||[])r?r=!1:n+=",",n+=Fu(o);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){let n=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let a of n)o?o=!1:r+=",",r+=`${a}:${Fu(t.fields[a])}`;return r+"}"}(i.mapValue):K(61005,{value:i})}function dd(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function Lu(i){return!!i&&"integerValue"in i}function ls(i){return!!i&&"arrayValue"in i}function Fg(i){return!!i&&"nullValue"in i}function Lg(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function mu(i){return!!i&&"mapValue"in i}function kc(i){return(i?.mapValue?.fields||{})[J_]?.stringValue===Y_}function Wo(i){if(i.geoPointValue)return{geoPointValue:we({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:we({},i.timestampValue)};if(i.mapValue){let e={mapValue:{fields:{}}};return ud(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Wo(n)),e}if(i.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wo(i.arrayValue.values[t]);return e}return we({},i)}function Z_(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===X_}var e0={mapValue:{fields:{[J_]:{stringValue:Y_},[nc]:{arrayValue:{}}}}};function xb(i){return"nullValue"in i?Ba:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?dd(as.empty(),$.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?kc(i)?e0:{mapValue:{}}:K(35942,{value:i})}function Ab(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?dd(as.empty(),$.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?e0:"mapValue"in i?kc(i)?{mapValue:{}}:On:K(61959,{value:i})}function Bg(i,e){let t=Ln(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function Ug(i,e){let t=Ln(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}var Zt=class i{constructor(e){this.value=e}static empty(){return new i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!mu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wo(t)}setAll(e){let t=Ke.emptyPath(),n={},r=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){let h=this.getFieldsMap(t);this.applyChanges(h,n,r),n={},r=[],t=l.popLast()}a?n[l.lastSegment()]=Wo(a):r.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,n,r)}delete(e){let t=this.field(e.popLast());mu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return on(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];mu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ud(t,(r,o)=>e[r]=o);for(let r of n)delete e[r]}clone(){return new i(Wo(this.value))}};var Nt=class i{constructor(e,t,n,r,o,a,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new i(e,0,he.min(),he.min(),he.min(),Zt.empty(),0)}static newFoundDocument(e,t,n,r){return new i(e,1,t,he.min(),n,r,0)}static newNoDocument(e,t){return new i(e,2,t,he.min(),he.min(),Zt.empty(),0)}static newUnknownDocument(e,t){return new i(e,3,t,he.min(),he.min(),Zt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof i&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new i(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Bn=class{constructor(e,t){this.position=e,this.inclusive=t}};function qg(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){let o=e[r],a=i.position[r];if(o.field.isKeyField()?n=$.comparator($.fromName(a.referenceValue),t.key):n=Ln(a,t.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function jg(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!on(i.position[t],e.position[t]))return!1;return!0}var Qr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Db(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}var ic=class{},oe=class i extends ic{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new qu(e,t,n):t==="array-contains"?new $u(e,n):t==="in"?new rc(e,n):t==="not-in"?new Gu(e,n):t==="array-contains-any"?new Wu(e,n):new i(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new ju(e,n):new Hu(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ln(t,this.value)):t!==null&&Wr(this.value)===Wr(t)&&this.matchesComparison(Ln(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ge=class i extends ic{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new i(e,t)}matches(e){return Jr(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Jr(i){return i.op==="and"}function Bu(i){return i.op==="or"}function fd(i){return t0(i)&&Jr(i)}function t0(i){for(let e of i.filters)if(e instanceof ge)return!1;return!0}function Uu(i){if(i instanceof oe)return i.field.canonicalString()+i.op.toString()+Kr(i.value);if(fd(i))return i.filters.map(e=>Uu(e)).join(",");{let e=i.filters.map(t=>Uu(t)).join(",");return`${i.op}(${e})`}}function n0(i,e){return i instanceof oe?function(n,r){return r instanceof oe&&n.op===r.op&&n.field.isEqual(r.field)&&on(n.value,r.value)}(i,e):i instanceof ge?function(n,r){return r instanceof ge&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((o,a,l)=>o&&n0(a,r.filters[l]),!0):!1}(i,e):void K(19439)}function i0(i,e){let t=i.filters.concat(e);return ge.create(t,i.op)}function r0(i){return i instanceof oe?function(t){return`${t.field.canonicalString()} ${t.op} ${Kr(t.value)}`}(i):i instanceof ge?function(t){return t.op.toString()+" {"+t.getFilters().map(r0).join(" ,")+"}"}(i):"Filter"}var qu=class extends oe{constructor(e,t,n){super(e,t,n),this.key=$.fromName(n.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},ju=class extends oe{constructor(e,t){super(e,"in",t),this.keys=o0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Hu=class extends oe{constructor(e,t){super(e,"not-in",t),this.keys=o0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function o0(i,e){return(e.arrayValue?.values||[]).map(t=>$.fromName(t.referenceValue))}var $u=class extends oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ls(t)&&cs(t.arrayValue,this.value)}},rc=class extends oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&cs(this.value.arrayValue,t)}},Gu=class extends oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(cs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!cs(this.value.arrayValue,t)}},Wu=class extends oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ls(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>cs(this.value.arrayValue,n))}};var Ku=class{constructor(e,t=null,n=[],r=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}};function Qu(i,e=null,t=[],n=[],r=null,o=null,a=null){return new Ku(i,e,t,n,r,o,a)}function Ei(i){let e=Ie(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Uu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Rc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Kr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Kr(n)).join(",")),e.Te=t}return e.Te}function _s(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!Db(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!n0(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!jg(i.startAt,e.startAt)&&jg(i.endAt,e.endAt)}function Nb(i){return $.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function oc(i,e){return i.filters.filter(t=>t instanceof oe&&t.field.isEqual(e))}function Hg(i,e,t){let n=Ba,r=!0;for(let o of oc(i,e)){let a=Ba,l=!0;switch(o.op){case"<":case"<=":a=xb(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,l=!1;break;case"!=":case"not-in":a=Ba}Bg({value:n,inclusive:r},{value:a,inclusive:l})<0&&(n=a,r=l)}if(t!==null){for(let o=0;o<i.orderBy.length;++o)if(i.orderBy[o].field.isEqual(e)){let a=t.position[o];Bg({value:n,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(n=a,r=t.inclusive);break}}return{value:n,inclusive:r}}function $g(i,e,t){let n=On,r=!0;for(let o of oc(i,e)){let a=On,l=!0;switch(o.op){case">=":case">":a=Ab(o.value),l=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,l=!1;break;case"!=":case"not-in":a=On}Ug({value:n,inclusive:r},{value:a,inclusive:l})>0&&(n=a,r=l)}if(t!==null){for(let o=0;o<i.orderBy.length;++o)if(i.orderBy[o].field.isEqual(e)){let a=t.position[o];Ug({value:n,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(n=a,r=t.inclusive);break}}return{value:n,inclusive:r}}var Xr=class{constructor(e,t=null,n=[],r=[],o=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function Rb(i,e,t,n,r,o,a,l){return new Xr(i,e,t,n,r,o,a,l)}function s0(i){return new Xr(i)}function Gg(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function Pb(i){return i.collectionGroup!==null}function Ko(i){let e=Ie(i);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Ce(Ke.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Qr(o,n))}),t.has(Ke.keyField().canonicalString())||e.Ie.push(new Qr(Ke.keyField(),n))}return e.Ie}function Cn(i){let e=Ie(i);return e.Ee||(e.Ee=Vb(e,Ko(i))),e.Ee}function Vb(i,e){if(i.limitType==="F")return Qu(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new Qr(r.field,o)});let t=i.endAt?new Bn(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Bn(i.startAt.position,i.startAt.inclusive):null;return Qu(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function Ju(i,e,t){return new Xr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function a0(i,e){return _s(Cn(i),Cn(e))&&i.limitType===e.limitType}function c0(i){return`${Ei(Cn(i))}|lt:${i.limitType}`}function Fo(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>r0(r)).join(", ")}]`),Rc(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Kr(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Kr(r)).join(",")),`Target(${n})`}(Cn(i))}; limitType=${i.limitType})`}function Mc(i,e){return e.isFoundDocument()&&function(n,r){let o=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):$.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(i,e)&&function(n,r){for(let o of Ko(n))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0}(i,e)&&function(n,r){for(let o of n.filters)if(!o.matches(r))return!1;return!0}(i,e)&&function(n,r){return!(n.startAt&&!function(a,l,h){let d=qg(a,l,h);return a.inclusive?d<=0:d<0}(n.startAt,Ko(n),r)||n.endAt&&!function(a,l,h){let d=qg(a,l,h);return a.inclusive?d>=0:d>0}(n.endAt,Ko(n),r))}(i,e)}function zb(i){return(e,t)=>{let n=!1;for(let r of Ko(i)){let o=kb(r,e,t);if(o!==0)return o;n=n||r.field.isKeyField()}return 0}}function kb(i,e,t){let n=i.field.isKeyField()?$.comparator(e.key,t.key):function(o,a,l){let h=a.data.field(o),d=l.data.field(o);return h!==null&&d!==null?Ln(h,d):K(42886)}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return K(19790,{direction:i.dir})}}var sn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[r,o]of n)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ud(this.inner,(t,n)=>{for(let[r,o]of n)e(r,o)})}isEmpty(){return Ib(this.inner)}size(){return this.innerSize}};var Mb=new wt($.comparator);function yi(){return Mb}var l0=new wt($.comparator);function Va(...i){let e=l0;for(let t of i)e=e.insert(t.key,t);return e}function Ob(i){let e=l0;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function nn(){return Qo()}function u0(){return Qo()}function Qo(){return new sn(i=>i.toString(),(i,e)=>i.isEqual(e))}var Fb=new wt($.comparator),Lb=new Ce($.comparator);function We(...i){let e=Lb;for(let t of i)e=e.add(t);return e}var Bb=new Ce(re);function Ub(){return Bb}function qb(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ja(e)?"-0":e}}function jb(i){return{integerValue:""+i}}var Yr=class{constructor(){this._=void 0}};function Hb(i,e,t){return i instanceof Ii?function(r,o){let a={fields:{[G_]:{stringValue:$_},[K_]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&hd(o)&&(o=Q_(o)),o&&(a.fields[W_]=o),{mapValue:a}}(t,e):i instanceof Un?h0(i,e):i instanceof qn?d0(i,e):function(r,o){let a=Gb(r,o),l=Wg(a)+Wg(r.Ae);return Lu(a)&&Lu(r.Ae)?jb(l):qb(r.serializer,l)}(i,e)}function $b(i,e,t){return i instanceof Un?h0(i,e):i instanceof qn?d0(i,e):t}function Gb(i,e){return i instanceof Si?function(n){return Lu(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}var Ii=class extends Yr{},Un=class extends Yr{constructor(e){super(),this.elements=e}};function h0(i,e){let t=f0(e);for(let n of i.elements)t.some(r=>on(r,n))||t.push(n);return{arrayValue:{values:t}}}var qn=class extends Yr{constructor(e){super(),this.elements=e}};function d0(i,e){let t=f0(e);for(let n of i.elements)t=t.filter(r=>!on(r,n));return{arrayValue:{values:t}}}var Si=class extends Yr{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Wg(i){return ze(i.integerValue||i.doubleValue)}function f0(i){return ls(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}var Xu=class{constructor(e,t){this.field=e,this.transform=t}};function Wb(i,e){return i.field.isEqual(e.field)&&function(n,r){return n instanceof Un&&r instanceof Un||n instanceof qn&&r instanceof qn?Lr(n.elements,r.elements,on):n instanceof Si&&r instanceof Si?on(n.Ae,r.Ae):n instanceof Ii&&r instanceof Ii}(i.transform,e.transform)}var Yu=class{constructor(e,t){this.version=e,this.transformResults=t}},wn=class i{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new i}static exists(e){return new i(void 0,e)}static updateTime(e){return new i(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ua(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}var Zr=class{};function m0(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new us(i.key,wn.none()):new xi(i.key,i.data,wn.none());{let t=i.data,n=Zt.empty(),r=new Ce(Ke.comparator);for(let o of e.fields)if(!r.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?n.delete(o):n.set(o,a),r=r.add(o)}return new jn(i.key,n,new Mn(r.toArray()),wn.none())}}function Kb(i,e,t){i instanceof xi?function(r,o,a){let l=r.value.clone(),h=Qg(r.fieldTransforms,o,a.transformResults);l.setAll(h),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(i,e,t):i instanceof jn?function(r,o,a){if(!Ua(r.precondition,o))return void o.convertToUnknownDocument(a.version);let l=Qg(r.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(p0(r)),h.setAll(l),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(i,e,t):function(r,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Jo(i,e,t,n){return i instanceof xi?function(o,a,l,h){if(!Ua(o.precondition,a))return l;let d=o.value.clone(),_=Jg(o.fieldTransforms,h,a);return d.setAll(_),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(i,e,t,n):i instanceof jn?function(o,a,l,h){if(!Ua(o.precondition,a))return l;let d=Jg(o.fieldTransforms,h,a),_=a.data;return _.setAll(p0(o)),_.setAll(d),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(w=>w.field))}(i,e,t,n):function(o,a,l){return Ua(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(i,e,t)}function Kg(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Lr(n,r,(o,a)=>Wb(o,a))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}var xi=class extends Zr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},jn=class extends Zr{constructor(e,t,n,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function p0(i){let e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=i.data.field(t);e.set(t,n)}}),e}function Qg(i,e,t){let n=new Map;Z(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let r=0;r<t.length;r++){let o=i[r],a=o.transform,l=e.data.field(o.field);n.set(o.field,$b(a,l,t[r]))}return n}function Jg(i,e,t){let n=new Map;for(let r of i){let o=r.transform,a=t.data.field(r.field);n.set(r.field,Hb(o,a,e))}return n}var us=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},sc=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var hs=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&Kb(o,e,n[r])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Jo(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Jo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=u0();return this.mutations.forEach(r=>{let o=e.get(r.key),a=o.overlayedDocument,l=this.applyToLocalView(a,o.mutatedFields);l=t.has(r.key)?null:l;let h=m0(a,l);h!==null&&n.set(r.key,h),a.isValidDocument()||a.convertToNoDocument(he.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),We())}isEqual(e){return this.batchId===e.batchId&&Lr(this.mutations,e.mutations,(t,n)=>Kg(t,n))&&Lr(this.baseMutations,e.baseMutations,(t,n)=>Kg(t,n))}},Zu=class i{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Z(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return Fb}(),o=e.mutations;for(let a=0;a<o.length;a++)r=r.insert(o[a].key,n[a].version);return new i(e,t,n,r)}};var ds=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Pe,ce;function Qb(i){switch(i){case z.OK:return K(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return K(15467,{code:i})}}function Jb(i){if(i===void 0)return vt("GRPC error has no .code"),z.UNKNOWN;switch(i){case Pe.OK:return z.OK;case Pe.CANCELLED:return z.CANCELLED;case Pe.UNKNOWN:return z.UNKNOWN;case Pe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Pe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Pe.INTERNAL:return z.INTERNAL;case Pe.UNAVAILABLE:return z.UNAVAILABLE;case Pe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Pe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Pe.NOT_FOUND:return z.NOT_FOUND;case Pe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Pe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Pe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Pe.ABORTED:return z.ABORTED;case Pe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Pe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Pe.DATA_LOSS:return z.DATA_LOSS;default:return K(39323,{code:i})}}(ce=Pe||(Pe={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";var TP=new Na([4294967295,4294967295],0);var Xb={asc:"ASCENDING",desc:"DESCENDING"},Yb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zb={and:"AND",or:"OR"},eh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function eE(i,e){return i.useProto3Json||Rc(e)?e:{value:e}}function th(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tE(i,e){return th(i,e.toTimestamp())}function qt(i){return Z(!!i,49232),he.fromTimestamp(function(t){let n=Fn(t);return new qe(n.seconds,n.nanos)}(i))}function g0(i,e){return nh(i,e).canonicalString()}function nh(i,e){let t=function(r){return new Re(["projects",r.projectId,"databases",r.database])}(i).child("documents");return e===void 0?t:t.child(e)}function _0(i){let e=Re.fromString(i);return Z(hE(e),10190,{key:e.toString()}),e}function ac(i,e){return g0(i.databaseId,e.path)}function qa(i,e){let t=_0(e);if(t.get(1)!==i.databaseId.projectId)throw new H(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new H(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new $(w0(t))}function y0(i,e){return g0(i.databaseId,e)}function v0(i){let e=_0(i);return e.length===4?Re.emptyPath():w0(e)}function nE(i){return new Re(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function w0(i){return Z(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Xg(i,e,t){return{name:ac(i,e),fields:t.value.mapValue.fields}}function iE(i,e,t){let n=qa(i,e.name),r=qt(e.updateTime),o=e.createTime?qt(e.createTime):he.min(),a=new Zt({mapValue:{fields:e.fields}}),l=Nt.newFoundDocument(n,r,o,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function cc(i,e){let t;if(e instanceof xi)t={update:Xg(i,e.key,e.value)};else if(e instanceof us)t={delete:ac(i,e.key)};else if(e instanceof jn)t={update:Xg(i,e.key,e.data),updateMask:uE(e.fieldMask)};else{if(!(e instanceof sc))return K(16599,{Vt:e.type});t={verify:ac(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(o,a){let l=a.transform;if(l instanceof Ii)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Un)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof qn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Si)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw K(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:tE(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:K(27497)}(i,e.precondition)),t}function ih(i,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?wn.updateTime(qt(o.updateTime)):o.exists!==void 0?wn.exists(o.exists):wn.none()}(e.currentDocument):wn.none(),n=e.updateTransforms?e.updateTransforms.map(r=>function(a,l){let h=null;if("setToServerValue"in l)Z(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),h=new Ii;else if("appendMissingElements"in l){let _=l.appendMissingElements.values||[];h=new Un(_)}else if("removeAllFromArray"in l){let _=l.removeAllFromArray.values||[];h=new qn(_)}else"increment"in l?h=new Si(a,l.increment):K(16584,{proto:l});let d=Ke.fromServerFormat(l.fieldPath);return new Xu(d,h)}(i,r)):[];if(e.update){e.update.name;let r=qa(i,e.update.name),o=new Zt({mapValue:{fields:e.update.fields}});if(e.updateMask){let a=function(h){let d=h.fieldPaths||[];return new Mn(d.map(_=>Ke.fromServerFormat(_)))}(e.updateMask);return new jn(r,o,a,t,n)}return new xi(r,o,t,n)}if(e.delete){let r=qa(i,e.delete);return new us(r,t)}if(e.verify){let r=qa(i,e.verify);return new sc(r,t)}return K(1463,{proto:e})}function rE(i,e){return i&&i.length>0?(Z(e!==void 0,14353),i.map(t=>function(r,o){let a=r.updateTime?qt(r.updateTime):qt(o);return a.isEqual(he.min())&&(a=qt(o)),new Yu(a,r.transformResults||[])}(t,e))):[]}function oE(i,e){return{documents:[y0(i,e.path)]}}function sE(i,e){let t={structuredQuery:{}},n=e.path,r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=y0(i,r);let o=function(d){if(d.length!==0)return b0(ge.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(_=>function(P){return{field:Rr(P.field),direction:aE(P.dir)}}(_))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let l=eE(i,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:t,parent:r}}function T0(i){let e=v0(i.parent),t=i.structuredQuery,n=t.from?t.from.length:0,r=null;if(n>0){Z(n===1,65062);let _=t.from[0];_.allDescendants?r=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=function(w){let P=C0(w);return P instanceof ge&&fd(P)?P.getFilters():[P]}(t.where));let a=[];t.orderBy&&(a=function(w){return w.map(P=>function(L){return new Qr(Pr(L.field),function(W){switch(W){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(P))}(t.orderBy));let l=null;t.limit&&(l=function(w){let P;return P=typeof w=="object"?w.value:w,Rc(P)?null:P}(t.limit));let h=null;t.startAt&&(h=function(w){let P=!!w.before,F=w.values||[];return new Bn(F,P)}(t.startAt));let d=null;return t.endAt&&(d=function(w){let P=!w.before,F=w.values||[];return new Bn(F,P)}(t.endAt)),Rb(e,r,a,o,l,"F",h,d)}function C0(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=Pr(t.unaryFilter.field);return oe.create(n,"==",{doubleValue:NaN});case"IS_NULL":let r=Pr(t.unaryFilter.field);return oe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Pr(t.unaryFilter.field);return oe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Pr(t.unaryFilter.field);return oe.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return K(61313);default:return K(60726)}}(i):i.fieldFilter!==void 0?function(t){return oe.create(Pr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return K(58110);default:return K(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return ge.create(t.compositeFilter.filters.map(n=>C0(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return K(1026)}}(t.compositeFilter.op))}(i):K(30097,{filter:i})}function aE(i){return Xb[i]}function cE(i){return Yb[i]}function lE(i){return Zb[i]}function Rr(i){return{fieldPath:i.canonicalString()}}function Pr(i){return Ke.fromServerFormat(i.fieldPath)}function b0(i){return i instanceof oe?function(t){if(t.op==="=="){if(Lg(t.value))return{unaryFilter:{field:Rr(t.field),op:"IS_NAN"}};if(Fg(t.value))return{unaryFilter:{field:Rr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Lg(t.value))return{unaryFilter:{field:Rr(t.field),op:"IS_NOT_NAN"}};if(Fg(t.value))return{unaryFilter:{field:Rr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rr(t.field),op:cE(t.op),value:t.value}}}(i):i instanceof ge?function(t){let n=t.getFilters().map(r=>b0(r));return n.length===1?n[0]:{compositeFilter:{op:lE(t.op),filters:n}}}(i):K(54877,{filter:i})}function uE(i){let e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function hE(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}var rh=class i{constructor(e,t,n,r,o=he.min(),a=he.min(),l=Tt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var lc=class{constructor(e){this.yt=e}};function dE(i,e){let t;if(e.document)t=iE(i.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=$.fromSegments(e.noDocument.path),r=Di(e.noDocument.readTime);t=Nt.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return K(56709);{let n=$.fromSegments(e.unknownDocument.path),r=Di(e.unknownDocument.version);t=Nt.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime(function(r){let o=new qe(r[0],r[1]);return he.fromTimestamp(o)}(e.readTime)),t}function Yg(i,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:uc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(o,a){return{name:ac(o,a.key),fields:a.data.value.mapValue.fields,updateTime:th(o,a.version.toTimestamp()),createTime:th(o,a.createTime.toTimestamp())}}(i.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Ai(e.version)};else{if(!e.isUnknownDocument())return K(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Ai(e.version)}}return n}function uc(i){let e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function Ai(i){let e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Di(i){let e=new qe(i.seconds,i.nanoseconds);return he.fromTimestamp(e)}function mi(i,e){let t=(e.baseMutations||[]).map(o=>ih(i.yt,o));for(let o=0;o<e.mutations.length-1;++o){let a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let l=e.mutations[o+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let n=e.mutations.map(o=>ih(i.yt,o)),r=qe.fromMillis(e.localWriteTimeMs);return new hs(e.batchId,r,t,n)}function jo(i){let e=Di(i.readTime),t=i.lastLimboFreeSnapshotVersion!==void 0?Di(i.lastLimboFreeSnapshotVersion):he.min(),n;return n=function(o){return o.documents!==void 0}(i.query)?function(o){let a=o.documents.length;return Z(a===1,1966,{count:a}),Cn(s0(v0(o.documents[0])))}(i.query):function(o){return Cn(T0(o))}(i.query),new rh(n,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,Tt.fromBase64String(i.resumeToken))}function E0(i,e){let t=Ai(e.snapshotVersion),n=Ai(e.lastLimboFreeSnapshotVersion),r;r=Nb(e.target)?oE(i.yt,e.target):sE(i.yt,e.target).ft;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ei(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function I0(i){let e=T0({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Ju(e,e.limit,"L"):e}function pu(i,e){return new ds(e.largestBatchId,ih(i.yt,e.overlayMutation))}function Zg(i,e){let t=e.path.lastSegment();return[i,st(e.path.popLast()),t]}function e_(i,e,t,n){return{indexId:i,uid:e,sequenceNumber:t,readTime:Ai(n.readTime),documentKey:st(n.documentKey.path),largestBatchId:n.largestBatchId}}var oh=class{getBundleMetadata(e,t){return t_(e).get(t).next(n=>{if(n)return function(o){return{id:o.bundleId,createTime:Di(o.createTime),version:o.version}}(n)})}saveBundleMetadata(e,t){return t_(e).put(function(r){return{bundleId:r.id,createTime:Ai(qt(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return n_(e).get(t).next(n=>{if(n)return function(o){return{name:o.name,query:I0(o.bundledQuery),readTime:Di(o.readTime)}}(n)})}saveNamedQuery(e,t){return n_(e).put(function(r){return{name:r.name,readTime:Ai(qt(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function t_(i){return Oe(i,Pc)}function n_(i){return Oe(i,Vc)}var hc=class i{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){let n=t.uid||"";return new i(e,n)}getOverlay(e,t){return Lo(e).get(Zg(this.userId,t)).next(n=>n?pu(this.serializer,n):null)}getOverlays(e,t){let n=nn();return A.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&n.set(r,o)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((o,a)=>{let l=new ds(t,a);r.push(this.St(e,l))}),A.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(a=>r.add(st(a.getCollectionPath())));let o=[];return r.forEach(a=>{let l=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);o.push(Lo(e).Z(zu,l))}),A.waitFor(o)}getOverlaysForCollection(e,t,n){let r=nn(),o=st(t),a=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Lo(e).J(zu,a).next(l=>{for(let h of l){let d=pu(this.serializer,h);r.set(d.getKey(),d)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let o=nn(),a,l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Lo(e).ee({index:B_,range:l},(h,d,_)=>{let w=pu(this.serializer,d);o.size()<r||w.largestBatchId===a?(o.set(w.getKey(),w),a=w.largestBatchId):_.done()}).next(()=>o)}St(e,t){return Lo(e).put(function(r,o,a){let[l,h,d]=Zg(o,a.mutation.key);return{userId:o,collectionPath:h,documentId:d,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:cc(r.yt,a.mutation)}}(this.serializer,this.userId,t))}};function Lo(i){return Oe(i,zc)}var sh=class{bt(e){return Oe(e,cd)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{let n=t?.value;return n?Tt.fromUint8Array(n):Tt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var vn=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ze(e.integerValue));else if("doubleValue"in e){let n=ze(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Ja(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Fn(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Gr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Z_(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):kc(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):K(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let n=e.fields||{};this.Ft(t,55);for(let r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){let n=e.fields||{};this.Ft(t,53);let r=nc,o=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ze(o)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){let n=e.values||[];this.Ft(t,50);for(let r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),$.fromName(e).path.forEach(n=>{this.Ft(t,60),this.Ut(n,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};vn.Kt=new vn;var Sr=255;function fE(i){if(i===0)return 8;let e=0;return i>>4||(e+=4,i<<=4),i>>6||(e+=2,i<<=2),i>>7||(e+=1),e}function i_(i){let e=64-function(n){let r=0;for(let o=0;o<8;++o){let a=fE(255&n[o]);if(r+=a,a!==8)break}return r}(i);return Math.ceil(e/8)}var ah=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{let r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{let r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){let t=this.en(e),n=i_(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){let t=this.en(e),n=i_(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Sr),this.sn(255)}_n(){this.an(Sr),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t=function(o){let a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Gt(e){let t=255&e;t===0?(this.sn(0),this.sn(255)):t===Sr?(this.sn(Sr),this.sn(0)):this.sn(t)}Jt(e){let t=255&e;t===0?(this.an(0),this.an(255)):t===Sr?(this.an(Sr),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}},ch=class{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}},lh=class{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}},pi=class{constructor(){this.cn=new ah,this.ln=new ch(this.cn),this.hn=new lh(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}};var gi=class i{constructor(e,t,n,r){this.Tn=e,this.In=t,this.En=n,this.dn=r}An(){let e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new i(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:ja(this.En),directionalValue:ja(this.dn),orderedDocumentKey:ja(t),documentKey:n.path.toArray()}}Vn(e,t,n){let r=this.Rn(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}};function Pn(i,e){let t=i.Tn-e.Tn;return t!==0?t:(t=r_(i.En,e.En),t!==0?t:(t=r_(i.dn,e.dn),t!==0?t:$.comparator(i.In,e.In)))}function r_(i,e){for(let t=0;t<i.length&&t<e.length;++t){let n=i[t]-e[t];if(n!==0)return n}return i.length-e.length}function ja(i){return tu()?function(t){let n="";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n}(i):i}function o_(i){return typeof i!="string"?i:function(t){let n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(i)}var dc=class{constructor(e){this.mn=new Ce((t,n)=>Ke.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(let t of e.filters){let n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(Z(e.collectionGroup===this.collectionId,49279),this.pn)return!1;let t=xu(e);if(t!==void 0&&!this.wn(t))return!1;let n=hi(e),r=new Set,o=0,a=0;for(;o<n.length&&this.wn(n[o]);++o)r=r.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.mn.size>0){let l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){let h=n[o];if(!this.Sn(l,h)||!this.bn(this.fn[a++],h))return!1}++o}for(;o<n.length;++o){let l=n[o];if(a>=this.fn.length||!this.bn(this.fn[a++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ce(Ke.comparator),t=[];for(let n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Mr(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Mr(n.field,0))}for(let n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Mr(n.field,n.dir==="asc"?0:1)));return new Br(Br.UNKNOWN_ID,this.collectionId,t,ns.empty())}wn(e){for(let t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function S0(i){if(Z(i instanceof oe||i instanceof ge,20012),i instanceof oe){if(i instanceof rc){let t=i.value.arrayValue?.values?.map(n=>oe.create(i.field,"==",n))||[];return ge.create(t,"or")}return i}let e=i.filters.map(t=>S0(t));return ge.create(e,i.op)}function mE(i){if(i.getFilters().length===0)return[];let e=dh(S0(i));return Z(x0(e),7391),uh(e)||hh(e)?[e]:e.getFilters()}function uh(i){return i instanceof oe}function hh(i){return i instanceof ge&&fd(i)}function x0(i){return uh(i)||hh(i)||function(t){if(t instanceof ge&&Bu(t)){for(let n of t.getFilters())if(!uh(n)&&!hh(n))return!1;return!0}return!1}(i)}function dh(i){if(Z(i instanceof oe||i instanceof ge,34018),i instanceof oe)return i;if(i.filters.length===1)return dh(i.filters[0]);let e=i.filters.map(n=>dh(n)),t=ge.create(e,i.op);return t=fc(t),x0(t)?t:(Z(t instanceof ge,64498),Z(Jr(t),40251),Z(t.filters.length>1,57927),t.filters.reduce((n,r)=>md(n,r)))}function md(i,e){let t;return Z(i instanceof oe||i instanceof ge,38388),Z(e instanceof oe||e instanceof ge,25473),t=i instanceof oe?e instanceof oe?function(r,o){return ge.create([r,o],"and")}(i,e):s_(i,e):e instanceof oe?s_(e,i):function(r,o){if(Z(r.filters.length>0&&o.filters.length>0,48005),Jr(r)&&Jr(o))return i0(r,o.getFilters());let a=Bu(r)?r:o,l=Bu(r)?o:r,h=a.filters.map(d=>md(d,l));return ge.create(h,"or")}(i,e),fc(t)}function s_(i,e){if(Jr(e))return i0(e,i.getFilters());{let t=e.filters.map(n=>md(i,n));return ge.create(t,"or")}}function fc(i){if(Z(i instanceof oe||i instanceof ge,11850),i instanceof oe)return i;let e=i.getFilters();if(e.length===1)return fc(e[0]);if(t0(i))return i;let t=e.map(r=>fc(r)),n=[];return t.forEach(r=>{r instanceof oe?n.push(r):r instanceof ge&&(r.op===i.op?n.push(...r.filters):n.push(r))}),n.length===1?n[0]:ge.create(n,i.op)}var fh=class{constructor(){this.Cn=new fs}addToCollectionParentIndex(e,t){return this.Cn.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}deleteAllFieldIndexes(e){return A.resolve()}createTargetIndexes(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(Rt.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(Rt.min())}updateCollectionGroup(e,t,n){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}},fs=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ce(Re.comparator),o=!r.has(n);return this.index[t]=r.add(n),o}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ce(Re.comparator)).toArray()}};var a_="IndexedDbIndexManager",za=new Uint8Array(0),mh=class{constructor(e,t){this.databaseId=t,this.vn=new fs,this.Fn=new sn(n=>Ei(n),(n,r)=>_s(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});let o={collectionId:n,parent:st(r)};return c_(e).put(o)}return A.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[R_(t),""],!1,!0);return c_(e).J(r).next(o=>{for(let a of o){if(a.collectionId!==t)break;n.push(tn(a.parent))}return n})}addFieldIndex(e,t){let n=Bo(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete r.indexId;let o=n.add(r);if(t.indexState){let a=Ar(e);return o.next(l=>{a.put(e_(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let n=Bo(e),r=Ar(e),o=xr(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Bo(e),n=xr(e),r=Ar(e);return t.Z().next(()=>n.Z()).next(()=>r.Z())}createTargetIndexes(e,t){return A.forEach(this.Mn(t),n=>this.getIndexType(e,n).next(r=>{if(r===0||r===1){let o=new dc(n).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let n=xr(e),r=!0,o=new Map;return A.forEach(this.Mn(t),a=>this.xn(e,a).next(l=>{r&&(r=!!l),o.set(a,l)})).next(()=>{if(r){let a=We(),l=[];return A.forEach(o,(h,d)=>{O(a_,`Using index ${function(te){return`id=${te.indexId}|cg=${te.collectionGroup}|f=${te.fields.map(ve=>`${ve.fieldPath}:${ve.kind}`).join(",")}`}(h)} to execute ${Ei(t)}`);let _=function(te,ve){let be=xu(ve);if(be===void 0)return null;for(let fe of oc(te,be.fieldPath))switch(fe.op){case"array-contains-any":return fe.value.arrayValue.values||[];case"array-contains":return[fe.value]}return null}(d,h),w=function(te,ve){let be=new Map;for(let fe of hi(ve))for(let C of oc(te,fe.fieldPath))switch(C.op){case"==":case"in":be.set(fe.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return be.set(fe.fieldPath.canonicalString(),C.value),Array.from(be.values())}return null}(d,h),P=function(te,ve){let be=[],fe=!0;for(let C of hi(ve)){let m=C.kind===0?Hg(te,C.fieldPath,te.startAt):$g(te,C.fieldPath,te.startAt);be.push(m.value),fe&&(fe=m.inclusive)}return new Bn(be,fe)}(d,h),F=function(te,ve){let be=[],fe=!0;for(let C of hi(ve)){let m=C.kind===0?$g(te,C.fieldPath,te.endAt):Hg(te,C.fieldPath,te.endAt);be.push(m.value),fe&&(fe=m.inclusive)}return new Bn(be,fe)}(d,h),L=this.On(h,d,P),G=this.On(h,d,F),W=this.Nn(h,d,w),Ae=this.Bn(h.indexId,_,L,P.inclusive,G,F.inclusive,W);return A.forEach(Ae,le=>n.Y(le,t.limit).next(te=>{te.forEach(ve=>{let be=$.fromSegments(ve.documentKey);a.has(be)||(a=a.add(be),l.push(be))})}))}).next(()=>l)}return A.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=mE(ge.create(e.filters,"and")).map(n=>Qu(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,n,r,o,a,l){let h=(t!=null?t.length:1)*Math.max(n.length,o.length),d=h/(t!=null?t.length:1),_=[];for(let w=0;w<h;++w){let P=t?this.Ln(t[w/d]):za,F=this.kn(e,P,n[w%d],r),L=this.qn(e,P,o[w%d],a),G=l.map(W=>this.kn(e,P,W,!0));_.push(...this.createRange(F,L,G))}return _}kn(e,t,n,r){let o=new gi(e,$.empty(),t,n);return r?o:o.An()}qn(e,t,n,r){let o=new gi(e,$.empty(),t,n);return r?o.An():o}xn(e,t){let n=new dc(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(o=>{let a=null;for(let l of o)n.yn(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let n=2,r=this.Mn(t);return A.forEach(r,o=>this.xn(e,o).next(a=>{a?n!==0&&a.fields.length<function(h){let d=new Ce(Ke.comparator),_=!1;for(let w of h.filters)for(let P of w.getFlattenedFilters())P.field.isKeyField()||(P.op==="array-contains"||P.op==="array-contains-any"?_=!0:d=d.add(P.field));for(let w of h.orderBy)w.field.isKeyField()||(d=d.add(w.field));return d.size+(_?1:0)}(o)&&(n=1):n=0})).next(()=>function(a){return a.limit!==null}(t)&&r.length>1&&n===2?1:n)}Qn(e,t){let n=new pi;for(let r of hi(e)){let o=t.data.field(r.fieldPath);if(o==null)return null;let a=n.Pn(r.kind);vn.Kt.Dt(o,a)}return n.un()}Ln(e){let t=new pi;return vn.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){let n=new pi;return vn.Kt.Dt(dd(this.databaseId,t),n.Pn(function(o){let a=hi(o);return a.length===0?0:a[a.length-1].kind}(e))),n.un()}Nn(e,t,n){if(n===null)return[];let r=[];r.push(new pi);let o=0;for(let a of hi(e)){let l=n[o++];for(let h of r)if(this.Un(t,a.fieldPath)&&ls(l))r=this.Kn(r,a,l);else{let d=h.Pn(a.kind);vn.Kt.Dt(l,d)}}return this.Wn(r)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){let r=[...e],o=[];for(let a of n.arrayValue.values||[])for(let l of r){let h=new pi;h.seed(l.un()),vn.Kt.Dt(a,h.Pn(t.kind)),o.push(h)}return o}Un(e,t){return!!e.filters.find(n=>n instanceof oe&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=Bo(e),r=Ar(e);return(t?n.J(Vu,IDBKeyRange.bound(t,t)):n.J()).next(o=>{let a=[];return A.forEach(o,l=>r.get([l.indexId,this.uid]).next(h=>{a.push(function(_,w){let P=w?new ns(w.sequenceNumber,new Rt(Di(w.readTime),new $(tn(w.documentKey)),w.largestBatchId)):ns.empty(),F=_.fields.map(([L,G])=>new Mr(Ke.fromServerFormat(L),G));return new Br(_.indexId,_.collectionGroup,F,P)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,r)=>{let o=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return o!==0?o:re(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=Bo(e),o=Ar(e);return this.Gn(e).next(a=>r.J(Vu,IDBKeyRange.bound(t,t)).next(l=>A.forEach(l,h=>o.put(e_(h.indexId,this.uid,a,n)))))}updateIndexEntries(e,t){let n=new Map;return A.forEach(t,(r,o)=>{let a=n.get(r.collectionGroup);return(a?A.resolve(a):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(n.set(r.collectionGroup,l),A.forEach(l,h=>this.zn(e,r,h).next(d=>{let _=this.jn(o,h);return d.isEqual(_)?A.resolve():this.Jn(e,o,h,d,_)}))))})}Hn(e,t,n,r){return xr(e).put(r.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,r){return xr(e).delete(r.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){let r=xr(e),o=new Ce(Pn);return r.ee({index:L_,range:IDBKeyRange.only([n.indexId,this.uid,ja(this.$n(n,t))])},(a,l)=>{o=o.add(new gi(n.indexId,t,o_(l.arrayValue),o_(l.directionalValue)))}).next(()=>o)}jn(e,t){let n=new Ce(Pn),r=this.Qn(t,e);if(r==null)return n;let o=xu(t);if(o!=null){let a=e.data.field(o.fieldPath);if(ls(a))for(let l of a.arrayValue.values||[])n=n.add(new gi(t.indexId,e.key,this.Ln(l),r))}else n=n.add(new gi(t.indexId,e.key,za,r));return n}Jn(e,t,n,r,o){O(a_,"Updating index entries for document '%s'",t.key);let a=[];return function(h,d,_,w,P){let F=h.getIterator(),L=d.getIterator(),G=Ir(F),W=Ir(L);for(;G||W;){let Ae=!1,le=!1;if(G&&W){let te=_(G,W);te<0?le=!0:te>0&&(Ae=!0)}else G!=null?le=!0:Ae=!0;Ae?(w(W),W=Ir(L)):le?(P(G),G=Ir(F)):(G=Ir(F),W=Ir(L))}}(r,o,Pn,l=>{a.push(this.Hn(e,t,n,l))},l=>{a.push(this.Yn(e,t,n,l))}),A.waitFor(a)}Gn(e){let t=1;return Ar(e).ee({index:F_,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,r,o)=>{o.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((a,l)=>Pn(a,l)).filter((a,l,h)=>!l||Pn(a,h[l-1])!==0);let r=[];r.push(e);for(let a of n){let l=Pn(a,e),h=Pn(a,t);if(l===0)r[0]=e.An();else if(l>0&&h<0)r.push(a),r.push(a.An());else if(h>0)break}r.push(t);let o=[];for(let a=0;a<r.length;a+=2){if(this.Zn(r[a],r[a+1]))return[];let l=r[a].Vn(this.uid,za,$.empty()),h=r[a+1].Vn(this.uid,za,$.empty());o.push(IDBKeyRange.bound(l,h))}return o}Zn(e,t){return Pn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(l_)}getMinOffset(e,t){return A.mapArray(this.Mn(t),n=>this.xn(e,n).next(r=>r||K(44426))).next(l_)}};function c_(i){return Oe(i,os)}function xr(i){return Oe(i,Go)}function Bo(i){return Oe(i,ad)}function Ar(i){return Oe(i,$o)}function l_(i){Z(i.length!==0,28825);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){let r=i[n].indexState.offset;rd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Rt(e.readTime,e.documentKey,t)}var u_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},A0=41943040,Dt=class i{static withCacheSize(e){return new i(e,i.DEFAULT_COLLECTION_PERCENTILE,i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};function D0(i,e,t){let n=i.store(Ut),r=i.store(qr),o=[],a=IDBKeyRange.only(t.batchId),l=0,h=n.ee({range:a},(_,w,P)=>(l++,P.delete()));o.push(h.next(()=>{Z(l===1,47070,{batchId:t.batchId})}));let d=[];for(let _ of t.mutations){let w=k_(e,_.key.path,t.batchId);o.push(r.delete(w)),d.push(_.key)}return A.waitFor(o).next(()=>d)}function mc(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw K(14731);e=i.noDocument}return JSON.stringify(e).length}Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(A0,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);var pc=class i{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Xn={}}static wt(e,t,n,r){Z(e.uid!=="",64387);let o=e.isAuthenticated()?e.uid:"";return new i(o,t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vn(e).ee({index:_i,range:n},(r,o,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let o=Vr(e),a=Vn(e);return a.add({}).next(l=>{Z(typeof l=="number",49019);let h=new hs(l,t,n,r),d=function(F,L,G){let W=G.baseMutations.map(le=>cc(F.yt,le)),Ae=G.mutations.map(le=>cc(F.yt,le));return{userId:L,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:W,mutations:Ae}}(this.serializer,this.userId,h),_=[],w=new Ce((P,F)=>re(P.canonicalString(),F.canonicalString()));for(let P of r){let F=k_(this.userId,P.key.path,l);w=w.add(P.key.path.popLast()),_.push(a.put(d)),_.push(o.put(F,tb))}return w.forEach(P=>{_.push(this.indexManager.addToCollectionParentIndex(e,P))}),e.addOnCommittedListener(()=>{this.Xn[l]=h.keys()}),A.waitFor(_).next(()=>h)})}lookupMutationBatch(e,t){return Vn(e).get(t).next(n=>n?(Z(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),mi(this.serializer,n)):null)}er(e,t){return this.Xn[t]?A.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let r=n.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),o=null;return Vn(e).ee({index:_i,range:r},(a,l,h)=>{l.userId===this.userId&&(Z(l.batchId>=n,47524,{tr:n}),o=mi(this.serializer,l)),h.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=wi;return Vn(e).ee({index:_i,range:t,reverse:!0},(r,o,a)=>{n=o.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,wi],[this.userId,Number.POSITIVE_INFINITY]);return Vn(e).J(_i,t).next(n=>n.map(r=>mi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=Fa(this.userId,t.path),r=IDBKeyRange.lowerBound(n),o=[];return Vr(e).ee({range:r},(a,l,h)=>{let[d,_,w]=a,P=tn(_);if(d===this.userId&&t.path.isEqual(P))return Vn(e).get(w).next(F=>{if(!F)throw K(61480,{nr:a,batchId:w});Z(F.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:F.userId,batchId:w}),o.push(mi(this.serializer,F))});h.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ce(re),r=[];return t.forEach(o=>{let a=Fa(this.userId,o.path),l=IDBKeyRange.lowerBound(a),h=Vr(e).ee({range:l},(d,_,w)=>{let[P,F,L]=d,G=tn(F);P===this.userId&&o.path.isEqual(G)?n=n.add(L):w.done()});r.push(h)}),A.waitFor(r).next(()=>this.rr(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,o=Fa(this.userId,n),a=IDBKeyRange.lowerBound(o),l=new Ce(re);return Vr(e).ee({range:a},(h,d,_)=>{let[w,P,F]=h,L=tn(P);w===this.userId&&n.isPrefixOf(L)?L.length===r&&(l=l.add(F)):_.done()}).next(()=>this.rr(e,l))}rr(e,t){let n=[],r=[];return t.forEach(o=>{r.push(Vn(e).get(o).next(a=>{if(a===null)throw K(35274,{batchId:o});Z(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:o}),n.push(mi(this.serializer,a))}))}),A.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return D0(e.le,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),A.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return A.resolve();let n=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),r=[];return Vr(e).ee({range:n},(o,a,l)=>{if(o[0]===this.userId){let h=tn(o[1]);r.push(h)}else l.done()}).next(()=>{Z(r.length===0,56720,{sr:r.map(o=>o.canonicalString())})})})}containsKey(e,t){return N0(e,this.userId,t)}_r(e){return R0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:wi,lastStreamToken:""})}};function N0(i,e,t){let n=Fa(e,t.path),r=n[1],o=IDBKeyRange.lowerBound(n),a=!1;return Vr(i).ee({range:o,X:!0},(l,h,d)=>{let[_,w,P]=l;_===e&&w===r&&(a=!0),d.done()}).next(()=>a)}function Vn(i){return Oe(i,Ut)}function Vr(i){return Oe(i,qr)}function R0(i){return Oe(i,is)}var eo=class i{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new i(0)}static cr(){return new i(-1)}};var ph=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{let n=new eo(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>he.fromTimestamp(new qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.lr(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Dr(e).delete(t.targetId)).next(()=>this.lr(e)).next(n=>(Z(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n)))}removeTargets(e,t,n){let r=0,o=[];return Dr(e).ee((a,l)=>{let h=jo(l);h.sequenceNumber<=t&&n.get(h.targetId)===null&&(r++,o.push(this.removeTargetData(e,h)))}).next(()=>A.waitFor(o)).next(()=>r)}forEachTarget(e,t){return Dr(e).ee((n,r)=>{let o=jo(r);t(o)})}lr(e){return h_(e).get(Za).next(t=>(Z(t!==null,2888),t))}hr(e,t){return h_(e).put(Za,t)}Pr(e,t){return Dr(e).put(E0(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){let n=Ei(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),o=null;return Dr(e).ee({range:r,index:O_},(a,l,h)=>{let d=jo(l);_s(t,d.target)&&(o=d,h.done())}).next(()=>o)}addMatchingKeys(e,t,n){let r=[],o=kn(e);return t.forEach(a=>{let l=st(a.path);r.push(o.put({targetId:n,path:l})),r.push(this.referenceDelegate.addReference(e,n,a))}),A.waitFor(r)}removeMatchingKeys(e,t,n){let r=kn(e);return A.forEach(t,o=>{let a=st(o.path);return A.waitFor([r.delete([n,a]),this.referenceDelegate.removeReference(e,n,o)])})}removeMatchingKeysForTargetId(e,t){let n=kn(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=kn(e),o=We();return r.ee({range:n,X:!0},(a,l,h)=>{let d=tn(a[1]),_=new $(d);o=o.add(_)}).next(()=>o)}containsKey(e,t){let n=st(t.path),r=IDBKeyRange.bound([n],[R_(n)],!1,!0),o=0;return kn(e).ee({index:sd,X:!0,range:r},([a,l],h,d)=>{a!==0&&(o++,d.done())}).next(()=>o>0)}At(e,t){return Dr(e).get(t).next(n=>n?jo(n):null)}};function Dr(i){return Oe(i,jr)}function h_(i){return Oe(i,Ti)}function kn(i){return Oe(i,Hr)}var d_="LruGarbageCollector",pE=1048576;function f_([i,e],[t,n]){let r=re(i,t);return r===0?re(e,n):r}var gh=class{constructor(e){this.Ir=e,this.buffer=new Ce(f_),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();f_(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},_h=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){O(d_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>B(this,null,function*(){this.Rr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ni(t)?O(d_,"Ignoring IndexedDB error during garbage collection: ",t):yield Nc(t)}yield this.Vr(3e5)}))}},yh=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return A.resolve(en.ce);let n=new gh(t);return this.mr.forEachTarget(e,r=>n.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>n.Ar(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(u_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),u_):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,o,a,l,h,d,_=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),r=this.params.maximumSequenceNumbersToCollect):r=w,a=Date.now(),this.nthSequenceNumber(e,r))).next(w=>(n=w,l=Date.now(),this.removeTargets(e,n,t))).next(w=>(o=w,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(w=>(d=Date.now(),Nr()<=ae.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${r} in `+(l-a)+`ms
	Removed ${o} targets in `+(h-l)+`ms
	Removed ${w} documents in `+(d-h)+`ms
Total Duration: ${d-_}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:w})))}};function gE(i,e){return new yh(i,e)}var vh=class{constructor(e,t){this.db=e,this.garbageCollector=gE(this,t)}gr(e){let t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(n,r)=>t(r))}addReference(e,t,n){return ka(e,n)}removeReference(e,t,n){return ka(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return ka(e,t)}br(e,t){return function(r,o){let a=!1;return R0(r).te(l=>N0(r,l,o).next(h=>(h&&(a=!0),A.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],o=0;return this.Sr(e,(a,l)=>{if(l<=t){let h=this.br(e,a).next(d=>{if(!d)return o++,n.getEntry(e,a).next(()=>(n.removeEntry(a,he.min()),kn(e).delete(function(w){return[0,st(w.path)]}(a))))});r.push(h)}}).next(()=>A.waitFor(r)).next(()=>n.apply(e)).next(()=>o)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return ka(e,t)}Sr(e,t){let n=kn(e),r,o=en.ce;return n.ee({index:sd},([a,l],{path:h,sequenceNumber:d})=>{a===0?(o!==en.ce&&t(new $(tn(r)),o),o=d,r=h):o=en.ce}).next(()=>{o!==en.ce&&t(new $(tn(r)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ka(i,e){return kn(i).put(function(n,r){return{targetId:0,path:st(n.path),sequenceNumber:r}}(e,i.currentSequenceNumber))}var gc=class{constructor(){this.changes=new sn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?A.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var wh=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return ui(e).put(n)}removeEntry(e,t,n){return ui(e).delete(function(o,a){let l=o.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],uc(a),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Dr(e,n)))}getEntry(e,t){let n=Nt.newInvalidDocument(t);return ui(e).ee({index:La,range:IDBKeyRange.only(Uo(t))},(r,o)=>{n=this.Cr(t,o)}).next(()=>n)}vr(e,t){let n={size:0,document:Nt.newInvalidDocument(t)};return ui(e).ee({index:La,range:IDBKeyRange.only(Uo(t))},(r,o)=>{n={document:this.Cr(t,o),size:mc(o)}}).next(()=>n)}getEntries(e,t){let n=yi();return this.Fr(e,t,(r,o)=>{let a=this.Cr(r,o);n=n.insert(r,a)}).next(()=>n)}Mr(e,t){let n=yi(),r=new wt($.comparator);return this.Fr(e,t,(o,a)=>{let l=this.Cr(o,a);n=n.insert(o,l),r=r.insert(o,mc(a))}).next(()=>({documents:n,Or:r}))}Fr(e,t,n){if(t.isEmpty())return A.resolve();let r=new Ce(g_);t.forEach(h=>r=r.add(h));let o=IDBKeyRange.bound(Uo(r.first()),Uo(r.last())),a=r.getIterator(),l=a.getNext();return ui(e).ee({index:La,range:o},(h,d,_)=>{let w=$.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&g_(l,w)<0;)n(l,null),l=a.getNext();l&&l.isEqual(w)&&(n(l,d),l=a.hasNext()?a.getNext():null),l?_.j(Uo(l)):_.done()}).next(()=>{for(;l;)n(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,o){let a=t.path,l=[a.popLast().toArray(),a.lastSegment(),uc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ui(e).J(IDBKeyRange.bound(l,h,!0)).next(d=>{o?.incrementDocumentReadCount(d.length);let _=yi();for(let w of d){let P=this.Cr($.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);P.isFoundDocument()&&(Mc(t,P)||r.has(P.key))&&(_=_.insert(P.key,P))}return _})}getAllFromCollectionGroup(e,t,n,r){let o=yi(),a=p_(t,n),l=p_(t,Rt.max());return ui(e).ee({index:M_,range:IDBKeyRange.bound(a,l,!0)},(h,d,_)=>{let w=this.Cr($.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);o=o.insert(w.key,w),o.size===r&&_.done()}).next(()=>o)}newChangeBuffer(e){return new Th(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return m_(e).get(Pu).next(t=>(Z(!!t,20021),t))}Dr(e,t){return m_(e).put(Pu,t)}Cr(e,t){if(t){let n=dE(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(he.min())))return n}return Nt.newInvalidDocument(e)}};function P0(i){return new wh(i)}var Th=class extends gc{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new sn(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){let t=[],n=0,r=new Ce((o,a)=>re(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{let l=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,l.readTime)),a.isValidDocument()){let h=Yg(this.Nr.serializer,a);r=r.add(o.path.popLast());let d=mc(h);n+=d-l.size,t.push(this.Nr.addEntry(e,o,h))}else if(n-=l.size,this.trackRemovals){let h=Yg(this.Nr.serializer,a.convertToNoDocument(he.min()));t.push(this.Nr.addEntry(e,o,h))}}),r.forEach(o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Nr.updateMetadata(e,n)),A.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:n,Or:r})=>(r.forEach((o,a)=>{this.Br.set(o,{size:a,readTime:n.get(o).readTime})}),n))}};function m_(i){return Oe(i,rs)}function ui(i){return Oe(i,Ya)}function Uo(i){let e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function p_(i,e){let t=e.documentKey.path.toArray();return[i,uc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function g_(i,e){let t=i.path.toArray(),n=e.path.toArray(),r=0;for(let o=0;o<t.length-2&&o<n.length-2;++o)if(r=re(t[o],n[o]),r)return r;return r=re(t.length,n.length),r||(r=re(t[t.length-2],n[n.length-2]),r||re(t[t.length-1],n[n.length-1]))}var Ch=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var _c=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Jo(n.mutation,r,Mn.empty(),qe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,We()).next(()=>n))}getLocalViewOfDocuments(e,t,n=We()){let r=nn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(o=>{let a=Va();return o.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let n=nn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,We()))}populateOverlays(e,t,n){let r=[];return n.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,n,r){let o=yi(),a=Qo(),l=function(){return Qo()}();return t.forEach((h,d)=>{let _=n.get(d.key);r.has(d.key)&&(_===void 0||_.mutation instanceof jn)?o=o.insert(d.key,d):_!==void 0?(a.set(d.key,_.mutation.getFieldMask()),Jo(_.mutation,d,_.mutation.getFieldMask(),qe.now())):a.set(d.key,Mn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,_)=>a.set(d,_)),t.forEach((d,_)=>l.set(d,new Ch(_,a.get(d)??null))),l))}recalculateAndSaveOverlays(e,t){let n=Qo(),r=new wt((a,l)=>a-l),o=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let l of a)l.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let _=n.get(h)||Mn.empty();_=l.applyToLocalView(d,_),n.set(h,_);let w=(r.get(l.batchId)||We()).add(h);r=r.insert(l.batchId,w)})}).next(()=>{let a=[],l=r.getReverseIterator();for(;l.hasNext();){let h=l.getNext(),d=h.key,_=h.value,w=u0();_.forEach(P=>{if(!o.has(P)){let F=m0(t.get(P),n.get(P));F!==null&&w.set(P,F),o=o.add(P)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,w))}return A.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(a){return $.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Pb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(o=>{let a=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-o.size):A.resolve(nn()),l=ts,h=o;return a.next(d=>A.forEach(d,(_,w)=>(l<w.largestBatchId&&(l=w.largestBatchId),o.get(_)?A.resolve():this.remoteDocumentCache.getEntry(e,_).next(P=>{h=h.insert(_,P)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,We())).next(_=>({batchId:l,changes:Ob(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(n=>{let r=Va();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let o=t.collectionGroup,a=Va();return this.indexManager.getCollectionParents(e,o).next(l=>A.forEach(l,h=>{let d=function(w,P){return new Xr(P,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,r).next(_=>{_.forEach((w,P)=>{a=a.insert(w,P)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,r))).next(a=>{o.forEach((h,d)=>{let _=d.getKey();a.get(_)===null&&(a=a.insert(_,Nt.newInvalidDocument(_)))});let l=Va();return a.forEach((h,d)=>{let _=o.get(h);_!==void 0&&Jo(_.mutation,d,Mn.empty(),qe.now()),Mc(t,d)&&(l=l.insert(h,d))}),l})}};var bh=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return A.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:qt(r.createTime)}}(t)),A.resolve()}getNamedQuery(e,t){return A.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:I0(r.bundledQuery),readTime:qt(r.readTime)}}(t)),A.resolve()}};var Eh=class{constructor(){this.overlays=new wt($.comparator),this.qr=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){let n=nn();return A.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&n.set(r,o)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,o)=>{this.St(e,t,o)}),A.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.qr.get(n);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),A.resolve()}getOverlaysForCollection(e,t,n){let r=nn(),o=t.length+1,a=new $(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){let h=l.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&r.set(h.getKey(),h)}return A.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let o=new wt((d,_)=>d-_),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let _=o.get(d.largestBatchId);_===null&&(_=nn(),o=o.insert(d.largestBatchId,_)),_.set(d.getKey(),d)}}let l=nn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,_)=>l.set(d,_)),!(l.size()>=r)););return A.resolve(l)}St(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let a=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new ds(t,n));let o=this.qr.get(t);o===void 0&&(o=We(),this.qr.set(t,o)),this.qr.set(t,o.add(n.key))}};var Ih=class{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return A.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,A.resolve()}};var ms=class{constructor(){this.Qr=new Ce(Ve.$r),this.Ur=new Ce(Ve.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let n=new Ve(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Ve(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){let t=new $(new Re([])),n=new Ve(t,e),r=new Ve(t,e+1),o=[];return this.Ur.forEachInRange([n,r],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new $(new Re([])),n=new Ve(t,e),r=new Ve(t,e+1),o=We();return this.Ur.forEachInRange([n,r],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new Ve(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Ve=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return $.comparator(e.key,t.key)||re(e.Yr,t.Yr)}static Kr(e,t){return re(e.Yr,t.Yr)||$.comparator(e.key,t.key)}};var Sh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ce(Ve.$r)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new hs(o,t,n,r);this.mutationQueue.push(a);for(let l of r)this.Zr=this.Zr.add(new Ve(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return A.resolve(a)}lookupMutationBatch(e,t){return A.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.ei(n),o=r<0?0:r;return A.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?wi:this.tr-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Ve(t,0),r=new Ve(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,r],a=>{let l=this.Xr(a.Yr);o.push(l)}),A.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ce(re);return t.forEach(r=>{let o=new Ve(r,0),a=new Ve(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],l=>{n=n.add(l.Yr)})}),A.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,o=n;$.isDocumentKey(o)||(o=o.child(""));let a=new Ve(new $(o),0),l=new Ce(re);return this.Zr.forEachWhile(h=>{let d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===r&&(l=l.add(h.Yr)),!0)},a),A.resolve(this.ti(l))}ti(e){let t=[];return e.forEach(n=>{let r=this.Xr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Z(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return A.forEach(t.mutations,r=>{let o=new Ve(r.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){let n=new Ve(t,0),r=this.Zr.firstAfterOrEqual(n);return A.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var xh=class{constructor(e){this.ri=e,this.docs=function(){return new wt($.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),o=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return A.resolve(n?n.document.mutableCopy():Nt.newInvalidDocument(t))}getEntries(e,t){let n=yi();return t.forEach(r=>{let o=this.docs.get(r);n=n.insert(r,o?o.document.mutableCopy():Nt.newInvalidDocument(r))}),A.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let o=yi(),a=t.path,l=new $(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){let{key:d,value:{document:_}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||rd(P_(_),n)<=0||(r.has(_.key)||Mc(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return A.resolve(o)}getAllFromCollectionGroup(e,t,n,r){K(9500)}ii(e,t){return A.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Ah(this)}getSize(e){return A.resolve(this.size)}},Ah=class extends gc{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),A.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var Dh=class{constructor(e){this.persistence=e,this.si=new sn(t=>Ei(t),_s),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this.oi=0,this._i=new ms,this.targetCount=0,this.ai=eo.ur()}forEachTarget(e,t){return this.si.forEach((n,r)=>t(r)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),A.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new eo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.Pr(t),A.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,n){let r=0,o=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),A.waitFor(o).next(()=>r)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){let n=this.si.get(t)||null;return A.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),A.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(a=>{o.push(r.markPotentiallyOrphaned(e,a))}),A.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),A.resolve()}getMatchingKeysForTargetId(e,t){let n=this._i.Hr(t);return A.resolve(n)}containsKey(e,t){return A.resolve(this._i.containsKey(t))}};var yc=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new en(0),this.li=!1,this.li=!0,this.hi=new Ih,this.referenceDelegate=e(this),this.Pi=new Dh(this),this.indexManager=new fh,this.remoteDocumentCache=function(r){return new xh(r)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new lc(t),this.Ii=new bh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Eh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Sh(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){O("MemoryPersistence","Starting transaction:",e);let r=new Nh(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(o=>this.referenceDelegate.di(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ai(e,t){return A.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}},Nh=class extends Ka{constructor(e){super(),this.currentSequenceNumber=e}},vc=class i{constructor(e){this.persistence=e,this.Ri=new ms,this.Vi=null}static mi(e){return new i(e)}get fi(){if(this.Vi)return this.Vi;throw K(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),A.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),A.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.fi,n=>{let r=$.fromPath(n);return this.gi(e,r).next(o=>{o||t.removeEntry(r,he.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return A.or([()=>A.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}};var Rh=class{constructor(e){this.serializer=e}k(e,t,n,r){let o=new Qa("createOrUpgrade",t);n<1&&r>=1&&(function(h){h.createObjectStore(gs)}(e),function(h){h.createObjectStore(is,{keyPath:eb}),h.createObjectStore(Ut,{keyPath:Vg,autoIncrement:!0}).createIndex(_i,zg,{unique:!0}),h.createObjectStore(qr)}(e),__(e),function(h){h.createObjectStore(di)}(e));let a=A.resolve();return n<3&&r>=3&&(n!==0&&(function(h){h.deleteObjectStore(Hr),h.deleteObjectStore(jr),h.deleteObjectStore(Ti)}(e),__(e)),a=a.next(()=>function(h){let d=h.store(Ti),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:he.min().toTimestamp(),targetCount:0};return d.put(Za,_)}(o))),n<4&&r>=4&&(n!==0&&(a=a.next(()=>function(h,d){return d.store(Ut).J().next(w=>{h.deleteObjectStore(Ut),h.createObjectStore(Ut,{keyPath:Vg,autoIncrement:!0}).createIndex(_i,zg,{unique:!0});let P=d.store(Ut),F=w.map(L=>P.put(L));return A.waitFor(F)})}(e,o))),a=a.next(()=>{(function(h){h.createObjectStore($r,{keyPath:lb})})(e)})),n<5&&r>=5&&(a=a.next(()=>this.yi(o))),n<6&&r>=6&&(a=a.next(()=>(function(h){h.createObjectStore(rs)}(e),this.wi(o)))),n<7&&r>=7&&(a=a.next(()=>this.Si(o))),n<8&&r>=8&&(a=a.next(()=>this.bi(e,o))),n<9&&r>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&r>=10&&(a=a.next(()=>this.Di(o))),n<11&&r>=11&&(a=a.next(()=>{(function(h){h.createObjectStore(Pc,{keyPath:ub})})(e),function(h){h.createObjectStore(Vc,{keyPath:hb})}(e)})),n<12&&r>=12&&(a=a.next(()=>{(function(h){let d=h.createObjectStore(zc,{keyPath:yb});d.createIndex(zu,vb,{unique:!1}),d.createIndex(B_,wb,{unique:!1})})(e)})),n<13&&r>=13&&(a=a.next(()=>function(h){let d=h.createObjectStore(Ya,{keyPath:nb});d.createIndex(La,ib),d.createIndex(M_,rb)}(e)).next(()=>this.Ci(e,o)).next(()=>e.deleteObjectStore(di))),n<14&&r>=14&&(a=a.next(()=>this.Fi(e,o))),n<15&&r>=15&&(a=a.next(()=>function(h){h.createObjectStore(ad,{keyPath:db,autoIncrement:!0}).createIndex(Vu,fb,{unique:!1}),h.createObjectStore($o,{keyPath:mb}).createIndex(F_,pb,{unique:!1}),h.createObjectStore(Go,{keyPath:gb}).createIndex(L_,_b,{unique:!1})}(e))),n<16&&r>=16&&(a=a.next(()=>{t.objectStore($o).clear()}).next(()=>{t.objectStore(Go).clear()})),n<17&&r>=17&&(a=a.next(()=>{(function(h){h.createObjectStore(cd,{keyPath:Tb})})(e)})),n<18&&r>=18&&tu()&&(a=a.next(()=>{t.objectStore($o).clear()}).next(()=>{t.objectStore(Go).clear()})),a}wi(e){let t=0;return e.store(di).ee((n,r)=>{t+=mc(r)}).next(()=>{let n={byteSize:t};return e.store(rs).put(Pu,n)})}yi(e){let t=e.store(is),n=e.store(Ut);return t.J().next(r=>A.forEach(r,o=>{let a=IDBKeyRange.bound([o.userId,wi],[o.userId,o.lastAcknowledgedBatchId]);return n.J(_i,a).next(l=>A.forEach(l,h=>{Z(h.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});let d=mi(this.serializer,h);return D0(e,o.userId,d).next(()=>{})}))}))}Si(e){let t=e.store(Hr),n=e.store(di);return e.store(Ti).get(Za).next(r=>{let o=[];return n.ee((a,l)=>{let h=new Re(a),d=function(w){return[0,st(w)]}(h);o.push(t.get(d).next(_=>_?A.resolve():(w=>t.put({targetId:0,path:st(w),sequenceNumber:r.highestListenSequenceNumber}))(h)))}).next(()=>A.waitFor(o))})}bi(e,t){e.createObjectStore(os,{keyPath:cb});let n=t.store(os),r=new fs,o=a=>{if(r.add(a)){let l=a.lastSegment(),h=a.popLast();return n.put({collectionId:l,parent:st(h)})}};return t.store(di).ee({X:!0},(a,l)=>{let h=new Re(a);return o(h.popLast())}).next(()=>t.store(qr).ee({X:!0},([a,l,h],d)=>{let _=tn(l);return o(_.popLast())}))}Di(e){let t=e.store(jr);return t.ee((n,r)=>{let o=jo(r),a=E0(this.serializer,o);return t.put(a)})}Ci(e,t){let n=t.store(di),r=[];return n.ee((o,a)=>{let l=t.store(Ya),h=function(w){return w.document?new $(Re.fromString(w.document.name).popFirst(5)):w.noDocument?$.fromSegments(w.noDocument.path):w.unknownDocument?$.fromSegments(w.unknownDocument.path):K(36783)}(a).path.toArray(),d={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};r.push(l.put(d))}).next(()=>A.waitFor(r))}Fi(e,t){let n=t.store(Ut),r=P0(this.serializer),o=new yc(vc.mi,this.serializer.yt);return n.J().next(a=>{let l=new Map;return a.forEach(h=>{let d=l.get(h.userId)??We();mi(this.serializer,h).keys().forEach(_=>d=d.add(_)),l.set(h.userId,d)}),A.forEach(l,(h,d)=>{let _=new Ge(d),w=hc.wt(this.serializer,_),P=o.getIndexManager(_),F=pc.wt(_,this.serializer,P,o.referenceDelegate);return new _c(r,F,w,P).recalculateAndSaveOverlaysForDocumentKeys(new ss(t,en.ce),h).next()})})}};function __(i){i.createObjectStore(Hr,{keyPath:sb}).createIndex(sd,ab,{unique:!0}),i.createObjectStore(jr,{keyPath:"targetId"}).createIndex(O_,ob,{unique:!0}),i.createObjectStore(Ti)}var zn="IndexedDbPersistence",gu=18e5,_u=5e3,yu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_E="main",Ph=class i{constructor(e,t,n,r,o,a,l,h,d,_,w=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=o,this.window=a,this.document=l,this.xi=d,this.Oi=_,this.Ni=w,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=P=>Promise.resolve(),!i.v())throw new H(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vh(this,r),this.$i=t+_E,this.serializer=new lc(h),this.Ui=new Ur(this.$i,this.Ni,new Rh(this.serializer)),this.hi=new sh,this.Pi=new ph(this.referenceDelegate,this.serializer),this.remoteDocumentCache=P0(this.serializer),this.Ii=new oh,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&vt(zn,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new H(z.FAILED_PRECONDITION,yu);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new en(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=t=>B(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(t=>B(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(()=>B(this,null,function*(){this.started&&(yield this.Wi())})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ma(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Ni(e))return O(zn,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O(zn,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return qo(e).get(Er).next(t=>A.resolve(this.es(t)))}ts(e){return Ma(e).delete(this.clientId)}ns(){return B(this,null,function*(){if(this.isPrimary&&!this.rs(this.qi,gu)){this.qi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=Oe(t,$r);return n.J().next(r=>{let o=this.ss(r,gu),a=r.filter(l=>o.indexOf(l)===-1);return A.forEach(a,l=>n.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ki)for(let t of e)this.Ki.removeItem(this._s(t.clientId))}})}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?A.resolve(!0):qo(e).get(Er).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_u)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new H(z.FAILED_PRECONDITION,yu);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ma(e).J().next(n=>this.ss(n,_u).find(r=>{if(this.clientId!==r.clientId){let o=!this.networkEnabled&&r.networkEnabled,a=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(o||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O(zn,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return B(this,null,function*(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),yield this.Ui.runTransaction("shutdown","readwrite",[gs,$r],e=>{let t=new ss(e,en.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()})}ss(e,t){return e.filter(n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Ma(e).J().next(t=>this.ss(t,gu).map(n=>n.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return pc.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mh(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return hc.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){O(zn,"Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",o=function(h){return h===18?Eb:h===17?H_:h===16?bb:h===15?ld:h===14?j_:h===13?q_:h===12?Cb:h===11?U_:void K(60245)}(this.Ni),a;return this.Ui.runTransaction(e,r,o,l=>(a=new ss(l,this.ci?this.ci.next():en.ce),t==="readwrite-primary"?this.Hi(a).next(h=>!!h||this.Yi(a)).next(h=>{if(!h)throw vt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new H(z.FAILED_PRECONDITION,V_);return n(a)}).next(h=>this.Xi(a).next(()=>h)):this.Is(a).next(()=>n(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Is(e){return qo(e).get(Er).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,_u)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new H(z.FAILED_PRECONDITION,yu)})}Xi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qo(e).put(Er,t)}static v(){return Ur.v()}Zi(e){let t=qo(e);return t.get(Er).next(n=>this.es(n)?(O(zn,"Releasing primary lease."),t.delete(Er)):A.resolve())}rs(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(vt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();let e=/(?:Version|Mobile)\/1[456]/;eu()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{let t=this.Ki?.getItem(this._s(e))!==null;return O(zn,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return vt(zn,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){vt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function qo(i){return Oe(i,gs)}function Ma(i){return Oe(i,$r)}function yE(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}var Vh=class i{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=We(),r=We();for(let o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new i(e,t.fromCache,n,r)}};var zh=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var wc=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return eu()?8:z_(zo())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){let o={result:null};return this.ys(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,t,r,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new zh;return this.Ss(e,t,a).next(l=>{if(o.result=l,this.Vs)return this.bs(e,t,a,l.size)})}).next(()=>o.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Nr()<=ae.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Fo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),A.resolve()):(Nr()<=ae.DEBUG&&O("QueryEngine","Query:",Fo(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Nr()<=ae.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Fo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(t))):A.resolve())}ys(e,t){if(Gg(t))return A.resolve(null);let n=Cn(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Ju(t,null,"F"),n=Cn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{let a=We(...o);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,n).next(h=>{let d=this.Ds(t,l);return this.Cs(t,d,a,h.readTime)?this.ys(e,Ju(t,null,"F")):this.vs(e,d,t,h)}))})))}ws(e,t,n,r){return Gg(t)||r.isEqual(he.min())?A.resolve(null):this.ps.getDocuments(e,n).next(o=>{let a=this.Ds(t,o);return this.Cs(t,a,n,r)?A.resolve(null):(Nr()<=ae.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Fo(t)),this.vs(e,a,t,YC(r,ts)).next(l=>l))})}Ds(e,t){let n=new Ce(zb(e));return t.forEach((r,o)=>{Mc(e,o)&&(n=n.add(o))}),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Ss(e,t,n){return Nr()<=ae.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Fo(t)),this.ps.getDocumentsMatchingQuery(e,t,Rt.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var vE="LocalStore";var kh=class{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new wt(re),this.xs=new sn(o=>Ei(o),_s),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _c(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function V0(i,e,t,n){return new kh(i,e,t,n)}function wE(i,e){return B(this,null,function*(){let t=Ie(i);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(o=>(r=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(o=>{let a=[],l=[],h=We();for(let d of r){a.push(d.batchId);for(let _ of d.mutations)h=h.add(_.key)}for(let d of o){l.push(d.batchId);for(let _ of d.mutations)h=h.add(_.key)}return t.localDocuments.getDocuments(n,h).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:l}))})})})}function TE(i,e){let t=Ie(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let r=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,h,d,_){let w=d.batch,P=w.keys(),F=A.resolve();return P.forEach(L=>{F=F.next(()=>_.getEntry(h,L)).next(G=>{let W=d.docVersions.get(L);Z(W!==null,48541),G.version.compareTo(W)<0&&(w.applyToRemoteDocument(G,d),G.isValidDocument()&&(G.setReadTime(d.commitVersion),_.addEntry(G)))})}),F.next(()=>l.mutationQueue.removeMutationBatch(h,w))}(t,n,e,o).next(()=>o.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let h=We();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(h=h.add(l.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function CE(i){let e=Ie(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function bE(i,e){let t=Ie(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=wi),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}var Tc=class{constructor(){this.activeTargetIds=Ub()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Cc=class{constructor(){this.Mo=new Tc,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Tc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Mh=class{Oo(e){}shutdown(){}};var y_="ConnectivityMonitor",bc=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(y_,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){O(y_,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Oa=null;function Oh(){return Oa===null?Oa=function(){return 268435456+Math.round(2147483648*Math.random())}():Oa++,"0x"+Oa.toString(16)}var vu="RestConnection",EE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Fh=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Ou?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,o){let a=Oh(),l=this.zo(e,t.toUriEncodedString());O(vu,`Sending RPC '${e}' ${a}:`,l,n);let h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,r,o);let{host:d}=new URL(l),_=ug(d);return this.Jo(e,l,h,n,_).then(w=>(O(vu,`Received RPC '${e}' ${a}: `,w),w),w=>{throw nd(vu,`RPC '${e}' ${a} failed with error: `,w,"url: ",l,"request:",n),w})}Ho(e,t,n,r,o,a){return this.Go(e,t,n,r,o)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+to}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,o)=>e[o]=r),n&&n.headers.forEach((r,o)=>e[o]=r)}zo(e,t){let n=EE[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}};var Lh=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var nt="WebChannelConnection",Bh=class extends Fh{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,o){let a=Oh();return new Promise((l,h)=>{let d=new cu;d.setWithCredentials(!0),d.listenOnce(lu.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Oo.NO_ERROR:let w=d.getResponseJson();O(nt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(w)),l(w);break;case Oo.TIMEOUT:O(nt,`RPC '${e}' ${a} timed out`),h(new H(z.DEADLINE_EXCEEDED,"Request time out"));break;case Oo.HTTP_ERROR:let P=d.getStatus();if(O(nt,`RPC '${e}' ${a} failed with status:`,P,"response text:",d.getResponseText()),P>0){let F=d.getResponseJson();Array.isArray(F)&&(F=F[0]);let L=F?.error;if(L&&L.status&&L.message){let G=function(Ae){let le=Ae.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(le)>=0?le:z.UNKNOWN}(L.status);h(new H(G,L.message))}else h(new H(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new H(z.UNAVAILABLE,"Connection failed."));break;default:K(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{O(nt,`RPC '${e}' ${a} completed.`)}});let _=JSON.stringify(r);O(nt,`RPC '${e}' ${a} sending request:`,r),d.send(t,"POST",_,n,15)})}T_(e,t,n){let r=Oh(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=du(),l=hu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,n),h.encodeInitMessageHeaders=!0;let _=o.join("");O(nt,`Creating RPC '${e}' stream ${r}: ${_}`,h);let w=a.createWebChannel(_,h);this.I_(w);let P=!1,F=!1,L=new Lh({Yo:W=>{F?O(nt,`Not sending because RPC '${e}' stream ${r} is closed:`,W):(P||(O(nt,`Opening RPC '${e}' stream ${r} transport.`),w.open(),P=!0),O(nt,`RPC '${e}' stream ${r} sending:`,W),w.send(W))},Zo:()=>w.close()}),G=(W,Ae,le)=>{W.listen(Ae,te=>{try{le(te)}catch(ve){setTimeout(()=>{throw ve},0)}})};return G(w,br.EventType.OPEN,()=>{F||(O(nt,`RPC '${e}' stream ${r} transport opened.`),L.o_())}),G(w,br.EventType.CLOSE,()=>{F||(F=!0,O(nt,`RPC '${e}' stream ${r} transport closed`),L.a_(),this.E_(w))}),G(w,br.EventType.ERROR,W=>{F||(F=!0,nd(nt,`RPC '${e}' stream ${r} transport errored. Name:`,W.name,"Message:",W.message),L.a_(new H(z.UNAVAILABLE,"The operation could not be completed")))}),G(w,br.EventType.MESSAGE,W=>{if(!F){let Ae=W.data[0];Z(!!Ae,16349);let le=Ae,te=le?.error||le[0]?.error;if(te){O(nt,`RPC '${e}' stream ${r} received error:`,te);let ve=te.status,be=function(m){let g=Pe[m];if(g!==void 0)return Jb(g)}(ve),fe=te.message;be===void 0&&(be=z.INTERNAL,fe="Unknown error status: "+ve+" with message "+te.message),F=!0,L.a_(new H(be,fe)),w.close()}else O(nt,`RPC '${e}' stream ${r} received:`,Ae),L.u_(Ae)}}),G(l,uu.STAT_EVENT,W=>{W.stat===Pa.PROXY?O(nt,`RPC '${e}' stream ${r} detected buffering proxy`):W.stat===Pa.NOPROXY&&O(nt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{L.__()},0),L}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function IE(){return typeof window<"u"?window:null}function Ha(){return typeof document<"u"?document:null}function z0(i){return new eh(i,!0)}var Ec=class{constructor(e,t,n=1e3,r=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&O("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var v_="PersistentStream",Uh=class{constructor(e,t,n,r,o,a,l,h){this.Mi=e,this.S_=n,this.b_=r,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ec(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}stop(){return B(this,null,function*(){this.x_()&&(yield this.close(0))})}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}k_(){return B(this,null,function*(){if(this.O_())return this.close(0)})}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return B(this,null,function*(){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(vt(t.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.r_(t)})}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.D_===t&&this.G_(n,r)},n=>{e(()=>{let r=new H(z.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)})})}G_(e,t){let n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{n(()=>this.z_(r))}),this.stream.onMessage(r=>{n(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(()=>B(this,null,function*(){this.state=0,this.start()}))}z_(e){return O(v_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(O(v_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var qh=class extends Uh{constructor(e,t,n,r,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Z(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Z(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=rE(e.writeResults,e.commitTime),n=qt(e.commitTime);return this.listener.na(n,t)}ra(){let e={};e.database=nE(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>cc(this.serializer,n))};this.q_(t)}};var jh=class{},Hh=class extends jh{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new H(z.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,nh(t,n),r,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new H(z.UNKNOWN,o.toString())})}Ho(e,t,n,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,nh(t,n),r,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(z.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},$h=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vt(t),this.aa=!1):O("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Oc="RemoteStore",Gh=class{constructor(e,t,n,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(()=>B(this,null,function*(){Lc(this)&&(O(Oc,"Restarting streams for network reachability change."),yield function(h){return B(this,null,function*(){let d=Ie(h);d.Ea.add(4),yield Fc(d),d.Ra.set("Unknown"),d.Ea.delete(4),yield pd(d)})}(this))}))}),this.Ra=new $h(n,r)}};function pd(i){return B(this,null,function*(){if(Lc(i))for(let e of i.da)yield e(!0)})}function Fc(i){return B(this,null,function*(){for(let e of i.da)yield e(!1)})}function Lc(i){return Ie(i).Ea.size===0}function k0(i,e,t){return B(this,null,function*(){if(!Ni(e))throw e;i.Ea.add(1),yield Fc(i),i.Ra.set("Offline"),t||(t=()=>CE(i.localStore)),i.asyncQueue.enqueueRetryable(()=>B(null,null,function*(){O(Oc,"Retrying IndexedDB access"),yield t(),i.Ea.delete(1),yield pd(i)}))})}function M0(i,e){return e().catch(t=>k0(i,t,e))}function Bc(i){return B(this,null,function*(){let e=Ie(i),t=Hn(e),n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:wi;for(;SE(e);)try{let r=yield bE(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,xE(e,r)}catch(r){yield k0(e,r)}O0(e)&&F0(e)})}function SE(i){return Lc(i)&&i.Ta.length<10}function xE(i,e){i.Ta.push(e);let t=Hn(i);t.O_()&&t.X_&&t.ea(e.mutations)}function O0(i){return Lc(i)&&!Hn(i).x_()&&i.Ta.length>0}function F0(i){Hn(i).start()}function AE(i){return B(this,null,function*(){Hn(i).ra()})}function DE(i){return B(this,null,function*(){let e=Hn(i);for(let t of i.Ta)e.ea(t.mutations)})}function NE(i,e,t){return B(this,null,function*(){let n=i.Ta.shift(),r=Zu.from(n,e,t);yield M0(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),yield Bc(i)})}function RE(i,e){return B(this,null,function*(){e&&Hn(i).X_&&(yield function(n,r){return B(this,null,function*(){if(function(a){return Qb(a)&&a!==z.ABORTED}(r.code)){let o=n.Ta.shift();Hn(n).B_(),yield M0(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,r)),yield Bc(n)}})}(i,e)),O0(i)&&F0(i)})}function PE(i,e){return B(this,null,function*(){let t=Ie(i);e?(t.Ea.delete(2),yield pd(t)):e||(t.Ea.add(2),yield Fc(t),t.Ra.set("Unknown"))})}function Hn(i){return i.fa||(i.fa=function(t,n,r){let o=Ie(t);return o.sa(),new qh(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:AE.bind(null,i),r_:RE.bind(null,i),ta:DE.bind(null,i),na:NE.bind(null,i)}),i.da.push(e=>B(null,null,function*(){e?(i.fa.B_(),yield Bc(i)):(yield i.fa.stop(),i.Ta.length>0&&(O(Oc,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}var Wh=class i{constructor(e,t,n,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=o,this.deferred=new Tn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,o){let a=Date.now()+n,l=new i(e,t,a,r,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function VE(i,e){if(vt("AsyncQueue",`${e}: ${i}`),Ni(i))return new H(z.UNAVAILABLE,`${e}: ${i}`);throw i}var Kh=class{constructor(){this.queries=w_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){let r=Ie(t),o=r.queries;r.queries=w_(),o.forEach((a,l)=>{for(let h of l.Sa)h.onError(n)})})(this,new H(z.ABORTED,"Firestore shutting down"))}};function w_(){return new sn(i=>c0(i),a0)}function zE(i){i.Ca.forEach(e=>{e.next()})}var T_,C_;(C_=T_||(T_={})).Ma="default",C_.Cache="cache";var kE="SyncEngine";var Qh=class{constructor(e,t,n,r,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new sn(l=>c0(l),a0),this.Iu=new Map,this.Eu=new Set,this.du=new wt($.comparator),this.Au=new Map,this.Ru=new ms,this.Vu={},this.mu=new Map,this.fu=eo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};function b_(i,e,t){let n=Ie(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let r=[];n.Tu.forEach((o,a)=>{let l=a.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(a,l){let h=Ie(a);h.onlineState=l;let d=!1;h.queries.forEach((_,w)=>{for(let P of w.Sa)P.va(l)&&(d=!0)}),d&&zE(h)}(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function ME(i,e){return B(this,null,function*(){let t=Ie(i),n=e.batch.batchId;try{let r=yield TE(t.localStore,e);B0(t,n,null),L0(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield gd(t,r)}catch(r){yield Nc(r)}})}function OE(i,e,t){return B(this,null,function*(){let n=Ie(i);try{let r=yield function(a,l){let h=Ie(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let _;return h.mutationQueue.lookupMutationBatch(d,l).next(w=>(Z(w!==null,37113),_=w.keys(),h.mutationQueue.removeMutationBatch(d,w))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,_,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,_)).next(()=>h.localDocuments.getDocuments(d,_))})}(n.localStore,e);B0(n,e,t),L0(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield gd(n,r)}catch(r){yield Nc(r)}})}function L0(i,e){(i.mu.get(e)||[]).forEach(t=>{t.resolve()}),i.mu.delete(e)}function B0(i,e,t){let n=Ie(i),r=n.Vu[n.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function gd(i,e,t){return B(this,null,function*(){let n=Ie(i),r=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((l,h)=>{a.push(n.pu(h,e,t).then(d=>{if((d||t)&&n.isPrimaryClient){let _=d?!d.fromCache:t?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(d){r.push(d);let _=Vh.As(h.targetId,d);o.push(_)}}))}),yield Promise.all(a),n.Pu.H_(r),yield function(h,d){return B(this,null,function*(){let _=Ie(h);try{yield _.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>A.forEach(d,P=>A.forEach(P.Es,F=>_.persistence.referenceDelegate.addReference(w,P.targetId,F)).next(()=>A.forEach(P.ds,F=>_.persistence.referenceDelegate.removeReference(w,P.targetId,F)))))}catch(w){if(!Ni(w))throw w;O(vE,"Failed to update sequence numbers: "+w)}for(let w of d){let P=w.targetId;if(!w.fromCache){let F=_.Ms.get(P),L=F.snapshotVersion,G=F.withLastLimboFreeSnapshotVersion(L);_.Ms=_.Ms.insert(P,G)}}})}(n.localStore,o))})}function FE(i,e){return B(this,null,function*(){let t=Ie(i);if(!t.currentUser.isEqual(e)){O(kE,"User change. New user:",e.toKey());let n=yield wE(t.localStore,e);t.currentUser=e,function(o,a){o.mu.forEach(l=>{l.forEach(h=>{h.reject(new H(z.CANCELLED,a))})}),o.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield gd(t,n.Ls)}})}function LE(i){let e=Ie(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ME.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OE.bind(null,e),e}var BE=(()=>{class i{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return B(this,null,function*(){this.serializer=z0(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)})}Fu(t,n){return null}Mu(t,n){return null}vu(t){return V0(this.persistence,new wc,t.initialUser,this.serializer)}Cu(t){return new yc(vc.mi,this.serializer)}Du(t){return new Cc}terminate(){return B(this,null,function*(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return i.provider={build:()=>new i},i})();var Jh=class i extends BE{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return B(this,null,function*(){yield vf(i.prototype,this,"initialize").call(this,e),yield this.xu.initialize(this,e),yield LE(this.xu.syncEngine),yield Bc(this.xu.remoteStore),yield this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}vu(e){return V0(this.persistence,new wc,e.initialUser,this.serializer)}Fu(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new _h(n,e.asyncQueue,t)}Mu(e,t){let n=new Ru(t,this.persistence);return new Nu(e.asyncQueue,n)}Cu(e){let t=yE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new Ph(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,IE(),Ha(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Cc}};var UE=(()=>{class i{initialize(t,n){return B(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>b_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=FE.bind(null,this.syncEngine),yield PE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Kh}()}createDatastore(t){let n=z0(t.databaseInfo.databaseId),r=function(a){return new Bh(a)}(t.databaseInfo);return function(a,l,h,d){return new Hh(a,l,h,d)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,o,a,l,h){return new Gh(r,o,a,l,h)}(this.localStore,this.datastore,t.asyncQueue,n=>b_(this.syncEngine,n,0),function(){return bc.v()?new bc:new Mh}())}createSyncEngine(t,n){return function(o,a,l,h,d,_,w){let P=new Qh(o,a,l,h,d,_);return w&&(P.gu=!0),P}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return B(this,null,function*(){yield function(n){return B(this,null,function*(){let r=Ie(n);O(Oc,"RemoteStore shutting down."),r.Ea.add(5),yield Fc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()})}}return i.provider={build:()=>new i},i})();var E_="FirestoreClient",Xh=class{constructor(e,t,n,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ge.UNAUTHENTICATED,this.clientId=Ga.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,a=>B(this,null,function*(){O(E_,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,a=>(O(E_,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Tn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>B(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=VE(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function U0(i){let e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}var I_=new Map;var qE="firestore.googleapis.com",S_=!0,Ic=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qE,this.ssl=S_}else this.host=e.host,this.ssl=e.ssl??S_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=A0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pE)throw new H(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=U0(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new H(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new H(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new H(z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Yh=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ic({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ic(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Tu;switch(n.type){case"firstParty":return new Eu(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new H(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return B(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=I_.get(t);n&&(O("ComponentProvider","Removing Datastore"),I_.delete(t),n.terminate())}(this),Promise.resolve()}};var Zh=class i{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new i(this.firestore,e,this._query)}},Ci=class i{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ed(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new i(this.firestore,e,this._key)}toJSON(){return{type:i._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(ps(t,i._jsonSchema))return new i(e,n||null,new $(Re.fromString(t.referencePath)))}};Ci._jsonSchemaVersion="firestore/documentReference/1.0",Ci._jsonSchema={type:ke("string",Ci._jsonSchemaVersion),referencePath:ke("string")};var ed=class i extends Zh{constructor(e,t,n){super(e,t,s0(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ci(this.firestore,null,new $(e))}withConverter(e){return new i(this.firestore,e,this._path)}};var x_="AsyncQueue",Sc=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ec(this,"async_queue_retry"),this._c=()=>{let n=Ha();n&&O(x_,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;let t=Ha();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Ha();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Tn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}lc(){return B(this,null,function*(){if(this.Xu.length!==0){try{yield this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ni(e))throw e;O(x_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}})}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,vt("INTERNAL UNHANDLED ERROR: ",A_(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=Wh.createAndSchedule(this,e,t,n,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&K(47125,{Pc:A_(this.nc)})}verifyOperationInProgress(){}Tc(){return B(this,null,function*(){let e;do e=this.ac,yield e;while(e!==this.ac)})}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function A_(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}var xc=class extends Yh{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Sc,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return B(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Sc(e),this._firestoreClient=void 0,yield e}})}};function jE(i){let e=i._freezeSettings(),t=function(r,o,a,l){return new Mu(r,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,U0(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new Xh(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&function(r){let o=r?._online.build();return{_offline:r?._offline.build(o),_online:o}}(i._componentsProvider))}function q0(i,e){nd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=i._freezeSettings();return HE(i,UE.provider,{build:n=>new Jh(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function HE(i,e,t){if((i=XC(i,xc))._firestoreClient||i._terminated)throw new H(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(i._componentsProvider||i._getSettings().localCache)throw new H(z.FAILED_PRECONDITION,"SDK cache is already specified.");i._componentsProvider={_online:e,_offline:t},jE(i)}var Xo=class i{constructor(e){this._byteString=e}static fromBase64String(e){try{return new i(Tt.fromBase64String(e))}catch(t){throw new H(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new i(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:i._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ps(e,i._jsonSchema))return i.fromBase64String(e.bytes)}};Xo._jsonSchemaVersion="firestore/bytes/1.0",Xo._jsonSchema={type:ke("string",Xo._jsonSchemaVersion),bytes:ke("string")};var Ac=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new H(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ke(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Yo=class i{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new H(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new H(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:i._jsonSchemaVersion}}static fromJSON(e){if(ps(e,i._jsonSchema))return new i(e.latitude,e.longitude)}};Yo._jsonSchemaVersion="firestore/geoPoint/1.0",Yo._jsonSchema={type:ke("string",Yo._jsonSchemaVersion),latitude:ke("number"),longitude:ke("number")};var Zo=class i{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==r[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:i._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ps(e,i._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new i(e.vectorValues);throw new H(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Zo._jsonSchemaVersion="firestore/vectorValue/1.0",Zo._jsonSchema={type:ke("string",Zo._jsonSchemaVersion),vectorValues:ke("object")};var $E=new RegExp("[~\\*/\\[\\]]");function GE(i,e,t){if(e.search($E)>=0)throw D_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new Ac(...e.split("."))._internalPath}catch{throw D_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function D_(i,e,t,n,r){let o=n&&!n.isEmpty(),a=r!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${n}`),a&&(h+=` in document ${r}`),h+=")"),new H(z.INVALID_ARGUMENT,l+i+h)}var Dc=class{constructor(e,t,n,r,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ci(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new td(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(j0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},td=class extends Dc{data(){return super.data()}};function j0(i,e){return typeof e=="string"?GE(i,e):e instanceof Ac?e._internalPath:e._delegate._internalPath}var kr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Or=class i extends Dc{constructor(e,t,n,r,o,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Fr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(j0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=i._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Or._jsonSchemaVersion="firestore/documentSnapshot/1.0",Or._jsonSchema={type:ke("string",Or._jsonSchemaVersion),bundleSource:ke("string","DocumentSnapshot"),bundleName:ke("string"),bundle:ke("string")};var Fr=class extends Or{data(e={}){return super.data(e)}},es=class i{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new kr(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Fr(this._firestore,this._userDataWriter,n.key,n,new kr(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new H(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>{let h=new Fr(r._firestore,r._userDataWriter,l.doc.key,l.doc,new kr(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let h=new Fr(r._firestore,r._userDataWriter,l.doc.key,l.doc,new kr(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),d=-1,_=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),_=a.indexOf(l.doc.key)),{type:WE(l.type),doc:h,oldIndex:d,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=i._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ga.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],n=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function WE(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K(61501,{type:i})}}es._jsonSchemaVersion="firestore/querySnapshot/1.0",es._jsonSchema={type:ke("string",es._jsonSchemaVersion),bundleSource:ke("string","QuerySnapshot"),bundleName:ke("string"),bundle:ke("string")};(function(e,t=!0){(function(r){to=r})(wg),ko(new Rn("firestore",(n,{instanceIdentifier:r,options:o})=>{let a=n.getProvider("app").getImmediate(),l=new xc(new Cu(n.getProvider("auth-internal")),new Iu(a,n.getProvider("app-check-internal")),function(d,_){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new as(d.options.projectId,_)}(a,r),a);return o=we({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Cr(Sg,xg,e),Cr(Sg,xg,"esm2020")})();var Ri=class Ri{constructor(){this.firestore=N(Ys)}getCollection(e){return Zs(this.firestore,e)}getDocument(e,t){return Xi(this.firestore,e,t)}addDocument(e,t){let n=this.getCollection(e);return qm(n,t).then(r=>r.id)}setDocument(e,t,n){let r=this.getDocument(e,t);return So(r,n)}updateDocument(e,t,n){let r=this.getDocument(e,t);return Wm(r,n)}deleteDocument(e,t){let n=this.getDocument(e,t);return jm(n)}getDocumentData(e,t){let n=this.getDocument(e,t);return Um(n).pipe(at(r=>r||null))}getDocumentOnce(e,t){let n=this.getDocument(e,t);return Yi(n).then(r=>r.exists()?r.data():null)}getDocumentSnapshots(e,t){let n=this.getDocument(e,t);return Io(n).pipe(at(r=>r.exists()?r:null))}getCollectionData(e,t){let n=this.getCollection(e),r=t?t(n):n;return ut(r)}getCollectionDataWithId(e,t,n){let r=this.getCollection(e),o=n?n(r):r;return ut(o,{idField:t})}getCollectionOnce(e,t){let n=this.getCollection(e),r=t?t(n):n;return ea(r).then(o=>o.docs.map(a=>we({id:a.id},a.data())))}queryCollection(e,t){let n=this.getCollection(e),r=Bt(n,...t);return ut(r)}queryCollectionOnce(e,t){let n=this.getCollection(e),r=Bt(n,...t);return ea(r).then(o=>o.docs.map(a=>we({id:a.id},a.data())))}listenToDocument(e,t,n){let r=this.getDocument(e,t);return ri(r,o=>{n(o.exists()?o.data():null)})}listenToCollection(e,t,n){let r=this.getCollection(e),o=n?n(r):r;return ri(o,a=>{let l=a.docs.map(h=>we({id:h.id},h.data()));t(l)})}documentExists(e,t){let n=this.getDocument(e,t);return Yi(n).then(r=>r.exists())}getCollectionCount(e,t){let n=this.getCollection(e),r=t?t(n):n;return ea(r).then(o=>o.size)}addDocuments(e,t){let n=t.map(r=>this.addDocument(e,r));return Promise.all(n)}deleteDocuments(e,t){let n=t.map(r=>this.deleteDocument(e,r));return Promise.all(n).then(()=>{})}documentExists$(e,t){let n=this.getDocument(e,t);return Io(n).pipe(at(r=>r.exists()))}generateDocumentId(){return Xi(Zs(this.firestore,"_temp")).id}addDocumentIfNotExists(e,t,n){return B(this,null,function*(){return(yield this.documentExists(e,t))?!1:(yield this.setDocument(e,t,n),!0)})}getCollectionSnapshotChanges(e,t){let n=this.getCollection(e),r=t?t(n):n;return new un(o=>ri(r,a=>{let l=a.docChanges().map(h=>({type:h.type,doc:h.doc,oldIndex:h.oldIndex,newIndex:h.newIndex}));o.next(l)}))}getCollectionSnapshotChangesWithId(e,t){let n=this.getCollection(e),r=t?t(n):n;return new un(o=>ri(r,a=>{let l=a.docs.map(h=>we({id:h.id},h.data()));o.next(l)}))}getCollectionStateChanges(e,t=["added","modified","removed"],n){let r=this.getCollection(e),o=n?n(r):r;return new un(a=>ri(o,l=>{let h=l.docChanges().filter(d=>t.includes(d.type)).map(d=>({type:d.type,doc:d.doc,oldIndex:d.oldIndex,newIndex:d.newIndex}));a.next(h)}))}getCollectionAuditTrail(e,t){let n=this.getCollection(e),r=t?t(n):n,o=[];return new un(a=>ri(r,l=>{let h=l.docChanges().map(d=>({type:d.type,doc:d.doc,oldIndex:d.oldIndex,newIndex:d.newIndex}));o=[...o,...h],a.next(o)}))}getDynamicQuery(e,t,n){return t.pipe(Ct(r=>{let o=this.getCollection(e),a=n(r,o);return ut(a)}))}getCompoundQuery(e,t){let n=this.getCollection(e),r=[];Object.entries(t).forEach(([a,l])=>{l!=null&&r.push(xo(a,"==",l))});let o=Bt(n,...r);return ut(o)}getPaginatedQuery(e,t,n,r){let o=this.getCollection(e),a=r?r(o):o;return n?a=Bt(a,Pl(n),mn(t)):a=Bt(a,mn(t)),ut(a)}getSubCollection(e,t,n,r){let o=this.getDocument(e,t),a=Zs(o,n),l=r?r(a):a;return ut(l)}getCollectionGroup(e,t){let n=this.getCollection(e),r=t?t(n):n;return ut(r)}batchWrite(e){return B(this,null,function*(){let t=e.map(n=>{switch(n.type){case"set":return this.setDocument(n.collectionName,n.documentId,n.data);case"update":return this.updateDocument(n.collectionName,n.documentId,n.data);case"delete":return this.deleteDocument(n.collectionName,n.documentId);default:throw new Error(`Unknown operation type: ${n.type}`)}});yield Promise.all(t)})}runTransaction(e){return B(this,null,function*(){return e({})})}getDocumentField(e,t,n){let r=this.getDocument(e,t);return Io(r).pipe(at(o=>o.exists()?o.get(n):null))}hasDocumentField(e,t,n){let r=this.getDocument(e,t);return Io(r).pipe(at(o=>o.exists()?o.get(n)!==void 0:!1))}createWhereQuery(e,t,n){return xo(e,t,n)}createOrderByQuery(e,t="asc"){return ta(e,t)}createLimitQuery(e){return mn(e)}createStartAfterQuery(e){return Pl(e)}createStartAtQuery(...e){return Gm(...e)}createEndAtQuery(...e){return Hm(...e)}createEndBeforeQuery(...e){return $m(...e)}searchDocuments(e,t,n){let r=this.getCollection(e),o=Bt(r,xo(t,">=",n),xo(t,"<=",n+"\uF8FF"),mn(20));return ut(o)}getLatestDocuments(e,t="createdAt",n=10){let r=this.getCollection(e),o=Bt(r,ta(t,"desc"),mn(n));return ut(o)}getRandomDocuments(e,t=10){let n=this.getCollection(e),r=Bt(n,ta("createdAt","desc"),mn(t));return ut(r)}isCollectionEmpty(e){let t=this.getCollection(e),n=Bt(t,mn(1));return ut(n).pipe(at(r=>r.length===0))}getCollectionStats(e){let t=this.getCollection(e),n=Bt(t,mn(1e3));return ut(n).pipe(at(r=>({total:r.length,empty:r.length===0})))}enableOfflineCache(){return q0(this.firestore)}};Ri.\u0275fac=function(t){return new(t||Ri)},Ri.\u0275prov=bt({token:Ri,factory:Ri.\u0275fac,providedIn:"root"});var H0=Ri;export{Lp as a,$l as b,Zp as c,BT as d,tR as e,DR as f,Aa as g,RR as h,Op as i,Fp as j,_p as k};

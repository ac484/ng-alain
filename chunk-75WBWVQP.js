import{a as X}from"./chunk-6AOWKASD.js";import"./chunk-KNP3MJAK.js";import"./chunk-ERNLQ6N4.js";import"./chunk-VAGS5EVQ.js";import{a as le,b as se}from"./chunk-NJ7DRAUT.js";import{d as Ut,f as Zt}from"./chunk-L3HMFE5E.js";import"./chunk-5UL4OGVR.js";import{f as ge,k as he}from"./chunk-RSNPD6EB.js";import{c as pe,f as ue,h as de,j as me,k as fe,l as ze,n as _e}from"./chunk-QXXECWUW.js";import"./chunk-CKQ6FBZR.js";import"./chunk-NMCFBNRY.js";import"./chunk-F7UE2Z2N.js";import"./chunk-GFX7JDKS.js";import"./chunk-OTGL7XGI.js";import"./chunk-5NDUH4BM.js";import"./chunk-7INLARAR.js";import"./chunk-3LZSSZ2Q.js";import{d as ie,g as oe,m as re,o as ae,y as ce}from"./chunk-4AYNG3KP.js";import"./chunk-Q6QAL4XK.js";import"./chunk-2HVL4WVD.js";import"./chunk-ZDNPLYMC.js";import"./chunk-KR7JNVYJ.js";import{t as ut}from"./chunk-H53TJUCR.js";import"./chunk-QBQXGPEE.js";import{d as ne}from"./chunk-QRKJYL4P.js";import"./chunk-JE6KLO7C.js";import"./chunk-W5FC2PZ7.js";import"./chunk-TPNYXQ4U.js";import{h as Kt,q as te,s as ee,t as Y}from"./chunk-5PLKKHJ2.js";import{Nc as B,Oc as O,Pc as Jt,a as q,aa as pt,e as qt,ea as Yt,f as jt,ga as Xt,o as j}from"./chunk-Z6UJEHZN.js";import{q as st,y as $t}from"./chunk-KF7OGFLI.js";import{Aa as u,Ac as Pt,Ba as d,Cc as S,Dc as x,Dd as ct,Ec as w,Fa as xt,Fb as C,Fc as rt,Ga as nt,Gb as Ft,Hc as Ht,Hd as lt,Ic as D,Kc as L,Lb as v,Mc as Rt,Nc as _,Ob as R,Oc as Lt,Pb as It,Pc as M,R as yt,Ra as wt,Sc as A,Tc as Q,Uc as G,_b as F,ac as I,b as ht,cc as Nt,dc as kt,dd as At,ec as Et,fc as s,g as Ct,ga as vt,gc as a,hc as c,ic as z,kd as b,mc as Bt,nb as Mt,nc as Ot,oa as Tt,oc as ot,pa as Dt,pc as T,pd as $,q as bt,qd as Qt,r as et,rd as Gt,sa as St,sb as l,ta as h,ud as Wt,vc as f,vd as y,yb as it,yc as m,yd as at,zc as Vt}from"./chunk-IDL4MXQM.js";import{a as _t,b as gt,g as tt,i as W}from"./chunk-57BLH6QZ.js";function Se(i,o){}function xe(i,o){if(i&1&&(a(0,"div",2),v(1,Se,0,0,"ng-template",4),c()),i&2){let t=m(2);l(),s("ngTemplateOutlet",t.nzIcon)}}function we(i,o){if(i&1&&(Bt(0),_(1),Ot()),i&2){let t=m(3);l(),M(" ",t.nzDescription," ")}}function Me(i,o){if(i&1&&(a(0,"div",3),v(1,we,2,1,"ng-container",5),c()),i&2){let t=m(2);l(),s("nzStringTemplateOutlet",t.nzDescription)}}function Fe(i,o){if(i&1&&(F(0,xe,2,1,"div",2),F(1,Me,2,1,"div",3)),i&2){let t=m();I(t.nzIcon?0:-1),l(),I(t.nzDescription&&t.nzShape==="square"?1:-1)}}function Ie(i,o){i&1&&(a(0,"div",2),z(1,"nz-icon",6),c())}function Ne(i,o){if(i&1){let t=T();a(0,"a",2),f("click",function(){u(t);let n=m();return d(n.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();L("ant-float-btn-default",t.nzType==="default"),s("target",t.nzTarget)("href",t.nzHref,Mt)("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}function ke(i,o){if(i&1){let t=T();a(0,"button",4),f("click",function(){u(t);let n=m();return d(n.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();L("ant-float-btn-default",t.nzType==="default"),s("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}var Ee=["backTop"];function Be(i,o){i&1&&z(0,"nz-icon",3)}var Oe=["*"];function Ve(i,o){i&1&&ot(0)}function Pe(i,o){if(i&1&&v(0,Ve,1,0,"ng-container",2),i&2){m();let t=D(3);s("ngTemplateOutlet",t)}}function He(i,o){i&1&&ot(0)}function Re(i,o){if(i&1&&(a(0,"div",3),v(1,He,1,0,"ng-container",2),c()),i&2){m(2);let t=D(3);s("@fadeMotion",void 0),l(),s("ngTemplateOutlet",t)}}function Le(i,o){if(i&1){let t=T();F(0,Re,2,2,"div",3),a(1,"nz-float-button",4),f("nzOnClick",function(){u(t);let n=m();return d(n.open()?n.clickCloseMenu():n.clickOpenMenu())})("mouseover",function(){u(t);let n=m();return d(n.hoverOpenMenu())}),c()}if(i&2){let t=m(),e=D(5);I(t.open()?0:-1),l(),s("nzType",t.nzType())("nzIcon",t.open()?e:t.nzIcon())("nzShape",t.nzShape())("nzDescription",t.open()?null:t.nzDescription())}}function Ae(i,o){i&1&&Pt(0)}function Qe(i,o){i&1&&z(0,"nz-icon",5)}var Ce=(()=>{class i{nzIcon=null;nzDescription=null;nzShape="circle";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["nz-float-button-content"]],inputs:{nzIcon:"nzIcon",nzDescription:"nzDescription",nzShape:"nzShape"},exportAs:["nzFloatButtonContent"],decls:4,vars:1,consts:[[1,"ant-float-btn-body"],[1,"ant-float-btn-content"],[1,"ant-float-btn-icon"],[1,"ant-float-btn-description"],[3,"ngTemplateOutlet"],[4,"nzStringTemplateOutlet"],["nzType","file-text","nzTheme","outline"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1),F(2,Fe,2,2)(3,Ie,2,0,"div",2),c()()),e&2&&(l(2),I(n.nzDescription||n.nzIcon?2:3))},dependencies:[O,B,st,Jt],encapsulation:2,changeDetection:0})}return i})(),N=(()=>{class i{directionality=h(j);cdr=h(ct);destroyRef=h(nt);nzHref=null;nzTarget=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzOnClick=new R;dir="ltr";constructor(){this.dir=this.directionality.value}ngOnInit(){this.directionality.change?.pipe(q(this.destroyRef)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["nz-float-button"]],hostAttrs:[1,"ant-float-btn"],hostVars:6,hostBindings:function(e,n){e&2&&L("ant-float-btn-circle",n.nzShape==="circle")("ant-float-btn-square",n.nzShape==="square")("ant-float-btn-rtl",n.dir==="rtl")},inputs:{nzHref:"nzHref",nzTarget:"nzTarget",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription"},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButton"],decls:2,vars:1,consts:[["nz-button","",1,"ant-float-btn-inner",3,"target","href","nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"click","target","href","nzType"],[3,"nzIcon","nzDescription","nzShape"],["nz-button","",1,"ant-float-btn-inner",3,"click","nzType"]],template:function(e,n){e&1&&F(0,Ne,2,8,"a",0)(1,ke,2,6,"button",1),e&2&&I(n.nzHref?0:1)},dependencies:[Y,ee,Kt,te,Ce],encapsulation:2,changeDetection:0})}return i})(),Ge="backTop",We=jt({passive:!0}),dt=(()=>{var e;let i,o=[],t=[];return e=class{nzConfigService=h(Yt);scrollSrv=h(ne);platform=h(qt);ngZone=h(It);cdr=h(ct);directionality=h(j);destroyRef=h(nt);_nzModuleName=Ge;scrollListenerDestroy$=new Ct;target=null;visible=!1;dir="ltr";nzHref=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzTemplate;nzVisibilityHeight=et(this,o,400);nzTarget=et(this,t);nzDuration=450;nzOnClick=new R;set backTop(r){r&&(this.backTopClickSubscription.unsubscribe(),this.backTopClickSubscription=pt(r.nativeElement,"click").pipe(q(this.destroyRef)).subscribe(()=>{this.scrollSrv.scrollTo(this.getTarget(),0,{duration:this.nzDuration}),this.nzOnClick.observers.length&&this.ngZone.run(()=>this.nzOnClick.emit(!0))}))}doc=h(xt);backTopClickSubscription=ht.EMPTY;constructor(){this.destroyRef.onDestroy(()=>{this.scrollListenerDestroy$.next(),this.scrollListenerDestroy$.complete()})}ngOnInit(){this.registerScrollEvent(),this.dir=this.directionality.value,this.directionality.change?.pipe(q(this.destroyRef)).subscribe(r=>{this.dir=r,this.cdr.detectChanges()})}getTarget(){return this.target||window}handleScroll(){this.visible!==this.scrollSrv.getScroll(this.getTarget())>this.nzVisibilityHeight&&(this.visible=!this.visible,this.cdr.detectChanges())}registerScrollEvent(){this.platform.isBrowser&&(this.scrollListenerDestroy$.next(),this.handleScroll(),pt(this.getTarget(),"scroll",We).pipe(yt(50),vt(this.scrollListenerDestroy$)).subscribe(()=>this.handleScroll()))}detectChanges(){this.cdr.detectChanges()}ngOnChanges(r){let{nzTarget:p}=r;p&&(this.target=typeof this.nzTarget=="string"?this.doc.querySelector(this.nzTarget):this.nzTarget,this.registerScrollEvent())}},(()=>{let r=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[Xt()],bt(null,null,i,{kind:"field",name:"nzVisibilityHeight",static:!1,private:!1,access:{has:p=>"nzVisibilityHeight"in p,get:p=>p.nzVisibilityHeight,set:(p,g)=>{p.nzVisibilityHeight=g}},metadata:r},o,t),r&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),tt(e,"\u0275fac",function(p){return new(p||e)}),tt(e,"\u0275cmp",C({type:e,selectors:[["nz-float-button-top"]],viewQuery:function(p,g){if(p&1&&S(Ee,5),p&2){let E;x(E=w())&&(g.backTop=E.first)}},hostAttrs:[1,"ant-float-btn","ant-float-btn-top"],hostVars:8,hostBindings:function(p,g){p&2&&L("ant-float-btn-circle",g.nzShape==="circle")("ant-float-btn-hidden",!g.visible)("ant-float-btn-square",g.nzShape==="square")("ant-float-btn-rtl",g.dir==="rtl")},inputs:{nzHref:"nzHref",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription",nzTemplate:"nzTemplate",nzVisibilityHeight:[2,"nzVisibilityHeight","nzVisibilityHeight",lt],nzTarget:"nzTarget",nzDuration:[2,"nzDuration","nzDuration",lt]},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButtonTop"],features:[wt],decls:5,vars:6,consts:[["backTop",""],["top",""],[3,"nzIcon","nzDescription","nzHref","nzType","nzShape"],["nzType","vertical-align-top","nzTheme","outline"]],template:function(p,g){if(p&1&&(a(0,"div",null,0),z(2,"nz-float-button",2),v(3,Be,1,0,"ng-template",null,1,b),c()),p&2){let E=D(4);s("@fadeMotion",void 0),l(2),s("nzIcon",g.nzIcon||E)("nzDescription",g.nzDescription)("nzHref",g.nzHref)("nzType",g.nzType)("nzShape",g.nzShape)}},dependencies:[N,O,B],encapsulation:2,data:{animation:[ut]},changeDetection:0})),e})(),mt=(()=>{class i{nzFloatButtonComponents=at(N);nzFloatButtonTopComponents=at(dt);nzHref=y(null);nzTarget=y(null);nzType=y("default");nzIcon=y(null);nzDescription=y(null);nzShape=y("circle");nzTrigger=y(null);nzOpen=y(null);nzPlacement=y("top");nzOnOpenChange=Wt();dir=h(j).valueSignal;open=Gt(()=>!!this.nzOpen());isMenuMode=$(()=>!!this.nzTrigger()&&["click","hover"].includes(this.nzTrigger()));isControlledMode=$(()=>this.nzOpen()!==null);class=$(()=>{let t=this.nzShape(),e=this.dir(),n=["ant-float-btn-group",this.generateClass(t)];return this.isMenuMode()?n.push(this.generateClass(this.nzPlacement())):n.push(this.generateClass(`${t}-shadow`)),e==="rtl"&&n.push(this.generateClass(e)),n});constructor(){Qt(()=>{this.nzFloatButtonComponents()&&this.nzFloatButtonComponents().forEach(t=>{t.nzShape=this.nzShape()}),this.nzFloatButtonTopComponents()&&this.nzFloatButtonTopComponents().forEach(t=>{t.nzShape=this.nzShape(),t.detectChanges()})})}clickOpenMenu(){this.handleEvent("click",!0)}hoverOpenMenu(){this.handleEvent("hover",!0)}clickCloseMenu(){this.handleEvent("click",!1)}hoverCloseMenu(){this.handleEvent("hover",!1)}handleEvent(t,e){this.nzTrigger()!==t||this.isControlledMode()||this.open()===e||(this.open.set(e),this.nzOnOpenChange.emit(e))}generateClass(t){return`ant-float-btn-group-${t}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["nz-float-button-group"]],contentQueries:function(e,n,r){e&1&&(rt(r,n.nzFloatButtonComponents,N,4),rt(r,n.nzFloatButtonTopComponents,dt,4)),e&2&&Ht(2)},hostVars:2,hostBindings:function(e,n){e&1&&f("mouseleave",function(){return n.hoverCloseMenu()}),e&2&&Rt(n.class())},inputs:{nzHref:[1,"nzHref"],nzTarget:[1,"nzTarget"],nzType:[1,"nzType"],nzIcon:[1,"nzIcon"],nzDescription:[1,"nzDescription"],nzShape:[1,"nzShape"],nzTrigger:[1,"nzTrigger"],nzOpen:[1,"nzOpen"],nzPlacement:[1,"nzPlacement"]},outputs:{nzOnOpenChange:"nzOnOpenChange"},exportAs:["nzFloatButtonGroup"],ngContentSelectors:Oe,decls:6,vars:1,consts:[["menu",""],["close",""],[4,"ngTemplateOutlet"],[1,"ant-float-btn-group-wrap"],[1,"ant-float-btn-group-trigger",3,"nzOnClick","mouseover","nzType","nzIcon","nzShape","nzDescription"],["nzType","close","nzTheme","outline"]],template:function(e,n){e&1&&(Vt(),F(0,Pe,1,1,"ng-container")(1,Le,2,5),v(2,Ae,1,0,"ng-template",null,0,b)(4,Qe,1,0,"ng-template",null,1,b)),e&2&&I(n.isMenuMode()?1:0)},dependencies:[N,O,B,st],encapsulation:2,data:{animation:[ut]},changeDetection:0})}return i})(),be=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=Ft({type:i});static \u0275inj=Dt({imports:[N,mt,dt,Ce]})}return i})();var qe=["upIcon"],je=["downIcon"],Ye=["leftIcon"],Xe=["rightIcon"],Ue=["commentIcon"],Ze=(i,o)=>({x:i,y:o});function Je(i,o){i&1&&z(0,"nz-icon",8)}function Ke(i,o){i&1&&z(0,"nz-icon",9)}function tn(i,o){i&1&&z(0,"nz-icon",10)}function en(i,o){i&1&&z(0,"nz-icon",11)}function nn(i,o){i&1&&z(0,"nz-icon",12)}var V=class V{constructor(){this.dragX=0;this.dragY=0;this.smartPlacement="top";this.currentX=0;this.currentY=0;this.onAction=new R}get currentIcon(){return{top:this.upIcon,bottom:this.downIcon,left:this.leftIcon,right:this.rightIcon}[this.smartPlacement]}onDragMove(o){let t=o.source.element.nativeElement.getBoundingClientRect();this.currentX=t.left,this.currentY=t.top,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}onDragEnd(o){this.dragX=o.source.getFreeDragPosition().x,this.dragY=o.source.getFreeDragPosition().y,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}calculateSmartPlacement(o,t){let e=window.innerWidth,n=window.innerHeight,r=56,p=o+r/2,g=t+r/2,E=e/2,Te=n/2,ft=p-E,zt=g-Te;return Math.abs(ft)>Math.abs(zt)?ft>0?"left":"right":zt>0?"top":"bottom"}openChange(o){}};V.\u0275fac=function(t){return new(t||V)},V.\u0275cmp=C({type:V,selectors:[["app-fab"]],viewQuery:function(t,e){if(t&1&&(S(qe,7),S(je,7),S(Ye,7),S(Xe,7),S(Ue,7)),t&2){let n;x(n=w())&&(e.upIcon=n.first),x(n=w())&&(e.downIcon=n.first),x(n=w())&&(e.leftIcon=n.first),x(n=w())&&(e.rightIcon=n.first),x(n=w())&&(e.commentIcon=n.first)}},outputs:{onAction:"onAction"},decls:13,vars:7,consts:[["upIcon",""],["downIcon",""],["leftIcon",""],["rightIcon",""],["commentIcon",""],["cdkDrag","",1,"fab-drag-anchor",3,"cdkDragEnded","cdkDragMoved","cdkDragFreeDragPosition"],["nzType","primary","nzTrigger","click",3,"nzOnOpenChange","nzIcon","nzPlacement"],[3,"click","nzIcon"],["nzType","up","nzTheme","outline"],["nzType","down","nzTheme","outline"],["nzType","left","nzTheme","outline"],["nzType","right","nzTheme","outline"],["nzType","plus","nzTheme","outline"]],template:function(t,e){if(t&1){let n=T();a(0,"div",5),f("cdkDragEnded",function(p){return u(n),d(e.onDragEnd(p))})("cdkDragMoved",function(p){return u(n),d(e.onDragMove(p))}),a(1,"nz-float-button-group",6),f("nzOnOpenChange",function(p){return u(n),d(e.openChange(p))}),a(2,"nz-float-button",7),f("click",function(){return u(n),d(e.onAction.emit("add"))}),c()(),v(3,Je,1,0,"ng-template",null,0,b)(5,Ke,1,0,"ng-template",null,1,b)(7,tn,1,0,"ng-template",null,2,b)(9,en,1,0,"ng-template",null,3,b)(11,nn,1,0,"ng-template",null,4,b),c()}if(t&2){let n=D(12);s("cdkDragFreeDragPosition",At(4,Ze,e.dragX,e.dragY)),l(),s("nzIcon",e.currentIcon)("nzPlacement",e.smartPlacement),l(),s("nzIcon",n)}},dependencies:[be,N,mt,O,B,Zt,Ut],styles:[".fab-drag-anchor[_ngcontent-%COMP%]{position:fixed;z-index:1000;right:32px;bottom:32px;cursor:grab;-webkit-user-select:none;user-select:none}.fab-drag-anchor[_ngcontent-%COMP%]:active{cursor:grabbing}nz-float-button-group[_ngcontent-%COMP%]{position:absolute}"]});var Z=V;var k=class k{constructor(o){this.hubCrud=o}list(){return this.hubCrud.useCollection("hub_contract")}add(o){return this.hubCrud.add("hub_contract",o)}update(o,t){return this.hubCrud.update("hub_contract",o,t)}delete(o){return this.hubCrud.delete("hub_contract",o)}};k.\u0275fac=function(t){return new(t||k)(St(X))},k.\u0275prov=Tt({token:k,factory:k.\u0275fac,providedIn:"root"});var J=k;function an(i,o){if(i&1){let t=T();a(0,"tr",3)(1,"td"),_(2),c(),a(3,"td")(4,"div",4),_(5),c()(),a(6,"td")(7,"div",5),f("click",function(){let n=u(t).$implicit,r=m();return d(r.startEdit(n.key))}),_(8),c(),a(9,"input",6),G("ngModelChange",function(n){let r=u(t).$implicit;return Q(r.contractName,n)||(r.contractName=n),d(n)}),f("blur",function(){let n=u(t).$implicit,r=m();return d(r.stopEdit(n))}),c()(),a(10,"td")(11,"div",5),f("click",function(){let n=u(t).$implicit,r=m();return d(r.startEdit(n.key))}),_(12),c(),a(13,"input",6),G("ngModelChange",function(n){let r=u(t).$implicit;return Q(r.contractCode,n)||(r.contractCode=n),d(n)}),f("blur",function(){let n=u(t).$implicit,r=m();return d(r.stopEdit(n))}),c()(),a(14,"td")(15,"div",5),f("click",function(){let n=u(t).$implicit,r=m();return d(r.startEdit(n.key))}),_(16),c(),a(17,"input",6),G("ngModelChange",function(n){let r=u(t).$implicit;return Q(r.feeCode,n)||(r.feeCode=n),d(n)}),f("blur",function(){let n=u(t).$implicit,r=m();return d(r.stopEdit(n))}),c()(),a(18,"td")(19,"div",5),f("click",function(){let n=u(t).$implicit,r=m();return d(r.startEdit(n.key))}),_(20),c(),a(21,"input",7),G("ngModelChange",function(n){let r=u(t).$implicit;return Q(r.amount,n)||(r.amount=n),d(n)}),f("blur",function(){let n=u(t).$implicit,r=m();return d(r.stopEdit(n))}),c()(),a(22,"td")(23,"a",8),f("nzOnConfirm",function(){let n=u(t).$implicit,r=m();return d(r.deleteRow(n.key))}),_(24,"\u522A\u9664"),c()()()}if(i&2){let t=o.$implicit,e=m();l(2),Lt(t.contractSerial),l(3),M(" ",t.client," "),l(2),s("hidden",e.editId===t.key),l(),M(" ",t.contractName," "),l(),s("hidden",e.editId!==t.key),A("ngModel",t.contractName),l(2),s("hidden",e.editId===t.key),l(),M(" ",t.contractCode," "),l(),s("hidden",e.editId!==t.key),A("ngModel",t.contractCode),l(2),s("hidden",e.editId===t.key),l(),M(" ",t.feeCode," "),l(),s("hidden",e.editId!==t.key),A("ngModel",t.feeCode),l(2),s("hidden",e.editId===t.key),l(),M(" ",t.amount," "),l(),s("hidden",e.editId!==t.key),A("ngModel",t.amount)}}var P=class P{constructor(o,t){this.contractService=o;this.hubCrud=t;this.contracts=[];this.editId=null;this.clients=[]}ngOnInit(){this.refresh(),this.hubCrud.getClientsSettings().then(o=>{this.clients=o?.list||[]})}refresh(){this.contractService.list().subscribe(o=>this.contracts=o)}addRow(){return W(this,null,function*(){let[o,t]=yield Promise.all([this.hubCrud.getDefaultClient(),this.hubCrud.getNextContractSerial()]),e={contractSerial:t,client:o,contractName:"",contractCode:"",feeCode:"",amount:0},n=yield this.contractService.add(e);this.contracts=[...this.contracts,gt(_t({},e),{key:n})],setTimeout(()=>{this.startEdit(n)},200)})}startEdit(o){o&&(this.editId=o,setTimeout(()=>{let t=document.querySelector("input[nz-input]:not([hidden])");t&&t.focus()},50))}stopEdit(o){return W(this,null,function*(){o.key&&(yield this.contractService.update(o.key,o)),this.editId=null})}deleteRow(o){return W(this,null,function*(){o&&(yield this.contractService.delete(o),this.contracts=this.contracts.filter(t=>t.key!==o))})}};P.\u0275fac=function(t){return new(t||P)(it(J),it(X))},P.\u0275cmp=C({type:P,selectors:[["contract-list"]],decls:24,vars:1,consts:[["editRowTable",""],[3,"onAction"],["nzBordered","",3,"nzData"],[1,"editable-row"],[1,"client-cell"],[1,"editable-cell",3,"click","hidden"],["type","text","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["type","number","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\u78BA\u5B9A\u522A\u9664\uFF1F",3,"nzOnConfirm"]],template:function(t,e){if(t&1){let n=T();a(0,"app-fab",1),f("onAction",function(){return u(n),d(e.addRow())}),c(),z(1,"br")(2,"br"),a(3,"nz-table",2,0)(5,"thead")(6,"tr")(7,"th"),_(8,"\u5E8F\u865F"),c(),a(9,"th"),_(10,"\u696D\u4E3B"),c(),a(11,"th"),_(12,"\u5408\u7D04\u540D\u7A31"),c(),a(13,"th"),_(14,"\u5408\u7D04\u6848\u865F\u8B58\u5225\u78BC"),c(),a(15,"th"),_(16,"\u5408\u7D04\u8CBB\u7528\u8B58\u5225\u78BC"),c(),a(17,"th"),_(18,"\u5408\u7D04\u91D1\u984D"),c(),a(19,"th"),_(20,"\u64CD\u4F5C"),c()()(),a(21,"tbody"),kt(22,an,25,18,"tr",3,Nt),c()()}if(t&2){let n=D(4);l(3),s("nzData",e.contracts),l(19),Et(n.data)}},dependencies:[$t,ce,ie,ae,oe,re,_e,me,pe,ue,ze,de,fe,Y,he,ge,se,le,Z],styles:[".editable-cell[_ngcontent-%COMP%]{position:relative;padding:5px 12px;cursor:pointer}.editable-row[_ngcontent-%COMP%]:hover   .editable-cell[_ngcontent-%COMP%]{border:1px solid #d9d9d9;border-radius:4px;padding:4px 11px}.client-cell[_ngcontent-%COMP%]{position:relative;padding:5px 12px;background:transparent;cursor:default;border:none!important}.editable-row[_ngcontent-%COMP%]:hover   .client-cell[_ngcontent-%COMP%]{border:none!important;background:transparent;cursor:default}"]});var K=P;var H=class H{};H.\u0275fac=function(t){return new(t||H)},H.\u0275cmp=C({type:H,selectors:[["hub-contract"]],decls:1,vars:0,template:function(t,e){t&1&&z(0,"contract-list")},dependencies:[K],encapsulation:2});var ve=H;export{ve as HubContractComponent};

import{a as U}from"./chunk-6AOWKASD.js";import"./chunk-KNP3MJAK.js";import"./chunk-ERNLQ6N4.js";import"./chunk-VAGS5EVQ.js";import{a as ze,b as _e}from"./chunk-NJ7DRAUT.js";import{d as Jt,f as Kt}from"./chunk-L3HMFE5E.js";import"./chunk-5UL4OGVR.js";import{f as De,k as we}from"./chunk-RSNPD6EB.js";import{c as Ce,f as ge,h as he,j as be,k as ye,l as ve,n as Te}from"./chunk-QXXECWUW.js";import"./chunk-CKQ6FBZR.js";import"./chunk-NMCFBNRY.js";import{a as se,c as pe,f as ue,g as me,i as de,j as fe}from"./chunk-F7UE2Z2N.js";import"./chunk-GFX7JDKS.js";import"./chunk-OTGL7XGI.js";import"./chunk-5NDUH4BM.js";import"./chunk-7INLARAR.js";import"./chunk-3LZSSZ2Q.js";import{d as oe,g as re,m as ae,o as ce,y as le}from"./chunk-4AYNG3KP.js";import"./chunk-Q6QAL4XK.js";import"./chunk-2HVL4WVD.js";import"./chunk-ZDNPLYMC.js";import"./chunk-KR7JNVYJ.js";import{t as dt}from"./chunk-H53TJUCR.js";import"./chunk-QBQXGPEE.js";import{d as ie}from"./chunk-QRKJYL4P.js";import"./chunk-JE6KLO7C.js";import"./chunk-W5FC2PZ7.js";import"./chunk-TPNYXQ4U.js";import{h as Y,q as ee,s as ne,t as X}from"./chunk-5PLKKHJ2.js";import{Nc as B,Oc as O,Pc as te,a as q,aa as mt,e as Yt,ea as Ut,f as Xt,ga as Zt,o as j}from"./chunk-Z6UJEHZN.js";import{o as qt,q as ut,y as jt}from"./chunk-KF7OGFLI.js";import{Aa as p,Ac as Ht,Ba as u,Cc as w,Dc as x,Dd as st,Ec as S,Fa as Mt,Fb as h,Fc as at,Ga as it,Gb as It,Hc as Lt,Hd as pt,Ic as v,Kc as A,Lb as b,Mc as At,Nc as _,Ob as L,Oc as ct,Pb as kt,Pc as M,R as Tt,Ra as Nt,Sc as Q,Tc as $,Uc as G,_b as N,ac as F,b as bt,cc as Et,dc as Bt,dd as Qt,ec as Ot,fc as s,g as yt,ga as Dt,gc as a,hc as c,ic as z,kd as T,mc as Vt,nb as Ft,nc as Pt,oa as wt,oc as rt,pa as xt,pc as y,pd as W,q as vt,qd as $t,r as nt,rd as Gt,sa as St,sb as l,ta as g,ud as Wt,vc as f,vd as D,yb as ot,yc as m,yd as lt,zc as Rt}from"./chunk-IDL4MXQM.js";import{a as gt,b as ht,g as et,i as H}from"./chunk-57BLH6QZ.js";function Ee(i,o){}function Be(i,o){if(i&1&&(a(0,"div",2),b(1,Ee,0,0,"ng-template",4),c()),i&2){let t=m(2);l(),s("ngTemplateOutlet",t.nzIcon)}}function Oe(i,o){if(i&1&&(Vt(0),_(1),Pt()),i&2){let t=m(3);l(),M(" ",t.nzDescription," ")}}function Ve(i,o){if(i&1&&(a(0,"div",3),b(1,Oe,2,1,"ng-container",5),c()),i&2){let t=m(2);l(),s("nzStringTemplateOutlet",t.nzDescription)}}function Pe(i,o){if(i&1&&(N(0,Be,2,1,"div",2),N(1,Ve,2,1,"div",3)),i&2){let t=m();F(t.nzIcon?0:-1),l(),F(t.nzDescription&&t.nzShape==="square"?1:-1)}}function Re(i,o){i&1&&(a(0,"div",2),z(1,"nz-icon",6),c())}function He(i,o){if(i&1){let t=y();a(0,"a",2),f("click",function(){p(t);let e=m();return u(e.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();A("ant-float-btn-default",t.nzType==="default"),s("target",t.nzTarget)("href",t.nzHref,Ft)("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}function Le(i,o){if(i&1){let t=y();a(0,"button",4),f("click",function(){p(t);let e=m();return u(e.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();A("ant-float-btn-default",t.nzType==="default"),s("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}var Ae=["backTop"];function Qe(i,o){i&1&&z(0,"nz-icon",3)}var $e=["*"];function Ge(i,o){i&1&&rt(0)}function We(i,o){if(i&1&&b(0,Ge,1,0,"ng-container",2),i&2){m();let t=v(3);s("ngTemplateOutlet",t)}}function qe(i,o){i&1&&rt(0)}function je(i,o){if(i&1&&(a(0,"div",3),b(1,qe,1,0,"ng-container",2),c()),i&2){m(2);let t=v(3);s("@fadeMotion",void 0),l(),s("ngTemplateOutlet",t)}}function Ye(i,o){if(i&1){let t=y();N(0,je,2,2,"div",3),a(1,"nz-float-button",4),f("nzOnClick",function(){p(t);let e=m();return u(e.open()?e.clickCloseMenu():e.clickOpenMenu())})("mouseover",function(){p(t);let e=m();return u(e.hoverOpenMenu())}),c()}if(i&2){let t=m(),n=v(5);F(t.open()?0:-1),l(),s("nzType",t.nzType())("nzIcon",t.open()?n:t.nzIcon())("nzShape",t.nzShape())("nzDescription",t.open()?null:t.nzDescription())}}function Xe(i,o){i&1&&Ht(0)}function Ue(i,o){i&1&&z(0,"nz-icon",5)}var xe=(()=>{class i{nzIcon=null;nzDescription=null;nzShape="circle";static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button-content"]],inputs:{nzIcon:"nzIcon",nzDescription:"nzDescription",nzShape:"nzShape"},exportAs:["nzFloatButtonContent"],decls:4,vars:1,consts:[[1,"ant-float-btn-body"],[1,"ant-float-btn-content"],[1,"ant-float-btn-icon"],[1,"ant-float-btn-description"],[3,"ngTemplateOutlet"],[4,"nzStringTemplateOutlet"],["nzType","file-text","nzTheme","outline"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1),N(2,Pe,2,2)(3,Re,2,0,"div",2),c()()),n&2&&(l(2),F(e.nzDescription||e.nzIcon?2:3))},dependencies:[O,B,ut,te],encapsulation:2,changeDetection:0})}return i})(),I=(()=>{class i{directionality=g(j);cdr=g(st);destroyRef=g(it);nzHref=null;nzTarget=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzOnClick=new L;dir="ltr";constructor(){this.dir=this.directionality.value}ngOnInit(){this.directionality.change?.pipe(q(this.destroyRef)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button"]],hostAttrs:[1,"ant-float-btn"],hostVars:6,hostBindings:function(n,e){n&2&&A("ant-float-btn-circle",e.nzShape==="circle")("ant-float-btn-square",e.nzShape==="square")("ant-float-btn-rtl",e.dir==="rtl")},inputs:{nzHref:"nzHref",nzTarget:"nzTarget",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription"},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButton"],decls:2,vars:1,consts:[["nz-button","",1,"ant-float-btn-inner",3,"target","href","nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"click","target","href","nzType"],[3,"nzIcon","nzDescription","nzShape"],["nz-button","",1,"ant-float-btn-inner",3,"click","nzType"]],template:function(n,e){n&1&&N(0,He,2,8,"a",0)(1,Le,2,6,"button",1),n&2&&F(e.nzHref?0:1)},dependencies:[X,ne,Y,ee,xe],encapsulation:2,changeDetection:0})}return i})(),Ze="backTop",Je=Xt({passive:!0}),ft=(()=>{var n;let i,o=[],t=[];return n=class{nzConfigService=g(Ut);scrollSrv=g(ie);platform=g(Yt);ngZone=g(kt);cdr=g(st);directionality=g(j);destroyRef=g(it);_nzModuleName=Ze;scrollListenerDestroy$=new yt;target=null;visible=!1;dir="ltr";nzHref=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzTemplate;nzVisibilityHeight=nt(this,o,400);nzTarget=nt(this,t);nzDuration=450;nzOnClick=new L;set backTop(r){r&&(this.backTopClickSubscription.unsubscribe(),this.backTopClickSubscription=mt(r.nativeElement,"click").pipe(q(this.destroyRef)).subscribe(()=>{this.scrollSrv.scrollTo(this.getTarget(),0,{duration:this.nzDuration}),this.nzOnClick.observers.length&&this.ngZone.run(()=>this.nzOnClick.emit(!0))}))}doc=g(Mt);backTopClickSubscription=bt.EMPTY;constructor(){this.destroyRef.onDestroy(()=>{this.scrollListenerDestroy$.next(),this.scrollListenerDestroy$.complete()})}ngOnInit(){this.registerScrollEvent(),this.dir=this.directionality.value,this.directionality.change?.pipe(q(this.destroyRef)).subscribe(r=>{this.dir=r,this.cdr.detectChanges()})}getTarget(){return this.target||window}handleScroll(){this.visible!==this.scrollSrv.getScroll(this.getTarget())>this.nzVisibilityHeight&&(this.visible=!this.visible,this.cdr.detectChanges())}registerScrollEvent(){this.platform.isBrowser&&(this.scrollListenerDestroy$.next(),this.handleScroll(),mt(this.getTarget(),"scroll",Je).pipe(Tt(50),Dt(this.scrollListenerDestroy$)).subscribe(()=>this.handleScroll()))}detectChanges(){this.cdr.detectChanges()}ngOnChanges(r){let{nzTarget:d}=r;d&&(this.target=typeof this.nzTarget=="string"?this.doc.querySelector(this.nzTarget):this.nzTarget,this.registerScrollEvent())}},(()=>{let r=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[Zt()],vt(null,null,i,{kind:"field",name:"nzVisibilityHeight",static:!1,private:!1,access:{has:d=>"nzVisibilityHeight"in d,get:d=>d.nzVisibilityHeight,set:(d,C)=>{d.nzVisibilityHeight=C}},metadata:r},o,t),r&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),et(n,"\u0275fac",function(d){return new(d||n)}),et(n,"\u0275cmp",h({type:n,selectors:[["nz-float-button-top"]],viewQuery:function(d,C){if(d&1&&w(Ae,5),d&2){let E;x(E=S())&&(C.backTop=E.first)}},hostAttrs:[1,"ant-float-btn","ant-float-btn-top"],hostVars:8,hostBindings:function(d,C){d&2&&A("ant-float-btn-circle",C.nzShape==="circle")("ant-float-btn-hidden",!C.visible)("ant-float-btn-square",C.nzShape==="square")("ant-float-btn-rtl",C.dir==="rtl")},inputs:{nzHref:"nzHref",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription",nzTemplate:"nzTemplate",nzVisibilityHeight:[2,"nzVisibilityHeight","nzVisibilityHeight",pt],nzTarget:"nzTarget",nzDuration:[2,"nzDuration","nzDuration",pt]},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButtonTop"],features:[Nt],decls:5,vars:6,consts:[["backTop",""],["top",""],[3,"nzIcon","nzDescription","nzHref","nzType","nzShape"],["nzType","vertical-align-top","nzTheme","outline"]],template:function(d,C){if(d&1&&(a(0,"div",null,0),z(2,"nz-float-button",2),b(3,Qe,1,0,"ng-template",null,1,T),c()),d&2){let E=v(4);s("@fadeMotion",void 0),l(2),s("nzIcon",C.nzIcon||E)("nzDescription",C.nzDescription)("nzHref",C.nzHref)("nzType",C.nzType)("nzShape",C.nzShape)}},dependencies:[I,O,B],encapsulation:2,data:{animation:[dt]},changeDetection:0})),n})(),zt=(()=>{class i{nzFloatButtonComponents=lt(I);nzFloatButtonTopComponents=lt(ft);nzHref=D(null);nzTarget=D(null);nzType=D("default");nzIcon=D(null);nzDescription=D(null);nzShape=D("circle");nzTrigger=D(null);nzOpen=D(null);nzPlacement=D("top");nzOnOpenChange=Wt();dir=g(j).valueSignal;open=Gt(()=>!!this.nzOpen());isMenuMode=W(()=>!!this.nzTrigger()&&["click","hover"].includes(this.nzTrigger()));isControlledMode=W(()=>this.nzOpen()!==null);class=W(()=>{let t=this.nzShape(),n=this.dir(),e=["ant-float-btn-group",this.generateClass(t)];return this.isMenuMode()?e.push(this.generateClass(this.nzPlacement())):e.push(this.generateClass(`${t}-shadow`)),n==="rtl"&&e.push(this.generateClass(n)),e});constructor(){$t(()=>{this.nzFloatButtonComponents()&&this.nzFloatButtonComponents().forEach(t=>{t.nzShape=this.nzShape()}),this.nzFloatButtonTopComponents()&&this.nzFloatButtonTopComponents().forEach(t=>{t.nzShape=this.nzShape(),t.detectChanges()})})}clickOpenMenu(){this.handleEvent("click",!0)}hoverOpenMenu(){this.handleEvent("hover",!0)}clickCloseMenu(){this.handleEvent("click",!1)}hoverCloseMenu(){this.handleEvent("hover",!1)}handleEvent(t,n){this.nzTrigger()!==t||this.isControlledMode()||this.open()===n||(this.open.set(n),this.nzOnOpenChange.emit(n))}generateClass(t){return`ant-float-btn-group-${t}`}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button-group"]],contentQueries:function(n,e,r){n&1&&(at(r,e.nzFloatButtonComponents,I,4),at(r,e.nzFloatButtonTopComponents,ft,4)),n&2&&Lt(2)},hostVars:2,hostBindings:function(n,e){n&1&&f("mouseleave",function(){return e.hoverCloseMenu()}),n&2&&At(e.class())},inputs:{nzHref:[1,"nzHref"],nzTarget:[1,"nzTarget"],nzType:[1,"nzType"],nzIcon:[1,"nzIcon"],nzDescription:[1,"nzDescription"],nzShape:[1,"nzShape"],nzTrigger:[1,"nzTrigger"],nzOpen:[1,"nzOpen"],nzPlacement:[1,"nzPlacement"]},outputs:{nzOnOpenChange:"nzOnOpenChange"},exportAs:["nzFloatButtonGroup"],ngContentSelectors:$e,decls:6,vars:1,consts:[["menu",""],["close",""],[4,"ngTemplateOutlet"],[1,"ant-float-btn-group-wrap"],[1,"ant-float-btn-group-trigger",3,"nzOnClick","mouseover","nzType","nzIcon","nzShape","nzDescription"],["nzType","close","nzTheme","outline"]],template:function(n,e){n&1&&(Rt(),N(0,We,1,1,"ng-container")(1,Ye,2,5),b(2,Xe,1,0,"ng-template",null,0,T)(4,Ue,1,0,"ng-template",null,1,T)),n&2&&F(e.isMenuMode()?1:0)},dependencies:[I,O,B,ut],encapsulation:2,data:{animation:[dt]},changeDetection:0})}return i})(),Se=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=It({type:i});static \u0275inj=xt({imports:[I,zt,ft,xe]})}return i})();var tn=["upIcon"],en=["downIcon"],nn=["leftIcon"],on=["rightIcon"],rn=["commentIcon"],an=(i,o)=>({x:i,y:o});function cn(i,o){i&1&&z(0,"nz-icon",8)}function ln(i,o){i&1&&z(0,"nz-icon",9)}function sn(i,o){i&1&&z(0,"nz-icon",10)}function pn(i,o){i&1&&z(0,"nz-icon",11)}function un(i,o){i&1&&z(0,"nz-icon",12)}var V=class V{constructor(){this.dragX=0;this.dragY=0;this.smartPlacement="top";this.currentX=0;this.currentY=0;this.onAction=new L}get currentIcon(){return{top:this.upIcon,bottom:this.downIcon,left:this.leftIcon,right:this.rightIcon}[this.smartPlacement]}onDragMove(o){let t=o.source.element.nativeElement.getBoundingClientRect();this.currentX=t.left,this.currentY=t.top,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}onDragEnd(o){this.dragX=o.source.getFreeDragPosition().x,this.dragY=o.source.getFreeDragPosition().y,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}calculateSmartPlacement(o,t){let n=window.innerWidth,e=window.innerHeight,r=56,d=o+r/2,C=t+r/2,E=n/2,Fe=e/2,_t=d-E,Ct=C-Fe;return Math.abs(_t)>Math.abs(Ct)?_t>0?"left":"right":Ct>0?"top":"bottom"}openChange(o){}};V.\u0275fac=function(t){return new(t||V)},V.\u0275cmp=h({type:V,selectors:[["app-fab"]],viewQuery:function(t,n){if(t&1&&(w(tn,7),w(en,7),w(nn,7),w(on,7),w(rn,7)),t&2){let e;x(e=S())&&(n.upIcon=e.first),x(e=S())&&(n.downIcon=e.first),x(e=S())&&(n.leftIcon=e.first),x(e=S())&&(n.rightIcon=e.first),x(e=S())&&(n.commentIcon=e.first)}},outputs:{onAction:"onAction"},decls:13,vars:7,consts:[["upIcon",""],["downIcon",""],["leftIcon",""],["rightIcon",""],["commentIcon",""],["cdkDrag","",1,"fab-drag-anchor",3,"cdkDragEnded","cdkDragMoved","cdkDragFreeDragPosition"],["nzType","primary","nzTrigger","click",3,"nzOnOpenChange","nzIcon","nzPlacement"],[3,"click","nzIcon"],["nzType","up","nzTheme","outline"],["nzType","down","nzTheme","outline"],["nzType","left","nzTheme","outline"],["nzType","right","nzTheme","outline"],["nzType","plus","nzTheme","outline"]],template:function(t,n){if(t&1){let e=y();a(0,"div",5),f("cdkDragEnded",function(d){return p(e),u(n.onDragEnd(d))})("cdkDragMoved",function(d){return p(e),u(n.onDragMove(d))}),a(1,"nz-float-button-group",6),f("nzOnOpenChange",function(d){return p(e),u(n.openChange(d))}),a(2,"nz-float-button",7),f("click",function(){return p(e),u(n.onAction.emit("add"))}),c()(),b(3,cn,1,0,"ng-template",null,0,T)(5,ln,1,0,"ng-template",null,1,T)(7,sn,1,0,"ng-template",null,2,T)(9,pn,1,0,"ng-template",null,3,T)(11,un,1,0,"ng-template",null,4,T),c()}if(t&2){let e=v(12);s("cdkDragFreeDragPosition",Qt(4,an,n.dragX,n.dragY)),l(),s("nzIcon",n.currentIcon)("nzPlacement",n.smartPlacement),l(),s("nzIcon",e)}},dependencies:[Se,I,zt,O,B,Kt,Jt],styles:[".fab-drag-anchor[_ngcontent-%COMP%]{position:fixed;z-index:1000;right:32px;bottom:32px;cursor:grab;-webkit-user-select:none;user-select:none}.fab-drag-anchor[_ngcontent-%COMP%]:active{cursor:grabbing}nz-float-button-group[_ngcontent-%COMP%]{position:absolute}"]});var J=V;var k=class k{constructor(o){this.hubCrud=o}list(){return this.hubCrud.useCollection("hub_contract")}add(o){return this.hubCrud.add("hub_contract",o)}update(o,t){return this.hubCrud.update("hub_contract",o,t)}delete(o){return this.hubCrud.delete("hub_contract",o)}};k.\u0275fac=function(t){return new(t||k)(St(U))},k.\u0275prov=wt({token:k,factory:k.\u0275fac,providedIn:"root"});var K=k;function fn(i,o){if(i&1){let t=y();a(0,"tr",4)(1,"td"),_(2),c(),a(3,"td")(4,"div",7),f("nzClick",function(){let e=p(t).$implicit,r=m();return u(r.currentDropdownRow=e)}),a(5,"a",8),f("click",function(){let e=p(t).$implicit,r=m();return u(r.currentDropdownRow=e)}),_(6),z(7,"span",9),c()()(),a(8,"td")(9,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(10),c(),a(11,"input",11),G("ngModelChange",function(e){let r=p(t).$implicit;return $(r.contractName,e)||(r.contractName=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(12,"td")(13,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(14),c(),a(15,"input",11),G("ngModelChange",function(e){let r=p(t).$implicit;return $(r.contractCode,e)||(r.contractCode=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(16,"td")(17,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(18),c(),a(19,"input",11),G("ngModelChange",function(e){let r=p(t).$implicit;return $(r.feeCode,e)||(r.feeCode=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(20,"td")(21,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(22),c(),a(23,"input",12),G("ngModelChange",function(e){let r=p(t).$implicit;return $(r.amount,e)||(r.amount=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(24,"td")(25,"a",13),f("nzOnConfirm",function(){let e=p(t).$implicit,r=m();return u(r.deleteRow(e.key))}),_(26,"\u522A\u9664"),c()()()}if(i&2){let t=o.$implicit,n=m(),e=v(25);l(2),ct(t.contractSerial),l(2),s("nzDropdownMenu",e),l(2),M("",t.client," "),l(3),s("hidden",n.editId===t.key),l(),M(" ",t.contractName," "),l(),s("hidden",n.editId!==t.key),Q("ngModel",t.contractName),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.contractCode," "),l(),s("hidden",n.editId!==t.key),Q("ngModel",t.contractCode),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.feeCode," "),l(),s("hidden",n.editId!==t.key),Q("ngModel",t.feeCode),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.amount," "),l(),s("hidden",n.editId!==t.key),Q("ngModel",t.amount)}}function zn(i,o){if(i&1){let t=y();a(0,"li",14),f("click",function(){let e=p(t).$implicit,r=m();return u(r.changeClient(r.currentDropdownRow,e))}),_(1),c()}if(i&2){let t=o.$implicit;l(),ct(t)}}var P=class P{constructor(o,t){this.contractService=o;this.hubCrud=t;this.contracts=[];this.editId=null;this.clients=[];this.currentDropdownRow=null}ngOnInit(){this.refresh(),this.hubCrud.getClientsSettings().then(o=>{this.clients=o?.list||[]})}refresh(){this.contractService.list().subscribe(o=>this.contracts=o)}addRow(){return H(this,null,function*(){let[o,t]=yield Promise.all([this.hubCrud.getDefaultClient(),this.hubCrud.getNextContractSerial()]),n={contractSerial:t,client:o,contractName:"",contractCode:"",feeCode:"",amount:0},e=yield this.contractService.add(n);this.contracts=[...this.contracts,ht(gt({},n),{key:e})],setTimeout(()=>{this.startEdit(e)},200)})}startEdit(o){o&&(this.editId=o,setTimeout(()=>{let t=document.querySelector("input[nz-input]:not([hidden])");t&&t.focus()},50))}stopEdit(o){return H(this,null,function*(){o.key&&(yield this.contractService.update(o.key,o)),this.editId=null})}deleteRow(o){return H(this,null,function*(){o&&(yield this.contractService.delete(o),this.contracts=this.contracts.filter(t=>t.key!==o))})}changeClient(o,t){return H(this,null,function*(){o&&o.key&&o.client!==t&&(o.client=t,yield this.contractService.update(o.key,{client:t}))})}};P.\u0275fac=function(t){return new(t||P)(ot(K),ot(U))},P.\u0275cmp=h({type:P,selectors:[["contract-list"]],decls:28,vars:2,consts:[["editRowTable",""],["menuRef","nzDropdownMenu"],[3,"onAction"],["nzBordered","",3,"nzData"],[1,"editable-row"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["nz-dropdown","","nzTrigger","click",3,"nzClick","nzDropdownMenu"],["nz-dropdown","",3,"click"],["nz-icon","","nzType","down"],[1,"editable-cell",3,"click","hidden"],["type","text","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["type","number","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\u78BA\u5B9A\u522A\u9664\uFF1F",3,"nzOnConfirm"],["nz-menu-item","",3,"click"]],template:function(t,n){if(t&1){let e=y();a(0,"app-fab",2),f("onAction",function(){return p(e),u(n.addRow())}),c(),z(1,"br")(2,"br"),a(3,"nz-table",3,0)(5,"thead")(6,"tr")(7,"th"),_(8,"\u5E8F\u865F"),c(),a(9,"th"),_(10,"\u696D\u4E3B"),c(),a(11,"th"),_(12,"\u5408\u7D04\u540D\u7A31"),c(),a(13,"th"),_(14,"\u5408\u7D04\u6848\u865F\u8B58\u5225\u78BC"),c(),a(15,"th"),_(16,"\u5408\u7D04\u8CBB\u7528\u8B58\u5225\u78BC"),c(),a(17,"th"),_(18,"\u5408\u7D04\u91D1\u984D"),c(),a(19,"th"),_(20,"\u64CD\u4F5C"),c()()(),a(21,"tbody"),Bt(22,fn,27,19,"tr",4,Et),c()(),a(24,"nz-dropdown-menu",null,1)(26,"ul",5),b(27,zn,2,1,"li",6),c()()}if(t&2){let e=v(4);l(3),s("nzData",n.contracts),l(19),Ot(e.data),l(5),s("ngForOf",n.clients)}},dependencies:[jt,qt,le,oe,ce,re,ae,Te,be,Ce,ge,ve,he,ye,X,Y,we,De,_e,ze,fe,pe,se,ue,me,de,J],styles:[".editable-cell[_ngcontent-%COMP%]{position:relative;padding:5px 12px;cursor:pointer}.editable-row[_ngcontent-%COMP%]:hover   .editable-cell[_ngcontent-%COMP%]{border:1px solid #d9d9d9;border-radius:4px;padding:4px 11px}.client-cell[_ngcontent-%COMP%]{position:relative;padding:5px 12px;background:transparent;cursor:default;border:none!important}.editable-row[_ngcontent-%COMP%]:hover   .client-cell[_ngcontent-%COMP%]{border:none!important;background:transparent;cursor:default}"]});var tt=P;var R=class R{};R.\u0275fac=function(t){return new(t||R)},R.\u0275cmp=h({type:R,selectors:[["hub-contract"]],decls:1,vars:0,template:function(t,n){t&1&&z(0,"contract-list")},dependencies:[tt],encapsulation:2});var Ne=R;export{Ne as HubContractComponent};

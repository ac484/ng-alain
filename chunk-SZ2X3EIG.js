import{a as Ht,b as Wt}from"./chunk-VCOI22QR.js";import{a as $t,b as qt}from"./chunk-JNXOSXFH.js";import{a as Qt,b as Gt}from"./chunk-54SOX2ZU.js";import{a as Ut,b as Lt}from"./chunk-XL3LSW66.js";import"./chunk-7HKXGGQW.js";import{a as kt,b as Mt,c as Bt,d as Pt,e as At}from"./chunk-RJ372NDN.js";import{a as Ot,b as It,c as Dt}from"./chunk-3XJPIDKW.js";import{d as mt}from"./chunk-FNQFXT4L.js";import{a as wt,b as Nt}from"./chunk-BP5QTQZC.js";import{c as Ee,e as ve}from"./chunk-2AKQOGSQ.js";import{a as ne,f as Ft,k as oe}from"./chunk-IKXE7RY5.js";import{b as Tt,d as Et}from"./chunk-UEJJLST4.js";import"./chunk-YLT4J452.js";import"./chunk-PUYN37MU.js";import{g as ft,h as ht,n as zt,q as Ct,t as yt,x as gt,y as _t,z as xt}from"./chunk-Q4M6B46D.js";import{a as vt,b as bt}from"./chunk-JAU2U3S7.js";import{a as Rt,b as St}from"./chunk-LGE3RKIU.js";import{L as ie}from"./chunk-67AL53VY.js";import"./chunk-CGTTSKG2.js";import"./chunk-QHSDKNHJ.js";import{a as ut}from"./chunk-HG76SPUR.js";import"./chunk-VECD6G7R.js";import"./chunk-JKCE4WUB.js";import{k as st,t as at,v as lt,w as pt}from"./chunk-HFO44OZB.js";import{$b as y,$h as Vt,Aa as _,Ad as Ke,B as q,Bd as Je,Da as Le,Ea as Z,Fa as Y,Hb as T,Hc as Ze,Id as Xe,Jb as E,Ob as u,Oh as ge,P as H,Pa as de,Pb as c,Pc as ee,Pd as et,Ph as _e,Qb as l,Qh as xe,Rb as m,Rh as Te,Sa as K,Uh as ct,Vb as fe,Ve as Ce,Vh as dt,Wb as he,X as Ue,Xe as ot,Ya as Qe,Yb as N,Yd as tt,ai as jt,b as Ae,be as R,bf as ye,cb as a,cc as f,dc as He,ec as We,fe as it,ff as rt,ga as ce,gb as Ge,gc as S,gd as te,h as Ve,hc as F,hf as V,ic as O,id as A,jb as $e,jd as Ye,mc as J,nc as X,oa as W,ob as B,oc as ze,pa as Q,pb as G,pe as nt,q as M,qb as ue,r as x,rc as h,ta as p,tc as P,ub as b,w as je,wb as w,xb as me,za as g,zb as qe}from"./chunk-C2TUN3UK.js";import{g as pe,i as L}from"./chunk-57BLH6QZ.js";var be=class{_document;_textarea;constructor(i,e){this._document=e;let n=this._textarea=this._document.createElement("textarea"),o=n.style;o.position="fixed",o.top=o.opacity="0",o.left="-999em",n.setAttribute("aria-hidden","true"),n.value=i,n.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(n)}copy(){let i=this._textarea,e=!1;try{if(i){let n=this._document.activeElement;i.select(),i.setSelectionRange(0,i.value.length),e=this._document.execCommand("copy"),n&&n.focus()}}catch{}return e}destroy(){let i=this._textarea;i&&(i.remove(),this._textarea=void 0)}},Zt=(()=>{class t{_document=p(Z);constructor(){}copy(e){let n=this.beginCopy(e),o=n.copy();return n.destroy(),o}beginCopy(e){return new be(e,this._document)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=W({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var we=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275dir=ue({type:t,selectors:[["button","nz-trans-button",""]],hostVars:8,hostBindings:function(n,o){n&2&&X("border","0")("background","transparent")("padding","0")("line-height","inherit")}})}return t})(),Ne=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=G({type:t});static \u0275inj=Q({})}return t})();function ei(t,i){if(t&1&&(fe(0),m(1,"nz-icon",2),he()),t&2){let e=i.$implicit;a(),u("nzType",e)}}var ti=["textarea"];function ii(t,i){if(t&1){let e=N();c(0,"textarea",2,0),y("blur",function(){g(e);let o=f();return _(o.confirm())}),l(),c(2,"button",3),y("click",function(){g(e);let o=f();return _(o.confirm())}),m(3,"nz-icon",4),l()}}function ni(t,i){if(t&1&&(fe(0),m(1,"nz-icon",7),he()),t&2){let e=i.$implicit;a(),u("nzType",e)}}function oi(t,i){if(t&1){let e=N();c(0,"button",5),y("click",function(){g(e);let o=f();return _(o.onClick())}),b(1,ni,2,1,"ng-container",6),l()}if(t&2){let e=f();u("nzTooltipTitle",e.tooltip===null?null:e.tooltip||(e.locale==null?null:e.locale.edit)),a(),u("nzStringTemplateOutlet",e.icon)}}var ri=["ellipsisContainer"],si=["expandable"],ai=["contentTemplate"],li=["*"],pi=t=>({content:t});function ci(t,i){t&1&&We(0)}function di(t,i){if(t&1&&(T(0,ci,1,0),h(1)),t&2){let e=i.content;E(e?-1:0),a(),P(" ",e," ")}}function ui(t,i){}function mi(t,i){if(t&1&&h(0),t&2){let e=f(3);P(" ",e.nzSuffix," ")}}function fi(t,i){if(t&1&&(b(0,ui,0,0,"ng-template",5),T(1,mi,1,1)),t&2){let e=f(2),n=J(1);u("ngTemplateOutlet",n)("ngTemplateOutletContext",Ze(3,pi,e.nzContent)),a(),E(e.nzSuffix?1:-1)}}function hi(t,i){if(t&1&&h(0),t&2){let e=f(3);P(" ",e.ellipsisStr," ")}}function zi(t,i){if(t&1&&h(0),t&2){let e=f(3);P(" ",e.nzSuffix," ")}}function Ci(t,i){if(t&1){let e=N();c(0,"a",7,2),y("click",function(){g(e);let o=f(3);return _(o.onExpand())}),h(2),l()}if(t&2){let e=f(3);a(2),P(" ",e.locale==null?null:e.locale.expand," ")}}function yi(t,i){if(t&1&&(m(0,"span",null,1),T(2,hi,1,1),T(3,zi,1,1),T(4,Ci,3,1,"a",6)),t&2){let e=f(2);a(2),E(e.isEllipsis?2:-1),a(),E(e.nzSuffix?3:-1),a(),E(e.nzExpandable&&e.isEllipsis?4:-1)}}function gi(t,i){if(t&1&&T(0,fi,2,5)(1,yi,5,3),t&2){let e=f();E(e.expanded||!e.hasOperationsWithEllipsis&&e.nzEllipsisRows===1&&!e.hasEllipsisObservers||e.canCssEllipsis||e.nzSuffix&&e.expanded?0:1)}}function _i(t,i){if(t&1){let e=N();c(0,"nz-text-edit",8),y("endEditing",function(o){g(e);let z=f();return _(z.onEndEditing(o))})("startEditing",function(){g(e);let o=f();return _(o.onStartEditing())}),l()}if(t&2){let e=f();u("text",e.nzContent)("icon",e.nzEditIcon)("tooltip",e.nzEditTooltip)}}function xi(t,i){if(t&1){let e=N();c(0,"nz-text-copy",9),y("textCopy",function(o){g(e);let z=f();return _(z.onTextCopy(o))}),l()}if(t&2){let e=f();u("text",e.copyText)("tooltips",e.nzCopyTooltips)("icons",e.nzCopyIcons)}}var Re=(()=>{class t{cdr=p(te);clipboard=p(Zt);i18n=p(ie);destroyRef=p(Y);copied=!1;copyId;locale;nativeElement=p(K).nativeElement;copyTooltip=null;copedTooltip=null;copyIcon="copy";copedIcon="check";text;tooltips;icons=["copy","check"];textCopy=new w;constructor(){this.destroyRef.onDestroy(()=>{clearTimeout(this.copyId)})}ngOnInit(){this.i18n.localeChange.pipe(R(this.destroyRef)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Text"),this.updateTooltips(),this.cdr.markForCheck()})}ngOnChanges(e){let{tooltips:n,icons:o}=e;n&&this.updateTooltips(),o&&this.updateIcons()}onClick(){if(this.copied)return;this.copied=!0,this.cdr.detectChanges();let e=this.text;this.textCopy.emit(e),this.clipboard.copy(e),this.onCopied()}onCopied(){clearTimeout(this.copyId),this.copyId=setTimeout(()=>{this.copied=!1,this.cdr.detectChanges()},3e3)}updateTooltips(){if(this.tooltips===null)this.copedTooltip=null,this.copyTooltip=null;else if(Array.isArray(this.tooltips)){let[e,n]=this.tooltips;this.copyTooltip=e||this.locale?.copy,this.copedTooltip=n||this.locale?.copied}else this.copyTooltip=this.locale?.copy,this.copedTooltip=this.locale?.copied;this.cdr.markForCheck()}updateIcons(){let[e,n]=this.icons;this.copyIcon=e,this.copedIcon=n,this.cdr.markForCheck()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=B({type:t,selectors:[["nz-text-copy"]],inputs:{text:"text",tooltips:"tooltips",icons:"icons"},outputs:{textCopy:"textCopy"},exportAs:["nzTextCopy"],features:[de],decls:2,vars:4,consts:[["type","button","nz-tooltip","","nz-trans-button","",1,"ant-typography-copy",3,"click","nzTooltipTitle"],[4,"nzStringTemplateOutlet"],[3,"nzType"]],template:function(n,o){n&1&&(c(0,"button",0),y("click",function(){return o.onClick()}),b(1,ei,2,1,"ng-container",1),l()),n&2&&(ze("ant-typography-copy-success",o.copied),u("nzTooltipTitle",o.copied?o.copedTooltip:o.copyTooltip),a(),u("nzStringTemplateOutlet",o.copied?o.copedIcon:o.copyIcon))},dependencies:[ve,Ee,Ne,we,_e,ge,Te,xe],encapsulation:2,changeDetection:0})}return t})(),Se=(()=>{class t{ngZone=p(me);cdr=p(te);i18n=p(ie);destroyRef=p(Y);editing=!1;locale;text;icon="edit";tooltip;startEditing=new w;endEditing=new w(!0);set textarea(e){this.textarea$.next(e)}autosizeDirective;beforeText;currentText;nativeElement=p(K).nativeElement;textarea$=new Ve(null);injector=p(Le);ngOnInit(){this.i18n.localeChange.pipe(R(this.destroyRef)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Text"),this.cdr.markForCheck()}),this.textarea$.pipe(ce(e=>ye(e?.nativeElement,"keydown")),R(this.destroyRef)).subscribe(e=>{e.keyCode!==27&&e.keyCode!==13||this.ngZone.run(()=>{e.keyCode===27?this.onCancel():this.onEnter(e),this.cdr.markForCheck()})}),this.textarea$.pipe(ce(e=>ye(e?.nativeElement,"input")),R(this.destroyRef)).subscribe(e=>{this.currentText=e.target.value})}onClick(){this.beforeText=this.text,this.currentText=this.beforeText,this.editing=!0,this.startEditing.emit(),this.focusAndSetValue()}confirm(){this.editing=!1,this.endEditing.emit(this.currentText)}onEnter(e){e.stopPropagation(),e.preventDefault(),this.confirm()}onCancel(){this.currentText=this.beforeText,this.confirm()}focusAndSetValue(){let{injector:e}=this;qe(()=>{this.textarea$.pipe(Ue(n=>n!=null),R(this.destroyRef)).subscribe(n=>{n.nativeElement.focus(),n.nativeElement.value=this.currentText||"",this.autosizeDirective.resizeToFitContent(),this.cdr.markForCheck()})},{injector:e})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=B({type:t,selectors:[["nz-text-edit"]],viewQuery:function(n,o){if(n&1&&(S(ti,5),S(ne,5)),n&2){let z;F(z=O())&&(o.textarea=z.first),F(z=O())&&(o.autosizeDirective=z.first)}},inputs:{text:"text",icon:"icon",tooltip:"tooltip"},outputs:{startEditing:"startEditing",endEditing:"endEditing"},exportAs:["nzTextEdit"],decls:2,vars:1,consts:[["textarea",""],["nz-tooltip","","nz-trans-button","",1,"ant-typography-edit",3,"nzTooltipTitle"],["nz-input","","nzAutosize","",3,"blur"],["nz-trans-button","",1,"ant-typography-edit-content-confirm",3,"click"],["nzType","enter"],["nz-tooltip","","nz-trans-button","",1,"ant-typography-edit",3,"click","nzTooltipTitle"],[4,"nzStringTemplateOutlet"],[3,"nzType"]],template:function(n,o){n&1&&T(0,ii,4,0)(1,oi,2,2,"button",1),n&2&&E(o.editing?0:1)},dependencies:[oe,Ft,ne,Ne,we,_e,ge,ve,Ee,Te,xe],encapsulation:2,changeDetection:0})}return t})(),Ti="typography",Ei="ant-typography-expand",vi=(()=>{var v;let t,i=[],e=[],n,o=[],z=[],$,Fe=[],Oe=[],Ie,De=[],ke=[],Me,Be=[],Pe=[];return v=class{_nzModuleName=Ti;nzConfigService=p(rt);el=p(K).nativeElement;cdr=p(te);viewContainerRef=p($e);renderer=p(Ge);platform=p(it);i18n=p(ie);resizeService=p(ut);directionality=p(nt);document=p(Z);destroyRef=p(Y);nzCopyable=!1;nzEditable=!1;nzDisabled=!1;nzExpandable=!1;nzEllipsis=!1;nzCopyTooltips=x(this,i,void 0);nzCopyIcons=(x(this,e),x(this,o,["copy","check"]));nzEditTooltip=(x(this,z),x(this,Fe,void 0));nzEditIcon=(x(this,Oe),x(this,De,"edit"));nzContent=x(this,ke);nzEllipsisRows=x(this,Be,1);nzType=x(this,Pe);nzCopyText;nzSuffix;nzContentChange=new w;nzCopy=new w;nzExpandChange=new w;nzOnEllipsis=new w;textEditRef;textCopyRef;ellipsisContainer;expandableBtn;contentTemplate;locale;expandableBtnElementCache=null;editing=!1;ellipsisText;cssEllipsis=!1;isEllipsis=!0;expanded=!1;ellipsisStr="...";dir="ltr";get hasEllipsisObservers(){return this.nzOnEllipsis.observers.length>0}get canCssEllipsis(){return this.nzEllipsis&&this.cssEllipsis&&!this.expanded&&!this.hasEllipsisObservers}get hasOperationsWithEllipsis(){return(this.nzCopyable||this.nzEditable||this.nzExpandable)&&this.nzEllipsis}viewInit=!1;requestId=-1;windowResizeSubscription=Ae.EMPTY;get copyText(){return typeof this.nzCopyText=="string"?this.nzCopyText:this.nzContent}constructor(){this.destroyRef.onDestroy(()=>{this.expandableBtnElementCache=null,this.windowResizeSubscription.unsubscribe()})}onTextCopy(d){this.nzCopy.emit(d)}onStartEditing(){this.editing=!0}onEndEditing(d){this.editing=!1,this.nzContentChange.emit(d),this.nzContent===d&&this.renderOnNextFrame(),this.cdr.markForCheck()}onExpand(){this.isEllipsis=!1,this.expanded=!0,this.nzExpandChange.emit(),this.nzOnEllipsis.emit(!1)}canUseCSSEllipsis(){return this.nzEditable||this.nzCopyable||this.nzExpandable||this.nzSuffix||this.hasEllipsisObservers?!1:this.nzEllipsisRows===1?Ce("textOverflow"):Ce("webkitLineClamp")}renderOnNextFrame(){dt(this.requestId),!(!this.viewInit||!this.nzEllipsis||this.nzEllipsisRows<0||this.expanded||!this.platform.isBrowser)&&(this.requestId=ct(()=>this.syncEllipsis()))}getOriginContentViewRef(){let d=this.viewContainerRef.createEmbeddedView(this.contentTemplate,{content:this.nzContent});return d.detectChanges(),{viewRef:d,removeView:()=>this.viewContainerRef.remove(this.viewContainerRef.indexOf(d))}}syncEllipsis(){if(this.cssEllipsis)return;let{viewRef:d,removeView:s}=this.getOriginContentViewRef(),r=[this.textCopyRef,this.textEditRef].filter(k=>k&&k.nativeElement).map(k=>k.nativeElement),C=this.getExpandableBtnElement();C&&r.push(C);let{contentNodes:ae,text:le,ellipsis:U}=ot(this.el,this.nzEllipsisRows,d.rootNodes,r,this.ellipsisStr,this.nzSuffix);s(),this.ellipsisText=le,U!==this.isEllipsis&&(this.isEllipsis=U,this.nzOnEllipsis.emit(U));let D=this.ellipsisContainer.nativeElement;for(;D.firstChild;)this.renderer.removeChild(D,D.firstChild);ae.forEach(k=>{this.renderer.appendChild(D,k.cloneNode(!0))}),this.cdr.markForCheck()}getExpandableBtnElement(){if(this.nzExpandable){let d=this.locale?this.locale.expand:"",s=this.expandableBtnElementCache;if(!s||s.innerText===d){let r=this.document.createElement("a");r.className=Ei,r.innerText=d,this.expandableBtnElementCache=r}return this.expandableBtnElementCache}else return this.expandableBtnElementCache=null,null}renderAndSubscribeWindowResize(){this.platform.isBrowser&&(this.windowResizeSubscription.unsubscribe(),this.cssEllipsis=this.canUseCSSEllipsis(),this.renderOnNextFrame(),this.windowResizeSubscription=this.resizeService.connect().pipe(R(this.destroyRef)).subscribe(()=>this.renderOnNextFrame()))}ngOnInit(){this.i18n.localeChange.pipe(R(this.destroyRef)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Text"),this.cdr.markForCheck()}),this.directionality.change?.pipe(R(this.destroyRef)).subscribe(d=>{this.dir=d,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngAfterViewInit(){this.viewInit=!0,this.renderAndSubscribeWindowResize()}ngOnChanges(d){let{nzCopyable:s,nzEditable:r,nzExpandable:C,nzEllipsis:ae,nzContent:le,nzEllipsisRows:U,nzSuffix:D}=d;(s||r||C||ae||le||U||D)&&this.nzEllipsis&&(this.expanded?this.windowResizeSubscription.unsubscribe():this.renderAndSubscribeWindowResize())}},(()=>{let d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;t=[V()],n=[V()],$=[V()],Ie=[V()],Me=[V()],M(null,null,t,{kind:"field",name:"nzCopyTooltips",static:!1,private:!1,access:{has:s=>"nzCopyTooltips"in s,get:s=>s.nzCopyTooltips,set:(s,r)=>{s.nzCopyTooltips=r}},metadata:d},i,e),M(null,null,n,{kind:"field",name:"nzCopyIcons",static:!1,private:!1,access:{has:s=>"nzCopyIcons"in s,get:s=>s.nzCopyIcons,set:(s,r)=>{s.nzCopyIcons=r}},metadata:d},o,z),M(null,null,$,{kind:"field",name:"nzEditTooltip",static:!1,private:!1,access:{has:s=>"nzEditTooltip"in s,get:s=>s.nzEditTooltip,set:(s,r)=>{s.nzEditTooltip=r}},metadata:d},Fe,Oe),M(null,null,Ie,{kind:"field",name:"nzEditIcon",static:!1,private:!1,access:{has:s=>"nzEditIcon"in s,get:s=>s.nzEditIcon,set:(s,r)=>{s.nzEditIcon=r}},metadata:d},De,ke),M(null,null,Me,{kind:"field",name:"nzEllipsisRows",static:!1,private:!1,access:{has:s=>"nzEllipsisRows"in s,get:s=>s.nzEllipsisRows,set:(s,r)=>{s.nzEllipsisRows=r}},metadata:d},Be,Pe),d&&Object.defineProperty(v,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d})})(),pe(v,"\u0275fac",function(s){return new(s||v)}),pe(v,"\u0275cmp",B({type:v,selectors:[["nz-typography"],["","nz-typography",""],["p","nz-paragraph",""],["span","nz-text",""],["h1","nz-title",""],["h2","nz-title",""],["h3","nz-title",""],["h4","nz-title",""]],viewQuery:function(s,r){if(s&1&&(S(Se,5),S(Re,5),S(ri,5),S(si,5),S(ai,5)),s&2){let C;F(C=O())&&(r.textEditRef=C.first),F(C=O())&&(r.textCopyRef=C.first),F(C=O())&&(r.ellipsisContainer=C.first),F(C=O())&&(r.expandableBtn=C.first),F(C=O())&&(r.contentTemplate=C.first)}},hostVars:26,hostBindings:function(s,r){s&2&&(X("-webkit-line-clamp",r.canCssEllipsis&&r.nzEllipsisRows>1?r.nzEllipsisRows:null),ze("ant-typography",!r.editing)("ant-typography-rtl",r.dir==="rtl")("ant-typography-edit-content",r.editing)("ant-typography-secondary",r.nzType==="secondary")("ant-typography-warning",r.nzType==="warning")("ant-typography-danger",r.nzType==="danger")("ant-typography-success",r.nzType==="success")("ant-typography-disabled",r.nzDisabled)("ant-typography-ellipsis",r.nzEllipsis&&!r.expanded)("ant-typography-single-line",r.nzEllipsis&&r.nzEllipsisRows===1)("ant-typography-ellipsis-single-line",r.canCssEllipsis&&r.nzEllipsisRows===1)("ant-typography-ellipsis-multiple-line",r.canCssEllipsis&&r.nzEllipsisRows>1))},inputs:{nzCopyable:[2,"nzCopyable","nzCopyable",A],nzEditable:[2,"nzEditable","nzEditable",A],nzDisabled:[2,"nzDisabled","nzDisabled",A],nzExpandable:[2,"nzExpandable","nzExpandable",A],nzEllipsis:[2,"nzEllipsis","nzEllipsis",A],nzCopyTooltips:"nzCopyTooltips",nzCopyIcons:"nzCopyIcons",nzEditTooltip:"nzEditTooltip",nzEditIcon:"nzEditIcon",nzContent:"nzContent",nzEllipsisRows:[2,"nzEllipsisRows","nzEllipsisRows",Ye],nzType:"nzType",nzCopyText:"nzCopyText",nzSuffix:"nzSuffix"},outputs:{nzContentChange:"nzContentChange",nzCopy:"nzCopy",nzExpandChange:"nzExpandChange",nzOnEllipsis:"nzOnEllipsis"},exportAs:["nzTypography"],features:[de],ngContentSelectors:li,decls:5,vars:3,consts:[["contentTemplate",""],["ellipsisContainer",""],["expandable",""],[3,"text","icon","tooltip"],[3,"text","tooltips","icons"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-typography-expand"],[1,"ant-typography-expand",3,"click"],[3,"endEditing","startEditing","text","icon","tooltip"],[3,"textCopy","text","tooltips","icons"]],template:function(s,r){s&1&&(He(),b(0,di,2,2,"ng-template",null,0,ee),T(2,gi,2,1),T(3,_i,1,3,"nz-text-edit",3),T(4,xi,1,3,"nz-text-copy",4)),s&2&&(a(2),E(r.editing?-1:2),a(),E(r.nzEditable?3:-1),a(),E(r.nzCopyable&&!r.editing?4:-1))},dependencies:[Je,Se,Re],encapsulation:2,changeDetection:0})),v})(),Yt=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=G({type:t});static \u0275inj=Q({imports:[vi,Re,Se]})}return t})();var I=class I{constructor(){this.http=p(tt);this.functionsUrl="https://us-central1-lin-in.cloudfunctions.net/api"}extractText(i){return this.http.post(`${this.functionsUrl}/ocr/extract`,i).pipe(q(e=>this.handleResponse(e)),H(e=>this.handleError(e)))}extractPdfFirstPage(i){return this.http.post(`${this.functionsUrl}/ocr/pdf-first-page`,i).pipe(q(e=>this.handleResponse(e)),H(e=>this.handleError(e)))}extractFromBuffer(i){let e=new et({"Content-Type":"application/octet-stream"});return this.http.post(`${this.functionsUrl}/ocr/buffer`,i,{headers:e}).pipe(q(n=>this.handleResponse(n)),H(n=>this.handleError(n)))}handleResponse(i){if(i.success&&i.data)return i.data;throw new Error(i.error||"OCR \u8655\u7406\u5931\u6557")}handleError(i){console.error("OCR Service Error:",i);let e="OCR \u670D\u52D9\u932F\u8AA4";return i.error?.error?e=i.error.error:i.message?e=i.message:typeof i=="string"&&(e=i),je(()=>new Error(e))}isSupportedFileType(i){let e=["application/pdf","image/tiff","image/tif","image/jpeg","image/jpg","image/png","image/gif"],n=[".pdf",".tiff",".tif",".jpg",".jpeg",".png",".gif"];return e.includes(i.type)||n.some(o=>i.name.toLowerCase().endsWith(o))}isValidFileSize(i,e=20){return i.size<=e*1024*1024}fileToArrayBuffer(i){return new Promise((e,n)=>{let o=new FileReader;o.onload=()=>{e(o.result)},o.onerror=()=>{n(new Error("\u6587\u4EF6\u8B80\u53D6\u5931\u6557"))},o.readAsArrayBuffer(i)})}formatText(i){return i?i.replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/  /g,"&nbsp;&nbsp;"):""}copyToClipboard(i){return L(this,null,function*(){try{return yield navigator.clipboard.writeText(i),!0}catch(e){return console.error("\u8907\u88FD\u5931\u6557:",e),!1}})}downloadTextFile(i,e){let n=new Blob([i],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(n),z=document.createElement("a");z.href=o,z.download=e||`ocr-result-${new Date().getTime()}.txt`,document.body.appendChild(z),z.click(),document.body.removeChild(z),window.URL.revokeObjectURL(o)}};I.\u0275fac=function(e){return new(e||I)},I.\u0275prov=W({token:I,factory:I.\u0275fac,providedIn:"root"});var se=I;function bi(t,i){t&1&&(c(0,"div",20)(1,"nz-spin",21)(2,"div",22),h(3,"\u6B63\u5728\u8655\u7406\u6587\u4EF6\uFF0C\u8ACB\u7A0D\u5019..."),l()()())}function wi(t,i){if(t&1&&(c(0,"div",24),m(1,"nz-statistic",37),l()),t&2){let e=f(2);a(),u("nzValue",e.ocrResult.pages)}}function Ni(t,i){if(t&1&&(c(0,"div",24),m(1,"nz-statistic",38),l()),t&2){let e=f(2);a(),u("nzValue",(e.ocrResult.confidence*100).toFixed(1))}}function Ri(t,i){t&1&&(c(0,"nz-tag",39),m(1,"i",40),h(2," \u5DF2\u4FDD\u5B58\u5230 Storage "),l())}function Si(t,i){t&1&&(c(0,"nz-tag",41),m(1,"i",42),h(2," \u591A\u9801\u6587\u6A94 "),l())}function Fi(t,i){if(t&1){let e=N();c(0,"div")(1,"div",23)(2,"div",24),m(3,"nz-statistic",25),l(),b(4,wi,2,1,"div",26)(5,Ni,2,1,"div",26),l(),m(6,"nz-divider"),c(7,"div",27),b(8,Ri,3,0,"nz-tag",28)(9,Si,3,0,"nz-tag",29),l(),m(10,"nz-divider"),c(11,"div",30)(12,"h4"),h(13,"\u63D0\u53D6\u7684\u6587\u5B57\u5167\u5BB9\uFF1A"),l(),m(14,"div",31),l(),c(15,"div",32)(16,"button",33),y("click",function(){g(e);let o=f();return _(o.copyText())}),m(17,"i",34),h(18," \u8907\u88FD\u6587\u5B57 "),l(),c(19,"button",33),y("click",function(){g(e);let o=f();return _(o.downloadText())}),m(20,"i",35),h(21," \u4E0B\u8F09\u6587\u5B57 "),l(),c(22,"button",33),y("click",function(){g(e);let o=f();return _(o.clearResult())}),m(23,"i",36),h(24," \u6E05\u9664\u7D50\u679C "),l()()()}if(t&2){let e=f();a(),u("nzGutter",16),a(2),u("nzValue",e.ocrResult.text.length),a(),u("ngIf",e.ocrResult.pages),a(),u("ngIf",e.ocrResult.confidence),a(3),u("ngIf",e.ocrResult.resultPath),a(),u("ngIf",e.ocrResult.pages&&e.ocrResult.pages>1),a(5),u("innerHTML",e.formatText(e.ocrResult.text),Qe)}}function Oi(t,i){t&1&&m(0,"nz-alert",43)}function Ii(t,i){t&1&&(c(0,"nz-tag",44),m(1,"i",45),h(2," Firebase Functions "),l())}var j=class j{constructor(){this.ocrService=p(se);this.fb=p(gt);this.message=p(mt);this.fileList=[];this.selectedFile=null;this.loading=!1;this.ocrResult=null;this.beforeUpload=i=>{let e=i;return this.ocrService.isSupportedFileType(e)?this.ocrService.isValidFileSize(e,20)?(this.selectedFile=e,this.fileList=[i],!1):(this.message.error("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u904E 20MB\uFF01"),!1):(this.message.error("\u8ACB\u4E0A\u50B3 PDF\u3001TIFF \u6216\u5716\u7247\u6587\u4EF6\uFF01"),!1)}}ngOnInit(){this.initForm()}initForm(){this.optionsForm=this.fb.group({saveResult:[!1],pdfFirstPageOnly:[!1]})}handleChange(i){i.file.status==="removed"&&(this.selectedFile=null,this.fileList=[],this.clearResult())}startOcr(){return L(this,null,function*(){if(!this.selectedFile){this.message.warning("\u8ACB\u5148\u9078\u64C7\u6587\u4EF6\uFF01");return}this.loading=!0,this.ocrResult=null;try{let i=yield this.ocrService.fileToArrayBuffer(this.selectedFile);this.ocrService.extractFromBuffer(i).subscribe({next:e=>{this.ocrResult=e,this.message.success("OCR \u8655\u7406\u5B8C\u6210\uFF01"),this.loading=!1},error:e=>{console.error("OCR Error:",e),this.message.error(`OCR \u8655\u7406\u5931\u6557: ${e.message}`),this.loading=!1}})}catch(i){console.error("File processing error:",i),this.message.error("\u6587\u4EF6\u8655\u7406\u5931\u6557\uFF01"),this.loading=!1}})}formatText(i){return this.ocrService.formatText(i)}copyText(){return L(this,null,function*(){if(!this.ocrResult?.text)return;(yield this.ocrService.copyToClipboard(this.ocrResult.text))?this.message.success("\u6587\u5B57\u5DF2\u8907\u88FD\u5230\u526A\u8CBC\u677F\uFF01"):this.message.error("\u8907\u88FD\u5931\u6557\uFF01")})}downloadText(){this.ocrResult?.text&&(this.ocrService.downloadTextFile(this.ocrResult.text),this.message.success("\u6587\u5B57\u6587\u4EF6\u5DF2\u4E0B\u8F09\uFF01"))}clearResult(){this.ocrResult=null,this.message.info("\u7D50\u679C\u5DF2\u6E05\u9664")}};j.\u0275fac=function(e){return new(e||j)},j.\u0275cmp=B({type:j,selectors:[["app-tree-pdf-scan"]],decls:38,vars:12,consts:[["extraTemplate",""],[1,"pdf-scan-container"],["nzTitle","PDF OCR \u6587\u5B57\u6383\u63CF",3,"nzExtra"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],["nzSize","small","nzTitle","\u6587\u4EF6\u4E0A\u50B3"],["nzType","drag",3,"nzChange","nzMultiple","nzAccept","nzBeforeUpload","nzFileList"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nz-form","",3,"formGroup"],["nz-checkbox","","formControlName","saveResult"],["formControlName","pdfFirstPageOnly","nzCheckedChildren","\u50C5\u7B2C\u4E00\u9801","nzUnCheckedChildren","\u5B8C\u6574\u6587\u6A94"],["nz-button","","nzType","primary","nzSize","large","nzBlock","",3,"click","nzLoading","disabled"],["nz-icon","","nzType","eye"],["nzSize","small","nzTitle","\u6383\u63CF\u7D50\u679C"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["nzType","info","nzMessage","\u8ACB\u4E0A\u50B3\u6587\u4EF6\u4E26\u958B\u59CB OCR \u6383\u63CF","nzShowIcon","",4,"ngIf"],[1,"loading-container"],["nzSize","large"],[1,"loading-text"],["nz-row","",1,"stats-row",3,"nzGutter"],["nz-col","","nzSpan","8"],["nzTitle","\u6587\u5B57\u9577\u5EA6","nzSuffix","\u5B57\u7B26",3,"nzValue"],["nz-col","","nzSpan","8",4,"ngIf"],[1,"result-tags"],["nzColor","success",4,"ngIf"],["nzColor","processing",4,"ngIf"],[1,"text-result"],[1,"text-content",3,"innerHTML"],[1,"action-buttons"],["nz-button","","nzType","default",3,"click"],["nz-icon","","nzType","copy"],["nz-icon","","nzType","download"],["nz-icon","","nzType","close"],["nzTitle","\u9801\u6578","nzSuffix","\u9801",3,"nzValue"],["nzTitle","\u4FE1\u5FC3\u5EA6","nzSuffix","%",3,"nzValue"],["nzColor","success"],["nz-icon","","nzType","save"],["nzColor","processing"],["nz-icon","","nzType","file"],["nzType","info","nzMessage","\u8ACB\u4E0A\u50B3\u6587\u4EF6\u4E26\u958B\u59CB OCR \u6383\u63CF","nzShowIcon",""],["nzColor","blue"],["nz-icon","","nzType","cloud"]],template:function(e,n){if(e&1){let o=N();c(0,"div",1)(1,"nz-card",2)(2,"div",3)(3,"div",4)(4,"nz-card",5)(5,"nz-upload",6),y("nzChange",function($){return g(o),_(n.handleChange($))}),c(6,"p",7),m(7,"i",8),l(),c(8,"p",9),h(9,"\u9EDE\u64CA\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u5340\u57DF\u4E0A\u50B3"),l(),c(10,"p",10),h(11," \u652F\u63F4 PDF\u3001TIFF\u3001JPG\u3001PNG \u7B49\u683C\u5F0F"),m(12,"br"),h(13," \u55AE\u500B\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u904E 20MB "),l()(),m(14,"nz-divider"),c(15,"form",11)(16,"nz-form-item")(17,"nz-form-label"),h(18,"\u8655\u7406\u6A21\u5F0F"),l(),c(19,"nz-form-control")(20,"label",12),h(21,"\u4FDD\u5B58\u7D50\u679C\u5230 Storage"),l()()(),c(22,"nz-form-item")(23,"nz-form-label"),h(24,"PDF \u8655\u7406"),l(),c(25,"nz-form-control"),m(26,"nz-switch",13),l()()(),m(27,"nz-divider"),c(28,"button",14),y("click",function(){return g(o),_(n.startOcr())}),m(29,"i",15),h(30," \u958B\u59CB OCR \u6383\u63CF "),l()()(),c(31,"div",4)(32,"nz-card",16),b(33,bi,4,0,"div",17)(34,Fi,25,7,"div",18)(35,Oi,1,0,"nz-alert",19),l()()()()(),b(36,Ii,3,0,"ng-template",null,0,ee)}if(e&2){let o=J(37);a(),u("nzExtra",o),a(),u("nzGutter",24),a(3),u("nzMultiple",!1)("nzAccept",".pdf,.tiff,.tif,.jpg,.jpeg,.png,.gif")("nzBeforeUpload",n.beforeUpload)("nzFileList",n.fileList),a(10),u("formGroup",n.optionsForm),a(13),u("nzLoading",n.loading)("disabled",!n.selectedFile),a(5),u("ngIf",n.loading),a(),u("ngIf",!n.loading&&n.ocrResult),a(),u("ngIf",!n.loading&&!n.ocrResult)}},dependencies:[Xe,Ke,_t,zt,ft,ht,xt,Ct,yt,qt,$t,pt,lt,st,at,jt,Vt,At,It,Ot,Mt,kt,Pt,Bt,oe,St,Rt,Nt,wt,Yt,bt,vt,Wt,Ht,Dt,Lt,Ut,Gt,Qt,Et,Tt],styles:[".pdf-scan-container[_ngcontent-%COMP%]{padding:24px}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:50px 0}.loading-text[_ngcontent-%COMP%]{margin-top:16px;color:#666}.stats-row[_ngcontent-%COMP%], .result-tags[_ngcontent-%COMP%]{margin-bottom:16px}.result-tags[_ngcontent-%COMP%]   nz-tag[_ngcontent-%COMP%]{margin-right:8px}.text-result[_ngcontent-%COMP%]{margin-bottom:24px}.text-content[_ngcontent-%COMP%]{background:#f5f5f5;padding:16px;border-radius:6px;max-height:300px;overflow-y:auto;white-space:pre-wrap;word-wrap:break-word;font-family:Courier New,monospace;font-size:14px;line-height:1.6}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:120px}[_nghost-%COMP%]     .ant-upload.ant-upload-drag{background:#fafafa}[_nghost-%COMP%]     .ant-upload-drag-icon i{font-size:48px;color:#1890ff}"]});var Kt=j;export{Kt as TreePdfScanComponent};

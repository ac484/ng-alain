import{a as _n,b as Sn,c as yn}from"./chunk-GYPN7F4O.js";import{a as on,b as St}from"./chunk-3FT5BVEM.js";import{a as Nn}from"./chunk-KSTLQBRT.js";import{c as vn}from"./chunk-WRC6T4QQ.js";import"./chunk-X36VYPCJ.js";import{n as Oi}from"./chunk-LZHHB3SB.js";import"./chunk-SIZM2XL7.js";import"./chunk-2DVOMO4J.js";import"./chunk-R6MQLA7X.js";import{a as Mn,d as te,h as oe,i as Hi,j as ne,m as re,p as ae,r as pe}from"./chunk-VBHAP5ML.js";import{d as ie}from"./chunk-G74ALAER.js";import{a as gn,b as ee}from"./chunk-26SH3NET.js";import{a as Cn,b as se}from"./chunk-JEGYFCNI.js";import"./chunk-NVDFEF5M.js";import{a as rn,e as sn,g as H,h as Bt,i as zt,j as Y}from"./chunk-5K3L5NDZ.js";import{b as an}from"./chunk-DIDUPPIN.js";import{B as ki,N as tn,a as $o,e as Ri,f as Ht,g as Bi,i as Zo,j as vi,m as P,t as Li}from"./chunk-6253ML26.js";import{b as I}from"./chunk-LI7UBDJM.js";import{b as U}from"./chunk-IZSVHWVC.js";import{b as ue}from"./chunk-C45SM7OZ.js";import{a as qt,b as Zt,c as Xt,d as Yt,e as K}from"./chunk-D5PHB2FG.js";import{b as $,k as q}from"./chunk-4JVOCDVL.js";import{a as hn,b as X}from"./chunk-J7YN77AB.js";import{e as V}from"./chunk-MFG6XL3Q.js";import{a as zn,f as Rt,h as Gi,k as Z}from"./chunk-OETAK3GR.js";import{c as ln,f as pn,h as un,j as dn,k as cn,l as fn,n as W}from"./chunk-B2QFLHEA.js";import{d as L}from"./chunk-QI74WDX5.js";import{c as k}from"./chunk-LVQ7KXE6.js";import{j as G}from"./chunk-2E6GDIHE.js";import"./chunk-JYBAKELG.js";import{b as Vi,c as Ui,d as j}from"./chunk-GHD2FGWK.js";import"./chunk-DNAKBF6E.js";import"./chunk-GXVUYNK4.js";import{A as B,d as Pt,g as yt,h as jt,k as Wt,m as bt,n as $t,o as nn,z as R}from"./chunk-BQVMEIZ5.js";import{c as me,l as le}from"./chunk-EJPHIAHG.js";import{h as en,k as F}from"./chunk-N7DLCMW5.js";import{a as wt,b as O}from"./chunk-ZEZPGFWG.js";import{a as mn,b as D}from"./chunk-PUGKNFED.js";import{a as ht,b as gt,c as J}from"./chunk-FKZEB7ER.js";import{d as we}from"./chunk-3UXJQ3KI.js";import{j as jo,m as Wo,n as Pi}from"./chunk-EXZNONST.js";import"./chunk-FWGM4PSC.js";import{L as Qo,g as Ko}from"./chunk-L6VFZVUC.js";import{f as Me,g as Q}from"./chunk-5G6BXQUB.js";import{a as ce,b as ve,d as ze,e as E}from"./chunk-L3XAXJTY.js";import"./chunk-SUWO6CW6.js";import"./chunk-PV63DGP2.js";import"./chunk-EOTHDIY5.js";import"./chunk-6W2MZKTD.js";import"./chunk-TWOZTKVL.js";import{h as Yo,i as Jo,j as A}from"./chunk-27W33B5M.js";import"./chunk-VF6IKWU5.js";import{Aa as xo,Bd as Vo,Cb as Ct,Cc as ge,Cd as Ft,Dc as Lo,Eb as vt,Fb as Dt,Fd as Uo,Hb as xt,Hc as Nt,Hd as Go,Ib as At,Ic as _t,Jb as f,Jc as ko,Jh as Ii,Ka as po,Kb as m,Kh as T,Lb as l,Lc as Ut,Lh as Xo,Mb as Ce,Na as yi,Nb as bi,Ob as wi,Od as Ho,Qa as Ao,Qb as Ti,R as Eo,Rb as Ei,Ta as Fo,Tb as fe,Vd as Fi,Wb as C,Za as p,Zb as v,_d as qo,bc as Ro,cc as Bo,cd as Di,ce as zo,d as zi,dc as Io,ea as lo,ed as Oo,fd as fo,g as mo,h as bo,hc as Lt,ja as It,jb as b,jc as co,ka as gi,kb as Mi,lb as uo,ma as Do,mc as d,nc as Ae,oa as M,oc as _e,pb as de,pc as Vt,r as hi,rb as Ni,rc as Se,sb as Po,sc as ye,tc as be,ua as S,va as y,vd as Gt,w as To,wd as xi,yc as Ci,yd as Ai}from"./chunk-BJGZKRME.js";import{b as wo}from"./chunk-PMZOYKO3.js";import{a as ft,d as In,f as So,i as yo}from"./chunk-57BLH6QZ.js";var Co=In((Mo,No)=>{"use strict";(function(n,i){typeof define=="function"&&define.amd?define([],i):typeof Mo<"u"?i():(i(),n.FileSaver={})})(Mo,function(){"use strict";function n(h,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function i(h,o,a){var s=new XMLHttpRequest;s.open("GET",h),s.responseType="blob",s.onload=function(){c(s.response,o,a)},s.onerror=function(){console.error("could not download file")},s.send()}function e(h){var o=new XMLHttpRequest;o.open("HEAD",h,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function t(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(o)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,u=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,o,a){var s=r.URL||r.webkitURL,z=document.createElement("a");o=o||h.name||"download",z.download=o,z.rel="noopener",typeof h=="string"?(z.href=h,z.origin===location.origin?t(z):e(z.href)?i(h,o,a):t(z,z.target="_blank")):(z.href=s.createObjectURL(h),setTimeout(function(){s.revokeObjectURL(z.href)},4e4),setTimeout(function(){t(z)},0))}:"msSaveOrOpenBlob"in navigator?function(h,o,a){if(o=o||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(n(h,a),o);else if(e(h))i(h,o,a);else{var s=document.createElement("a");s.href=h,s.target="_blank",setTimeout(function(){t(s)})}}:function(h,o,a,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof h=="string")return i(h,o,a);var z=h.type==="application/octet-stream",g=/constructor/i.test(r.HTMLElement)||r.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||z&&g||u)&&typeof FileReader<"u"){var N=new FileReader;N.onloadend=function(){var Mt=N.result;Mt=_?Mt:Mt.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=Mt:location=Mt,s=null},N.readAsDataURL(h)}else{var x=r.URL||r.webkitURL,w=x.createObjectURL(h);s?s.location=w:location.href=w,s=null,setTimeout(function(){x.revokeObjectURL(w)},4e4)}});r.saveAs=c.saveAs=c,typeof No<"u"&&(No.exports=c)})});function Ln(n,i){if(n&1){let e=fe();m(0,"div",16)(1,"button",17),C("click",function(){let r=S(e).$implicit,u=v();return y(u.setRole(r.id))}),d(2),l()()}if(n&2){let e=i.$implicit;p(2),Vt(" ",e.name," (",e.id,") ")}}function kn(n,i){if(n&1&&(m(0,"nz-tag",20),d(1),l()),n&2){let e=i.$implicit;p(),_e(" ",e," ")}}function On(n,i){if(n&1&&(m(0,"div")(1,"p")(2,"strong"),d(3,"\u89D2\u8272\uFF1A"),l(),d(4),l(),m(5,"p")(6,"strong"),d(7,"\u6B0A\u9650\uFF1A"),l()(),de(8,kn,2,1,"nz-tag",18),m(9,"p",19)(10,"small"),d(11),Nt(12,"date"),l()()()),n&2){let e=i.ngIf;p(4),Ae(e.roles.join(", ")||"\u7121"),p(4),f("ngForOf",e.permissions),p(3),_e("\u6700\u5F8C\u66F4\u65B0\uFF1A",ko(12,3,e.updatedAt,"medium"))}}function Vn(n,i){n&1&&(m(0,"p",21),d(1,"\u8ACB\u5148\u767B\u5165\u4EE5\u67E5\u770B\u6B0A\u9650"),l())}var Jt=class Jt{constructor(){this.aclSrv=M(Bi);this.menuSrv=M(Li);this.auth=M(Oi);this.firebaseACLSrv=M(St);this.full=!1;this.availableRoles=[];this.currentUserACL$=this.firebaseACLSrv.userACL$}ngOnInit(){this.loadAvailableRoles()}get data(){return this.aclSrv.data}reMenu(){this.menuSrv.resume()}loadAvailableRoles(){this.firebaseACLSrv.getRoles().subscribe(i=>{this.availableRoles=i})}toggleFull(){this.full=!this.full,this.aclSrv.setFull(this.full),this.reMenu()}setRole(i){let e=this.auth.currentUser;if(!e)return;let t=this.availableRoles.find(r=>r.id===i);t&&this.firebaseACLSrv.updateUserACL(e.uid,[i],t.permissions).subscribe(()=>{this.reMenu()})}clearACL(){let i=this.auth.currentUser;i&&this.firebaseACLSrv.updateUserACL(i.uid,[],[]).subscribe(()=>{this.reMenu()})}};Jt.\u0275fac=function(e){return new(e||Jt)},Jt.\u0275cmp=b({type:Jt,selectors:[["app-acl"]],decls:42,vars:21,consts:[["noUser",""],[1,"alain-default__content-title"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzTitle","\u6B0A\u9650\u72C0\u614B"],[1,"mt-md"],["nz-button","","nzType","default",3,"acl"],["nz-button","","nzType","default",1,"ml-sm",3,"acl"],["nzTitle","\u5168\u91CF\u6B0A\u9650"],["nz-button","",3,"click","nzType"],[1,"pt-md","text-grey"],["nzTitle","\u89D2\u8272\u5207\u63DB"],["class","mb-sm",4,"ngFor","ngForOf"],["nz-button","","nzType","dashed","nzBlock","",1,"mt-md",3,"click"],["nzTitle","\u7576\u524D\u7528\u6236\u6B0A\u9650"],[4,"ngIf","ngIfElse"],[1,"mb-sm"],["nz-button","","nzType","default","nzBlock","",3,"click"],["class","mb-xs",4,"ngFor","ngForOf"],[1,"mt-md","text-grey"],[1,"mb-xs"],[1,"text-grey"]],template:function(e,t){if(e&1){let r=fe();m(0,"div",1)(1,"h1"),d(2," ACL \u6B0A\u9650\u63A7\u5236 (Firestore \u6574\u5408) "),m(3,"small"),d(4," \u6CE8\u610F\u89C0\u5BDF\u5DE6\u908A\u7684\u9078\u55AE\uFF1BACL \u670D\u52D9\u63D0\u4F9B\u5B8C\u6574\u7684\u57FA\u65BC\u89D2\u8272\u7684\u8A2A\u554F\u63A7\u5236\uFF0C\u73FE\u5728\u6574\u5408\u4E86 Firestore \u5F8C\u7AEF\u5B58\u5132\u3002 "),l()()(),m(5,"div",2)(6,"div",3)(7,"nz-card",4)(8,"p")(9,"strong"),d(10,"\u7576\u524D ACL \u8CC7\u6599\uFF1A"),l(),d(11),Nt(12,"json"),l(),m(13,"div",5)(14,"button",6),d(15,"\u7528\u6236\u6B0A\u9650"),l(),m(16,"button",7),d(17,"\u8A8D\u8B49\u7528\u6236"),l(),m(18,"button",7),d(19,"\u7BA1\u7406\u54E1\u6B0A\u9650"),l(),m(20,"button",7),d(21,"\u5100\u8868\u677F\u8B80\u53D6"),l(),m(22,"button",7),d(23,"\u7BA1\u7406\u54E1\u8A2A\u554F"),l()()()()(),m(24,"div",2)(25,"div",3)(26,"nz-card",8)(27,"button",9),C("click",function(){return S(r),y(t.toggleFull())}),d(28),l(),m(29,"p",10),d(30,"\u5168\u91CF\u6B0A\u9650\u6307\u7CFB\u7D71\u7BA1\u7406\u54E1\u89D2\u8272\uFF0C\u7121\u4EFB\u4F55\u9650\u5236\u3002"),l()()(),m(31,"div",3)(32,"nz-card",11),de(33,Ln,3,2,"div",12),m(34,"button",13),C("click",function(){return S(r),y(t.clearACL())}),d(35," \u6E05\u9664\u6B0A\u9650 "),l()()(),m(36,"div",3)(37,"nz-card",14),de(38,On,13,6,"div",15),Nt(39,"async"),de(40,Vn,2,0,"ng-template",null,0,Ut),l()()()}if(e&2){let r=Lt(41);p(5),f("nzGutter",16),p(),f("nzSpan",24),p(5),Ae(_t(12,17,t.data)),p(3),f("acl","user"),p(2),f("acl","user1"),p(2),f("acl","admin"),p(2),f("acl","dashboard:read"),p(2),f("acl","admin:access"),p(2),f("nzGutter",16),p(),f("nzSpan",8),p(2),f("nzType",t.full?"primary":"default"),p(),_e(" ",t.full?"\u95DC\u9589":"\u958B\u555F","\u5168\u91CF\u6B0A\u9650 "),p(3),f("nzSpan",8),p(2),f("ngForOf",t.availableRoles),p(3),f("nzSpan",8),p(2),f("ngIf",_t(39,19,t.currentUserACL$))("ngIfElse",r)}},dependencies:[R,B,te,Y,ae,re,ne,Zo,E,ze,ce,ve,G,J,gt,ht,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,wt,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,xi,Gt,Ft,Ai,Vo],encapsulation:2});var ji=Jt;function Un(n,i){if(n&1&&(m(0,"nz-tag",13),d(1),l()),n&2){let e=i.$implicit;p(),_e(" ",e," ")}}function Gn(n,i){if(n&1){let e=fe();m(0,"div",6)(1,"nz-card",7)(2,"div",8)(3,"div",2)(4,"h4"),d(5),l(),m(6,"p",9),d(7),l(),m(8,"div"),de(9,Un,2,1,"nz-tag",10),l()(),m(10,"div",11)(11,"nz-switch",12),C("ngModelChange",function(r){let u=S(e).$implicit,c=v();return y(c.toggleRoleStatus(u.id,r))}),l()()()()()}if(n&2){let e=i.$implicit;p(3),f("nzSpan",18),p(2),Vt("",e.name," (",e.id,")"),p(2),Ae(e.description),p(2),f("ngForOf",e.permissions),p(),f("nzSpan",6),p(),f("ngModel",e.isActive)}}function Hn(n,i){if(n&1){let e=fe();m(0,"div",6)(1,"nz-card",7)(2,"div",8)(3,"div",2)(4,"h4"),d(5),l(),m(6,"p",9),d(7),l(),m(8,"nz-tag"),d(9),l()(),m(10,"div",11)(11,"nz-switch",12),C("ngModelChange",function(r){let u=S(e).$implicit,c=v();return y(c.togglePermissionStatus(u.id,r))}),l()()()()()}if(n&2){let e=i.$implicit;p(3),f("nzSpan",18),p(2),Vt("",e.name," (",e.id,")"),p(2),Ae(e.description),p(2),Vt("",e.resource,":",e.action),p(),f("nzSpan",6),p(),f("ngModel",e.isActive)}}var Kt=class Kt{constructor(){this.firebaseACLSrv=M(St);this.message=M(we);this.roles=[];this.permissions=[]}ngOnInit(){this.loadData()}loadData(){this.firebaseACLSrv.getRoles().subscribe(i=>{this.roles=i}),this.firebaseACLSrv.getPermissions().subscribe(i=>{this.permissions=i})}toggleRoleStatus(i,e){this.message.info(`\u89D2\u8272 ${i} \u72C0\u614B\u5DF2${e?"\u555F\u7528":"\u505C\u7528"}`)}togglePermissionStatus(i,e){this.message.info(`\u6B0A\u9650 ${i} \u72C0\u614B\u5DF2${e?"\u555F\u7528":"\u505C\u7528"}`)}};Kt.\u0275fac=function(e){return new(e||Kt)},Kt.\u0275cmp=b({type:Kt,selectors:[["app-acl-admin"]],decls:10,vars:5,consts:[[1,"alain-default__content-title"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzTitle","\u89D2\u8272\u7BA1\u7406"],["class","mb-md",4,"ngFor","ngForOf"],["nzTitle","\u6B0A\u9650\u7BA1\u7406"],[1,"mb-md"],["nzSize","small"],["nz-row",""],[1,"text-grey"],["class","mb-xs",4,"ngFor","ngForOf"],["nz-col","",1,"text-right",3,"nzSpan"],[3,"ngModelChange","ngModel"],[1,"mb-xs"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2,"ACL \u7BA1\u7406"),l()(),m(3,"div",1)(4,"div",2)(5,"nz-card",3),de(6,Gn,12,7,"div",4),l()(),m(7,"div",2)(8,"nz-card",5),de(9,Hn,12,8,"div",4),l()()()),e&2&&(p(3),f("nzGutter",16),p(),f("nzSpan",12),p(2),f("ngForOf",t.roles),p(),f("nzSpan",12),p(2),f("ngForOf",t.permissions))},dependencies:[R,yt,bt,B,te,Y,ae,re,ne,E,G,J,gt,ht,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,wt,oe,le,ee,gn,k,K,me,D,Q,Me,U,ue,H,A,Gt],encapsulation:2});var Wi=Kt;var jn=()=>({show:!0});function Wn(n,i){if(n&1){let e=fe();m(0,"button",4),C("click",function(){let r=S(e).$implicit,u=v();return y(u.editUser(r))}),d(1,"\u7DE8\u8F2F"),l(),m(2,"button",5),C("click",function(){let r=S(e).$implicit,u=v();return y(u.deleteUser(r))}),d(3,"\u522A\u9664"),l()}}var Qt=class Qt{constructor(){this.firebaseUserSrv=M(on);this.message=M(we);this.total=0;this.columns=[{title:"UID",index:"uid",width:200},{title:"Email",index:"email"},{title:"\u986F\u793A\u540D\u7A31",index:"displayName"},{title:"\u89D2\u8272",index:"role"},{title:"\u72C0\u614B",index:"isActive",type:"yn"},{title:"\u6700\u5F8C\u767B\u5165",index:"lastLoginAt",type:"date"},{title:"\u64CD\u4F5C",render:"actions",width:120}]}ngOnInit(){this.loadUsers()}loadUsers(){this.users$=this.firebaseUserSrv.getAllUsers(),this.users$.subscribe(i=>{this.total=i.length})}editUser(i){this.message.info(`\u7DE8\u8F2F\u7528\u6236: ${i.email}`)}deleteUser(i){this.message.info(`\u522A\u9664\u7528\u6236: ${i.email}`)}};Qt.\u0275fac=function(e){return new(e||Qt)},Qt.\u0275cmp=b({type:Qt,selectors:[["app-acl-users"]],decls:6,vars:5,consts:[["st",""],[1,"alain-default__content-title"],[3,"data","columns","total","page"],["st-row","actions"],["nz-button","","nzType","link",3,"click"],["nz-button","","nzType","link","nzDanger","",3,"click"]],template:function(e,t){e&1&&(m(0,"div",1)(1,"h1"),d(2,"\u7528\u6236\u7BA1\u7406"),l()(),m(3,"st",2,0),de(5,Wn,4,0,"ng-template",3),l()),e&2&&(p(3),f("data",t.users$)("columns",t.columns)("total",t.total)("page",ge(4,jn)))},dependencies:[R,B,te,Y,zt,Bt,ae,re,ne,E,ze,ce,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,U,ue,H,A],encapsulation:2});var $i=Qt;var $n=()=>({show:!0});function qn(n,i){if(n&1&&(m(0,"nz-tag",6),d(1),l()),n&2){let e=i.$implicit;p(),_e(" ",e," ")}}function Zn(n,i){if(n&1&&de(0,qn,2,1,"nz-tag",5),n&2){let e=i.$implicit;f("ngForOf",e.permissions)}}function Xn(n,i){if(n&1){let e=fe();m(0,"button",7),C("click",function(){let r=S(e).$implicit,u=v();return y(u.editRole(r))}),d(1,"\u7DE8\u8F2F"),l(),m(2,"button",8),C("click",function(){let r=S(e).$implicit,u=v();return y(u.deleteRole(r))}),d(3,"\u522A\u9664"),l()}}var ei=class ei{constructor(){this.firebaseACLSrv=M(St);this.message=M(we);this.total=0;this.columns=[{title:"ID",index:"id",width:150},{title:"\u540D\u7A31",index:"name"},{title:"\u63CF\u8FF0",index:"description"},{title:"\u6B0A\u9650",render:"permissions",width:300},{title:"\u72C0\u614B",index:"isActive",type:"yn"},{title:"\u5EFA\u7ACB\u6642\u9593",index:"createdAt",type:"date"},{title:"\u64CD\u4F5C",render:"actions",width:120}]}ngOnInit(){this.loadRoles()}loadRoles(){this.roles$=this.firebaseACLSrv.getRoles(),this.roles$.subscribe(i=>{this.total=i.length})}editRole(i){this.message.info(`\u7DE8\u8F2F\u89D2\u8272: ${i.name}`)}deleteRole(i){this.message.info(`\u522A\u9664\u89D2\u8272: ${i.name}`)}};ei.\u0275fac=function(e){return new(e||ei)},ei.\u0275cmp=b({type:ei,selectors:[["app-acl-roles"]],decls:7,vars:5,consts:[["st",""],[1,"alain-default__content-title"],[3,"data","columns","total","page"],["st-row","permissions"],["st-row","actions"],["class","mb-xs",4,"ngFor","ngForOf"],[1,"mb-xs"],["nz-button","","nzType","link",3,"click"],["nz-button","","nzType","link","nzDanger","",3,"click"]],template:function(e,t){e&1&&(m(0,"div",1)(1,"h1"),d(2,"\u89D2\u8272\u7BA1\u7406"),l()(),m(3,"st",2,0),de(5,Zn,1,1,"ng-template",3)(6,Xn,4,0,"ng-template",4),l()),e&2&&(p(3),f("data",t.roles$)("columns",t.columns)("total",t.total)("page",ge(4,$n)))},dependencies:[R,B,te,Y,zt,Bt,ae,re,ne,E,ze,ce,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,wt,oe,le,ee,k,K,me,D,Q,U,ue,H,A],encapsulation:2});var qi=ei;var Yn=()=>({show:!0});function Jn(n,i){if(n&1){let e=fe();m(0,"button",4),C("click",function(){let r=S(e).$implicit,u=v();return y(u.editPermission(r))}),d(1,"\u7DE8\u8F2F"),l(),m(2,"button",5),C("click",function(){let r=S(e).$implicit,u=v();return y(u.deletePermission(r))}),d(3,"\u522A\u9664"),l()}}var ti=class ti{constructor(){this.firebaseACLSrv=M(St);this.message=M(we);this.total=0;this.columns=[{title:"ID",index:"id",width:120},{title:"\u540D\u7A31",index:"name",width:150},{title:"\u63CF\u8FF0",index:"description",width:200},{title:"\u8CC7\u6E90",index:"resource",width:120},{title:"\u52D5\u4F5C",index:"action",width:120},{title:"\u72C0\u614B",index:"isActive",type:"yn"},{title:"\u5EFA\u7ACB\u6642\u9593",index:"createdAt",type:"date"},{title:"\u64CD\u4F5C",render:"actions",width:120}]}ngOnInit(){this.loadPermissions()}loadPermissions(){this.permissions$=this.firebaseACLSrv.getPermissions(),this.permissions$.subscribe(i=>{this.total=i.length})}editPermission(i){this.message.info(`\u7DE8\u8F2F\u6B0A\u9650: ${i.name}`)}deletePermission(i){this.message.warning(`\u522A\u9664\u6B0A\u9650: ${i.name}`)}};ti.\u0275fac=function(e){return new(e||ti)},ti.\u0275cmp=b({type:ti,selectors:[["app-acl-permissions"]],decls:6,vars:5,consts:[["st",""],[1,"alain-default__content-title"],[3,"data","columns","total","page"],["st-row","actions"],["nz-button","","nzType","link",3,"click"],["nz-button","","nzType","link","nzDanger","",3,"click"]],template:function(e,t){e&1&&(m(0,"div",1)(1,"h1"),d(2,"\u6B0A\u9650\u7BA1\u7406"),l()(),m(3,"st",2,0),de(5,Jn,4,0,"ng-template",3),l()),e&2&&(p(3),f("data",t.permissions$)("columns",t.columns)("total",t.total)("page",ge(4,Yn)))},dependencies:[R,B,te,Y,zt,Bt,ae,re,ne,E,ze,ce,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,U,ue,H,A],encapsulation:2});var Zi=ti;var Kn=new Do("DC_STORE_STORAGE_TOKEN",{providedIn:"root",factory:()=>new go}),go=class{platform=M(zo);get(i){return this.platform.isBrowser&&JSON.parse(localStorage.getItem(i)||"null")||null}set(i,e){return this.platform.isBrowser&&localStorage.setItem(i,JSON.stringify(e)),!0}remove(i){this.platform.isBrowser&&localStorage.removeItem(i)}},bn=(()=>{class n{store=M(Kn);http=M(Fi);platform=M(zo);memory=new Map;notifyBuffer=new Map;meta=new Set;freqTick=3e3;freqTime;cog=M(Ht).merge("cache",{mode:"promise",reName:"",prefix:"",meta_key:"__cache_meta"});constructor(){this.platform.isBrowser&&(this.loadMeta(),this.startExpireNotify())}pushMeta(e){this.meta.has(e)||(this.meta.add(e),this.saveMeta())}removeMeta(e){this.meta.has(e)&&(this.meta.delete(e),this.saveMeta())}loadMeta(){let e=this.store.get(this.cog.meta_key);e&&e.v&&e.v.forEach(t=>this.meta.add(t))}saveMeta(){let e=[];this.meta.forEach(t=>e.push(t)),this.store.set(this.cog.meta_key,{v:e,e:0})}getMeta(){return this.meta}set(e,t,r={}){if(!this.platform.isBrowser)return;let u=0,{type:c,expire:h}=this.cog;r=ft({type:c,expire:h},r),r.expire&&(u=Ko(new Date,r.expire).valueOf());let o=r.emitNotify!==!1;if(!(t instanceof zi)){this.save(r.type,e,{v:t,e:u},o);return}return t.pipe(lo(a=>{this.save(r.type,e,{v:a,e:u},o)}))}save(e,t,r,u=!0){e==="m"?this.memory.set(t,r):(this.store.set(this.cog.prefix+t,r),this.pushMeta(t)),u&&this.runNotify(t,"set")}get(e,t={}){if(!this.platform.isBrowser)return null;let r=t.mode!=="none"&&this.cog.mode==="promise",u=this.memory.has(e)?this.memory.get(e):this.store.get(this.cog.prefix+e);return!u||u.e&&u.e>0&&u.e<new Date().valueOf()?r?(this.cog.request?this.cog.request(e):this.http.get(e)).pipe(To(c=>$o(c,this.cog.reName,c)),lo(c=>this.set(e,c,{type:t.type,expire:t.expire,emitNotify:t.emitNotify}))):null:r?hi(u.v):u.v}getNone(e){return this.get(e,{mode:"none"})}tryGet(e,t,r={}){if(!this.platform.isBrowser)return null;let u=this.getNone(e);return u===null?t instanceof zi?this.set(e,t,r):(this.set(e,t,r),t):hi(u)}has(e){return this.memory.has(e)||this.meta.has(e)}_remove(e,t){if(t&&this.runNotify(e,"remove"),this.memory.has(e)){this.memory.delete(e);return}this.store.remove(this.cog.prefix+e),this.removeMeta(e)}remove(e){this.platform.isBrowser&&this._remove(e,!0)}clear(){this.platform.isBrowser&&(this.notifyBuffer.forEach((e,t)=>this.runNotify(t,"remove")),this.memory.clear(),this.meta.forEach(e=>this.store.remove(this.cog.prefix+e)))}set freq(e){this.freqTick=Math.max(20,e),this.abortExpireNotify(),this.startExpireNotify()}startExpireNotify(){this.checkExpireNotify(),this.runExpireNotify()}runExpireNotify(){this.freqTime=setTimeout(()=>{this.checkExpireNotify(),this.runExpireNotify()},this.freqTick)}checkExpireNotify(){let e=[];this.notifyBuffer.forEach((t,r)=>{this.has(r)&&this.getNone(r)===null&&e.push(r)}),e.forEach(t=>{this.runNotify(t,"expire"),this._remove(t,!1)})}abortExpireNotify(){clearTimeout(this.freqTime)}runNotify(e,t){this.notifyBuffer.has(e)&&this.notifyBuffer.get(e).next({type:t,value:this.getNone(e)})}notify(e){if(!this.notifyBuffer.has(e)){let t=new bo(this.getNone(e));this.notifyBuffer.set(e,t)}return this.notifyBuffer.get(e).asObservable()}cancelNotify(e){this.notifyBuffer.has(e)&&(this.notifyBuffer.get(e).unsubscribe(),this.notifyBuffer.delete(e))}hasNotify(e){return this.notifyBuffer.has(e)}clearNotify(){this.notifyBuffer.forEach(e=>e.unsubscribe()),this.notifyBuffer.clear()}ngOnDestroy(){this.memory.clear(),this.abortExpireNotify(),this.clearNotify()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=It({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$a=new Ho(()=>({}));var ii=class ii{constructor(){this.cache=M(bn);this.msg=M(we);this.KEY="user"}set(){this.cache.set(this.KEY,+new Date)}get(){this.msg.success(this.cache.getNone(this.KEY))}};ii.\u0275fac=function(e){return new(e||ii)},ii.\u0275cmp=b({type:ii,selectors:[["app-cache"]],decls:10,vars:0,consts:[[1,"alain-default__content-title"],["href","https://ng-alain.com/components/cache","target","_blank"],["nzTitle","Service"],["nz-button","",3,"click"],["nz-button","",1,"ml-sm",3,"click"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2," Cache \u7F13\u5B58, "),m(3,"a",1),d(4,"Document"),l()()(),m(5,"nz-card",2)(6,"button",3),C("click",function(){return t.set()}),d(7,"\u8BBE\u7F6E"),l(),m(8,"button",4),C("click",function(){return t.get()}),d(9,"\u83B7\u53D6"),l()())},dependencies:[R,B,te,Y,ae,re,ne,E,ze,ce,ve,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A],encapsulation:2});var Xi=ii;var wn=So(Co(),1);var Tn=(()=>{class n{el=M(yi).nativeElement;_http=M(ki);httpData;httpBody;httpMethod="get";httpUrl;fileName;pre;success=new Ni;error=new Ni;getDisposition(e){return(e||"").split(";").filter(r=>r.includes("=")).map(r=>{let u=r.split("="),c="UTF-8''",h=u[1];return h.startsWith(c)&&(h=h.substring(c.length)),{[u[0].trim()]:h}}).reduce((r,u)=>u,{})}isFileSaverSupported=!1;constructor(){try{this.isFileSaverSupported=!!new Blob}catch{}this.isFileSaverSupported||this.el.classList.add("down-file__not-support")}setDisabled(e){let t=this.el;t.disabled=e,t.classList[e?"add":"remove"]("down-file__disabled")}_click(e){return yo(this,null,function*(){if(!this.isFileSaverSupported||typeof this.pre=="function"&&!(yield this.pre(e))){e.stopPropagation(),e.preventDefault();return}this.setDisabled(!0),this._http.request(this.httpMethod,this.httpUrl,{params:this.httpData||{},responseType:"blob",observe:"response",body:this.httpBody}).pipe(Eo(()=>this.setDisabled(!1))).subscribe({next:t=>{if(t.status!==200||t.body.size<=0){this.error.emit(t);return}let r=this.getDisposition(t.headers.get("content-disposition")),u=this.fileName;typeof u=="function"&&(u=u(t)),u=u||r["filename*"]||r.filename||t.headers.get("filename")||t.headers.get("x-filename"),(0,wn.saveAs)(t.body,decodeURI(u)),this.success.emit(t)},error:t=>this.error.emit(t)})})}static \u0275fac=function(t){return new(t||n)};static \u0275dir=uo({type:n,selectors:[["","down-file",""]],hostBindings:function(t,r){t&1&&C("click",function(c){return r._click(c)})},inputs:{httpData:[0,"http-data","httpData"],httpBody:[0,"http-body","httpBody"],httpMethod:[0,"http-method","httpMethod"],httpUrl:[0,"http-url","httpUrl"],fileName:[0,"file-name","fileName"],pre:"pre"},outputs:{success:"success",error:"error"},exportAs:["downFile"]})}return n})();function Qn(n,i){if(n&1&&(m(0,"button",2),d(1),l()),n&2){let e=i.$implicit,t=v();f("http-url",Ci("assets/tmp/demo",e))("http-data",t.data),p(),_e(" ",e," ")}}var oi=class oi{constructor(){this.fileTypes=[".xlsx",".docx",".pptx",".pdf"];this.data={otherdata:1,time:new Date}}};oi.\u0275fac=function(e){return new(e||oi)},oi.\u0275cmp=b({type:oi,selectors:[["app-down-file"]],decls:6,vars:0,consts:[[1,"alain-default__content-title"],["nzTitle","DEMO"],["nz-button","","down-file","","file-name","demo\u4E2D\u6587",1,"mr-sm",3,"http-data","http-url"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2,"Download a file"),l()(),m(3,"nz-card",1),xt(4,Qn,2,4,"button",2,Dt),l()),e&2&&(p(4),At(t.fileTypes))},dependencies:[R,B,te,Y,ae,re,ne,E,ze,ce,ve,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,Tn],encapsulation:2});var Yi=oi;var er=n=>({params:n}),ni=class ni{constructor(){this.params={};this.url="/user";this.searchSchema={properties:{no:{type:"string",title:"\u7F16\u53F7"}}};this.columns=[{title:"\u7F16\u53F7",index:"no"},{title:"\u8C03\u7528\u6B21\u6570",type:"number",index:"callNo"},{title:"\u5934\u50CF",type:"img",width:"50px",index:"avatar"},{title:"\u65F6\u95F4",type:"date",index:"updatedAt"}]}};ni.\u0275fac=function(e){return new(e||ni)},ni.\u0275cmp=b({type:ni,selectors:[["app-delon-form"]],decls:5,vars:8,consts:[["st",""],[3,"title"],["mode","search",3,"formSubmit","formReset","schema","formData"],[3,"data","columns","req"]],template:function(e,t){if(e&1){let r=fe();Ce(0,"page-header",1),m(1,"nz-card")(2,"sf",2),C("formSubmit",function(c){S(r);let h=Lt(4);return y(h.reset(c))})("formReset",function(){S(r);let c=Lt(4);return y(c.reset(t.params))}),l(),Ce(3,"st",3,0),l()}e&2&&(f("title","Page Name"),p(2),f("schema",t.searchSchema)("formData",t.params),p(),f("data",t.url)("columns",t.columns)("req",Lo(6,er,t.params)))},dependencies:[R,B,te,Mn,Y,zt,ae,re,ne,Hi,E,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A],encapsulation:2});var Ji=ni;var ri=class ri{};ri.\u0275fac=function(e){return new(e||ri)},ri.\u0275cmp=b({type:ri,selectors:[["app-guard-admin"]],decls:2,vars:0,template:function(e,t){e&1&&(bi(0,"p"),d(1,"\u8FD9\u662F\u4E00\u4E2Aadmin\u9875\u9762"),wi())},encapsulation:2});var Ki=ri;var ai=class ai{};ai.\u0275fac=function(e){return new(e||ai)},ai.\u0275cmp=b({type:ai,selectors:[["app-guard-auth"]],decls:2,vars:0,template:function(e,t){e&1&&(bi(0,"p"),d(1,"\u8FD9\u662F\u4E00\u4E2Auser1\u9875\u9762"),wi())},encapsulation:2});var Qi=ai;var En=()=>{let n=M(en);return new zi(i=>{n.confirm({nzTitle:"\u786E\u8BA4\u8981\u79BB\u5F00\u5417\uFF1F",nzContent:"\u4F60\u5DF2\u7ECF\u586B\u5199\u4E86\u90E8\u5206\u8868\u5355\u79BB\u5F00\u4F1A\u653E\u5F03\u5DF2\u7ECF\u586B\u5199\u7684\u5185\u5BB9\u3002",nzOkText:"\u79BB\u5F00",nzCancelText:"\u53D6\u6D88",nzOnOk:()=>{i.next(!0),i.complete()},nzOnCancel:()=>{i.next(!1),i.complete()}})})};var ir=()=>["/delon/guard/leave"],or=()=>["/delon/guard/auth"],nr=()=>["/delon/guard/admin"];function rr(n,i){n&1&&(m(0,"button",12),d(1," \u96E2\u958B\u78BA\u8A8D\u9801 "),l()),n&2&&f("routerLink",ge(1,ir))}function ar(n,i){n&1&&(m(0,"button",12),d(1," \u9700\u8981 user1 \u6B0A\u9650 "),l()),n&2&&f("routerLink",ge(1,or))}function sr(n,i){n&1&&(m(0,"button",12),d(1," \u9700\u8981\u7BA1\u7406\u54E1\u6B0A\u9650 "),l()),n&2&&f("routerLink",ge(1,nr))}function mr(n,i){if(n&1){let e=fe();m(0,"button",13),C("click",function(){S(e);let r=v();return y(r.setFull(!0))}),d(1," \u8A2D\u7F6E\u5168\u91CF\u6B0A\u9650 "),l()}}function lr(n,i){if(n&1){let e=fe();m(0,"button",17),C("click",function(){S(e);let r=v().$implicit,u=v(2);return y(u.setRole(r.id))}),d(1),l()}if(n&2){let e=v().$implicit;p(),_e(" ",e.name," ")}}function pr(n,i){n&1&&(Ti(0),de(1,lr,2,1,"button",16),Ei())}function ur(n,i){if(n&1&&(m(0,"div")(1,"p",14)(2,"strong"),d(3,"\u53EF\u7528\u89D2\u8272\uFF1A"),l()(),m(4,"nz-space"),de(5,pr,2,0,"ng-container",15),l()()),n&2){let e=v();p(5),f("ngForOf",e.availableRoles)}}function dr(n,i){if(n&1){let e=fe();m(0,"button",18),C("click",function(){S(e);let r=v();return y(r.clearACL())}),d(1," \u6E05\u9664\u6B0A\u9650 "),l()}}function cr(n,i){if(n&1&&(m(0,"nz-tag",21),d(1),l()),n&2){let e=i.$implicit;p(),_e(" ",e," ")}}function fr(n,i){if(n&1&&(m(0,"div",19)(1,"p")(2,"strong"),d(3,"\u7528\u6236\u6B0A\u9650\uFF1A"),l()(),m(4,"p"),d(5),l(),m(6,"p"),d(7,"\u6B0A\u9650\uFF1A"),l(),de(8,cr,2,1,"nz-tag",20),l()),n&2){let e=i.ngIf;p(5),_e("\u89D2\u8272\uFF1A",e.roles.join(", ")||"\u7121"),p(3),f("ngForOf",e.permissions)}}var si=class si{constructor(){this.aclSrv=M(Bi);this.menuSrv=M(Li);this.router=M(Wo);this.auth=M(Oi);this.firebaseACLSrv=M(St);this.availableRoles=[];this.currentUserACL$=this.firebaseACLSrv.userACL$}ngOnInit(){this.loadAvailableRoles()}get data(){return this.aclSrv.data}loadAvailableRoles(){this.firebaseACLSrv.getRoles().subscribe(i=>{this.availableRoles=i})}setRole(i){let e=this.auth.currentUser;if(!e)return;let t=this.availableRoles.find(r=>r.id===i);t&&this.firebaseACLSrv.updateUserACL(e.uid,[i],t.permissions).subscribe(()=>{this.menuSrv.resume(),this.router.navigate(["/delon/guard"])})}setFull(i){this.aclSrv.setFull(i),this.menuSrv.resume(),this.router.navigate(["/delon/guard"])}clearACL(){let i=this.auth.currentUser;i&&this.firebaseACLSrv.updateUserACL(i.uid,[],[]).subscribe(()=>{this.menuSrv.resume(),this.router.navigate(["/delon/guard"])})}};si.\u0275fac=function(e){return new(e||si)},si.\u0275cmp=b({type:si,selectors:[["app-guard"]],decls:28,vars:11,consts:[[1,"alain-default__content-title"],["nz-row","",1,"mb-lg",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzTitle","\u8DEF\u7531\u6E2C\u8A66"],["nz-button","",3,"routerLink",4,"nzSpaceItem"],["nzTitle","\u6B0A\u9650\u63A7\u5236"],["nzDirection","vertical",2,"width","100%"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],[4,"nzSpaceItem"],["nz-button","","nzType","dashed",3,"click",4,"nzSpaceItem"],["nzTitle","\u7576\u524D\u72C0\u614B"],["class","mt-md",4,"ngIf"],["nz-button","",3,"routerLink"],["nz-button","","nzType","primary",3,"click"],[1,"mb-sm"],[4,"ngFor","ngForOf"],["nz-button","","nzType","default",3,"click",4,"nzSpaceItem"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","dashed",3,"click"],[1,"mt-md"],["class","mb-xs",4,"ngFor","ngForOf"],[1,"mb-xs"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2,"\u8DEF\u7531\u5B88\u885B (Firestore \u6574\u5408)"),l()(),m(3,"div",1)(4,"div",2)(5,"nz-card",3)(6,"nz-space"),de(7,rr,2,2,"button",4)(8,ar,2,2,"button",4)(9,sr,2,2,"button",4),l()()()(),m(10,"div",1)(11,"div",2)(12,"nz-card",5)(13,"nz-space",6),de(14,mr,2,0,"button",7)(15,ur,6,1,"div",8)(16,dr,2,0,"button",9),l()()(),m(17,"div",2)(18,"nz-card",10)(19,"p")(20,"strong"),d(21,"ACL \u8CC7\u6599\uFF1A"),l()(),m(22,"pre"),d(23),Nt(24,"json"),l(),de(25,fr,9,2,"div",11),Nt(26,"async"),l()()(),Ce(27,"router-outlet")),e&2&&(p(3),f("nzGutter",16),p(),f("nzSpan",24),p(6),f("nzGutter",16),p(),f("nzSpan",12),p(6),f("nzSpan",12),p(6),Ae(_t(24,7,t.data)),p(2),f("ngIf",_t(26,9,t.currentUserACL$)))},dependencies:[R,B,Pi,jo,te,Y,ae,re,ne,E,ze,ce,ve,G,J,gt,ht,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,wt,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,Jo,Yo,xi,Gt,Ft,Ai],encapsulation:2});var eo=si;var zr=()=>["/delon/guard"],mi=class mi{};mi.\u0275fac=function(e){return new(e||mi)},mi.\u0275cmp=b({type:mi,selectors:[["app-guard-leave"]],decls:5,vars:3,consts:[["nz-button","",3,"nzType","routerLink"]],template:function(e,t){e&1&&(m(0,"p"),d(1,"\u79BB\u5F00\u65F6\u9700\u8981\u786E\u8BA4"),l(),m(2,"button",0)(3,"span"),d(4,"\u6211\u8981\u79BB\u5F00"),l()()),e&2&&(p(2),f("nzType","primary")("routerLink",ge(2,zr)))},dependencies:[R,B,Pi,te,Y,ae,re,ne,E,ze,ce,ve,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,U,ue,H,A],encapsulation:2});var to=mi;var Dn=(()=>{class n{scriptSrv=M(Ri);cogSrv=M(Ht);defaultConfig;_cog;pending=!1;_lodop=null;_init=new mo;_events=new mo;printBuffer=[];constructor(){this.defaultConfig=this.cogSrv.merge("lodop",{url:"http://localhost:8443/CLodopfuncs.js",name:"CLODOP",companyName:"",checkMaxCount:100}),this.cog=this.defaultConfig}get cog(){return this._cog}set cog(e){this._cog=ft(ft({},this.defaultConfig),e)}get events(){return this._events.asObservable()}get lodop(){return this._lodop?hi({ok:!0,lodop:this._lodop}):this.pending?this._init.asObservable():(this.request(),this._init.asObservable())}get printer(){this.check();let e=[],t=this._lodop.GET_PRINTER_COUNT();for(let r=0;r<t;r++)e.push(this._lodop.GET_PRINTER_NAME(r));return e}check(){if(!this._lodop)throw new Error("\u8BF7\u52A1\u5FC5\u5148\u8C03\u7528 lodop \u83B7\u53D6\u5BF9\u8C61")}request(){this.pending=!0;let e=new URL(this.cog.url);e.searchParams.set("name",this.cog.name);let t=e.toString(),r=this.cog.checkMaxCount,u=(h,o)=>{this._init.next({ok:h==="ok",status:h,error:o,lodop:this._lodop})},c=()=>{if(--r,this._lodop.webskt&&this._lodop.webskt.readyState===1)u("ok");else{if(r<0){u("check-limit");return}setTimeout(()=>c(),100)}};this.scriptSrv.loadScript(t).then(h=>{if(h.status!=="ok"){this.pending=!1,u("script-load-error",h[0]);return}let o=window;if(Object.prototype.hasOwnProperty.call(o,this.cog.name)&&(this._lodop=o[this.cog.name]),this._lodop===null){u("load-variable-name-error",{name:this.cog.name});return}this._lodop.SET_LICENSES(this.cog.companyName,this.cog.license,this.cog.licenseA,this.cog.licenseB),c()})}reset(){this._lodop=null,this.pending=!1,this.request()}attachCode(e,t,r){this.check(),r||(r=/LODOP\.([^(]+)\(([^\n]+)?\);/i),e.split(`
`).forEach(u=>{let c=r.exec(u.trim());if(!c)return;let h=this._lodop[c[1]];if(h){let o=null;try{o=new Function(`return [${c[2]}]`)()}catch{}if(o!=null&&Array.isArray(o)&&t)for(let a=0;a<o.length;a++)typeof o[a]=="string"&&(o[a]=o[a].replace(/{{(.*?)}}/g,(s,z)=>t[z.trim()]||""));h.apply(this._lodop,o)}})}design(){this.check();let e=this._lodop.PRINT_DESIGN();return new Promise(t=>{this._lodop.On_Return=(r,u)=>{e===r&&(this._lodop.On_Return=null,t(`${u}`))}})}printDo(){let e=this.printBuffer.shift();if(!e)return;this.attachCode(e.code,e.item,e.parser);let t=this._lodop.PRINT();this._lodop.On_Return=(r,u)=>{t===r&&(this._lodop.On_Return=null,this._events.next(ft({ok:u===!0,error:u===!0?null:u},e)),this.printDo())}}print(e,t,r){this.check(),t&&this.printBuffer.push(...(Array.isArray(t)?t:[t]).map(u=>({code:e,parser:r,item:u}))),this.printDo()}ngOnDestroy(){this._init.unsubscribe(),this._events.unsubscribe()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=It({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hr(n,i){n&1&&(d(0," \u8BF7\u5148\u4E0B\u8F7D "),m(1,"a",5),d(2,"Lodop\u63D2\u4EF6"),l(),d(3,"\u3002 "))}function gr(n,i){if(n&1&&(m(0,"nz-alert",3),de(1,hr,4,0,"ng-template",null,0,Ut),l()),n&2){let e=Lt(2);f("nzType","warning")("nzMessage",e)}}function Mr(n,i){if(n&1&&Ce(0,"nz-option",12),n&2){let e=i.$implicit;f("nzLabel",e)("nzValue",e)}}function Nr(n,i){if(n&1&&Ce(0,"nz-option",12),n&2){let e=i.$implicit;f("nzLabel",e)("nzValue",e)}}function Cr(n,i){if(n&1){let e=fe();m(0,"form",4)(1,"nz-form-item",6)(2,"nz-form-label",7),d(3,"\u6253\u5370\u670D\u52A1\u5668"),l(),m(4,"nz-form-control",7)(5,"nz-input-group")(6,"div",8)(7,"input",9),be("ngModelChange",function(r){S(e);let u=v();return ye(u.cog.url,r)||(u.cog.url=r),y(r)}),l()(),m(8,"div",8)(9,"button",10),C("click",function(){S(e);let r=v();return y(r.reload(null))}),d(10,"\u91CD\u65B0\u52A0\u8F7D\u6253\u5370\u673A"),l()()()()(),m(11,"nz-form-item",6)(12,"nz-form-label",7),d(13,"\u6253\u5370\u673A"),l(),m(14,"nz-form-control",7)(15,"nz-select",11),be("ngModelChange",function(r){S(e);let u=v();return ye(u.cog.printer,r)||(u.cog.printer=r),y(r)}),C("ngModelChange",function(r){S(e);let u=v();return y(u.changePinter(r))}),xt(16,Mr,1,2,"nz-option",12,Dt),l()()(),m(18,"nz-form-item",6)(19,"nz-form-label",7),d(20,"\u7EB8\u5F20\u7C7B\u578B"),l(),m(21,"nz-form-control",7)(22,"nz-select",13),be("ngModelChange",function(r){S(e);let u=v();return ye(u.cog.paper,r)||(u.cog.paper=r),y(r)}),xt(23,Nr,1,2,"nz-option",12,Dt),l()()(),m(25,"nz-form-item",6)(26,"nz-form-label",7),d(27,"\u6253\u5370\u5185\u5BB9"),l(),m(28,"nz-form-control",7)(29,"textarea",14),be("ngModelChange",function(r){S(e);let u=v();return ye(u.cog.html,r)||(u.cog.html=r),y(r)}),l(),m(30,"div",15),d(31,"\u4EC5\u9650HTML\uFF0C\u66F4\u591A\u7C7B\u578B\u652F\u6301\u8BF7\u53C2\u8003\u5B98\u7F51"),l()()(),m(32,"nz-form-item",6)(33,"nz-form-control",16)(34,"button",17),C("click",function(){S(e);let r=v();return y(r.print(!0))}),d(35,"\u6253\u5370\u9884\u89C8"),l(),m(36,"button",17),C("click",function(){S(e);let r=v();return y(r.print())}),d(37,"\u76F4\u63A5\u6253\u5370"),l()()()()}if(n&2){let e=v();p(2),f("nzSm",6),p(2),f("nzSm",18),p(2),f("nzSpan",16),p(),Se("ngModel",e.cog.url),p(),f("nzSpan",8),p(4),f("nzSm",6),p(2),f("nzSm",18),p(),Se("ngModel",e.cog.printer),p(),At(e.pinters),p(3),f("nzSm",6),p(2),f("nzSm",18),p(),Se("ngModel",e.cog.paper),p(),At(e.papers),p(3),f("nzSm",6),p(2),f("nzSm",18),p(),Se("ngModel",e.cog.html),p(4),f("nzSm",18)("nzOffset",6),p(),f("nzLoading",e.printing),p(2),f("nzLoading",e.printing)}}var li=class li{constructor(){this.lodopSrv=M(Dn);this.msg=M(we);this.cog={url:"https://localhost:8443/CLodopfuncs.js",printer:"",paper:"",html:`
      <h1>Title</h1>
      <p>\u8FD9~\uFF01@#\uFFE5%\u2026\u2026&*\uFF08\uFF09\u2014\u2014sdilfjnvn</p>
      <p>\u8FD9~\uFF01@#\uFFE5%\u2026\u2026&*\uFF08\uFF09\u2014\u2014sdilfjnvn</p>
      <p>\u8FD9~\uFF01@#\uFFE5%\u2026\u2026&*\uFF08\uFF09\u2014\u2014sdilfjnvn</p>
      <p>\u8FD9~\uFF01@#\uFFE5%\u2026\u2026&*\uFF08\uFF09\u2014\u2014sdilfjnvn</p>
      <p>\u8FD9~\uFF01@#\uFFE5%\u2026\u2026&*\uFF08\uFF09\u2014\u2014sdilfjnvn</p>
    `};this.error=!1;this.lodop=null;this.pinters=[];this.papers=[];this.printing=!1;this.lodopSrv.lodop.subscribe(({lodop:i,ok:e})=>{if(!e){this.error=!0;return}this.error=!1,this.msg.success("\u6253\u5370\u673A\u52A0\u8F7D\u6210\u529F"),this.lodop=i,this.pinters=this.lodopSrv.printer})}reload(i={url:"https://localhost:8443/CLodopfuncs.js"}){this.pinters=[],this.papers=[],this.cog.printer="",this.cog.paper="",this.lodopSrv.cog=ft(ft({},this.cog),i),this.error=!1,i===null&&this.lodopSrv.reset()}changePinter(i){this.lodop!=null&&(this.papers=this.lodop.GET_PAGESIZES_LIST(i,`
`).split(`
`))}print(i=!1){let e=this.lodop;e.PRINT_INITA(10,20,810,610,"\u6D4B\u8BD5C-Lodop\u8FDC\u7A0B\u6253\u5370\u56DB\u6B65\u9AA4"),e.SET_PRINTER_INDEXA(this.cog.printer),e.SET_PRINT_PAGESIZE(0,0,0,this.cog.paper),e.ADD_PRINT_TEXT(1,1,300,200,"\u4E0B\u9762\u8F93\u51FA\u7684\u662F\u672C\u9875\u6E90\u4EE3\u7801\u53CA\u5176\u5C55\u73B0\u6548\u679C\uFF1A"),e.ADD_PRINT_TEXT(20,10,"90%","95%",this.cog.html),e.SET_PRINT_STYLEA(0,"ItemType",4),e.NEWPAGEA(),e.ADD_PRINT_HTM(20,10,"90%","95%",this.cog.html),i?e.PREVIEW():e.PRINT()}};li.\u0275fac=function(e){return new(e||li)},li.\u0275cmp=b({type:li,selectors:[["app-print"]],decls:10,vars:2,consts:[["message",""],[1,"alain-default__content-title"],["href","https://ng-alain.com/components/lodop","target","_blank"],[3,"nzType","nzMessage"],["nz-form",""],["href","http://c-lodop.com/download.html","target","_blank"],["nz-row",""],["nz-col","",3,"nzSm"],["nz-col","",3,"nzSpan"],["nz-input","","nzPlaceHolder","https://localhost:8443/CLodopfuncs.js","name","url",3,"ngModelChange","ngModel"],["nz-button","",3,"click"],["nzPlaceHolder","\u8BF7\u9009\u62E9\u6253\u5370\u673A","nzShowSearch","","nzAllowClear","","name","printer",2,"width","90%",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue"],["nzPlaceHolder","\u8BF7\u9009\u62E9\u7EB8\u5F20\u7C7B\u578B","nzShowSearch","","nzAllowClear","","name","paper",2,"width","90%",3,"ngModelChange","ngModel"],["nz-input","","name","html","nzAutosize","",3,"ngModelChange","ngModel"],["nz-form-extra",""],["nz-col","",3,"nzSm","nzOffset"],["nz-button","",3,"click","nzLoading"]],template:function(e,t){e&1&&(m(0,"div",1)(1,"h1"),d(2," Lodop\u6253\u5370 "),m(3,"small"),d(4," \u66F4\u591A\u4F53\u9A8C\u8BF7\u81F3 "),m(5,"a",2),d(6,"NG-ALAIN.com"),l()()()(),m(7,"nz-card"),Ct(8,gr,3,2,"nz-alert",3),Ct(9,Cr,38,18,"form",4),l()),e&2&&(p(8),vt(t.error?8:-1),p(),vt(t.error?-1:9))},dependencies:[R,$t,Pt,yt,jt,bt,Wt,B,te,Y,ae,re,ne,E,ze,ce,ve,G,J,gt,ht,L,V,pe,j,Vi,Ui,T,I,se,Cn,F,W,P,ie,Z,Rt,Gi,zn,X,q,$,O,oe,le,ee,k,K,Zt,qt,Yt,Xt,me,D,Q,Me,U,ue,H,A],encapsulation:2});var io=li;var vr=["canvas"];function _r(n,i){if(n&1&&(Ti(0),d(1),Ei()),n&2){let e=v(2);p(),Ae(e.nzStatusRender)}}function Sr(n,i){if(n&1&&(m(0,"div",1),de(1,_r,2,1,"ng-container",2),l()),n&2){let e=v();p(),f("nzStringTemplateOutlet",e.nzStatusRender)}}function yr(n,i){n&1&&Ce(0,"nz-spin")}function br(n,i){if(n&1){let e=fe();m(0,"div")(1,"p",3),d(2),l(),m(3,"button",4),C("click",function(){S(e);let r=v(2);return y(r.reloadQRCode())}),Ce(4,"nz-icon",5),m(5,"span"),d(6),l()()()}if(n&2){let e=v(2);p(2),Ae(e.locale.expired),p(4),Ae(e.locale.refresh)}}function wr(n,i){if(n&1&&(m(0,"div")(1,"p",3),d(2),l()()),n&2){let e=v(2);p(2),Ae(e.locale.scanned)}}function Tr(n,i){if(n&1&&(m(0,"div",1),Ct(1,yr,1,0,"nz-spin")(2,br,7,2,"div")(3,wr,3,1,"div"),l()),n&2){let e,t=v();p(),vt((e=t.nzStatus)==="loading"?1:e==="expired"?2:e==="scanned"?3:-1)}}function Er(n,i){n&1&&Ce(0,"canvas",null,0)}var kt;(function(n){let i=(()=>{class c{version;errorCorrectionLevel;static encodeText(o,a){let s=n.QrSegment.makeSegments(o);return c.encodeSegments(s,a)}static encodeBinary(o,a){let s=n.QrSegment.makeBytes(o);return c.encodeSegments([s],a)}static encodeSegments(o,a,s=1,z=40,g=-1,_=!0){if(!(c.MIN_VERSION<=s&&s<=z&&z<=c.MAX_VERSION)||g<-1||g>7)throw new RangeError("Invalid value");let N,x;for(N=s;;N++){let he=c.getNumDataCodewords(N,a)*8,ct=u.getTotalBits(o,N);if(ct<=he){x=ct;break}if(N>=z)throw new RangeError("Data too long")}for(let he of[c.Ecc.MEDIUM,c.Ecc.QUARTILE,c.Ecc.HIGH])_&&x<=c.getNumDataCodewords(N,he)*8&&(a=he);let w=[];for(let he of o){e(he.mode.modeBits,4,w),e(he.numChars,he.mode.numCharCountBits(N),w);for(let ct of he.getData())w.push(ct)}r(w.length==x);let Mt=c.getNumDataCodewords(N,a)*8;r(w.length<=Mt),e(0,Math.min(4,Mt-w.length),w),e(0,(8-w.length%8)%8,w),r(w.length%8==0);for(let he=236;w.length<Mt;he^=253)e(he,8,w);let Et=[];for(;Et.length*8<w.length;)Et.push(0);return w.forEach((he,ct)=>Et[ct>>>3]|=he<<7-(ct&7)),new c(N,a,Et,g)}size;mask;modules=[];isFunction=[];constructor(o,a,s,z){if(this.version=o,this.errorCorrectionLevel=a,o<c.MIN_VERSION||o>c.MAX_VERSION)throw new RangeError("Version value out of range");if(z<-1||z>7)throw new RangeError("Mask value out of range");this.size=o*4+17;let g=[];for(let N=0;N<this.size;N++)g.push(!1);for(let N=0;N<this.size;N++)this.modules.push(g.slice()),this.isFunction.push(g.slice());this.drawFunctionPatterns();let _=this.addEccAndInterleave(s);if(this.drawCodewords(_),z==-1){let N=1e9;for(let x=0;x<8;x++){this.applyMask(x),this.drawFormatBits(x);let w=this.getPenaltyScore();w<N&&(z=x,N=w),this.applyMask(x)}}r(z>=0&&z<=7),this.mask=z,this.applyMask(z),this.drawFormatBits(z),this.isFunction=[]}getModule(o,a){return o>=0&&o<this.size&&a>=0&&a<this.size&&this.modules[a][o]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let o=this.getAlignmentPatternPositions(),a=o.length;for(let s=0;s<a;s++)for(let z=0;z<a;z++)s==0&&z==0||s==0&&z==a-1||s==a-1&&z==0||this.drawAlignmentPattern(o[s],o[z]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(o){let a=this.errorCorrectionLevel.formatBits<<3|o,s=a;for(let g=0;g<10;g++)s=s<<1^(s>>>9)*1335;let z=(a<<10|s)^21522;r(z>>>15==0);for(let g=0;g<=5;g++)this.setFunctionModule(8,g,t(z,g));this.setFunctionModule(8,7,t(z,6)),this.setFunctionModule(8,8,t(z,7)),this.setFunctionModule(7,8,t(z,8));for(let g=9;g<15;g++)this.setFunctionModule(14-g,8,t(z,g));for(let g=0;g<8;g++)this.setFunctionModule(this.size-1-g,8,t(z,g));for(let g=8;g<15;g++)this.setFunctionModule(8,this.size-15+g,t(z,g));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let o=this.version;for(let s=0;s<12;s++)o=o<<1^(o>>>11)*7973;let a=this.version<<12|o;r(a>>>18==0);for(let s=0;s<18;s++){let z=t(a,s),g=this.size-11+s%3,_=Math.floor(s/3);this.setFunctionModule(g,_,z),this.setFunctionModule(_,g,z)}}drawFinderPattern(o,a){for(let s=-4;s<=4;s++)for(let z=-4;z<=4;z++){let g=Math.max(Math.abs(z),Math.abs(s)),_=o+z,N=a+s;_>=0&&_<this.size&&N>=0&&N<this.size&&this.setFunctionModule(_,N,g!=2&&g!=4)}}drawAlignmentPattern(o,a){for(let s=-2;s<=2;s++)for(let z=-2;z<=2;z++)this.setFunctionModule(o+z,a+s,Math.max(Math.abs(z),Math.abs(s))!=1)}setFunctionModule(o,a,s){this.modules[a][o]=s,this.isFunction[a][o]=!0}addEccAndInterleave(o){let a=this.version,s=this.errorCorrectionLevel;if(o.length!=c.getNumDataCodewords(a,s))throw new RangeError("Invalid argument");let z=c.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][a],g=c.ECC_CODEWORDS_PER_BLOCK[s.ordinal][a],_=Math.floor(c.getNumRawDataModules(a)/8),N=z-_%z,x=Math.floor(_/z),w=[],Mt=c.reedSolomonComputeDivisor(g);for(let he=0,ct=0;he<z;he++){let Ot=o.slice(ct,ct+x-g+(he<N?0:1));ct+=Ot.length;let Bn=c.reedSolomonComputeRemainder(Ot,Mt);he<N&&Ot.push(0),w.push(Ot.concat(Bn))}let Et=[];for(let he=0;he<w[0].length;he++)w.forEach((ct,Ot)=>{(he!=x-g||Ot>=N)&&Et.push(ct[he])});return r(Et.length==_),Et}drawCodewords(o){if(o.length!=Math.floor(c.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let z=0;z<this.size;z++)for(let g=0;g<2;g++){let _=s-g,x=(s+1&2)==0?this.size-1-z:z;!this.isFunction[x][_]&&a<o.length*8&&(this.modules[x][_]=t(o[a>>>3],7-(a&7)),a++)}}r(a==o.length*8)}applyMask(o){if(o<0||o>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++){let z;switch(o){case 0:z=(s+a)%2==0;break;case 1:z=a%2==0;break;case 2:z=s%3==0;break;case 3:z=(s+a)%3==0;break;case 4:z=(Math.floor(s/3)+Math.floor(a/2))%2==0;break;case 5:z=s*a%2+s*a%3==0;break;case 6:z=(s*a%2+s*a%3)%2==0;break;case 7:z=((s+a)%2+s*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][s]&&z&&(this.modules[a][s]=!this.modules[a][s])}}getPenaltyScore(){let o=0;for(let g=0;g<this.size;g++){let _=!1,N=0,x=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[g][w]==_?(N++,N==5?o+=c.PENALTY_N1:N>5&&o++):(this.finderPenaltyAddHistory(N,x),_||(o+=this.finderPenaltyCountPatterns(x)*c.PENALTY_N3),_=this.modules[g][w],N=1);o+=this.finderPenaltyTerminateAndCount(_,N,x)*c.PENALTY_N3}for(let g=0;g<this.size;g++){let _=!1,N=0,x=[0,0,0,0,0,0,0];for(let w=0;w<this.size;w++)this.modules[w][g]==_?(N++,N==5?o+=c.PENALTY_N1:N>5&&o++):(this.finderPenaltyAddHistory(N,x),_||(o+=this.finderPenaltyCountPatterns(x)*c.PENALTY_N3),_=this.modules[w][g],N=1);o+=this.finderPenaltyTerminateAndCount(_,N,x)*c.PENALTY_N3}for(let g=0;g<this.size-1;g++)for(let _=0;_<this.size-1;_++){let N=this.modules[g][_];N==this.modules[g][_+1]&&N==this.modules[g+1][_]&&N==this.modules[g+1][_+1]&&(o+=c.PENALTY_N2)}let a=0;for(let g of this.modules)a=g.reduce((_,N)=>_+(N?1:0),a);let s=this.size*this.size,z=Math.ceil(Math.abs(a*20-s*10)/s)-1;return r(z>=0&&z<=9),o+=z*c.PENALTY_N4,r(o>=0&&o<=2568888),o}getAlignmentPatternPositions(){if(this.version==1)return[];{let o=Math.floor(this.version/7)+2,a=Math.floor((this.version*8+o*3+5)/(o*4-4))*2,s=[6];for(let z=this.size-7;s.length<o;z-=a)s.splice(1,0,z);return s}}static getNumRawDataModules(o){if(o<c.MIN_VERSION||o>c.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*o+128)*o+64;if(o>=2){let s=Math.floor(o/7)+2;a-=(25*s-10)*s-55,o>=7&&(a-=36)}return r(a>=208&&a<=29648),a}static getNumDataCodewords(o,a){return Math.floor(c.getNumRawDataModules(o)/8)-c.ECC_CODEWORDS_PER_BLOCK[a.ordinal][o]*c.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][o]}static reedSolomonComputeDivisor(o){if(o<1||o>255)throw new RangeError("Degree out of range");let a=[];for(let z=0;z<o-1;z++)a.push(0);a.push(1);let s=1;for(let z=0;z<o;z++){for(let g=0;g<a.length;g++)a[g]=c.reedSolomonMultiply(a[g],s),g+1<a.length&&(a[g]^=a[g+1]);s=c.reedSolomonMultiply(s,2)}return a}static reedSolomonComputeRemainder(o,a){let s=a.map(z=>0);for(let z of o){let g=z^s.shift();s.push(0),a.forEach((_,N)=>s[N]^=c.reedSolomonMultiply(_,g))}return s}static reedSolomonMultiply(o,a){if(o>>>8||a>>>8)throw new RangeError("Byte out of range");let s=0;for(let z=7;z>=0;z--)s=s<<1^(s>>>7)*285,s^=(a>>>z&1)*o;return r(s>>>8==0),s}finderPenaltyCountPatterns(o){let a=o[1];r(a<=this.size*3);let s=a>0&&o[2]==a&&o[3]==a*3&&o[4]==a&&o[5]==a;return(s&&o[0]>=a*4&&o[6]>=a?1:0)+(s&&o[6]>=a*4&&o[0]>=a?1:0)}finderPenaltyTerminateAndCount(o,a,s){return o&&(this.finderPenaltyAddHistory(a,s),a=0),a+=this.size,this.finderPenaltyAddHistory(a,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(o,a){a[0]==0&&(o+=this.size),a.pop(),a.unshift(o)}static MIN_VERSION=1;static MAX_VERSION=40;static PENALTY_N1=3;static PENALTY_N2=3;static PENALTY_N3=40;static PENALTY_N4=10;static ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]];static NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]}return c})();n.QrCode=i;function e(c,h,o){if(h<0||h>31||c>>>h)throw new RangeError("Value out of range");for(let a=h-1;a>=0;a--)o.push(c>>>a&1)}function t(c,h){return(c>>>h&1)!=0}function r(c){if(!c)throw new Error("Assertion error")}let u=(()=>{class c{mode;numChars;bitData;static makeBytes(o){let a=[];for(let s of o)e(s,8,a);return new c(c.Mode.BYTE,o.length,a)}static makeNumeric(o){if(!c.isNumeric(o))throw new RangeError("String contains non-numeric characters");let a=[];for(let s=0;s<o.length;){let z=Math.min(o.length-s,3);e(parseInt(o.substring(s,s+z),10),z*3+1,a),s+=z}return new c(c.Mode.NUMERIC,o.length,a)}static makeAlphanumeric(o){if(!c.isAlphanumeric(o))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],s;for(s=0;s+2<=o.length;s+=2){let z=c.ALPHANUMERIC_CHARSET.indexOf(o.charAt(s))*45;z+=c.ALPHANUMERIC_CHARSET.indexOf(o.charAt(s+1)),e(z,11,a)}return s<o.length&&e(c.ALPHANUMERIC_CHARSET.indexOf(o.charAt(s)),6,a),new c(c.Mode.ALPHANUMERIC,o.length,a)}static makeSegments(o){return o==""?[]:c.isNumeric(o)?[c.makeNumeric(o)]:c.isAlphanumeric(o)?[c.makeAlphanumeric(o)]:[c.makeBytes(c.toUtf8ByteArray(o))]}static makeEci(o){let a=[];if(o<0)throw new RangeError("ECI assignment value out of range");if(o<128)e(o,8,a);else if(o<16384)e(2,2,a),e(o,14,a);else if(o<1e6)e(6,3,a),e(o,21,a);else throw new RangeError("ECI assignment value out of range");return new c(c.Mode.ECI,0,a)}static isNumeric(o){return c.NUMERIC_REGEX.test(o)}static isAlphanumeric(o){return c.ALPHANUMERIC_REGEX.test(o)}constructor(o,a,s){if(this.mode=o,this.numChars=a,this.bitData=s,a<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}getData(){return this.bitData.slice()}static getTotalBits(o,a){let s=0;for(let z of o){let g=z.mode.numCharCountBits(a);if(z.numChars>=1<<g)return 1/0;s+=4+g+z.bitData.length}return s}static toUtf8ByteArray(o){o=encodeURI(o);let a=[];for(let s=0;s<o.length;s++)o.charAt(s)!="%"?a.push(o.charCodeAt(s)):(a.push(parseInt(o.substring(s+1,s+3),16)),s+=2);return a}static NUMERIC_REGEX=/^[0-9]*$/;static ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+./:-]*$/;static ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"}return c})();n.QrSegment=u})(kt||(kt={}));(function(n){let i;(function(e){class t{ordinal;formatBits;static LOW=new t(0,1);static MEDIUM=new t(1,0);static QUARTILE=new t(2,3);static HIGH=new t(3,2);constructor(u,c){this.ordinal=u,this.formatBits=c}}e.Ecc=t})(i=n.QrCode||(n.QrCode={}))})(kt||(kt={}));(function(n){let i;(function(e){class t{modeBits;numBitsCharCount;static NUMERIC=new t(1,[10,12,14]);static ALPHANUMERIC=new t(2,[9,11,13]);static BYTE=new t(4,[8,16,16]);static KANJI=new t(8,[8,10,12]);static ECI=new t(7,[0,0,0]);constructor(u,c){this.modeBits=u,this.numBitsCharCount=c}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}}e.Mode=t})(i=n.QrSegment||(n.QrSegment={}))})(kt||(kt={}));var _i=kt,Dr={L:_i.QrCode.Ecc.LOW,M:_i.QrCode.Ecc.MEDIUM,Q:_i.QrCode.Ecc.QUARTILE,H:_i.QrCode.Ecc.HIGH},xr=160,Ar=10,Fr=10,Pr="#000000",Rr="#FFFFFF",Br=40,Ir="M",Lr=(n,i=Ir)=>n?_i.QrCode.encodeText(n,Dr[i]):null;function kr(n,i,e=xr,t=Ar,r=Fr,u=Pr,c=Rr,h=Br,o){let a=n.getContext("2d"),s=Or(r);if(n.style.width=`${e}px`,n.style.height=`${e}px`,!i){a.fillStyle="rgba(0, 0, 0, 0)",a.fillRect(0,0,n.width,n.height);return}if(n.width=i.size*t+s[1]+s[3],n.height=i.size*t+s[0]+s[2],!o)_o(a,n.width,n.height,t,c),vo(a,i,t,s,c,u);else{let z=new Image;z.src=o,z.crossOrigin="anonymous",z.width=h*(n.width/e),z.height=h*(n.width/e);let g=()=>{N(),_o(a,n.width,n.height,t,c),vo(a,i,t,s,c,u);let x=n.width/2-h*(n.width/e)/2;a.fillRect(x,x,h*(n.width/e),h*(n.width/e)),a.drawImage(z,x,x,h*(n.width/e),h*(n.width/e))},_=()=>{N(),_o(a,n.width,n.height,t,c),vo(a,i,t,s,c,u)},N=()=>{z.removeEventListener("load",g),z.removeEventListener("error",_)};z.addEventListener("load",g),z.addEventListener("error",_)}}function vo(n,i,e,t,r,u){for(let c=0;c<i.size;c++)for(let h=0;h<i.size;h++)n.fillStyle=i.getModule(h,c)?u:r,n.fillRect(t[3]+h*e,t[0]+c*e,e,e)}function _o(n,i,e,t,r){n.fillStyle=r,n.fillRect(0,0,i*t,e*t)}function Or(n){return Array.isArray(n)?Array(4).fill(0).map((i,e)=>n[e%n.length]):[n,n,n,n]}var xn=(()=>{class n{i18n=M(Qo);el=M(yi);cdr=M(Di);destroyRef=M(xo);isBrowser=Go(M(Ao));canvas;nzValue="";nzPadding=0;nzColor="#000000";nzBgColor="#FFFFFF";nzSize=160;nzIcon="";nzIconSize=40;nzBordered=!0;nzStatus="active";nzLevel="M";nzStatusRender=null;nzRefresh=new Ni;locale;ngOnInit(){this.el.nativeElement.style.backgroundColor=this.nzBgColor,this.i18n.localeChange.pipe(qo(this.destroyRef)).subscribe(()=>{this.locale=this.i18n.getLocaleData("QRCode"),this.cdr.markForCheck()})}ngOnChanges(e){let{nzValue:t,nzIcon:r,nzLevel:u,nzSize:c,nzIconSize:h,nzColor:o,nzPadding:a,nzBgColor:s}=e;(t||r||u||c||h||o||a||s)&&this.canvas&&this.drawCanvasQRCode(),s&&(this.el.nativeElement.style.backgroundColor=this.nzBgColor)}ngAfterViewInit(){this.drawCanvasQRCode()}reloadQRCode(){this.drawCanvasQRCode(),this.nzRefresh.emit("refresh")}drawCanvasQRCode(){this.canvas&&kr(this.canvas.nativeElement,Lr(this.nzValue,this.nzLevel),this.nzSize,10,this.nzPadding,this.nzColor,this.nzBgColor,this.nzIconSize,this.nzIcon)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=b({type:n,selectors:[["nz-qrcode"]],viewQuery:function(t,r){if(t&1&&Ro(vr,5),t&2){let u;Bo(u=Io())&&(r.canvas=u.first)}},hostAttrs:[1,"ant-qrcode"],hostVars:2,hostBindings:function(t,r){t&2&&co("ant-qrcode-border",r.nzBordered)},inputs:{nzValue:"nzValue",nzPadding:"nzPadding",nzColor:"nzColor",nzBgColor:"nzBgColor",nzSize:[2,"nzSize","nzSize",fo],nzIcon:"nzIcon",nzIconSize:[2,"nzIconSize","nzIconSize",fo],nzBordered:[2,"nzBordered","nzBordered",Oo],nzStatus:"nzStatus",nzLevel:"nzLevel",nzStatusRender:"nzStatusRender"},outputs:{nzRefresh:"nzRefresh"},exportAs:["nzQRCode"],features:[po],decls:3,vars:2,consts:[["canvas",""],[1,"ant-qrcode-mask"],[4,"nzStringTemplateOutlet"],[1,"ant-qrcode-expired"],["nz-button","","nzType","link",3,"click"],["nzType","reload","nzTheme","outline"]],template:function(t,r){t&1&&(Ct(0,Sr,2,1,"div",1)(1,Tr,4,1,"div",1),Ct(2,Er,2,0,"canvas")),t&2&&(vt(r.nzStatusRender?0:r.nzStatus!=="active"?1:-1),p(2),vt(r.isBrowser?2:-1))},dependencies:[D,mn,E,ze,ce,T,Ii,Xo],encapsulation:2,changeDetection:0})}return n})();var Si=()=>({standalone:!0}),pi=class pi{constructor(){this.value="https://ng-alain.com/";this.background="#ffffff";this.foreground="#000000";this.level="L";this.mime="image/png";this.padding=10;this.size=220}};pi.\u0275fac=function(e){return new(e||pi)},pi.\u0275cmp=b({type:pi,selectors:[["app-qr"]],decls:44,vars:39,consts:[[1,"alain-default__content-title"],["href","https://ng.ant.design/components/qr-code","target","_blank"],[3,"nzGutter"],[1,"text-center",3,"nzSpan"],[3,"nzValue","nzBgColor","nzColor","nzLevel","nzSize","nzPadding"],[3,"nzSpan"],["nz-form",""],["nz-input","","type","color",2,"width","100px",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"],["nzValue","L","nzLabel","L"],["nzValue","M","nzLabel","M"],["nzValue","Q","nzLabel","Q"],["nzValue","H","nzLabel","H"],[3,"ngModelChange","ngModel","ngModelOptions","nzMin","nzMax"],[3,"ngModelChange","ngModel","ngModelOptions","nzMin","nzMax","nzStep"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2," \u4E8C\u7EF4\u7801 "),m(3,"a",1),d(4,"Document"),l()()(),m(5,"nz-card")(6,"nz-row",2)(7,"nz-col",3),Ce(8,"nz-qrcode",4),l(),m(9,"nz-col",5)(10,"form",6)(11,"nz-form-item")(12,"nz-form-label",5),d(13,"\u80CC\u666F"),l(),m(14,"nz-form-control",5)(15,"nz-input-group")(16,"input",7),be("ngModelChange",function(u){return ye(t.background,u)||(t.background=u),u}),l()()()(),m(17,"nz-form-item")(18,"nz-form-label",5),d(19,"\u524D\u666F"),l(),m(20,"nz-form-control",5)(21,"nz-input-group")(22,"input",7),be("ngModelChange",function(u){return ye(t.foreground,u)||(t.foreground=u),u}),l()()()(),m(23,"nz-form-item")(24,"nz-form-label",5),d(25,"\u8BEF\u5DEE"),l(),m(26,"nz-form-control",5)(27,"nz-select",8),be("ngModelChange",function(u){return ye(t.level,u)||(t.level=u),u}),Ce(28,"nz-option",9)(29,"nz-option",10)(30,"nz-option",11)(31,"nz-option",12),l()()(),m(32,"nz-form-item")(33,"nz-form-label",5),d(34,"\u5185\u8FB9\u8DDD"),l(),m(35,"nz-form-control",5)(36,"nz-input-number",13),be("ngModelChange",function(u){return ye(t.padding,u)||(t.padding=u),u}),l(),d(37,"px "),l()(),m(38,"nz-form-item")(39,"nz-form-label",5),d(40,"\u5927\u5C0F"),l(),m(41,"nz-form-control",5)(42,"nz-input-number",14),be("ngModelChange",function(u){return ye(t.size,u)||(t.size=u),u}),l(),d(43,"px "),l()()()()()()),e&2&&(p(6),f("nzGutter",24),p(),f("nzSpan",8),p(),f("nzValue",t.value)("nzBgColor",t.background)("nzColor",t.foreground)("nzLevel",t.level)("nzSize",t.size)("nzPadding",t.padding),p(),f("nzSpan",16),p(3),f("nzSpan",8),p(2),f("nzSpan",16),p(2),Se("ngModel",t.background),f("ngModelOptions",ge(34,Si)),p(2),f("nzSpan",8),p(2),f("nzSpan",16),p(2),Se("ngModel",t.foreground),f("ngModelOptions",ge(35,Si)),p(2),f("nzSpan",8),p(2),f("nzSpan",16),p(),Se("ngModel",t.level),f("ngModelOptions",ge(36,Si)),p(6),f("nzSpan",8),p(2),f("nzSpan",16),p(),Se("ngModel",t.padding),f("ngModelOptions",ge(37,Si))("nzMin",0)("nzMax",100),p(3),f("nzSpan",8),p(2),f("nzSpan",16),p(),Se("ngModel",t.size),f("ngModelOptions",ge(38,Si))("nzMin",100)("nzMax",1e3)("nzStep",t.padding))},dependencies:[R,$t,Pt,yt,jt,bt,Wt,B,te,Y,ae,re,ne,E,ce,G,J,gt,ht,L,V,pe,j,Vi,Ui,T,I,se,F,W,P,ie,Z,Rt,Gi,X,hn,q,$,O,oe,le,ee,k,K,Zt,qt,Yt,Xt,me,D,Q,Me,U,ue,H,A,xn],encapsulation:2});var oo=pi;var An=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=Mi({type:n});static \u0275inj=gi({imports:[Uo]})}return n})();var Vr=()=>({show:!0,front:!1}),Ur=()=>[0,0,0,0];function Gr(n,i){if(n&1){let e=fe();m(0,"button",14),C("click",function(){S(e);let r=v();return y(r.fullChange())}),Ce(1,"span",15),d(2," \u5168\u87A2\u5E55 "),l()}}function Hr(n,i){if(n&1&&Ce(0,"g2-mini-bar",16),n&2){let e=v();f("data",e.events)("height",30)("padding",ge(3,Ur))}}var ui=class ui{constructor(){this.http=M(ki);this.message=M(we);this.ps=20;this.total=200;this.args={_allow_anonymous:!0,userid:null};this.url="https://api.randomuser.me/?results=20";this.events=[];this.scroll={y:"230px"};this.columns=[{title:"id",index:"id.value",type:"checkbox"},{title:"Avatar",index:"picture.thumbnail",type:"img",width:80},{title:"Name",index:"name.first",width:150,format:i=>`${i.name.first} ${i.name.last}`,type:"link",click:i=>this.message.info(`${i.name.first}`)},{title:"Email",index:"email"},{title:"Gender",index:"gender",type:"yn",yn:{truth:"female",yes:"\u7537",no:"\u5973",mode:"text"},width:120},{title:"Events",render:"events",width:90},{title:"Registered",index:"registered.date",type:"date",width:170},{title:"Actions",width:120,buttons:[{text:"Edit",click:i=>this.message.info(`edit [${i.id.value}]`),iif:i=>i.gender==="female"},{text:"Delete",type:"del",click:i=>this.message.info(`deleted [${i.id.value}]`)}]}]}ngOnInit(){this.http.get("/chart/visit").subscribe(i=>this.events=i.slice(0,8))}fullChange(i){this.scroll=i?{y:"350px"}:{y:"230px"}}};ui.\u0275fac=function(e){return new(e||ui)},ui.\u0275cmp=b({type:ui,selectors:[["app-st"]],decls:23,vars:9,consts:[["extra",""],["st",""],[1,"st-demo"],[3,"title","home"],[3,"data","columns","total","page","scroll"],["st-row","events"],["nzTitle","Firebase \u6574\u5408\u72C0\u614B",1,"mt-lg"],[1,"firebase-status"],["nzTitle","\u8A8D\u8B49\u72C0\u614B",3,"nzColumn"],["nzTitle","Firebase Auth"],["nzColor","green"],["nzTitle","Firestore ACL"],["nzTitle","Google \u767B\u5165"],["nzTitle","\u6B0A\u9650\u63A7\u5236"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","fullscreen"],["color","#999","borderWidth","3","tooltipType","mini","theme","mini",3,"data","height","padding"]],template:function(e,t){e&1&&(m(0,"div",2)(1,"page-header",3),de(2,Gr,3,0,"ng-template",null,0,Ut),l(),m(4,"nz-card")(5,"st",4,1),de(7,Hr,1,4,"ng-template",5),l()(),m(8,"nz-card",6)(9,"div",7)(10,"nz-descriptions",8)(11,"nz-descriptions-item",9)(12,"nz-tag",10),d(13,"\u5DF2\u6574\u5408"),l()(),m(14,"nz-descriptions-item",11)(15,"nz-tag",10),d(16,"\u5DF2\u6574\u5408"),l()(),m(17,"nz-descriptions-item",12)(18,"nz-tag",10),d(19,"\u5DF2\u6574\u5408"),l()(),m(20,"nz-descriptions-item",13)(21,"nz-tag",10),d(22,"\u5DF2\u6574\u5408"),l()()()()()()),e&2&&(p(),f("title","ST \u8868\u683C\u5143\u4EF6\u6F14\u793A")("home","home"),p(4),f("data",t.url)("columns",t.columns)("total",t.total)("page",ge(8,Vr))("scroll",t.scroll),p(5),f("nzColumn",2))},dependencies:[R,B,te,Y,zt,Bt,ae,re,ne,Hi,E,ze,ce,ve,G,J,L,V,pe,j,T,Ii,I,se,F,W,P,ie,Z,X,q,$,O,wt,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,An,vn,yn,Sn,_n],encapsulation:2});var no=ui;var Fn=()=>({standalone:!0}),di=class di{constructor(){this.messageSrv=M(we);this.format_str="this is ${name}";this.format_res="";this.format_obj=JSON.stringify({name:"asdf"});this.content=`time ${+new Date}

    \u4E2D\u6587\uFF01@#\uFFE5%\u2026\u2026&*`}onFormat(){let i=null;try{i=JSON.parse(this.format_obj)}catch{this.messageSrv.error("\u65E0\u6CD5\u4F7F\u7528 JSON.parse \u8F6C\u6362");return}this.format_res=rn(this.format_str,i,!0)}onYuan(i){this.yuan_res=Nn(i)}onCopy(){tn(`time ${+new Date}`).then(()=>this.messageSrv.success("success"))}};di.\u0275fac=function(e){return new(e||di)},di.\u0275cmp=b({type:di,selectors:[["app-util"]],decls:39,vars:23,consts:[[1,"alain-default__content-title"],[3,"nzGutter"],[3,"nzSpan"],["nzTitle","\u5B57\u7B26\u4E32\u7C7B"],["nzType","inner","nzTitle","format"],["nz-form",""],[3,"nzSm"],["nz-input","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"nzSpan","nzOffset"],["nz-button","",3,"click"],["nzType","inner","nzTitle","yuan"],["type","number","nz-input","",3,"ngModelChange","ngModel"],[3,"innerHTML"],["nzTitle","\u5176\u5B83\u7C7B"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2," \u5DE5\u5177\u96C6 "),m(3,"small"),d(4,"@delon/util \u65E5\u5E38\u7528\u6CD5\u3002"),l()()(),m(5,"nz-row",1)(6,"nz-col",2)(7,"nz-card",3)(8,"nz-card",4)(9,"form",5)(10,"nz-form-item")(11,"nz-form-label",6),d(12,"String"),l(),m(13,"nz-form-control",6)(14,"input",7),be("ngModelChange",function(u){return ye(t.format_str,u)||(t.format_str=u),u}),l()()(),m(15,"nz-form-item")(16,"nz-form-label",6),d(17,"Object"),l(),m(18,"nz-form-control",6)(19,"input",7),be("ngModelChange",function(u){return ye(t.format_obj,u)||(t.format_obj=u),u}),l()()(),m(20,"nz-form-item")(21,"nz-form-control",8)(22,"button",9),C("click",function(){return t.onFormat()}),d(23,"Run"),l()()(),m(24,"nz-form-item")(25,"nz-form-label",6),d(26,"Result"),l(),m(27,"nz-form-control",6),d(28),l()()()(),m(29,"nz-card",10)(30,"nz-row",1)(31,"nz-col",2)(32,"input",11),be("ngModelChange",function(u){return ye(t.yuan_str,u)||(t.yuan_str=u),u}),C("ngModelChange",function(u){return t.onYuan(u)}),l()(),m(33,"nz-col",2),Ce(34,"div",12),l()()()()(),m(35,"nz-col",2)(36,"nz-card",13)(37,"button",9),C("click",function(){return t.onCopy()}),d(38,"Copy"),l()()()()),e&2&&(p(5),f("nzGutter",16),p(),f("nzSpan",12),p(5),f("nzSm",8),p(2),f("nzSm",16),p(),Se("ngModel",t.format_str),f("ngModelOptions",ge(21,Fn)),p(2),f("nzSm",8),p(2),f("nzSm",16),p(),Se("ngModel",t.format_obj),f("ngModelOptions",ge(22,Fn)),p(2),f("nzSpan",16)("nzOffset",8),p(4),f("nzSm",8),p(2),f("nzSm",16),p(),_e(" ",t.format_res," "),p(2),f("nzGutter",16),p(),f("nzSpan",12),p(),Se("ngModel",t.yuan_str),p(),f("nzSpan",12),p(),f("innerHTML",t.yuan_res,Fo),p(),f("nzSpan",12))},dependencies:[R,$t,Pt,nn,yt,jt,bt,Wt,B,te,Y,ae,re,ne,E,ze,ce,ve,G,J,gt,ht,L,V,pe,j,T,I,se,F,W,P,ie,Z,Rt,X,q,$,O,oe,le,ee,k,K,Zt,qt,Yt,Xt,me,D,Q,Me,U,ue,H,A],encapsulation:2});var ro=di;var ci=class ci{constructor(){this.xlsx=M(sn);this.users=Array(100).fill(0).map((i,e)=>({id:e+1,name:`name ${e+1}`,age:Math.ceil(Math.random()*10)+20}));this.columns=[{title:"\u7F16\u53F7",index:"id",type:"checkbox"},{title:"\u59D3\u540D",index:"name"},{title:"\u5E74\u9F84",index:"age"}]}url(){this.xlsx.import("./assets/tmp/demo.xlsx").then(i=>this.data=i)}change(i){let e=i.target.files[0];this.xlsx.import(e).then(t=>this.data=t)}download(){let i=[this.columns.map(e=>e.title)];this.users.forEach(e=>i.push(this.columns.map(t=>e[t.index]))),this.xlsx.export({sheets:[{data:i,name:"sheet name"}]})}};ci.\u0275fac=function(e){return new(e||ci)},ci.\u0275cmp=b({type:ci,selectors:[["app-xlsx"]],decls:16,vars:6,consts:[[1,"alain-default__content-title"],["href","//ng-alain.com/components/xlsx","target","_blank"],["nzTitle","Import"],["nz-button","",3,"click"],["type","file","multiple","false",1,"ml-sm",3,"change"],[1,"mt-sm"],["nzTitle","Export"],[1,"mt-sm",3,"data","ps","columns"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2," Import & Export excel file, "),m(3,"a",1),d(4,"Document"),l()()(),m(5,"nz-card",2)(6,"button",3),C("click",function(){return t.url()}),d(7,"Via Url"),l(),m(8,"input",4),C("change",function(u){return t.change(u)}),l(),m(9,"p",5),d(10),Nt(11,"json"),l()(),m(12,"nz-card",6)(13,"button",3),C("click",function(){return t.download()}),d(14,"Export"),l(),Ce(15,"st",7),l()),e&2&&(p(10),_e("result: ",_t(11,4,t.data)),p(5),f("data",t.users)("ps",3)("columns",t.columns))},dependencies:[R,B,te,Y,zt,ae,re,ne,E,ze,ce,ve,G,J,L,V,pe,j,T,I,se,F,W,P,ie,Z,X,q,$,O,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,Ft],encapsulation:2});var ao=ci;var Pn=So(Co(),1);var Rn=(()=>{class n{http=M(Fi);lazy=M(Ri);ngZone=M(Po);cogSrv=M(Ht);cog;constructor(){this.cog=this.cogSrv.merge("zip",{url:"https://cdn.jsdelivr.net/npm/jszip@3/dist/jszip.min.js",utils:[]})}init(){return this.lazy.load([this.cog.url].concat(this.cog.utils))}check(e){if(!e)throw new Error("get instance via `ZipService.create()`")}read(e,t){return new Promise((r,u)=>{let c=h=>{this.ngZone.run(()=>r(h))};this.init().then(()=>{if(typeof e=="string"){this.http.request("GET",e,{responseType:"arraybuffer"}).subscribe({next:o=>{JSZip.loadAsync(o,t).then(a=>c(a))},error:o=>{u(o)}});return}let h=new FileReader;h.onload=o=>{JSZip.loadAsync(o.target.result,t).then(a=>c(a))},h.readAsBinaryString(e)})})}create(){return new Promise(e=>{this.init().then(()=>{let t=new JSZip;e(t)}).catch(()=>e(null))})}pushUrl(e,t,r){return this.check(e),new Promise((u,c)=>{this.http.request("GET",r,{responseType:"arraybuffer"}).subscribe({next:h=>{e.file(t,h),u()},error:h=>{c({url:r,error:h})}})})}save(e,t){this.check(e);let r=ft({filename:"download.zip"},t);return new Promise((u,c)=>{e.generateAsync(ft({type:"blob"},r.options),r.update).then(h=>{r.callback&&r.callback(h),(0,Pn.saveAs)(h,r.filename),u()},h=>{c(h)})})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=It({token:n,factory:n.\u0275fac,providedIn:"root"})}return wo([an()],n.prototype,"read",null),n})();function jr(n,i){if(n&1&&(m(0,"li"),d(1),Nt(2,"json"),l()),n&2){let e=i.$implicit;p(),Ae(_t(2,1,e))}}function Wr(n,i){if(n&1){let e=fe();m(0,"nz-card",2)(1,"button",4),C("click",function(){S(e);let r=v();return y(r.url())}),d(2,"Via Url"),l(),m(3,"input",5),C("change",function(r){S(e);let u=v();return y(u.change(r))}),l(),m(4,"ol"),xt(5,jr,3,3,"li",null,Dt),l()()}if(n&2){let e=v();p(5),At(e.list)}}function $r(n,i){if(n&1){let e=fe();m(0,"tr")(1,"td")(2,"input",9),be("ngModelChange",function(r){let u=S(e).$implicit;return ye(u.path,r)||(u.path=r),y(r)}),l()(),m(3,"td")(4,"input",9),be("ngModelChange",function(r){let u=S(e).$implicit;return ye(u.url,r)||(u.url=r),y(r)}),l()()()}if(n&2){let e=i.$implicit,t=i.$index;p(2),f("name",Ci("path",t)),Se("ngModel",e.path),p(2),f("name",Ci("url",t)),Se("ngModel",e.url)}}function qr(n,i){if(n&1){let e=fe();m(0,"nz-card",3)(1,"button",6),C("click",function(){S(e);let r=v();return y(r.data.push({}))}),d(2,"new"),l(),m(3,"button",7),C("click",function(){S(e);let r=v();return y(r.download())}),d(4,"download"),l(),m(5,"nz-table",8)(6,"thead")(7,"tr")(8,"th")(9,"span"),d(10,"path"),l()(),m(11,"th")(12,"span"),d(13,"url"),l()()()(),m(14,"tbody"),xt(15,$r,5,6,"tr",null,Dt),l()()()}if(n&2){let e=v();p(),f("nzType","primary"),p(4),f("nzData",e.data)("nzFrontPagination",!1)("nzShowPagination",!1),p(10),At(e.data)}}var fi=class fi{constructor(){this.zip=M(Rn);this.msg=M(we);this.cdr=M(Di);this.instance=null;this.data=[{path:"demo.docx",url:"https://ng-alain.com/assets/demo.docx"},{path:"\u5C0F\u7A0B\u5E8F\u6807\u5FD7.zip",url:"https://wximg.gtimg.com/shake_tv/mina/standard_logo.zip"}]}ngOnInit(){this.zip.create().then(i=>{this.instance=i,this.cdr.detectChanges()})}format(i){let e=i.files;this.list=Object.keys(e).map(t=>({name:t,dir:e[t].dir,date:e[t].date})),this.cdr.detectChanges()}url(){this.zip.read("./assets/tmp/demo.zip").then(i=>this.format(i))}change(i){let e=i.target.files[0];this.zip.read(e).then(t=>this.format(t))}download(){let i=[];this.data.forEach(e=>{i.push(this.zip.pushUrl(this.instance,e.path,e.url))}),Promise.all(i).then(()=>{this.zip.save(this.instance).then(()=>{this.msg.success("download success"),this.data=[]})},e=>{console.warn(e),this.msg.error(JSON.stringify(e))})}};fi.\u0275fac=function(e){return new(e||fi)},fi.\u0275cmp=b({type:fi,selectors:[["app-zip"]],decls:7,vars:2,consts:[[1,"alain-default__content-title"],["href","//ng-alain.com/components/zip","target","_blank"],["nzTitle","\u89E3\u538B"],["nzTitle","\u538B\u7F29"],["nz-button","",3,"click"],["type","file","multiple","false",1,"ml-sm",3,"change"],["nz-button","",3,"click","nzType"],["nz-button","",1,"ml-sm",3,"click"],[1,"mt-sm",3,"nzData","nzFrontPagination","nzShowPagination"],["nz-input","",3,"ngModelChange","ngModel","name"]],template:function(e,t){e&1&&(m(0,"div",0)(1,"h1"),d(2," Read & Write zip file, "),m(3,"a",1),d(4,"Document"),l()()(),Ct(5,Wr,7,0,"nz-card",2),Ct(6,qr,17,4,"nz-card",3)),e&2&&(p(5),vt(t.instance?5:-1),p(),vt(t.instance?6:-1))},dependencies:[R,Pt,yt,bt,B,te,Y,ae,re,ne,E,ze,ce,ve,G,J,L,V,pe,j,T,I,se,F,W,dn,ln,pn,fn,un,cn,P,ie,Z,Rt,X,q,$,O,oe,le,ee,k,K,me,D,Q,Me,U,ue,H,A,Ft],encapsulation:2,changeDetection:0});var so=fi;var _l=[{path:"acl",component:ji,data:{title:"ACL"}},{path:"acl-admin",component:Wi,data:{title:"ACL Admin"}},{path:"acl-users",component:$i,canActivate:[vi],data:{title:"\u7528\u6236\u7BA1\u7406",guard:"admin"}},{path:"acl-roles",component:qi,canActivate:[vi],data:{title:"\u89D2\u8272\u7BA1\u7406",guard:"admin"}},{path:"acl-permissions",component:Zi,canActivate:[vi],data:{title:"\u6B0A\u9650\u7BA1\u7406",guard:"admin"}},{path:"cache",component:Xi,data:{title:"Cache"}},{path:"downfile",component:Yi,data:{title:"Down File"}},{path:"form",component:Ji,data:{title:"Form"}},{path:"guard",component:eo,data:{title:"Route Guard"}},{path:"guard/auth",component:Qi,data:{title:"Guard Auth"}},{path:"guard/admin",component:Ki,canActivate:[vi],data:{title:"Guard Admin",guard:"admin"}},{path:"guard/leave",component:to,canDeactivate:[En],data:{title:"Guard Leave"}},{path:"print",component:io,data:{title:"Print"}},{path:"qr",component:oo,data:{title:"QR"}},{path:"st",component:no,data:{title:"ST"}},{path:"util",component:ro,data:{title:"Util"}},{path:"xlsx",component:ao,data:{title:"Xlsx"}},{path:"zip",component:so,data:{title:"Zip"}}];export{_l as routes};

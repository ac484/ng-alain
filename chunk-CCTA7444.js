import{j as L,k as $,l as G}from"./chunk-56PXRFBZ.js";import{d as E}from"./chunk-MIVLBNPW.js";import{h as P}from"./chunk-HA4JAQYT.js";import{a as j,b as A}from"./chunk-HU3IRF5W.js";import{k as D,v as I,w as k}from"./chunk-5OKATPB4.js";import{$h as O,Dd as S,Hd as N,Kc as _,Mb as f,Mc as M,Nb as i,Nh as T,Ob as o,Oc as F,Oh as b,Pb as z,Wb as y,Zb as h,_h as B,ab as a,ac as c,fb as u,mb as C,pc as l,qc as p,rc as w,sb as v,xa as d,ya as g}from"./chunk-P5U5CQEL.js";function R(x,e){if(x&1){let t=y();i(0,"nz-list-item")(1,"div",3)(2,"div",4)(3,"div",5),l(4),o(),i(5,"div",6)(6,"nz-tag",7),l(7),o(),i(8,"span"),l(9),o(),i(10,"span"),l(11),_(12,"date"),o()()(),i(13,"div",8)(14,"button",9),h("click",function(){let r=d(t).$implicit,s=c();return g(s.viewFile(r))}),z(15,"span",10),o(),i(16,"button",9),h("click",function(){let r=d(t).$implicit,s=c();return g(s.downloadFile(r))}),z(17,"span",11),o()()()()}if(x&2){let t=e.$implicit,n=c();a(4),p(t.name),a(2),f("nzColor",n.getFileTypeColor(t.type)),a(),w(" ",n.getFileTypeDisplay(t.type)," "),a(2),p(n.formatFileSize(t.size)),a(2),p(M(12,5,t.uploadTime,"MM-dd HH:mm"))}}var m=class m{constructor(e,t){this.modal=e;this.message=t;this.attachments=[{name:"\u5408\u7D04\u6587\u4EF6.pdf",url:"https://example.com/contract.pdf",size:1024e3,type:"application/pdf",uploadTime:new Date(2024,0,15)},{name:"\u9644\u4EF6\u6E05\u55AE.xlsx",url:"https://example.com/attachments.xlsx",size:512e3,type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",uploadTime:new Date(2024,0,16)},{name:"\u7C3D\u540D\u5716\u7247.jpg",url:"https://example.com/signature.jpg",size:256e3,type:"image/jpeg",uploadTime:new Date(2024,0,17)}]}viewFile(e){if(e.type==="application/pdf"||e.type.includes("document")||e.type.includes("spreadsheet")){let t=`https://docs.google.com/viewer?url=${encodeURIComponent(e.url)}&embedded=true`;this.modal.create({nzTitle:e.name,nzContent:`<iframe src="${t}" style="width: 100%; height: 600px; border: none;"></iframe>`,nzWidth:"90%",nzFooter:[{label:"\u5728\u65B0\u8996\u7A97\u958B\u555F",onClick:()=>window.open(e.url,"_blank")},{label:"\u4E0B\u8F09",onClick:()=>this.downloadFile(e)}]})}else e.type.includes("image/")?this.modal.create({nzTitle:e.name,nzContent:`<img src="${e.url}" style="max-width: 100%; height: auto;" />`,nzWidth:"80%",nzFooter:[{label:"\u4E0B\u8F09",onClick:()=>this.downloadFile(e)}]}):(this.message.info("\u6B64\u6A94\u6848\u985E\u578B\u4E0D\u652F\u63F4\u9810\u89BD\uFF0C\u5C07\u76F4\u63A5\u4E0B\u8F09"),this.downloadFile(e))}downloadFile(e){let t=document.createElement("a");t.href=e.url,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.message.success("\u6A94\u6848\u4E0B\u8F09\u6210\u529F")}getFileTypeColor(e){return{"application/pdf":"red","application/msword":"blue","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"blue","application/vnd.ms-excel":"green","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"green","image/jpeg":"orange","image/jpg":"orange","image/png":"purple","image/gif":"cyan"}[e]||"default"}formatFileSize(e){if(e===0)return"0 B";let t=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+n[r]}getFileTypeDisplay(e){return{"application/pdf":"PDF","application/msword":"DOC","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"DOCX","application/vnd.ms-excel":"XLS","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"XLSX","image/jpeg":"JPG","image/jpg":"JPG","image/png":"PNG","image/gif":"GIF"}[e]||"FILE"}};m.\u0275fac=function(t){return new(t||m)(u(P),u(E))},m.\u0275cmp=C({type:m,selectors:[["app-contract-attachment"]],inputs:{contractId:"contractId"},decls:4,vars:2,consts:[["item",""],["title","\u5408\u7D04\u9644\u4EF6"],[3,"nzDataSource","nzSize"],[1,"attachment-item"],[1,"attachment-info"],[1,"attachment-name"],[1,"attachment-meta"],[3,"nzColor"],[1,"attachment-actions"],["nz-button","","nzType","link","nzSize","small",3,"click"],["nz-icon","","nzType","eye"],["nz-icon","","nzType","download"]],template:function(t,n){t&1&&(i(0,"nz-card",1)(1,"nz-list",2),v(2,R,18,8,"ng-template",null,0,F),o()()),t&2&&(a(),f("nzDataSource",n.attachments)("nzSize","small"))},dependencies:[N,O,B,G,L,$,A,j,k,I,D,b,T,S],styles:[".attachment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.attachment-info[_ngcontent-%COMP%]{flex:1}.attachment-name[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.attachment-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:12px;color:#666}.attachment-actions[_ngcontent-%COMP%]{display:flex;gap:4px}"]});var V=m;export{V as a};

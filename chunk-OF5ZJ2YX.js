import{a as B,b as K}from"./chunk-U2X5E77I.js";import"./chunk-MT5GF2ID.js";import{d as b}from"./chunk-FDGOABD7.js";import{e as S,j as F}from"./chunk-QQO7XJAL.js";import"./chunk-JOLA3FC3.js";import"./chunk-XYNR6SEP.js";import"./chunk-NFE23O5F.js";import"./chunk-RYWOVSD3.js";import{f as V,g as A}from"./chunk-SHX3V7LL.js";import"./chunk-UDEZOTLA.js";import"./chunk-AJZQPTXH.js";import{a as v,b as w,d as M,e as D}from"./chunk-AAISIDER.js";import"./chunk-KGMFTY4O.js";import"./chunk-LLGIJQAU.js";import"./chunk-BXOHVWQF.js";import"./chunk-JFSGAE4Z.js";import{f as T,g as z}from"./chunk-DW5T6CU6.js";import{Jd as N,Nb as x,Ob as r,Oh as E,Pb as o,Ph as k,Qb as m,Xb as g,_b as a,bb as h,gb as f,mc as y,nb as C,nc as _,qc as u,xa as s,ya as l}from"./chunk-F2J3MLFC.js";import"./chunk-57BLH6QZ.js";var p=class p{constructor(e){this.message=e;this.defaultTreeData=[{title:"\u6839\u7BC0\u9EDE 1",key:"0-0",children:[{title:"\u5B50\u7BC0\u9EDE 1-1",key:"0-0-0",children:[{title:"\u8449\u5B50\u7BC0\u9EDE 1-1-1",key:"0-0-0-0",isLeaf:!0},{title:"\u8449\u5B50\u7BC0\u9EDE 1-1-2",key:"0-0-0-1",isLeaf:!0}]},{title:"\u5B50\u7BC0\u9EDE 1-2",key:"0-0-1",children:[{title:"\u8449\u5B50\u7BC0\u9EDE 1-2-1",key:"0-0-1-0",isLeaf:!0}]}]},{title:"\u6839\u7BC0\u9EDE 2",key:"0-1",children:[{title:"\u5B50\u7BC0\u9EDE 2-1",key:"0-1-0",children:[{title:"\u8449\u5B50\u7BC0\u9EDE 2-1-1",key:"0-1-0-0",isLeaf:!0}]}]}];this.treeData=[...this.defaultTreeData];this.expandedKeys=["0-0","0-0-0","0-0-1","0-1","0-1-0"];this.selectedKeys=[];this.currentNode=null;this.showContextMenu=!1;this.contextMenuX=0;this.contextMenuY=0}onExpandChange(e){this.expandedKeys=e.keys}onNodeClick(e){this.selectedKeys=[e.node.key]}onContextMenu(e){this.currentNode=e.node,this.showContextMenuAt(e.event.clientX,e.event.clientY)}onContainerRightClick(e){e.preventDefault(),this.currentNode=null,this.showContextMenuAt(e.clientX,e.clientY)}showContextMenuAt(e,i){this.contextMenuX=e,this.contextMenuY=i,this.showContextMenu=!0,setTimeout(()=>{document.addEventListener("click",this.hideContextMenu.bind(this),{once:!0})},0)}hideContextMenu(){this.showContextMenu=!1}addChild(){this.hideContextMenu(),this.currentNode?(this.message.success(`\u70BA\u7BC0\u9EDE "${this.currentNode.title}" \u65B0\u589E\u5B50\u7BC0\u9EDE`),this.addChildNode(this.currentNode)):this.message.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE")}addSibling(){this.hideContextMenu(),this.currentNode?(this.message.success(`\u70BA\u7BC0\u9EDE "${this.currentNode.title}" \u65B0\u589E\u5144\u5F1F\u7BC0\u9EDE`),this.addSiblingNode(this.currentNode)):this.message.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE")}editNode(){this.hideContextMenu(),this.currentNode?(this.message.info(`\u7DE8\u8F2F\u7BC0\u9EDE "${this.currentNode.title}"`),this.editNodeTitle(this.currentNode)):this.message.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE")}copyNode(){this.hideContextMenu(),this.currentNode?(this.message.success(`\u8907\u88FD\u7BC0\u9EDE "${this.currentNode.title}"`),this.copyNodeData(this.currentNode)):this.message.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE")}deleteNode(){this.hideContextMenu(),this.currentNode?(this.message.warning(`\u522A\u9664\u7BC0\u9EDE "${this.currentNode.title}"`),this.deleteNodeFromTree(this.currentNode)):this.message.warning("\u8ACB\u5148\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE")}expandAll(){this.expandedKeys=this.getAllKeys(this.treeData),this.message.info("\u5DF2\u5C55\u958B\u5168\u90E8\u7BC0\u9EDE")}collapseAll(){this.expandedKeys=[],this.message.info("\u5DF2\u6536\u5408\u5168\u90E8\u7BC0\u9EDE")}resetTree(){this.treeData=[...this.defaultTreeData],this.expandedKeys=["0-0","0-0-0","0-0-1","0-1","0-1-0"],this.message.success("\u6A39\u72C0\u7D50\u69CB\u5DF2\u91CD\u7F6E")}addChildNode(e){let i=`${e.key}-${Date.now()}`,t={title:`\u65B0\u5B50\u7BC0\u9EDE ${i}`,key:i,children:[]};e.children||(e.children=[]),e.children.push(t),this.expandedKeys=[...this.expandedKeys,e.key]}addSiblingNode(e){let i=e.key.substring(0,e.key.lastIndexOf("-")),t=`${i}-${Date.now()}`,n={title:`\u65B0\u5144\u5F1F\u7BC0\u9EDE ${t}`,key:t,children:[]};this.addNodeToParent(this.treeData,i,n)}addNodeToParent(e,i,t){for(let n=0;n<e.length;n++){if(e[n].key===i)return e[n].children||(e[n].children=[]),e[n].children.push(t),!0;if(e[n].children&&this.addNodeToParent(e[n].children,i,t))return!0}return!1}editNodeTitle(e){let i=prompt("\u8ACB\u8F38\u5165\u65B0\u7684\u7BC0\u9EDE\u540D\u7A31:",e.title);i?.trim()&&(e.title=i.trim(),this.message.success("\u7BC0\u9EDE\u540D\u7A31\u5DF2\u66F4\u65B0"))}copyNodeData(e){let i=JSON.stringify({title:e.title,key:e.key,children:e.children||[]});console.log("\u8907\u88FD\u7684\u7BC0\u9EDE\u8CC7\u6599:",i),this.message.success("\u7BC0\u9EDE\u8CC7\u6599\u5DF2\u8907\u88FD\u5230\u526A\u8CBC\u7C3F")}deleteNodeFromTree(e){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u7BC0\u9EDE "${e.title}" \u55CE\uFF1F`)&&(this.removeNodeFromTree(this.treeData,e.key),this.message.success("\u7BC0\u9EDE\u5DF2\u522A\u9664"))}removeNodeFromTree(e,i){for(let t=0;t<e.length;t++){if(e[t].key===i)return e.splice(t,1),!0;if(e[t].children&&this.removeNodeFromTree(e[t].children,i))return!0}return!1}getAllKeys(e){let i=[];return e.forEach(t=>{i.push(t.key),t.children&&i.push(...this.getAllKeys(t.children))}),i}};p.\u0275fac=function(i){return new(i||p)(f(b))},p.\u0275cmp=C({type:p,selectors:[["app-tree-context"]],decls:43,vars:12,consts:[["tree",""],["contextMenu",""],["title","\u6A39\u72C0\u53F3\u9375\u9078\u55AE\u529F\u80FD"],[2,"margin-bottom","16px"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",3,"click"],[1,"tree-container",3,"contextmenu"],[3,"nzExpandChange","nzClick","nzContextMenu","nzData","nzBlockNode","nzShowLine","nzShowIcon","nzExpandedKeys","nzSelectedKeys"],[1,"context-menu",3,"click"],[1,"context-menu-list"],[1,"context-menu-item",3,"click"],["nz-icon","","nzType","plus"],["nz-icon","","nzType","plus-circle"],[1,"context-menu-divider"],["nz-icon","","nzType","edit"],["nz-icon","","nzType","copy"],[1,"context-menu-item","danger",3,"click"],["nz-icon","","nzType","delete"],[1,"help-info"]],template:function(i,t){if(i&1){let n=g();r(0,"nz-card",2)(1,"nz-space",3)(2,"button",4),a("click",function(){return s(n),l(t.expandAll())}),u(3,"\u5C55\u958B\u5168\u90E8"),o(),r(4,"button",5),a("click",function(){return s(n),l(t.collapseAll())}),u(5,"\u6536\u5408\u5168\u90E8"),o(),r(6,"button",5),a("click",function(){return s(n),l(t.resetTree())}),u(7,"\u91CD\u7F6E"),o()(),r(8,"div",6),a("contextmenu",function(c){return s(n),l(t.onContainerRightClick(c))}),r(9,"nz-tree",7,0),a("nzExpandChange",function(c){return s(n),l(t.onExpandChange(c))})("nzClick",function(c){return s(n),l(t.onNodeClick(c))})("nzContextMenu",function(c){return s(n),l(t.onContextMenu(c))}),o()(),r(11,"div",8,1),a("click",function(c){return s(n),l(c.stopPropagation())}),r(13,"ul",9)(14,"li",10),a("click",function(){return s(n),l(t.addChild())}),m(15,"span",11),u(16,"\u65B0\u589E\u5B50\u7BC0\u9EDE "),o(),r(17,"li",10),a("click",function(){return s(n),l(t.addSibling())}),m(18,"span",12),u(19,"\u65B0\u589E\u5144\u5F1F\u7BC0\u9EDE "),o(),m(20,"li",13),r(21,"li",10),a("click",function(){return s(n),l(t.editNode())}),m(22,"span",14),u(23,"\u7DE8\u8F2F\u7BC0\u9EDE "),o(),r(24,"li",10),a("click",function(){return s(n),l(t.copyNode())}),m(25,"span",15),u(26,"\u8907\u88FD\u7BC0\u9EDE "),o(),m(27,"li",13),r(28,"li",16),a("click",function(){return s(n),l(t.deleteNode())}),m(29,"span",17),u(30,"\u522A\u9664\u7BC0\u9EDE "),o()()(),r(31,"div",18)(32,"h4"),u(33,"\u53F3\u9375\u9078\u55AE\u8AAA\u660E\uFF1A"),o(),r(34,"ul")(35,"li"),u(36,"\u5728\u7BC0\u9EDE\u4E0A\u6309\u53F3\u9375\u6703\u986F\u793A\u4E0A\u4E0B\u6587\u9078\u55AE"),o(),r(37,"li"),u(38,"\u652F\u63F4\u65B0\u589E\u5B50\u7BC0\u9EDE\u548C\u5144\u5F1F\u7BC0\u9EDE"),o(),r(39,"li"),u(40,"\u53EF\u4EE5\u7DE8\u8F2F\u3001\u8907\u88FD\u3001\u522A\u9664\u7BC0\u9EDE"),o(),r(41,"li"),u(42,"\u5728\u7A7A\u767D\u8655\u53F3\u9375\u53EF\u4EE5\u65B0\u589E\u6839\u7BC0\u9EDE"),o()()()()}i&2&&(h(9),x("nzData",t.treeData)("nzBlockNode",!0)("nzShowLine",!0)("nzShowIcon",!0)("nzExpandedKeys",t.expandedKeys)("nzSelectedKeys",t.selectedKeys),h(2),y("left",t.contextMenuX,"px")("top",t.contextMenuY,"px"),_("show",t.showContextMenu))},dependencies:[N,A,V,K,B,D,M,v,w,z,T,F,S,k,E],styles:[".tree-container[_ngcontent-%COMP%]{min-height:300px;border:1px solid #d9d9d9;border-radius:6px;padding:16px;background-color:#fafafa}.tree-container[_ngcontent-%COMP%]:hover{border-color:#40a9ff}.context-menu[_ngcontent-%COMP%]{position:fixed;z-index:1000;background:#fff;border:1px solid #d9d9d9;border-radius:6px;box-shadow:0 2px 8px #00000026;display:none;min-width:160px}.context-menu.show[_ngcontent-%COMP%]{display:block}.context-menu-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:4px 0}.context-menu-item[_ngcontent-%COMP%]{padding:8px 16px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background-color .2s}.context-menu-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.context-menu-item.danger[_ngcontent-%COMP%]:hover{background-color:#fff2f0;color:#ff4d4f}.context-menu-divider[_ngcontent-%COMP%]{height:1px;background-color:#f0f0f0;margin:4px 0}.help-info[_ngcontent-%COMP%]{margin-top:16px;padding:16px;background-color:#f5f5f5;border-radius:4px}"]});var P=p;export{P as TreeContextComponent};

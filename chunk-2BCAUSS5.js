import{a as M}from"./chunk-VDJ72REQ.js";import{a as ae,b as pe}from"./chunk-LVG2LAOY.js";import{b as j,d as G,e as q}from"./chunk-Y5FLXPTW.js";import"./chunk-UCF3NJQY.js";import"./chunk-VAGS5EVQ.js";import{a as le}from"./chunk-RUD7LQCH.js";import"./chunk-LFVXFGPE.js";import{f as ne,g as ie,h as oe,k as re}from"./chunk-RGYXGWNO.js";import{a as X,c as Y,i as Z,j as ee,k as te}from"./chunk-I3YMRPXC.js";import"./chunk-VIGI73B6.js";import"./chunk-O3DGGP5O.js";import{d as H,g as J,m as K,z as U}from"./chunk-7GKVL75V.js";import"./chunk-X5G25CLX.js";import"./chunk-PAIB6VMN.js";import"./chunk-YMEC4OFG.js";import"./chunk-ZFIXZIYB.js";import"./chunk-W6Z6A3Q5.js";import"./chunk-FJXMRBDK.js";import"./chunk-5V3RUN7K.js";import"./chunk-2DZ25YRQ.js";import"./chunk-PR6SM3R4.js";import"./chunk-5NB44RP4.js";import"./chunk-M2FMHT2I.js";import"./chunk-BA2SIH6H.js";import"./chunk-AEDV7UUM.js";import{Ad as A,Cd as R,Dd as $,Gc as B,Jd as L,Lc as T,Mc as v,Nb as C,Ob as r,Oh as Q,Pb as l,Pc as E,Ph as W,Qb as _,Ub as y,Vb as P,Xb as x,_b as u,bb as s,bc as f,fc as S,gb as w,gc as b,hc as k,lc as N,nb as V,qc as m,rc as h,sc as D,tb as g,vc as I,wc as F,xa as p,xc as O,ya as c}from"./chunk-GM6XQ5SX.js";import"./chunk-57BLH6QZ.js";var se=()=>[];function me(d,n){d&1&&_(0,"nz-icon",12)}function ue(d,n){if(d&1){let t=x();y(0),r(1,"nz-icon",16),u("click",function(){p(t);let i=f().$implicit,o=f();return c(o.openFolder(i))}),l(),r(2,"span",17),m(3),l(),r(4,"span",18),m(5),T(6,"lowercase"),l(),P()}if(d&2){let t=f(),e=t.$implicit,i=t.origin;s(),C("nzType",e.isExpanded?"folder-open":"folder"),s(2),h(e.title),s(2),D("created by ",v(6,3,i.author))}}function _e(d,n){if(d&1&&(_(0,"nz-icon",19),r(1,"span",20),m(2),l(),r(3,"span",21),m(4),T(5,"lowercase"),l()),d&2){let t=f(),e=t.$implicit,i=t.origin;s(2),h(e.title),s(2),D("modified by ",v(5,2,i.author))}}function fe(d,n){if(d&1){let t=x();r(0,"span",13)(1,"span",14),u("contextmenu",function(i){let o=p(t).$implicit,a=f(),de=N(15);return c(a.contextMenu(i,de,o))}),g(2,ue,7,5,"ng-container",15)(3,_e,6,4,"ng-template",null,3,E),l()()}if(d&2){let t=n.$implicit,e=N(4);s(2),C("ngIf",!t.isLeaf)("ngIfElse",e)}}var z=class z{constructor(n,t){this.nzContextMenuService=n;this.firestore=t;this.searchValue="";this.contextNode=null;let e=q(this.firestore,"tree-nodes");this.treeData$=G(e,{idField:"key"})}openFolder(n){if(n instanceof le)n.isExpanded=!n.isExpanded;else{let t=n.node;t&&(t.isExpanded=!t.isExpanded)}}activeNode(n){this.activatedNode=n.node}onDrop(n){console.log("\u62D6\u66F3\u5B8C\u6210:",n)}contextMenu(n,t,e){this.contextNode=e??null,this.nzContextMenuService.create(n,t)}addNode(){this.crud.showAddModal(this.contextNode?.key)}editNode(){this.contextNode&&this.crud.showEditModal(this.contextNode.origin)}deleteNode(){this.contextNode&&this.crud.deleteNode(this.contextNode.origin)}addRootNode(){this.crud.showAddModal(null)}selectDropdown(n){alert(n)}};z.\u0275fac=function(t){return new(t||z)(w(te),w(j))},z.\u0275cmp=V({type:z,selectors:[["app-tree-panel"]],viewQuery:function(t,e){if(t&1&&S(M,5),t&2){let i;b(i=k())&&(e.crud=i.first)}},decls:23,vars:8,consts:[["suffixIcon",""],["nzTreeTemplate",""],["menu","nzDropdownMenu"],["fileIcon",""],[1,"toolbar"],["nz-button","","nzType","default",2,"margin-bottom","8px",3,"click"],["nz-icon","","nzType","cluster"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","\u641C\u5C0B\u7BC0\u9EDE",3,"ngModelChange","ngModel"],["nzBlockNode","","nzDraggable","","nzVirtualHeight","300px",3,"nzClick","nzDblClick","nzOnDrop","nzData","nzSearchValue","nzTreeTemplate"],["nz-menu",""],["nz-menu-item","",3,"click"],["nzType","search"],[1,"custom-node"],[3,"contextmenu"],[4,"ngIf","ngIfElse"],[3,"click","nzType"],[1,"folder-name"],[1,"folder-desc"],["nzType","file"],[1,"file-name"],[1,"file-desc"]],template:function(t,e){if(t&1){let i=x();_(0,"app-firebase-crud"),r(1,"div",4)(2,"button",5),u("click",function(){return p(i),c(e.addRootNode())}),_(3,"span",6),m(4,"\u5EFA\u7ACB\u6839\u7D50\u9EDE "),l()(),r(5,"nz-input-group",7)(6,"input",8),O("ngModelChange",function(a){return p(i),F(e.searchValue,a)||(e.searchValue=a),c(a)}),l()(),g(7,me,1,0,"ng-template",null,0,E),_(9,"br"),r(10,"nz-tree",9),T(11,"async"),u("nzClick",function(a){return p(i),c(e.activeNode(a))})("nzDblClick",function(a){return p(i),c(e.openFolder(a))})("nzOnDrop",function(a){return p(i),c(e.onDrop(a))}),l(),g(12,fe,5,2,"ng-template",null,1,E),r(14,"nz-dropdown-menu",null,2)(16,"ul",10)(17,"li",11),u("click",function(){return p(i),c(e.addNode())}),m(18,"\u65B0\u589E\u7BC0\u9EDE"),l(),r(19,"li",11),u("click",function(){return p(i),c(e.editNode())}),m(20,"\u7DE8\u8F2F\u7BC0\u9EDE"),l(),r(21,"li",11),u("click",function(){return p(i),c(e.deleteNode())}),m(22,"\u522A\u9664\u7BC0\u9EDE"),l()()()}if(t&2){let i=N(8),o=N(13);s(5),C("nzSuffix",i),s(),I("ngModel",e.searchValue),s(4),C("nzData",v(11,5,e.treeData$)??B(7,se))("nzSearchValue",e.searchValue)("nzTreeTemplate",o)}},dependencies:[L,A,U,H,J,K,pe,ae,ee,Y,X,Z,W,Q,re,ne,oe,ie,M,R,$],styles:["nz-tree[_ngcontent-%COMP%]{overflow:hidden;margin:0 -24px;padding:0 24px}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;display:inline-block;background:#87ceff;color:#fff;position:relative;left:12px}"]});var ce=z;export{ce as TreePanelComponent};

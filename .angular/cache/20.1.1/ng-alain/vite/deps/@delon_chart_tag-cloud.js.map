{
  "version": 3,
  "sources": ["../../../../../../node_modules/@delon/chart/fesm2022/tag-cloud.mjs"],
  "sourcesContent": ["import * as i0 from '@angular/core';\nimport { EventEmitter, numberAttribute, Output, Input, ViewEncapsulation, ChangeDetectionStrategy, Component, NgModule } from '@angular/core';\nimport { fromEvent, filter, debounceTime } from 'rxjs';\nimport { G2BaseComponent } from '@delon/chart/core';\nimport { NzSkeletonComponent, NzSkeletonModule } from 'ng-zorro-antd/skeleton';\nimport { CommonModule } from '@angular/common';\nfunction G2TagCloudComponent_Conditional_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"nz-skeleton\");\n  }\n}\nclass G2TagCloudComponent extends G2BaseComponent {\n  // #region fields\n  width = 0;\n  height = 200;\n  padding = 0;\n  data = [];\n  clickItem = new EventEmitter();\n  // #endregion\n  initTagCloud() {\n    const winG2 = this.winG2;\n    winG2.registerShape('point', 'cloud', {\n      draw(cfg, container) {\n        const data = cfg.data;\n        const textShape = container.addShape({\n          type: 'text',\n          name: 'tag-cloud-text',\n          attrs: {\n            ...cfg.style,\n            fontSize: data.size,\n            text: data.text,\n            textAlign: 'center',\n            fontFamily: data.font,\n            fill: cfg.color,\n            textBaseline: 'Alphabetic',\n            x: cfg.x,\n            y: cfg.y\n          }\n        });\n        if (data.rotate) {\n          winG2.Util.rotate(textShape, data.rotate * Math.PI / 180);\n        }\n        return textShape;\n      }\n    });\n  }\n  install() {\n    this.initTagCloud();\n    const {\n      el,\n      padding,\n      theme\n    } = this;\n    if (this.height === 0) {\n      this.height = this.el.nativeElement.clientHeight;\n    }\n    if (this.width === 0) {\n      this.width = this.el.nativeElement.clientWidth;\n    }\n    const chart = this._chart = new this.winG2.Chart({\n      container: el.nativeElement,\n      autoFit: false,\n      padding,\n      height: this.height,\n      width: this.width,\n      theme\n    });\n    chart.scale({\n      x: {\n        nice: false\n      },\n      y: {\n        nice: false\n      }\n    });\n    chart.legend(false);\n    chart.axis(false);\n    chart.tooltip({\n      showTitle: false,\n      showMarkers: false\n    });\n    chart.coordinate().reflect();\n    chart.point().position('x*y').color('text').shape('cloud').state({\n      active: {\n        style: {\n          fillOpacity: 0.4\n        }\n      }\n    });\n    chart.interaction('element-active');\n    chart.on('tag-cloud-text:click', ev => {\n      this.ngZone.run(() => this.clickItem.emit({\n        item: ev.data?.data,\n        ev\n      }));\n    });\n    this.ready.next(chart);\n    this.changeData();\n    chart.render();\n  }\n  changeData() {\n    const {\n      _chart,\n      data\n    } = this;\n    if (!_chart || !Array.isArray(data) || data.length <= 0) return;\n    const dv = new window.DataSet.View().source(data);\n    const range = dv.range('value');\n    const min = range[0];\n    const max = range[1];\n    dv.transform({\n      type: 'tag-cloud',\n      fields: ['name', 'value'],\n      // imageMask,\n      font: 'Verdana',\n      size: [this.width, this.height],\n      // 宽高设置最好根据 imageMask 做调整\n      padding: 0,\n      timeInterval: 5000,\n      // max execute time\n      rotate() {\n        let random = ~~(Math.random() * 4) % 4;\n        if (random === 2) {\n          random = 0;\n        }\n        return random * 90; // 0, 90, 270\n      },\n      fontSize(d) {\n        return (d.value - min) / (max - min) * (32 - 8) + 8;\n      }\n    });\n    _chart.changeData(dv.rows);\n  }\n  installResizeEvent() {\n    this.resize$ = fromEvent(window, 'resize').pipe(filter(() => !!this._chart), debounceTime(200)).subscribe(() => this.changeData());\n  }\n  onInit() {\n    this.installResizeEvent();\n  }\n  static ɵfac = /* @__PURE__ */(() => {\n    let ɵG2TagCloudComponent_BaseFactory;\n    return function G2TagCloudComponent_Factory(__ngFactoryType__) {\n      return (ɵG2TagCloudComponent_BaseFactory || (ɵG2TagCloudComponent_BaseFactory = i0.ɵɵgetInheritedFactory(G2TagCloudComponent)))(__ngFactoryType__ || G2TagCloudComponent);\n    };\n  })();\n  static ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n    type: G2TagCloudComponent,\n    selectors: [[\"g2-tag-cloud\"]],\n    inputs: {\n      width: [2, \"width\", \"width\", numberAttribute],\n      height: [2, \"height\", \"height\", numberAttribute],\n      padding: \"padding\",\n      data: \"data\"\n    },\n    outputs: {\n      clickItem: \"clickItem\"\n    },\n    exportAs: [\"g2TagCloud\"],\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 1,\n    vars: 1,\n    template: function G2TagCloudComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵconditionalCreate(0, G2TagCloudComponent_Conditional_0_Template, 1, 0, \"nz-skeleton\");\n      }\n      if (rf & 2) {\n        i0.ɵɵconditional(!ctx.loaded ? 0 : -1);\n      }\n    },\n    dependencies: [NzSkeletonComponent],\n    encapsulation: 2,\n    changeDetection: 0\n  });\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(G2TagCloudComponent, [{\n    type: Component,\n    args: [{\n      selector: 'g2-tag-cloud',\n      exportAs: 'g2TagCloud',\n      template: `@if (!loaded) {\n    <nz-skeleton />\n  }`,\n      changeDetection: ChangeDetectionStrategy.OnPush,\n      encapsulation: ViewEncapsulation.None,\n      imports: [NzSkeletonComponent]\n    }]\n  }], null, {\n    width: [{\n      type: Input,\n      args: [{\n        transform: numberAttribute\n      }]\n    }],\n    height: [{\n      type: Input,\n      args: [{\n        transform: numberAttribute\n      }]\n    }],\n    padding: [{\n      type: Input\n    }],\n    data: [{\n      type: Input\n    }],\n    clickItem: [{\n      type: Output\n    }]\n  });\n})();\nconst COMPONENTS = [G2TagCloudComponent];\nclass G2TagCloudModule {\n  static ɵfac = function G2TagCloudModule_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || G2TagCloudModule)();\n  };\n  static ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n    type: G2TagCloudModule,\n    imports: [CommonModule, NzSkeletonModule, G2TagCloudComponent],\n    exports: [G2TagCloudComponent]\n  });\n  static ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n    imports: [CommonModule, NzSkeletonModule, COMPONENTS]\n  });\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(G2TagCloudModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule, NzSkeletonModule, ...COMPONENTS],\n      exports: COMPONENTS\n    }]\n  }], null, null);\n})();\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { G2TagCloudComponent, G2TagCloudModule };\n"],
  "mappings": "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",
  "names": []
}

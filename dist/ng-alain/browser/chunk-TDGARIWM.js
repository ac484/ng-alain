import{g as O}from"./chunk-UR6TRNFJ.js";import"./chunk-MJBPQTDZ.js";import"./chunk-5MAMKSM6.js";import"./chunk-PEYVBGFC.js";import"./chunk-KHKEIR5Y.js";import"./chunk-ODOVWZNR.js";import"./chunk-OPZSBA3I.js";import{b as j}from"./chunk-UUGZREJK.js";import"./chunk-R7WW44JR.js";import"./chunk-BPQUQ6MO.js";import"./chunk-T6HWVAS2.js";import"./chunk-6IW4YWVE.js";import"./chunk-W4BJY4IL.js";import"./chunk-4AZZRXDC.js";import"./chunk-AMHC2ZNL.js";import"./chunk-OYRBCSW5.js";import"./chunk-QCCZH6HF.js";import{b as E}from"./chunk-GQ2GUVEO.js";import"./chunk-XNCF4SQO.js";import{d as V}from"./chunk-W2F5J6VW.js";import"./chunk-DPC4Z5WN.js";import{f as $,g as B}from"./chunk-RY5S5FFE.js";import"./chunk-4CYWFENI.js";import"./chunk-N2U5WHCP.js";import"./chunk-PZD74DD7.js";import"./chunk-B7TLEUBG.js";import"./chunk-MUUHR64J.js";import"./chunk-D2VCTMW4.js";import"./chunk-JIG3TSCX.js";import"./chunk-Y7K6W6MG.js";import"./chunk-ACVYVQPN.js";import"./chunk-L7UTUH2H.js";import"./chunk-4LNZ6HH6.js";import"./chunk-XJNVHZJS.js";import"./chunk-CQQKN5JJ.js";import{m as h}from"./chunk-J2M5LMUW.js";import{f as y,g as N,h as k,q as I,s as M,t as R}from"./chunk-5LNT6E46.js";import"./chunk-WLGCOGYM.js";import{P as T,p as D,y as S}from"./chunk-XHOQOBOK.js";import{Aa as l,Ba as u,Fb as b,Lb as C,Nc as g,bd as x,fc as v,gc as r,hc as p,pc as _,sb as d,vc as f,yb as m,yc as a}from"./chunk-ONJQPJYD.js";import{a as z,b as w}from"./chunk-HN2SGUN4.js";var F=()=>({show:!0});function P(n,e){if(n&1){let t=_();r(0,"button",7),f("click",function(){l(t);let o=a().$implicit,s=a();return u(s.approveContract(o.id))}),g(1," \u6838\u51C6 "),p()}}function W(n,e){if(n&1){let t=_();r(0,"button",8),f("click",function(){l(t);let o=a().$implicit,s=a();return u(s.rejectContract(o.id))}),g(1," \u62D2\u7D55 "),p()}}function q(n,e){if(n&1){let t=_();r(0,"nz-space"),C(1,P,2,0,"button",4)(2,W,2,0,"button",5),r(3,"button",6),f("click",function(){let o=l(t).$implicit,s=a();return u(s.viewDetail(o.id))}),g(4,"\u67E5\u770B"),p()()}if(n&2){let t=e.$implicit;d(),v("ngIf",t.status==="pending"),d(),v("ngIf",t.status==="pending")}}var c=class c{constructor(e,t,i,o){this.router=e;this.modal=t;this.message=i;this.http=o;this.data=[];this.total=0;this.columns=[{title:"\u5408\u7D04\u6A19\u984C",index:"title"},{title:"\u5BA2\u6236",index:"client"},{title:"\u91D1\u984D",index:"amount",type:"currency"},{title:"\u72C0\u614B",index:"status",render:"status",type:"tag",tag:{pending:{text:"\u5F85\u5BE9\u6838",color:"processing"},approved:{text:"\u5DF2\u6838\u51C6",color:"success"},rejected:{text:"\u5DF2\u62D2\u7D55",color:"error"}}},{title:"\u63D0\u4EA4\u65E5\u671F",index:"submitDate",type:"date"},{title:"\u5BE9\u6838\u4EBA",index:"reviewer"},{title:"\u5BE9\u6838\u65E5\u671F",index:"reviewDate",type:"date"},{title:"\u64CD\u4F5C",buttons:[{text:"\u64CD\u4F5C"}]}]}ngOnInit(){this.loadData()}loadData(){this.http.get("/contract").subscribe(e=>{this.data=e.list.map(t=>w(z({},t),{submitDate:t.createDate})),this.total=e.total})}approveContract(e){this.modal.confirm({nzTitle:"\u78BA\u8A8D\u6838\u51C6",nzContent:"\u78BA\u5B9A\u8981\u6838\u51C6\u9019\u500B\u5408\u7D04\u55CE\uFF1F",nzOnOk:()=>{this.http.post(`/contract/${e}/review`,{status:"approved",reviewer:"\u7576\u524D\u7528\u6236",comments:"\u5408\u7D04\u5167\u5BB9\u5B8C\u6574\uFF0C\u7B26\u5408\u516C\u53F8\u898F\u7BC4"}).subscribe(()=>{this.message.success("\u5408\u7D04\u5DF2\u6838\u51C6"),this.loadData()})}})}rejectContract(e){this.modal.confirm({nzTitle:"\u78BA\u8A8D\u62D2\u7D55",nzContent:"\u78BA\u5B9A\u8981\u62D2\u7D55\u9019\u500B\u5408\u7D04\u55CE\uFF1F",nzOnOk:()=>{this.http.post(`/contract/${e}/review`,{status:"rejected",reviewer:"\u7576\u524D\u7528\u6236",comments:"\u5408\u7D04\u5167\u5BB9\u9700\u8981\u4FEE\u6539"}).subscribe(()=>{this.message.success("\u5408\u7D04\u5DF2\u62D2\u7D55"),this.loadData()})}})}viewDetail(e){this.router.navigate(["/contract/detail",e])}};c.\u0275fac=function(t){return new(t||c)(m(h),m(j),m(V),m(T))},c.\u0275cmp=b({type:c,selectors:[["app-contract-review"]],decls:4,vars:5,consts:[["st",""],["title","\u5408\u7D04\u5BE9\u67E5"],[3,"data","columns","total","page"],["st-row-button",""],["nz-button","","nzType","primary","nzSize","small",3,"click",4,"ngIf"],["nz-button","","nzType","default","nzSize","small",3,"click",4,"ngIf"],["nz-button","","nzType","link",3,"click"],["nz-button","","nzType","primary","nzSize","small",3,"click"],["nz-button","","nzType","default","nzSize","small",3,"click"]],template:function(t,i){t&1&&(r(0,"nz-card",1)(1,"st",2,0),C(3,q,5,2,"ng-template",3),p()()),t&2&&(d(),v("data",i.data)("columns",i.columns)("total",i.total)("page",x(4,F)))},dependencies:[S,D,O,R,M,k,I,B,$,E,N,y],encapsulation:2});var H=c;export{H as ContractReviewComponent};

import{a as ve,b as be}from"./chunk-4THNYPR7.js";import"./chunk-CVWZRLFH.js";import"./chunk-LGQCUHVE.js";import"./chunk-VAGS5EVQ.js";import{a as pe,b as ue}from"./chunk-G4JMZD3J.js";import{d as Yt,f as jt}from"./chunk-UU4FHFKY.js";import"./chunk-3RWD3HET.js";import{f as he,k as ye}from"./chunk-55A3KN2A.js";import{c as me,f as de,h as fe,j as ze,k as _e,l as ge,n as Ce}from"./chunk-WAIHPACY.js";import"./chunk-FILHGIC5.js";import"./chunk-2CDCYO5P.js";import{a as oe,c as re,f as ae,g as ce,i as le,j as se}from"./chunk-MPSNF54G.js";import"./chunk-FO23PQCE.js";import"./chunk-MYHW4YTP.js";import"./chunk-T7EVMTMV.js";import"./chunk-G3VEBS7K.js";import"./chunk-P43R2PK7.js";import{d as Kt,g as te,m as ee,o as ne,y as ie}from"./chunk-TILQNZML.js";import"./chunk-LPDDJ3TV.js";import"./chunk-2APJHJ54.js";import"./chunk-AFUA6SNM.js";import"./chunk-7OUOMJSL.js";import{t as st}from"./chunk-NK4AO4BP.js";import"./chunk-F62RTV2J.js";import{d as Jt}from"./chunk-7FRFMFPD.js";import"./chunk-CB6IRRWZ.js";import"./chunk-QLO4SMLE.js";import"./chunk-C7IJ32K6.js";import{h as Y,q as Ut,s as Zt,t as j}from"./chunk-ZP3JRH3N.js";import{Nc as E,Oc as B,Pc as Xt,a as W,aa as lt,e as $t,ea as Wt,f as Gt,ga as qt,o as q}from"./chunk-YKU44AMC.js";import{o as At,q as ct,y as Qt}from"./chunk-M6U45NYK.js";import{Aa as p,Ac as Bt,Ba as u,Cc as w,Dc as S,Dd as rt,Ec as x,Fa as Tt,Fb as h,Fc as nt,Ga as K,Gb as St,Hc as Vt,Hd as at,Ic as b,Kc as L,Lb as y,Mc as Ot,Nc as _,Ob as H,Oc as it,Pb as xt,Pc as M,R as yt,Ra as Dt,Sc as A,Tc as Q,Uc as $,_b as N,ac as F,b as gt,cc as Mt,dc as Nt,dd as Pt,ec as Ft,fc as s,g as Ct,ga as vt,gc as a,hc as c,ic as z,kd as T,mc as It,nb as wt,nc as kt,oc as et,pa as bt,pc as v,pd as G,q as ht,qd as Rt,r as J,rd as Ht,sb as l,ta as C,ud as Lt,vc as f,vd as D,yb as tt,yc as m,yd as ot,zc as Et}from"./chunk-MUKALFIJ.js";import{a as zt,b as _t,g as Z,i as R}from"./chunk-57BLH6QZ.js";function Fe(i,o){}function Ie(i,o){if(i&1&&(a(0,"div",2),y(1,Fe,0,0,"ng-template",4),c()),i&2){let t=m(2);l(),s("ngTemplateOutlet",t.nzIcon)}}function ke(i,o){if(i&1&&(It(0),_(1),kt()),i&2){let t=m(3);l(),M(" ",t.nzDescription," ")}}function Ee(i,o){if(i&1&&(a(0,"div",3),y(1,ke,2,1,"ng-container",5),c()),i&2){let t=m(2);l(),s("nzStringTemplateOutlet",t.nzDescription)}}function Be(i,o){if(i&1&&(N(0,Ie,2,1,"div",2),N(1,Ee,2,1,"div",3)),i&2){let t=m();F(t.nzIcon?0:-1),l(),F(t.nzDescription&&t.nzShape==="square"?1:-1)}}function Ve(i,o){i&1&&(a(0,"div",2),z(1,"nz-icon",6),c())}function Oe(i,o){if(i&1){let t=v();a(0,"a",2),f("click",function(){p(t);let e=m();return u(e.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();L("ant-float-btn-default",t.nzType==="default"),s("target",t.nzTarget)("href",t.nzHref,wt)("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}function Pe(i,o){if(i&1){let t=v();a(0,"button",4),f("click",function(){p(t);let e=m();return u(e.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),c()}if(i&2){let t=m();L("ant-float-btn-default",t.nzType==="default"),s("nzType",t.nzType),l(),s("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}var Re=["backTop"];function He(i,o){i&1&&z(0,"nz-icon",3)}var Le=["*"];function Ae(i,o){i&1&&et(0)}function Qe(i,o){if(i&1&&y(0,Ae,1,0,"ng-container",2),i&2){m();let t=b(3);s("ngTemplateOutlet",t)}}function $e(i,o){i&1&&et(0)}function Ge(i,o){if(i&1&&(a(0,"div",3),y(1,$e,1,0,"ng-container",2),c()),i&2){m(2);let t=b(3);s("@fadeMotion",void 0),l(),s("ngTemplateOutlet",t)}}function We(i,o){if(i&1){let t=v();N(0,Ge,2,2,"div",3),a(1,"nz-float-button",4),f("nzOnClick",function(){p(t);let e=m();return u(e.open()?e.clickCloseMenu():e.clickOpenMenu())})("mouseover",function(){p(t);let e=m();return u(e.hoverOpenMenu())}),c()}if(i&2){let t=m(),n=b(5);F(t.open()?0:-1),l(),s("nzType",t.nzType())("nzIcon",t.open()?n:t.nzIcon())("nzShape",t.nzShape())("nzDescription",t.open()?null:t.nzDescription())}}function qe(i,o){i&1&&Bt(0)}function Ye(i,o){i&1&&z(0,"nz-icon",5)}var Te=(()=>{class i{nzIcon=null;nzDescription=null;nzShape="circle";static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button-content"]],inputs:{nzIcon:"nzIcon",nzDescription:"nzDescription",nzShape:"nzShape"},exportAs:["nzFloatButtonContent"],decls:4,vars:1,consts:[[1,"ant-float-btn-body"],[1,"ant-float-btn-content"],[1,"ant-float-btn-icon"],[1,"ant-float-btn-description"],[3,"ngTemplateOutlet"],[4,"nzStringTemplateOutlet"],["nzType","file-text","nzTheme","outline"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1),N(2,Be,2,2)(3,Ve,2,0,"div",2),c()()),n&2&&(l(2),F(e.nzDescription||e.nzIcon?2:3))},dependencies:[B,E,ct,Xt],encapsulation:2,changeDetection:0})}return i})(),I=(()=>{class i{directionality=C(q);cdr=C(rt);destroyRef=C(K);nzHref=null;nzTarget=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzOnClick=new H;dir="ltr";constructor(){this.dir=this.directionality.value}ngOnInit(){this.directionality.change?.pipe(W(this.destroyRef)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button"]],hostAttrs:[1,"ant-float-btn"],hostVars:6,hostBindings:function(n,e){n&2&&L("ant-float-btn-circle",e.nzShape==="circle")("ant-float-btn-square",e.nzShape==="square")("ant-float-btn-rtl",e.dir==="rtl")},inputs:{nzHref:"nzHref",nzTarget:"nzTarget",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription"},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButton"],decls:2,vars:1,consts:[["nz-button","",1,"ant-float-btn-inner",3,"target","href","nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"click","target","href","nzType"],[3,"nzIcon","nzDescription","nzShape"],["nz-button","",1,"ant-float-btn-inner",3,"click","nzType"]],template:function(n,e){n&1&&N(0,Oe,2,8,"a",0)(1,Pe,2,6,"button",1),n&2&&F(e.nzHref?0:1)},dependencies:[j,Zt,Y,Ut,Te],encapsulation:2,changeDetection:0})}return i})(),je="backTop",Xe=Gt({passive:!0}),pt=(()=>{var n;let i,o=[],t=[];return n=class{nzConfigService=C(Wt);scrollSrv=C(Jt);platform=C($t);ngZone=C(xt);cdr=C(rt);directionality=C(q);destroyRef=C(K);_nzModuleName=je;scrollListenerDestroy$=new Ct;target=null;visible=!1;dir="ltr";nzHref=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzTemplate;nzVisibilityHeight=J(this,o,400);nzTarget=J(this,t);nzDuration=450;nzOnClick=new H;set backTop(r){r&&(this.backTopClickSubscription.unsubscribe(),this.backTopClickSubscription=lt(r.nativeElement,"click").pipe(W(this.destroyRef)).subscribe(()=>{this.scrollSrv.scrollTo(this.getTarget(),0,{duration:this.nzDuration}),this.nzOnClick.observers.length&&this.ngZone.run(()=>this.nzOnClick.emit(!0))}))}doc=C(Tt);backTopClickSubscription=gt.EMPTY;constructor(){this.destroyRef.onDestroy(()=>{this.scrollListenerDestroy$.next(),this.scrollListenerDestroy$.complete()})}ngOnInit(){this.registerScrollEvent(),this.dir=this.directionality.value,this.directionality.change?.pipe(W(this.destroyRef)).subscribe(r=>{this.dir=r,this.cdr.detectChanges()})}getTarget(){return this.target||window}handleScroll(){this.visible!==this.scrollSrv.getScroll(this.getTarget())>this.nzVisibilityHeight&&(this.visible=!this.visible,this.cdr.detectChanges())}registerScrollEvent(){this.platform.isBrowser&&(this.scrollListenerDestroy$.next(),this.handleScroll(),lt(this.getTarget(),"scroll",Xe).pipe(yt(50),vt(this.scrollListenerDestroy$)).subscribe(()=>this.handleScroll()))}detectChanges(){this.cdr.detectChanges()}ngOnChanges(r){let{nzTarget:d}=r;d&&(this.target=typeof this.nzTarget=="string"?this.doc.querySelector(this.nzTarget):this.nzTarget,this.registerScrollEvent())}},(()=>{let r=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[qt()],ht(null,null,i,{kind:"field",name:"nzVisibilityHeight",static:!1,private:!1,access:{has:d=>"nzVisibilityHeight"in d,get:d=>d.nzVisibilityHeight,set:(d,g)=>{d.nzVisibilityHeight=g}},metadata:r},o,t),r&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),Z(n,"\u0275fac",function(d){return new(d||n)}),Z(n,"\u0275cmp",h({type:n,selectors:[["nz-float-button-top"]],viewQuery:function(d,g){if(d&1&&w(Re,5),d&2){let k;S(k=x())&&(g.backTop=k.first)}},hostAttrs:[1,"ant-float-btn","ant-float-btn-top"],hostVars:8,hostBindings:function(d,g){d&2&&L("ant-float-btn-circle",g.nzShape==="circle")("ant-float-btn-hidden",!g.visible)("ant-float-btn-square",g.nzShape==="square")("ant-float-btn-rtl",g.dir==="rtl")},inputs:{nzHref:"nzHref",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription",nzTemplate:"nzTemplate",nzVisibilityHeight:[2,"nzVisibilityHeight","nzVisibilityHeight",at],nzTarget:"nzTarget",nzDuration:[2,"nzDuration","nzDuration",at]},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButtonTop"],features:[Dt],decls:5,vars:6,consts:[["backTop",""],["top",""],[3,"nzIcon","nzDescription","nzHref","nzType","nzShape"],["nzType","vertical-align-top","nzTheme","outline"]],template:function(d,g){if(d&1&&(a(0,"div",null,0),z(2,"nz-float-button",2),y(3,He,1,0,"ng-template",null,1,T),c()),d&2){let k=b(4);s("@fadeMotion",void 0),l(2),s("nzIcon",g.nzIcon||k)("nzDescription",g.nzDescription)("nzHref",g.nzHref)("nzType",g.nzType)("nzShape",g.nzShape)}},dependencies:[I,B,E],encapsulation:2,data:{animation:[st]},changeDetection:0})),n})(),mt=(()=>{class i{nzFloatButtonComponents=ot(I);nzFloatButtonTopComponents=ot(pt);nzHref=D(null);nzTarget=D(null);nzType=D("default");nzIcon=D(null);nzDescription=D(null);nzShape=D("circle");nzTrigger=D(null);nzOpen=D(null);nzPlacement=D("top");nzOnOpenChange=Lt();dir=C(q).valueSignal;open=Ht(()=>!!this.nzOpen());isMenuMode=G(()=>!!this.nzTrigger()&&["click","hover"].includes(this.nzTrigger()));isControlledMode=G(()=>this.nzOpen()!==null);class=G(()=>{let t=this.nzShape(),n=this.dir(),e=["ant-float-btn-group",this.generateClass(t)];return this.isMenuMode()?e.push(this.generateClass(this.nzPlacement())):e.push(this.generateClass(`${t}-shadow`)),n==="rtl"&&e.push(this.generateClass(n)),e});constructor(){Rt(()=>{this.nzFloatButtonComponents()&&this.nzFloatButtonComponents().forEach(t=>{t.nzShape=this.nzShape()}),this.nzFloatButtonTopComponents()&&this.nzFloatButtonTopComponents().forEach(t=>{t.nzShape=this.nzShape(),t.detectChanges()})})}clickOpenMenu(){this.handleEvent("click",!0)}hoverOpenMenu(){this.handleEvent("hover",!0)}clickCloseMenu(){this.handleEvent("click",!1)}hoverCloseMenu(){this.handleEvent("hover",!1)}handleEvent(t,n){this.nzTrigger()!==t||this.isControlledMode()||this.open()===n||(this.open.set(n),this.nzOnOpenChange.emit(n))}generateClass(t){return`ant-float-btn-group-${t}`}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=h({type:i,selectors:[["nz-float-button-group"]],contentQueries:function(n,e,r){n&1&&(nt(r,e.nzFloatButtonComponents,I,4),nt(r,e.nzFloatButtonTopComponents,pt,4)),n&2&&Vt(2)},hostVars:2,hostBindings:function(n,e){n&1&&f("mouseleave",function(){return e.hoverCloseMenu()}),n&2&&Ot(e.class())},inputs:{nzHref:[1,"nzHref"],nzTarget:[1,"nzTarget"],nzType:[1,"nzType"],nzIcon:[1,"nzIcon"],nzDescription:[1,"nzDescription"],nzShape:[1,"nzShape"],nzTrigger:[1,"nzTrigger"],nzOpen:[1,"nzOpen"],nzPlacement:[1,"nzPlacement"]},outputs:{nzOnOpenChange:"nzOnOpenChange"},exportAs:["nzFloatButtonGroup"],ngContentSelectors:Le,decls:6,vars:1,consts:[["menu",""],["close",""],[4,"ngTemplateOutlet"],[1,"ant-float-btn-group-wrap"],[1,"ant-float-btn-group-trigger",3,"nzOnClick","mouseover","nzType","nzIcon","nzShape","nzDescription"],["nzType","close","nzTheme","outline"]],template:function(n,e){n&1&&(Et(),N(0,Qe,1,1,"ng-container")(1,We,2,5),y(2,qe,1,0,"ng-template",null,0,T)(4,Ye,1,0,"ng-template",null,1,T)),n&2&&F(e.isMenuMode()?1:0)},dependencies:[I,B,E,ct],encapsulation:2,data:{animation:[st]},changeDetection:0})}return i})(),De=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=St({type:i});static \u0275inj=bt({imports:[I,mt,pt,Te]})}return i})();var Ze=["upIcon"],Je=["downIcon"],Ke=["leftIcon"],tn=["rightIcon"],en=["commentIcon"],nn=(i,o)=>({x:i,y:o});function on(i,o){i&1&&z(0,"nz-icon",8)}function rn(i,o){i&1&&z(0,"nz-icon",9)}function an(i,o){i&1&&z(0,"nz-icon",10)}function cn(i,o){i&1&&z(0,"nz-icon",11)}function ln(i,o){i&1&&z(0,"nz-icon",12)}var V=class V{constructor(){this.dragX=0;this.dragY=0;this.smartPlacement="top";this.currentX=0;this.currentY=0;this.onAction=new H}get currentIcon(){return{top:this.upIcon,bottom:this.downIcon,left:this.leftIcon,right:this.rightIcon}[this.smartPlacement]}onDragMove(o){let t=o.source.element.nativeElement.getBoundingClientRect();this.currentX=t.left,this.currentY=t.top,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}onDragEnd(o){this.dragX=o.source.getFreeDragPosition().x,this.dragY=o.source.getFreeDragPosition().y,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}calculateSmartPlacement(o,t){let n=window.innerWidth,e=window.innerHeight,r=56,d=o+r/2,g=t+r/2,k=n/2,xe=e/2,dt=d-k,ft=g-xe;return Math.abs(dt)>Math.abs(ft)?dt>0?"left":"right":ft>0?"top":"bottom"}openChange(o){}};V.\u0275fac=function(t){return new(t||V)},V.\u0275cmp=h({type:V,selectors:[["app-fab"]],viewQuery:function(t,n){if(t&1&&(w(Ze,7),w(Je,7),w(Ke,7),w(tn,7),w(en,7)),t&2){let e;S(e=x())&&(n.upIcon=e.first),S(e=x())&&(n.downIcon=e.first),S(e=x())&&(n.leftIcon=e.first),S(e=x())&&(n.rightIcon=e.first),S(e=x())&&(n.commentIcon=e.first)}},outputs:{onAction:"onAction"},decls:13,vars:7,consts:[["upIcon",""],["downIcon",""],["leftIcon",""],["rightIcon",""],["commentIcon",""],["cdkDrag","",1,"fab-drag-anchor",3,"cdkDragEnded","cdkDragMoved","cdkDragFreeDragPosition"],["nzType","primary","nzTrigger","click",3,"nzOnOpenChange","nzIcon","nzPlacement"],[3,"click","nzIcon"],["nzType","up","nzTheme","outline"],["nzType","down","nzTheme","outline"],["nzType","left","nzTheme","outline"],["nzType","right","nzTheme","outline"],["nzType","plus","nzTheme","outline"]],template:function(t,n){if(t&1){let e=v();a(0,"div",5),f("cdkDragEnded",function(d){return p(e),u(n.onDragEnd(d))})("cdkDragMoved",function(d){return p(e),u(n.onDragMove(d))}),a(1,"nz-float-button-group",6),f("nzOnOpenChange",function(d){return p(e),u(n.openChange(d))}),a(2,"nz-float-button",7),f("click",function(){return p(e),u(n.onAction.emit("add"))}),c()(),y(3,on,1,0,"ng-template",null,0,T)(5,rn,1,0,"ng-template",null,1,T)(7,an,1,0,"ng-template",null,2,T)(9,cn,1,0,"ng-template",null,3,T)(11,ln,1,0,"ng-template",null,4,T),c()}if(t&2){let e=b(12);s("cdkDragFreeDragPosition",Pt(4,nn,n.dragX,n.dragY)),l(),s("nzIcon",n.currentIcon)("nzPlacement",n.smartPlacement),l(),s("nzIcon",e)}},dependencies:[De,I,mt,B,E,jt,Yt],styles:[".fab-drag-anchor[_ngcontent-%COMP%]{position:fixed;z-index:1000;right:32px;bottom:32px;cursor:grab;-webkit-user-select:none;user-select:none}.fab-drag-anchor[_ngcontent-%COMP%]:active{cursor:grabbing}nz-float-button-group[_ngcontent-%COMP%]{position:absolute}"]});var X=V;function sn(i,o){if(i&1){let t=v();a(0,"tr",4)(1,"td"),_(2),c(),a(3,"td")(4,"div",7),f("nzClick",function(){let e=p(t).$implicit,r=m();return u(r.currentDropdownRow=e)}),a(5,"a",8),f("click",function(){let e=p(t).$implicit,r=m();return u(r.currentDropdownRow=e)}),_(6),z(7,"span",9),c()()(),a(8,"td")(9,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(10),c(),a(11,"input",11),$("ngModelChange",function(e){let r=p(t).$implicit;return Q(r.contractName,e)||(r.contractName=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(12,"td")(13,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(14),c(),a(15,"input",11),$("ngModelChange",function(e){let r=p(t).$implicit;return Q(r.contractCode,e)||(r.contractCode=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(16,"td")(17,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(18),c(),a(19,"input",11),$("ngModelChange",function(e){let r=p(t).$implicit;return Q(r.feeCode,e)||(r.feeCode=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(20,"td")(21,"div",10),f("click",function(){let e=p(t).$implicit,r=m();return u(r.startEdit(e.key))}),_(22),c(),a(23,"input",12),$("ngModelChange",function(e){let r=p(t).$implicit;return Q(r.amount,e)||(r.amount=e),u(e)}),f("blur",function(){let e=p(t).$implicit,r=m();return u(r.stopEdit(e))}),c()(),a(24,"td")(25,"a",13),f("nzOnConfirm",function(){let e=p(t).$implicit,r=m();return u(r.deleteRow(e.key))}),_(26,"\u522A\u9664"),c()()()}if(i&2){let t=o.$implicit,n=m(),e=b(25);l(2),it(t.contractSerial),l(2),s("nzDropdownMenu",e),l(2),M("",t.client," "),l(3),s("hidden",n.editId===t.key),l(),M(" ",t.contractName," "),l(),s("hidden",n.editId!==t.key),A("ngModel",t.contractName),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.contractCode," "),l(),s("hidden",n.editId!==t.key),A("ngModel",t.contractCode),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.feeCode," "),l(),s("hidden",n.editId!==t.key),A("ngModel",t.feeCode),l(2),s("hidden",n.editId===t.key),l(),M(" ",t.amount," "),l(),s("hidden",n.editId!==t.key),A("ngModel",t.amount)}}function pn(i,o){if(i&1){let t=v();a(0,"li",14),f("click",function(){let e=p(t).$implicit,r=m();return u(r.changeClient(r.currentDropdownRow,e))}),_(1),c()}if(i&2){let t=o.$implicit;l(),it(t)}}var O=class O{constructor(o,t){this.contractService=o;this.hubCrud=t;this.contracts=[];this.editId=null;this.clients=[];this.currentDropdownRow=null}ngOnInit(){this.refresh(),this.contractService.getClientsSettings().then(o=>{this.clients=o?.list||[]})}refresh(){this.contractService.list().subscribe(o=>this.contracts=o)}addRow(){return R(this,null,function*(){let[o,t]=yield Promise.all([this.contractService.getDefaultClient(),this.contractService.getNextContractSerial()]),n={contractSerial:t,client:o,contractName:"",contractCode:"",feeCode:"",amount:0},e=yield this.contractService.add(n);this.contracts=[...this.contracts,_t(zt({},n),{key:e})],setTimeout(()=>{this.startEdit(e)},200)})}startEdit(o){o&&(this.editId=o,setTimeout(()=>{let t=document.querySelector("input[nz-input]:not([hidden])");t&&t.focus()},50))}stopEdit(o){return R(this,null,function*(){o.key&&(yield this.contractService.update(o.key,o)),this.editId=null})}deleteRow(o){return R(this,null,function*(){o&&(yield this.contractService.delete(o),this.contracts=this.contracts.filter(t=>t.key!==o))})}changeClient(o,t){return R(this,null,function*(){o&&o.key&&o.client!==t&&(o.client=t,yield this.contractService.update(o.key,{client:t}))})}};O.\u0275fac=function(t){return new(t||O)(tt(be),tt(ve))},O.\u0275cmp=h({type:O,selectors:[["contract-list"]],decls:28,vars:2,consts:[["editRowTable",""],["menuRef","nzDropdownMenu"],[3,"onAction"],["nzBordered","",3,"nzData"],[1,"editable-row"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["nz-dropdown","","nzTrigger","click",3,"nzClick","nzDropdownMenu"],["nz-dropdown","",3,"click"],["nz-icon","","nzType","down"],[1,"editable-cell",3,"click","hidden"],["type","text","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["type","number","nz-input","",3,"ngModelChange","blur","hidden","ngModel"],["nz-popconfirm","","nzPopconfirmTitle","\u78BA\u5B9A\u522A\u9664\uFF1F",3,"nzOnConfirm"],["nz-menu-item","",3,"click"]],template:function(t,n){if(t&1){let e=v();a(0,"app-fab",2),f("onAction",function(){return p(e),u(n.addRow())}),c(),z(1,"br")(2,"br"),a(3,"nz-table",3,0)(5,"thead")(6,"tr")(7,"th"),_(8,"\u5E8F\u865F"),c(),a(9,"th"),_(10,"\u696D\u4E3B"),c(),a(11,"th"),_(12,"\u5408\u7D04\u540D\u7A31"),c(),a(13,"th"),_(14,"\u5408\u7D04\u6848\u865F\u8B58\u5225\u78BC"),c(),a(15,"th"),_(16,"\u5408\u7D04\u8CBB\u7528\u8B58\u5225\u78BC"),c(),a(17,"th"),_(18,"\u5408\u7D04\u91D1\u984D"),c(),a(19,"th"),_(20,"\u64CD\u4F5C"),c()()(),a(21,"tbody"),Nt(22,sn,27,19,"tr",4,Mt),c()(),a(24,"nz-dropdown-menu",null,1)(26,"ul",5),y(27,pn,2,1,"li",6),c()()}if(t&2){let e=b(4);l(3),s("nzData",n.contracts),l(19),Ft(e.data),l(5),s("ngForOf",n.clients)}},dependencies:[Qt,At,ie,Kt,ne,te,ee,Ce,ze,me,de,ge,fe,_e,j,Y,ye,he,ue,pe,se,re,oe,ae,ce,le,X],styles:[".editable-cell[_ngcontent-%COMP%]{position:relative;padding:5px 12px;cursor:pointer}.editable-row[_ngcontent-%COMP%]:hover   .editable-cell[_ngcontent-%COMP%]{border:1px solid #d9d9d9;border-radius:4px;padding:4px 11px}"]});var U=O;var P=class P{};P.\u0275fac=function(t){return new(t||P)},P.\u0275cmp=h({type:P,selectors:[["hub-contract"]],decls:1,vars:0,template:function(t,n){t&1&&z(0,"contract-list")},dependencies:[U],encapsulation:2});var Se=P;export{Se as HubContractComponent};

import{a as de}from"./chunk-NT7OZ234.js";import"./chunk-XLR6N6SW.js";import"./chunk-ALZAR7EN.js";import"./chunk-VAGS5EVQ.js";import{b as ie}from"./chunk-HKA4FVC2.js";import{C as ee,g as J,m as Q,u as X,v as Y,w as Z}from"./chunk-6JCSLRHM.js";import{a as te,b as ne}from"./chunk-E47ZFLGS.js";import{a as re,b as se}from"./chunk-XM4J4R5M.js";import{d as G}from"./chunk-4PA35NCI.js";import{i as K,m as L}from"./chunk-6MAHXBEQ.js";import{a as oe,c as ae}from"./chunk-JGLAIUOG.js";import{g as ce}from"./chunk-4THZKRUO.js";import"./chunk-KZTNC3ON.js";import"./chunk-25S4KRZH.js";import"./chunk-FWH2T5AZ.js";import{a as U,b as H,d as $,e as q}from"./chunk-LIR6QQZX.js";import"./chunk-MDZXGNF2.js";import"./chunk-NXMPC2GS.js";import"./chunk-YRKA6VQO.js";import"./chunk-SPNOFANZ.js";import"./chunk-BNEGMIRN.js";import{A as h,Bd as B,Dd as A,Kd as R,Lc as w,Mc as F,Nb as m,O as M,Ob as t,Pb as n,Pc as V,Ph as j,Qb as N,Qh as W,Ub as S,Vb as T,Xb as k,_b as u,bb as c,bc as d,ea as E,gb as x,lc as z,nb as O,nc as v,qc as o,rc as _,sc as y,tb as g,v as b,vc as D,wc as P,xa as l,xc as I,ya as p}from"./chunk-Q7L763DV.js";import"./chunk-57BLH6QZ.js";var le={active:"green",inactive:"gray",archived:"orange",pending:"blue","in-progress":"orange",completed:"green",cancelled:"red",low:"blue",medium:"orange",high:"red",urgent:"red"};function ue(s,i){s&1&&(S(0),t(1,"div",3),N(2,"nz-spin",4),n(),T())}function me(s,i){if(s&1&&(t(0,"div",18)(1,"div",19),o(2,"\u5275\u5EFA\u8005"),n(),t(3,"div",20),o(4),n()()),s&2){let e=d(2).ngIf;c(4),_(e.createdBy)}}function ge(s,i){if(s&1&&(t(0,"div",18)(1,"div",19),o(2,"\u985E\u578B"),n(),t(3,"div",20),o(4),n()()),s&2){let e=d(2).ngIf;c(4),_(e.type)}}function _e(s,i){if(s&1){let e=k();t(0,"div",13)(1,"div",14)(2,"div",15),o(3,"\u63CF\u8FF0"),n(),t(4,"div",16),o(5),n()(),t(6,"div",14)(7,"div",15),o(8,"\u8A73\u60C5"),n(),t(9,"div",17)(10,"div",18)(11,"div",19),o(12,"\u5275\u5EFA\u6642\u9593"),n(),t(13,"div",20),o(14),n()(),t(15,"div",18)(16,"div",19),o(17,"\u66F4\u65B0\u6642\u9593"),n(),t(18,"div",20),o(19),n()(),g(20,me,5,1,"div",21)(21,ge,5,1,"div",21),n()(),t(22,"div",22)(23,"button",23),u("click",function(){l(e);let r=d(3);return p(r.toggleEditMode())}),o(24,"\u7DE8\u8F2F"),n(),t(25,"div",24)(26,"button",25),u("click",function(){l(e);let r=d(3);return p(r.updateTaskStatus("pending"))}),o(27,"\u5F85\u8FA6"),n(),t(28,"button",25),u("click",function(){l(e);let r=d(3);return p(r.updateTaskStatus("in-progress"))}),o(29,"\u9032\u884C\u4E2D"),n(),t(30,"button",25),u("click",function(){l(e);let r=d(3);return p(r.updateTaskStatus("completed"))}),o(31,"\u5DF2\u5B8C\u6210"),n(),t(32,"button",25),u("click",function(){l(e);let r=d(3);return p(r.updateTaskStatus("cancelled"))}),o(33,"\u5DF2\u53D6\u6D88"),n()()()()}if(s&2){let e=d().ngIf,a=d(2);c(5),y(" ",e.description||"\u7121\u63CF\u8FF0"," "),c(9),_(a.formatDate(e.createdAt)),c(5),_(a.formatDate(e.updatedAt)),c(),m("ngIf",e.createdBy),c(),m("ngIf",e.type),c(5),v("active",e.taskStatus==="pending"),c(2),v("active",e.taskStatus==="in-progress"),c(2),v("active",e.taskStatus==="completed"),c(2),v("active",e.taskStatus==="cancelled")}}function fe(s,i){if(s&1){let e=k();t(0,"div",26)(1,"div",27)(2,"label"),o(3,"\u72C0\u614B"),n(),t(4,"select",28),I("ngModelChange",function(r){l(e);let C=d(3);return P(C.taskStatus,r)||(C.taskStatus=r),p(r)}),t(5,"option",29),o(6,"\u5F85\u8FA6"),n(),t(7,"option",30),o(8,"\u9032\u884C\u4E2D"),n(),t(9,"option",31),o(10,"\u5DF2\u5B8C\u6210"),n(),t(11,"option",32),o(12,"\u5DF2\u53D6\u6D88"),n()()(),t(13,"div",33)(14,"button",34),u("click",function(){l(e);let r=d().ngIf,C=d(2);return p(C.saveChanges(r))}),o(15,"\u4FDD\u5B58"),n(),t(16,"button",23),u("click",function(){l(e);let r=d(3);return p(r.toggleEditMode())}),o(17,"\u53D6\u6D88"),n()()()}if(s&2){let e=d(3);c(4),D("ngModel",e.taskStatus)}}function xe(s,i){if(s&1){let e=k();S(0),t(1,"div",6)(2,"button",7),u("click",function(){l(e);let r=d(2);return p(r.goBack())}),N(3,"span",8),o(4," \u8FD4\u56DE "),n()(),t(5,"div",9)(6,"h1"),o(7),n(),t(8,"nz-tag",10),o(9),n()(),g(10,_e,34,13,"div",11)(11,fe,18,1,"div",12),T()}if(s&2){let e=i.ngIf,a=d(2);c(7),_(e.title),c(),m("nzColor",a.statusColors[e.taskStatus||"pending"]),c(),y(" ",e.taskStatus||"\u5F85\u8FA6"," "),c(),m("ngIf",!a.editMode),c(),m("ngIf",a.editMode)}}function ke(s,i){if(s&1){let e=k();t(0,"div",35),N(1,"nz-empty",36),t(2,"button",34),u("click",function(){l(e);let r=d(2);return p(r.goBack())}),o(3,"\u8FD4\u56DE\u4EFB\u52D9\u5217\u8868"),n()()}}function ve(s,i){if(s&1&&(S(0),g(1,xe,12,5,"ng-container",5),w(2,"async"),g(3,ke,4,0,"ng-template",null,0,V),T()),s&2){let e=z(4),a=d();c(),m("ngIf",F(2,2,a.task$))("ngIfElse",e)}}var f=class f{constructor(i,e,a,r){this.route=i;this.router=e;this.crudService=a;this.message=r;this.taskId=null;this.task$=b(null);this.loading=!0;this.editMode=!1;this.statusColors=le;this.taskStatus="pending"}ngOnInit(){this.route.paramMap.pipe(h(i=>i.get("id")),E(i=>(this.taskId=i,i?this.crudService.getNode(i).pipe(M(()=>(this.message.error("\u7121\u6CD5\u8F09\u5165\u4EFB\u52D9\u8A73\u60C5"),this.loading=!1,b(null)))):(this.loading=!1,b(null))))).subscribe(i=>{i&&i.isTask&&(this.taskStatus=i.taskStatus||"pending"),this.loading=!1}),this.taskId&&(this.task$=this.crudService.getNode(this.taskId).pipe(h(i=>i||null)))}updateTaskStatus(i){this.taskId&&(this.loading=!0,this.taskStatus=i,this.crudService.updateNode(this.taskId,{taskStatus:i,updatedAt:new Date().toISOString()}).then(()=>{this.message.success("\u4EFB\u52D9\u72C0\u614B\u5DF2\u66F4\u65B0"),this.loading=!1}).catch(()=>{this.message.error("\u66F4\u65B0\u4EFB\u52D9\u72C0\u614B\u5931\u6557"),this.loading=!1}))}toggleEditMode(){this.editMode=!this.editMode}saveChanges(i){this.taskId&&(this.loading=!0,this.crudService.updateNode(this.taskId,{taskStatus:this.taskStatus,updatedAt:new Date().toISOString()}).then(()=>{this.message.success("\u4EFB\u52D9\u5DF2\u66F4\u65B0"),this.editMode=!1,this.loading=!1}).catch(e=>{this.message.error("\u66F4\u65B0\u4EFB\u52D9\u5931\u6557"),this.loading=!1}))}goBack(){this.router.navigate(["/tree"])}formatDate(i){return i?new Date(i).toLocaleString("zh-TW"):"\u672A\u77E5"}};f.\u0275fac=function(e){return new(e||f)(x(K),x(L),x(de),x(G))},f.\u0275cmp=O({type:f,selectors:[["app-task-detail"]],decls:3,vars:2,consts:[["noTask",""],[1,"task-detail-container"],[4,"ngIf"],[1,"loading-container"],["nzTip","\u8F09\u5165\u4E2D..."],[4,"ngIf","ngIfElse"],[1,"task-nav"],["nz-button","","nzType","text",3,"click"],["nz-icon","","nzType","arrow-left"],[1,"task-header"],[3,"nzColor"],["class","task-content",4,"ngIf"],["class","task-edit",4,"ngIf"],[1,"task-content"],[1,"task-section"],[1,"section-title"],[1,"section-content"],[1,"info-grid"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["class","info-item",4,"ngIf"],[1,"task-actions"],["nz-button","","nzType","default",3,"click"],[1,"status-buttons"],["nz-button","",3,"click"],[1,"task-edit"],[1,"form-group"],["name","taskStatus",3,"ngModelChange","ngModel"],["value","pending"],["value","in-progress"],["value","completed"],["value","cancelled"],[1,"form-actions"],["nz-button","","nzType","primary",3,"click"],[1,"empty-state"],["nzDescription","\u627E\u4E0D\u5230\u4EFB\u52D9\u8A73\u60C5"]],template:function(e,a){e&1&&(t(0,"div",1),g(1,ue,3,0,"ng-container",2)(2,ve,5,4,"ng-container",2),n()),e&2&&(c(),m("ngIf",a.loading),c(),m("ngIf",!a.loading))},dependencies:[R,B,ee,Y,Z,X,J,Q,q,$,U,H,ce,ie,ae,oe,W,j,se,re,ne,te,A],styles:['.task-detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:24px 16px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:300px}.task-nav[_ngcontent-%COMP%]{margin-bottom:24px}.task-nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding-left:0}.task-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:32px}.task-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 16px 0 0;font-size:24px;font-weight:500}.task-header[_ngcontent-%COMP%]   nz-tag[_ngcontent-%COMP%]{font-size:14px}.task-content[_ngcontent-%COMP%]{margin-bottom:32px}.task-section[_ngcontent-%COMP%]{margin-bottom:24px}.task-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#000000d9;margin-bottom:16px;position:relative}.task-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-8px;width:24px;height:2px;background-color:#1890ff}.task-section[_ngcontent-%COMP%]   .section-content[_ngcontent-%COMP%]{color:#000000a6;line-height:1.6}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:14px;color:#00000073;margin-bottom:4px}.info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:#000000d9}.task-actions[_ngcontent-%COMP%]{margin-top:32px;display:flex;flex-direction:column;gap:16px}.task-actions[_ngcontent-%COMP%]   .status-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.task-actions[_ngcontent-%COMP%]   .status-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#e6f7ff;border-color:#1890ff;color:#1890ff}.task-edit[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.task-edit[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500}.task-edit[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d9d9d9;border-radius:2px}.task-edit[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#40a9ff;outline:none;box-shadow:0 0 0 2px #1890ff33}.task-edit[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:48px 0}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:16px}']});var pe=f;export{pe as TaskDetailComponent};

import{a as be}from"./chunk-O4W7BLAI.js";import{a as Rt}from"./chunk-IWTLJND4.js";import{a as At,b as Lt}from"./chunk-KOELLTGX.js";import{a as Vt,b as Bt,c as Ft}from"./chunk-2D7A5I3J.js";import"./chunk-MJVXNEER.js";import"./chunk-AKUUNSLZ.js";import"./chunk-VAGS5EVQ.js";import{a as kt}from"./chunk-327KNMMH.js";import{a as he}from"./chunk-L5Q3WTHH.js";import{f as St,g as Nt,h as Pt,k as yt}from"./chunk-AFI5VBSN.js";import{a as _t,c as zt,i as xt,j as Ct,k as ht}from"./chunk-4MUBFKQP.js";import{a as Mt}from"./chunk-JO3GM24R.js";import"./chunk-3NJSNK6C.js";import"./chunk-DX3NHPQF.js";import{C as ut,d as dt,g as pt,m as mt}from"./chunk-OCWJW6EQ.js";import{a as Tt,b as wt,c as Ot,g as Et,h as Dt,i as It}from"./chunk-QUFCR342.js";import"./chunk-74DGW2FI.js";import"./chunk-IQUWA4QL.js";import{a as ft,b as gt}from"./chunk-OGEMIMK7.js";import"./chunk-MT3IIREG.js";import"./chunk-JN4T53IL.js";import"./chunk-4SIYTYPC.js";import"./chunk-RWVJKBBP.js";import{a as bt,c as vt}from"./chunk-HGQ5MTOR.js";import"./chunk-LP7YL7TQ.js";import"./chunk-CU3JL36V.js";import"./chunk-N6IA2XSE.js";import"./chunk-YTOIKVDU.js";import{a as at,b as st,d as lt,e as ct}from"./chunk-MVNRV6CA.js";import"./chunk-X5DCXGVH.js";import"./chunk-7BXJ24OX.js";import"./chunk-BAHVVL27.js";import{h as Ce}from"./chunk-YTN5GAFT.js";import"./chunk-YBNWYGDG.js";import"./chunk-ZAMB7OTB.js";import{$ as K,A as xe,Mc as te,Nc as ne,c as ze,f as ot,o as rt}from"./chunk-NMHJQYP5.js";import{$ as Pe,$c as Q,B,Bd as Xe,C as Se,Da as we,Dd as Je,Ed as Ze,Fd as et,Gb as Ie,Gd as tt,Ha as le,Hc as Qe,Ib as j,Ic as Ue,Id as nt,Kb as q,Kc as We,L as W,Lb as Ve,Md as it,Nb as Be,Nc as F,Ob as Fe,Oc as H,Pb as f,Pc as ee,Qb as c,R as Ne,Ra as Oe,Rb as l,Rc as O,Sb as P,Wb as ce,Wc as A,Xb as de,Yb as Re,Yc as Ye,Zb as T,ac as b,ad as S,bd as He,ca as ye,db as s,dc as d,dd as Ke,ea as ke,ec as Ae,fc as Le,g as X,ga as Y,h as se,hc as pe,ib as J,ic as me,id as Ge,jc as ue,kc as $e,kd as _e,lc as je,mc as fe,nc as D,oa as Te,oc as ge,pb as $,pc as I,qb as Ee,rc as qe,sa as L,sc as _,tc as Z,uc as E,vb as k,wb as De,ya as z,za as x}from"./chunk-BUZ3SHNN.js";import{a as re,b as ae}from"./chunk-57BLH6QZ.js";var Yt=["nz-splitter-bar",""];function Ht(o,i){if(o&1&&P(0,"div",4),o&2){let e=d(),t=e.active()&&!!e.constrainedOffset();ge("transform",t?e.previewTransform():null),I("ant-splitter-bar-preview-active",t)}}function Kt(o,i){if(o&1){let e=T();c(0,"div",5),b("click",function(){z(e);let n=d();return x(n.collapseEvent("start"))}),P(1,"nz-icon",6),l()}if(o&2){let e=d();s(),f("nzType",e.vertical()?"up":"left")}}function Gt(o,i){if(o&1){let e=T();c(0,"div",7),b("click",function(){z(e);let n=d();return x(n.collapseEvent("end"))}),P(1,"nz-icon",8),l()}if(o&2){let e=d();s(),f("nzType",e.vertical()?"down":"right")}}var Xt=["contentTemplate"],Jt=["*"];function Zt(o,i){o&1&&Le(0)}function en(o,i){o&1&&Re(0)}function tn(o,i){if(o&1){let e=T();c(0,"div",4),b("offsetStart",function(n){z(e);let a=d().$index,r=d();return x(r.startResize(a,n))})("collapse",function(n){z(e);let a=d().$index,r=d();return x(r.collapse(a,n))}),l()}if(o&2){let e,t=d().$index,n=d(),a=n.resizableInfos()[t],r=n.ariaInfos()[t];f("ariaNow",r.ariaNow)("ariaMin",r.ariaMin)("ariaMax",r.ariaMax)("resizable",a.resizable)("collapsible",a.collapsible)("active",((e=n.movingIndex())==null?null:e.index)===t)("vertical",n.nzLayout()==="vertical")("lazy",n.nzLazy())("constrainedOffset",n.constrainedOffset())}}function nn(o,i){if(o&1&&(c(0,"div",1),k(1,en,1,0,"ng-container",2),l(),j(2,tn,1,9,"div",3)),o&2){let e=i.$implicit,t=i.$index,n=i.$count,a=d().sizes()[t],r=a.size?a.size:"auto",m=a.size?0:1;ge("flex-basis",r)("flex-grow",m),I("ant-splitter-panel-hidden",a.postPxSize===0),s(),f("ngTemplateOutlet",e.contentTemplate),s(),q(t!==n-1?2:-1)}}function on(o,i){if(o&1&&P(0,"div",5),o&2){let e=d();I("ant-splitter-mask-horizontal",e.nzLayout()==="horizontal")("ant-splitter-mask-vertical",e.nzLayout()==="vertical")}}var rn=(()=>{class o{ariaNow=S.required();ariaMin=S.required();ariaMax=S.required();active=S(!1);resizable=S(!0);vertical=S();lazy=S(!1);collapsible=S();constrainedOffset=S();offsetStart=Q();collapse=Q();previewTransform=A(()=>{let e=xe(this.constrainedOffset());return this.vertical()?`translateY(${e})`:`translateX(${e})`});resizeStartEvent(e){if(this.resizable()){let{pageX:t,pageY:n}=he(e);this.offsetStart.emit([t,n])}}collapseEvent(e){this.collapse.emit(e)}getValidNumber(e){return typeof e=="number"&&!isNaN(e)?Math.round(e):0}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=$({type:o,selectors:[["","nz-splitter-bar",""]],hostAttrs:["role","separator",1,"ant-splitter-bar"],hostVars:3,hostBindings:function(t,n){t&2&&Ie("aria-valuenow",n.getValidNumber(n.ariaNow()))("aria-valuemin",n.getValidNumber(n.ariaMin()))("aria-valuemax",n.getValidNumber(n.ariaMax()))},inputs:{ariaNow:[1,"ariaNow"],ariaMin:[1,"ariaMin"],ariaMax:[1,"ariaMax"],active:[1,"active"],resizable:[1,"resizable"],vertical:[1,"vertical"],lazy:[1,"lazy"],collapsible:[1,"collapsible"],constrainedOffset:[1,"constrainedOffset"]},outputs:{offsetStart:"offsetStart",collapse:"collapse"},attrs:Yt,decls:4,vars:7,consts:[[1,"ant-splitter-bar-preview",3,"ant-splitter-bar-preview-active","transform"],[1,"ant-splitter-bar-dragger",3,"mousedown","touchstart"],[1,"ant-splitter-bar-collapse-bar","ant-splitter-bar-collapse-bar-start"],[1,"ant-splitter-bar-collapse-bar","ant-splitter-bar-collapse-bar-end"],[1,"ant-splitter-bar-preview"],[1,"ant-splitter-bar-collapse-bar","ant-splitter-bar-collapse-bar-start",3,"click"],[1,"ant-splitter-bar-collapse-icon","ant-splitter-bar-collapse-start",3,"nzType"],[1,"ant-splitter-bar-collapse-bar","ant-splitter-bar-collapse-bar-end",3,"click"],[1,"ant-splitter-bar-collapse-icon","ant-splitter-bar-collapse-end",3,"nzType"]],template:function(t,n){if(t&1&&(j(0,Ht,1,4,"div",0),c(1,"div",1),b("mousedown",function(r){return n.resizeStartEvent(r)})("touchstart",function(r){return n.resizeStartEvent(r)}),l(),j(2,Kt,2,1,"div",2),j(3,Gt,2,1,"div",3)),t&2){let a,r;q(n.lazy()?0:-1),s(),I("ant-splitter-bar-dragger-disabled",!n.resizable())("ant-splitter-bar-dragger-active",n.active()),s(),q((a=n.collapsible())!=null&&a.start?2:-1),s(),q((r=n.collapsible())!=null&&r.end?3:-1)}},dependencies:[ne,te],encapsulation:2,changeDetection:0})}return o})(),$t=(()=>{class o{nzDefaultSize=S();nzMin=S();nzMax=S();nzSize=S();nzCollapsible=S(!1);nzResizable=S(!0,{transform:_e});contentTemplate=He.required("contentTemplate");static \u0275fac=function(t){return new(t||o)};static \u0275cmp=$({type:o,selectors:[["nz-splitter-panel"]],viewQuery:function(t,n){t&1&&je(n.contentTemplate,Xt,5),t&2&&fe()},inputs:{nzDefaultSize:[1,"nzDefaultSize"],nzMin:[1,"nzMin"],nzMax:[1,"nzMax"],nzSize:[1,"nzSize"],nzCollapsible:[1,"nzCollapsible"],nzResizable:[1,"nzResizable"]},exportAs:["nzSplitterPanel"],ngContentSelectors:Jt,decls:2,vars:0,consts:[["contentTemplate",""]],template:function(t,n){t&1&&(Ae(),De(0,Zt,1,0,"ng-template",null,0,O))},encapsulation:2,changeDetection:0})}return o})();function G(o){return Number(o.slice(0,-1))/100}function ve(o){return typeof o=="string"&&o.endsWith("%")}function an(o){if(o&&typeof o=="object")return o;let i=!!o;return{start:i,end:i}}var jt=ot({passive:!0}),sn=(()=>{class o{nzLayout=S("horizontal");nzLazy=S(!1,{transform:_e});nzResizeStart=Q();nzResize=Q();nzResizeEnd=Q();destroy$=L(Ce);elementRef=L(Oe);directionality=L(rt);resizeObserver=L(Mt);document=L(we);dir=ze(this.directionality.change,{initialValue:this.directionality.value});panels=Ke($t);panelProps=A(()=>this.panels().map(e=>({defaultSize:e.nzDefaultSize(),size:e.nzSize(),min:e.nzMin(),max:e.nzMax(),resizable:e.nzResizable(),collapsible:an(e.nzCollapsible()),contentTemplate:e.contentTemplate()})));containerBox=ze(this.resizeObserver.observe(this.elementRef).pipe(B(([e])=>e.target),B(e=>({width:e.clientWidth,height:e.clientHeight}))),{initialValue:{width:this.elementRef.nativeElement.clientWidth||0,height:this.elementRef.nativeElement.clientHeight||0}});containerSize=A(()=>this.nzLayout()==="horizontal"?this.containerBox().width:this.containerBox().height);innerSizes=Ye({source:this.panelProps,computation:e=>e.map(t=>t.defaultSize)});sizes=A(()=>{let e=0,t=this.containerSize(),n=this.innerSizes(),a=this.panelProps().map((m,p)=>{let u=m.size??n[p],g;if(ve(u))g=G(u);else if(u||u===0){let y=Number(u);isNaN(y)||(g=y/t)}else g=void 0,e++;let v=m.min,N=m.max,h=ve(v)?G(v):(v||0)/t,w=ve(N)?G(N):(N||t)/t;return{size:u,percentage:g,min:v,max:N,postPercentMinSize:h,postPercentMaxSize:w}}),r=a.reduce((m,{percentage:p})=>m+(p??0),0);for(let m of a){if(r>1&&!e){let p=1/r;m.percentage=m.percentage===void 0?0:m.percentage*p}else{let p=(1-r)/e;m.percentage=m.percentage===void 0?p:m.percentage}m.postPxSize=m.percentage*t,m.size=t?xe(m.postPxSize):m.size}return a});ariaInfos=A(()=>{let e=[],t=[],n=this.sizes(),a=0;for(let r of n)a+=r.percentage,e.push(a);for(let r=0;r<n.length-1;r+=1){let m=(e[r-1]||0)+n[r].postPercentMinSize,p=(e[r+1]||100)-n[r+1].postPercentMaxSize,u=(e[r-1]||0)+n[r].postPercentMaxSize,g=(e[r+1]||100)-n[r+1].postPercentMinSize;t.push({ariaNow:e[r]*100,ariaMin:Math.max(m,p)*100,ariaMax:Math.min(u,g)*100})}return t});getPxSizes(){return this.sizes().map(e=>e.postPxSize)}movingIndex=le(null);constrainedOffset=le(0);resizableInfos=A(()=>{let e=this.panelProps(),t=this.getPxSizes(),n=[];for(let a=0;a<e.length-1;a+=1){let r=e[a],m=e[a+1],p=t[a],u=t[a+1],{resizable:g=!0,min:v,collapsible:N}=r,{resizable:h=!0,min:w,collapsible:y}=m,M=g&&h&&(p!==0||!v)&&(u!==0||!w),C=N.end&&p>0||y.start&&u===0&&p>0,V=y.start&&u>0||N.end&&p===0&&u>0;n[a]={resizable:M,collapsible:{start:!!(this.dir()==="rtl"?V:C),end:!!(this.dir()==="rtl"?C:V)}}}return n});startResize(e,t){this.movingIndex.set({index:e,confirmed:!1}),this.nzResizeStart.emit(this.getPxSizes());let n=new X,a=p=>{let{percentage:u,postPercentMinSize:g,postPercentMaxSize:v}=this.sizes()[e],[N,h,w]=[u,g,v].map(R=>R*100),y=this.containerSize(),M=y*N/100,C=M+p,V=Math.max(0,y*h/100),Me=Math.min(y,y*w/100);return Math.max(V,Math.min(Me,C))-M},r=p=>{this.constrainedOffset.set(a(p))},m=()=>{this.updateOffset(e,this.constrainedOffset()),this.constrainedOffset.set(0)};W(K(this.document,"mousemove",jt),K(this.document,"touchmove",jt)).pipe(B(p=>he(p)),B(({pageX:p,pageY:u})=>this.nzLayout()==="horizontal"?p-t[0]:u-t[1]),B(p=>this.nzLayout()==="horizontal"&&this.dir()==="rtl"?-p:p),ke(0),Pe(),Y(W(n,this.destroy$))).subscribe(([p,u])=>{if(this.nzLazy()&&u!==0)r(u);else{let g=u-p;g!==0&&this.updateOffset(e,g)}}),W(K(this.document,"mouseup"),K(this.document,"touchend")).pipe(Y(W(n,this.destroy$))).subscribe(()=>{this.nzLazy()&&m(),this.movingIndex.set(null),this.nzResizeEnd.emit(this.getPxSizes()),n.next()})}updateOffset(e,t){let n=this.containerSize(),a=this.sizes().map(C=>[C.min,C.max]),r=this.sizes().map(C=>C.percentage*n),m=(C,V)=>typeof C=="string"?G(C)*n:C??V,p=null,u=this.movingIndex();if((!u||!u.confirmed)&&t!==0){if(t>0)p=e,this.movingIndex.set({index:e,confirmed:!0});else for(let C=e;C>=0;C-=1)if(r[C]>0&&this.resizableInfos()[C].resizable){p=C,this.movingIndex.set({index:C,confirmed:!0});break}}let g=p??e,v=g+1,N=m(a[g][0],0),h=m(a[v][0],0),w=m(a[g][1],n),y=m(a[v][1],n),M=t;r[g]+M<N&&(M=N-r[g]),r[v]-M<h&&(M=r[v]-h),r[g]+M>w&&(M=w-r[g]),r[v]-M>y&&(M=r[v]-y),r[g]+=M,r[v]-=M,this.innerSizes.set(r),this.nzResize.emit(r)}cacheCollapsedSize=[];collapse(e,t){let n=this.containerSize(),a=this.sizes().map(h=>[h.min,h.max]),r=this.sizes().map(h=>h.percentage*n),m=this.dir()==="rtl"?t==="start"?"end":"start":t,p=m==="start"?e:e+1,u=m=="start"?e+1:e,g=r[p],v=r[u],N=(h,w)=>typeof h=="string"?G(h)*n:h??w;if(g!==0&&v!==0)r[p]=0,r[u]+=g,this.cacheCollapsedSize[e]=g;else{let h=g+v,w=N(a[p][0],0),y=N(a[p][1],n),M=N(a[u][0],0),C=N(a[u][1],n),V=Math.max(w,h-C),ie=(Math.min(y,h-M)-V)/2,R=this.cacheCollapsedSize[e],oe=h-R;R&&R<=C&&R>=M&&oe<=y&&oe>=w?(r[u]=R,r[p]=oe):(r[p]-=ie,r[u]+=ie)}this.innerSizes.set(r),this.nzResize.emit(r),this.nzResizeEnd.emit(r)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=$({type:o,selectors:[["nz-splitter"]],contentQueries:function(t,n,a){t&1&&$e(a,n.panels,$t,4),t&2&&fe()},hostAttrs:[1,"ant-splitter"],hostVars:6,hostBindings:function(t,n){t&2&&I("ant-splitter-horizontal",n.nzLayout()==="horizontal")("ant-splitter-vertical",n.nzLayout()==="vertical")("ant-splitter-rtl",n.dir()==="rtl")},inputs:{nzLayout:[1,"nzLayout"],nzLazy:[1,"nzLazy"]},outputs:{nzResizeStart:"nzResizeStart",nzResize:"nzResize",nzResizeEnd:"nzResizeEnd"},exportAs:["nzSplitter"],features:[Qe([Ce])],decls:3,vars:1,consts:[["aria-hidden","",1,"ant-splitter-mask",3,"ant-splitter-mask-horizontal","ant-splitter-mask-vertical"],[1,"ant-splitter-panel"],[4,"ngTemplateOutlet"],["nz-splitter-bar","",3,"ariaNow","ariaMin","ariaMax","resizable","collapsible","active","vertical","lazy","constrainedOffset"],["nz-splitter-bar","",3,"offsetStart","collapse","ariaNow","ariaMin","ariaMax","resizable","collapsible","active","vertical","lazy","constrainedOffset"],["aria-hidden","",1,"ant-splitter-mask"]],template:function(t,n){t&1&&(Be(0,nn,3,8,null,null,Ve),j(2,on,1,4,"div",0)),t&2&&(Fe(n.panelProps()),s(2),q(n.movingIndex()!==null?2:-1))},dependencies:[Ze,rn],encapsulation:2,changeDetection:0})}return o})(),qt=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=Ee({type:o});static \u0275inj=Te({imports:[sn]})}return o})();var ln=["rootMenu"],cn=()=>[],dn=(o,i)=>[o,i];function pn(o,i){o&1&&P(0,"nz-icon",27)}function mn(o,i){if(o&1&&(ce(0),P(1,"nz-icon",31),c(2,"span",32),_(3),l(),c(4,"span",33),_(5),l(),c(6,"span",34),_(7),F(8,"lowercase"),l(),de()),o&2){let e=d(),t=e.$implicit,n=e.origin;s(3),Z(t.title),s(),f("ngClass","task-"+(n.taskStatus||"pending")),s(),E(" ",n.taskStatus||"pending"," "),s(2),E("created by ",H(8,4,n.author))}}function un(o,i){if(o&1){let e=T();ce(0),c(1,"nz-icon",35),b("click",function(){z(e);let n=d(2).$implicit,a=d();return x(a.openFolder(n))}),l(),c(2,"span",36),_(3),l(),de()}if(o&2){let e=d(2).$implicit;s(),f("nzType",e.isExpanded?"folder-open":"folder"),s(2),Z(e.title)}}function fn(o,i){if(o&1&&(P(0,"nz-icon",37),c(1,"span",38),_(2),l()),o&2){let e=d(2).$implicit;s(2),Z(e.title)}}function gn(o,i){if(o&1&&k(0,un,4,2,"ng-container",30)(1,fn,3,1,"ng-template",null,7,O),o&2){let e=D(2),t=d().$implicit;f("ngIf",!t.isLeaf)("ngIfElse",e)}}function _n(o,i){if(o&1){let e=T();c(0,"span",28)(1,"span",29),b("contextmenu",function(n){let a=z(e).$implicit,r=d(),m=D(18);return x(r.contextMenu(n,m,a))}),k(2,mn,9,6,"ng-container",30)(3,gn,3,2,"ng-template",null,6,O),l()()}if(o&2){let e=i.$implicit,t=i.origin,n=D(4),a=d();I("selected",(a.activatedNode==null?null:a.activatedNode.key)===e.key),s(2),f("ngIf",t.isTask)("ngIfElse",n)}}function zn(o,i){if(o&1){let e=T();c(0,"li",18),b("click",function(){z(e);let n=d();return x(n.addTask())}),_(1,"\u65B0\u589E\u4EFB\u52D9"),l()}}function xn(o,i){if(o&1){let e=T();c(0,"li",18),b("click",function(){z(e);let n=d();return x(n.editNode())}),_(1,"\u7DE8\u8F2F\u7BC0\u9EDE"),l()}}function Cn(o,i){if(o&1){let e=T();c(0,"li",18),b("click",function(){z(e);let n=d();return x(n.deleteNode())}),_(1,"\u522A\u9664\u7BC0\u9EDE"),l()}}function hn(o,i){if(o&1&&(c(0,"nz-descriptions-item",55)(1,"nz-tag",46),_(2),l()()),o&2){let e=d().ngIf,t=d();s(),f("nzColor",t.getStatusColor(e.status)),s(),E(" ",e.status," ")}}function bn(o,i){if(o&1&&(c(0,"nz-descriptions-item",56),_(1),F(2,"date"),l()),o&2){let e=d().ngIf;s(),E(" ",ee(2,1,e.createdAt,"short")," ")}}function vn(o,i){if(o&1&&(c(0,"nz-descriptions-item",57),_(1),F(2,"date"),l()),o&2){let e=d().ngIf;s(),E(" ",ee(2,1,e.updatedAt,"short")," ")}}function Mn(o,i){if(o&1){let e=T();c(0,"div",39)(1,"div",40)(2,"h3"),P(3,"nz-icon",41),_(4),l(),c(5,"button",42),b("click",function(){let n=z(e).ngIf,a=d();return x(a.onEditNodeRequested(n))}),P(6,"nz-icon",43),l()(),c(7,"nz-descriptions",44)(8,"nz-descriptions-item",45)(9,"nz-tag",46),_(10),l()(),k(11,hn,3,2,"nz-descriptions-item",47)(12,bn,3,4,"nz-descriptions-item",48)(13,vn,3,4,"nz-descriptions-item",49),l(),c(14,"div",50)(15,"button",51),b("click",function(){let n=z(e).ngIf,a=d();return x(a.onAddChildRequested(n))}),P(16,"nz-icon",52),_(17," \u65B0\u589E\u5B50\u7BC0\u9EDE "),l(),c(18,"button",53),b("click",function(){let n=z(e).ngIf,a=d();return x(a.onAddTaskRequested(n))}),P(19,"nz-icon",54),_(20," \u65B0\u589E\u4EFB\u52D9 "),l()()()}if(o&2){let e=i.ngIf,t=d();s(3),f("nzType",t.getNodeIcon(e)),s(),E(" ",e.title," "),s(3),f("nzColumn",1),s(2),f("nzColor",t.getTypeColor(e.type)),s(),E(" ",t.getTypeLabel(e.type)," "),s(),f("ngIf",e.status),s(),f("ngIf",e.createdAt),s(),f("ngIf",e.updatedAt)}}function Sn(o,i){o&1&&(c(0,"nz-empty",58)(1,"div"),_(2,"\u9EDE\u64CA\u5DE6\u5074\u6A39\u72C0\u7D50\u69CB\u4E2D\u7684\u4EFB\u4E00\u7BC0\u9EDE\u5373\u53EF\u67E5\u770B\u8A73\u7D30\u8CC7\u8A0A"),l()())}function Nn(o,i){if(o&1){let e=T();c(0,"button",64),b("click",function(){z(e);let n=d().$implicit,a=d(2);return x(a.onEditNodeRequested(n))}),_(1," \u7DE8\u8F2F "),l()}}function Pn(o,i){if(o&1){let e=T();c(0,"button",65),b("click",function(){z(e);let n=d(3);return x(n.deleteNode())}),_(1," \u522A\u9664 "),l()}}function yn(o,i){if(o&1&&(c(0,"nz-list-item",63)(1,"nz-list-item-meta")(2,"nz-list-item-meta-title")(3,"span"),_(4),l()(),c(5,"nz-list-item-meta-description"),_(6),F(7,"date"),l()(),c(8,"nz-tag",46),_(9),l(),k(10,Nn,2,0,"ng-template",null,9,O)(12,Pn,2,0,"ng-template",null,10,O),l()),o&2){let e=i.$implicit,t=D(11),n=D(13),a=d(2);f("nzActions",We(10,dn,t,n)),s(3),qe("task-title task-"+(e.taskStatus||"pending")),s(),E(" ",e.title," "),s(2),E(" \u5EFA\u7ACB\u65BC ",ee(7,7,e.createdAt,"short")," "),s(2),f("nzColor",a.getTaskStatusColor(e.taskStatus||"pending")),s(),E(" ",a.getTaskStatusLabel(e.taskStatus||"pending")," ")}}function kn(o,i){if(o&1){let e=T();c(0,"div",59)(1,"div",60)(2,"h4"),_(3,"\u76F8\u95DC\u4EFB\u52D9"),l(),c(4,"button",61),b("click",function(){let n=z(e).ngIf,a=d();return x(a.onAddTaskRequested(n))}),P(5,"nz-icon",52),_(6," \u65B0\u589E\u4EFB\u52D9 "),l()(),c(7,"nz-list",62),k(8,yn,14,13,"ng-template",null,8,O),l()()}if(o&2){let e=i.ngIf,t=d();s(7),f("nzDataSource",t.getRelatedTasks(e.id))}}function Tn(o,i){o&1&&(c(0,"nz-empty",66)(1,"div"),_(2,"\u4EFB\u52D9\u5C07\u986F\u793A\u5728\u6B64\u5340\u57DF"),l()())}var U=class U{constructor(i,e,t){this.nzContextMenuService=i;this.crudService=e;this.cdr=t;this.searchValue="";this.contextNode=null;this.destroy$=new X;this.selectedNodeSubject=new se(null);this.searchSubject=new se("");this.leftPanelSize=70;this.minLeftPanelSize=200;this.maxLeftPanelSize=600;this.upperPanelSize=60;this.minUpperPanelSize=200;this.resizerStyle={background:"rgba(0, 0, 0, 0.06)"};this.verticalResizerStyle={background:"rgba(0, 0, 0, 0.04)"};this.leftPanelCollapsed=!1;this.selectedNodeForDetail$=this.selectedNodeSubject.asObservable();this.treeData$=Se([this.crudService.getNodes(),this.searchSubject.asObservable().pipe(Ne(300))]).pipe(B(([i,e])=>{let t=wn(i);return e?this.filterTree(t,e):t}),Y(this.destroy$),ye(1))}ngOnInit(){this.searchSubject.next(this.searchValue)}ngAfterViewInit(){this.cdr.detectChanges()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.selectedNodeSubject.complete(),this.searchSubject.complete()}onSearchChange(i){this.searchValue=i,this.searchSubject.next(i)}filterTree(i,e){return e.trim()?i.filter(t=>this.matchesSearch(t,e)).map(t=>ae(re({},t),{children:t.children?this.filterTree(t.children,e):[]})):i}matchesSearch(i,e){let t=i.title.toLowerCase().includes(e.toLowerCase()),n=i.children?.some(a=>this.matchesSearch(a,e));return t||!!n}activeNode(i){this.activatedNode=i.node;let e=i.node?.origin;this.selectedNodeSubject.next(e),this.cdr.markForCheck()}onLeftPanelCollapse(i){this.leftPanelCollapsed=i,this.cdr.markForCheck()}onEditNodeRequested(i){this.crud.showEditModal(i)}onAddChildRequested(i){this.crud.showAddModal(i.key)}onAddTaskRequested(i){this.addTaskToNode(i)}onTaskUpdated(i){this.cdr.markForCheck()}onAddTaskFromList(i){this.cdr.markForCheck()}addTaskToNode(i){let e=new Date().toISOString(),t=`task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n={id:t,key:t,title:"\u65B0\u4EFB\u52D9",name:"\u65B0\u4EFB\u52D9",type:"leaf",isTask:!0,order:0,parentKey:i.key,createdAt:e,updatedAt:e};this.crudService.addNode(n).then(()=>{}).catch(a=>{console.error("\u65B0\u589E\u4EFB\u52D9\u5931\u6557:",a)})}openFolder(i){if(i instanceof kt)i.isExpanded=!i.isExpanded;else{let e=i.node;e&&(e.isExpanded=!e.isExpanded)}}onDrop(i){let e=i.dragNode,t=i.node;if(!e||!t)return;let n=t.key;this.crudService.updateNode(e.key,{parentKey:n,order:0}).then(()=>{}).catch(r=>{console.error("\u62D6\u66F3\u66F4\u65B0\u5931\u6557:",r)})}contextMenu(i,e,t){this.contextNode=t??null,this.nzContextMenuService.create(i,e)}onPanelContextMenu(i){i.target.closest(".ant-tree-node")||(i.preventDefault(),i.stopPropagation(),this.contextNode=null,this.rootMenu&&this.nzContextMenuService.create(i,this.rootMenu))}addNode(){this.crud.showAddModal(this.contextNode?.key)}editNode(){this.contextNode&&this.crud.showEditModal(this.contextNode.origin)}deleteNode(){this.contextNode&&this.crud.deleteNode(this.contextNode.origin)}addRootNode(){this.crud.showAddModal(null)}addTask(){if(!this.contextNode)return;let i=this.contextNode.origin;this.addTaskToNode(i)}selectDropdown(i){alert(i)}getNodeIcon(i){return i.isTask?"check-circle":i.type==="root"?"cluster":i.type==="branch"?"folder":"file"}getTypeColor(i){return{root:"purple",trunk:"blue",branch:"green",leaf:"orange"}[i]||"default"}getTypeLabel(i){return{root:"\u6839\u7BC0\u9EDE",trunk:"\u4E3B\u5E79",branch:"\u5206\u652F",leaf:"\u8449\u5B50\u7BC0\u9EDE"}[i]||i}getStatusColor(i){return i&&{active:"green",inactive:"gray",archived:"orange"}[i]||"default"}getRelatedTasks(i){return[]}getTaskStatusColor(i){return{pending:"orange","in-progress":"blue",completed:"green",cancelled:"red"}[i]||"default"}getTaskStatusLabel(i){return{pending:"\u5F85\u8FA6","in-progress":"\u9032\u884C\u4E2D",completed:"\u5DF2\u5B8C\u6210",cancelled:"\u5DF2\u53D6\u6D88"}[i]||i}};U.\u0275fac=function(e){return new(e||U)(J(ht),J(Rt),J(Ge))},U.\u0275cmp=$({type:U,selectors:[["app-tree-panel"]],viewQuery:function(e,t){if(e&1&&(pe(be,5),pe(ln,5)),e&2){let n;me(n=ue())&&(t.crud=n.first),me(n=ue())&&(t.rootMenu=n.first)}},decls:38,vars:21,consts:[["suffixIcon",""],["nzTreeTemplate",""],["rootMenu","nzDropdownMenu"],["menu","nzDropdownMenu"],["noNodeSelected",""],["noTasksAvailable",""],["folderOrFile",""],["fileIcon",""],["item",""],["editAction",""],["deleteAction",""],[1,"tree-panel-container"],[1,"tree-exploration-panel"],[1,"search-input",3,"nzSuffix"],["type","text","nz-input","","placeholder","\u641C\u5C0B\u7BC0\u9EDE",3,"ngModelChange","ngModel"],[1,"tree-container"],["nzBlockNode","","nzDraggable","","nzVirtualHeight","calc(100vh - 180px)",3,"nzClick","nzDblClick","nzOnDrop","contextmenu","nzData","nzSearchValue","nzTreeTemplate"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item","",3,"click",4,"ngIf"],[1,"resizer-handle","vertical-resizer"],[1,"details-analysis-panel"],[1,"node-details-section"],["class","node-details",4,"ngIf","ngIfElse"],[1,"resizer-handle","horizontal-resizer"],[1,"task-list-section"],["class","task-list",4,"ngIf","ngIfElse"],["nzType","search"],[1,"custom-node"],[3,"contextmenu"],[4,"ngIf","ngIfElse"],["nzType","check-circle",2,"color","#52c41a"],[1,"task-name"],[1,"task-status",3,"ngClass"],[1,"task-desc"],[3,"click","nzType"],[1,"folder-name"],["nzType","file"],[1,"file-name"],[1,"node-details"],[1,"details-header"],[3,"nzType"],["nz-button","","nzType","text",3,"click"],["nzType","edit"],["nzBordered","","nzSize","small",3,"nzColumn"],["nzTitle","\u985E\u578B"],[3,"nzColor"],["nzTitle","\u72C0\u614B",4,"ngIf"],["nzTitle","\u5EFA\u7ACB\u6642\u9593",4,"ngIf"],["nzTitle","\u66F4\u65B0\u6642\u9593",4,"ngIf"],[1,"actions-section"],["nz-button","","nzType","primary",3,"click"],["nzType","plus"],["nz-button","",3,"click"],["nzType","check-circle"],["nzTitle","\u72C0\u614B"],["nzTitle","\u5EFA\u7ACB\u6642\u9593"],["nzTitle","\u66F4\u65B0\u6642\u9593"],["nzNotFoundContent","\u8ACB\u9078\u64C7\u4E00\u500B\u7BC0\u9EDE\u67E5\u770B\u8A73\u60C5",1,"empty-state"],[1,"task-list"],[1,"task-header"],["nz-button","","nzType","primary","nzSize","small",3,"click"],["nzSize","small",3,"nzDataSource"],[3,"nzActions"],["nz-button","","nzType","link","nzSize","small",3,"click"],["nz-button","","nzType","link","nzSize","small","nzDanger","",3,"click"],["nzNotFoundContent","\u9078\u64C7\u7BC0\u9EDE\u4EE5\u67E5\u770B\u76F8\u95DC\u4EFB\u52D9",1,"empty-state"]],template:function(e,t){if(e&1){let n=T();P(0,"app-firebase-crud"),c(1,"div",11)(2,"div",12)(3,"nz-input-group",13)(4,"input",14),b("ngModelChange",function(r){return z(n),x(t.onSearchChange(r))}),l()(),k(5,pn,1,0,"ng-template",null,0,O),c(7,"div",15)(8,"nz-tree",16),F(9,"async"),b("nzClick",function(r){return z(n),x(t.activeNode(r))})("nzDblClick",function(r){return z(n),x(t.openFolder(r))})("nzOnDrop",function(r){return z(n),x(t.onDrop(r))})("contextmenu",function(r){return z(n),x(t.onPanelContextMenu(r))}),l()(),k(10,_n,5,4,"ng-template",null,1,O),c(12,"nz-dropdown-menu",null,2)(14,"ul",17)(15,"li",18),b("click",function(){return z(n),x(t.addRootNode())}),_(16,"\u65B0\u589E\u6839\u7BC0\u9EDE"),l()()(),c(17,"nz-dropdown-menu",null,3)(19,"ul",17)(20,"li",18),b("click",function(){return z(n),x(t.addNode())}),_(21,"\u65B0\u589E\u7BC0\u9EDE"),l(),k(22,zn,2,0,"li",19)(23,xn,2,0,"li",19)(24,Cn,2,0,"li",19),l()()(),P(25,"div",20),c(26,"div",21)(27,"div",22),k(28,Mn,21,8,"div",23),F(29,"async"),k(30,Sn,3,0,"ng-template",null,4,O),l(),P(32,"div",24),c(33,"div",25),k(34,kn,10,1,"div",26),F(35,"async"),k(36,Tn,3,0,"ng-template",null,5,O),l()()()}if(e&2){let n=D(6),a=D(11),r=D(31),m=D(37);s(2),I("collapsed",t.leftPanelCollapsed),s(),f("nzSuffix",n),s(),f("ngModel",t.searchValue),s(4),f("nzData",H(9,14,t.treeData$)??Ue(20,cn))("nzSearchValue",t.searchValue)("nzTreeTemplate",a),s(14),f("ngIf",t.contextNode),s(),f("ngIf",t.contextNode),s(),f("ngIf",t.contextNode),s(4),f("ngIf",H(29,16,t.selectedNodeForDetail$))("ngIfElse",r),s(6),f("ngIf",H(35,18,t.selectedNodeForDetail$))("ngIfElse",m)}},dependencies:[it,Xe,Je,ut,dt,pt,mt,Lt,At,Ct,zt,_t,xt,ne,te,yt,St,Pt,Nt,be,qt,Ft,Bt,Vt,gt,ft,ct,lt,at,st,It,Et,Dt,Ot,Tt,wt,vt,bt,et,tt,nt],styles:['.tree-panel-container[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 100px);min-height:600px;background:#fafafa;border-radius:8px;box-shadow:0 2px 8px #0000000f;overflow:hidden}.tree-exploration-panel[_ngcontent-%COMP%]{flex:0 0 60%;min-width:280px;max-width:800px;display:flex;flex-direction:column;background:#fff;border-right:1px solid #f0f0f0;transition:all .3s}.tree-exploration-panel.collapsed[_ngcontent-%COMP%]{flex:0 0 60px;min-width:60px;overflow:hidden}.toolbar[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #f0f0f0;background:#fafafa}.toolbar[_ngcontent-%COMP%]   .add-root-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;font-weight:500}.toolbar[_ngcontent-%COMP%]   .add-root-btn[_ngcontent-%COMP%]:hover{background:#e6f7ff;color:#1890ff}.search-input[_ngcontent-%COMP%]{margin:16px}.tree-container[_ngcontent-%COMP%]{flex:1;padding:0 16px 16px;overflow:hidden}nz-tree[_ngcontent-%COMP%]{overflow:hidden;height:100%}nz-tree[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]{background:transparent}nz-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{border-radius:4px;transition:all .2s}nz-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]:hover{background:#f5f5f5}nz-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper.ant-tree-node-selected[_ngcontent-%COMP%]{background:#e6f7ff;border:1px solid #91d5ff}.custom-node[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;padding:4px 8px;line-height:28px;cursor:pointer;border-radius:4px;transition:all .2s}.custom-node.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e6f7ff,#bae7ff);border-left:3px solid #1890ff;font-weight:500}.custom-node[_ngcontent-%COMP%]:hover{background:#f0f9ff}.custom-node[_ngcontent-%COMP%]   nz-icon[_ngcontent-%COMP%]{margin-right:6px;font-size:14px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:6px;font-size:14px;color:#262626}.folder-name[_ngcontent-%COMP%]{font-weight:500;color:#1890ff}.task-name[_ngcontent-%COMP%]{margin-left:6px;font-size:14px;font-weight:500}.task-status[_ngcontent-%COMP%]{margin-left:8px;padding:2px 6px;border-radius:10px;font-size:11px;font-weight:500;text-transform:uppercase}.task-status.task-pending[_ngcontent-%COMP%]{background:#fff7e6;color:#fa8c16;border:1px solid #ffd591}.task-status.task-in-progress[_ngcontent-%COMP%]{background:#e6f7ff;color:#1890ff;border:1px solid #91d5ff}.task-status.task-completed[_ngcontent-%COMP%]{background:#f6ffed;color:#52c41a;border:1px solid #b7eb8f}.task-status.task-cancelled[_ngcontent-%COMP%]{background:#fff2f0;color:#ff4d4f;border:1px solid #ffccc7}.task-desc[_ngcontent-%COMP%]{margin-left:8px;font-size:12px;color:#8c8c8c;font-style:italic}.resizer-handle[_ngcontent-%COMP%]{background:#f0f0f0;position:relative}.resizer-handle[_ngcontent-%COMP%]:before{content:"";position:absolute;background:#d9d9d9}.resizer-handle[_ngcontent-%COMP%]:hover{background:#e6f7ff}.resizer-handle[_ngcontent-%COMP%]:hover:before{background:#1890ff}.vertical-resizer[_ngcontent-%COMP%]{width:4px;cursor:ew-resize}.vertical-resizer[_ngcontent-%COMP%]:before{top:50%;left:50%;transform:translate(-50%,-50%);width:2px;height:40px}.horizontal-resizer[_ngcontent-%COMP%]{height:4px;cursor:ns-resize;margin:8px 0}.horizontal-resizer[_ngcontent-%COMP%]:before{top:50%;left:50%;transform:translate(-50%,-50%);height:2px;width:40px}.details-analysis-panel[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:#fff;min-width:300px}.node-details-section[_ngcontent-%COMP%]{flex:0 0 60%;padding:20px;border-bottom:1px solid #f0f0f0;overflow-y:auto}.node-details[_ngcontent-%COMP%]   .details-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid #f0f0f0}.node-details[_ngcontent-%COMP%]   .details-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#262626;display:flex;align-items:center;gap:8px}.node-details[_ngcontent-%COMP%]   .details-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   nz-icon[_ngcontent-%COMP%]{font-size:20px;color:#1890ff}.node-details[_ngcontent-%COMP%]   .details-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#8c8c8c}.node-details[_ngcontent-%COMP%]   .details-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#1890ff;background:#f0f9ff}.node-details[_ngcontent-%COMP%]   nz-descriptions[_ngcontent-%COMP%]{margin-bottom:20px}.node-details[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]{display:flex;gap:12px;padding-top:16px}.node-details[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:40px;border-radius:6px;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px}.node-details[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]   button[nztype=primary][_ngcontent-%COMP%]{background:linear-gradient(135deg,#1890ff,#096dd9);border:none}.node-details[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]   button[nztype=primary][_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#40a9ff,#1890ff);transform:translateY(-1px);box-shadow:0 4px 12px #1890ff4d}.task-list-section[_ngcontent-%COMP%]{flex:1;padding:20px;overflow-y:auto}.task-list[_ngcontent-%COMP%]   .task-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f0f0f0}.task-list[_ngcontent-%COMP%]   .task-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#262626}.task-list[_ngcontent-%COMP%]   .task-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:32px;border-radius:6px;font-size:12px}.task-list[_ngcontent-%COMP%]   .task-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 8px #1890ff4d}.task-list[_ngcontent-%COMP%]   nz-list[_ngcontent-%COMP%]   .ant-list-item[_ngcontent-%COMP%]{border-radius:6px;margin-bottom:8px;padding:12px;background:#fafafa;transition:all .2s}.task-list[_ngcontent-%COMP%]   nz-list[_ngcontent-%COMP%]   .ant-list-item[_ngcontent-%COMP%]:hover{background:#f0f9ff;transform:translateY(-1px);box-shadow:0 2px 8px #0000000f}.task-list[_ngcontent-%COMP%]   nz-list[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{font-weight:500;font-size:14px}.empty-state[_ngcontent-%COMP%]{padding:40px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   .ant-empty-description[_ngcontent-%COMP%]{color:#8c8c8c;font-size:14px}@media (max-width: 1200px){.tree-exploration-panel[_ngcontent-%COMP%]{flex:0 0 60%;min-width:280px}}@media (max-width: 768px){.tree-panel-container[_ngcontent-%COMP%]{flex-direction:column;height:auto;min-height:80vh}.tree-exploration-panel[_ngcontent-%COMP%]{flex:0 0 400px;border-right:none;border-bottom:1px solid #f0f0f0}.vertical-resizer[_ngcontent-%COMP%]{display:none}.details-analysis-panel[_ngcontent-%COMP%]{flex:1;min-height:400px}.node-details-section[_ngcontent-%COMP%]{flex:0 0 auto;min-height:200px}.task-list-section[_ngcontent-%COMP%]{min-height:200px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.node-details[_ngcontent-%COMP%], .task-list[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar, .node-details-section[_ngcontent-%COMP%]::-webkit-scrollbar, .task-list-section[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-track, .node-details-section[_ngcontent-%COMP%]::-webkit-scrollbar-track, .task-list-section[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f5f5f5;border-radius:3px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .node-details-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .task-list-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d9d9d9;border-radius:3px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .node-details-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .task-list-section[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#bfbfbf}'],changeDetection:0});var Qt=U;function wn(o){let i=new Map,e=[];return o.forEach(t=>{i.set(t.key,ae(re({},t),{children:[],isLeaf:t.type==="leaf"||t.isTask||!1,expanded:!1,selected:!1}))}),i.forEach(t=>{let n=t.parentKey;n&&i.has(n)?i.get(n).children.push(t):e.push(t)}),e}export{Qt as TreePanelComponent};

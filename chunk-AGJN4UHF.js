import{a as Z}from"./chunk-6AOWKASD.js";import"./chunk-KNP3MJAK.js";import"./chunk-ERNLQ6N4.js";import"./chunk-VAGS5EVQ.js";import{d as Zt,f as Jt,h as ee}from"./chunk-GG7OQ426.js";import{c as ue,f as me,h as de,j as _e,k as fe,l as Ce,n as ze}from"./chunk-QXXECWUW.js";import"./chunk-CKQ6FBZR.js";import"./chunk-NMCFBNRY.js";import"./chunk-F7UE2Z2N.js";import"./chunk-GFX7JDKS.js";import{b as le,c as se,d as pe}from"./chunk-OTGL7XGI.js";import"./chunk-5NDUH4BM.js";import"./chunk-7INLARAR.js";import"./chunk-3LZSSZ2Q.js";import{d as ie,g as oe,m as re,o as ae,y as ce}from"./chunk-4AYNG3KP.js";import"./chunk-Q6QAL4XK.js";import"./chunk-2HVL4WVD.js";import"./chunk-ZDNPLYMC.js";import"./chunk-KR7JNVYJ.js";import{t as dt}from"./chunk-H53TJUCR.js";import"./chunk-QBQXGPEE.js";import{d as ne}from"./chunk-QRKJYL4P.js";import"./chunk-JE6KLO7C.js";import"./chunk-W5FC2PZ7.js";import"./chunk-TPNYXQ4U.js";import{h as Y,q as te,s as X,t as U}from"./chunk-5PLKKHJ2.js";import{Nc as L,Oc as P,Pc as Kt,a as j,aa as mt,e as qt,ea as Xt,f as Yt,ga as Ut,o as q}from"./chunk-Z6UJEHZN.js";import{o as Gt,p as $t,q as ut,y as jt}from"./chunk-KF7OGFLI.js";import{Aa as u,Ac as Ot,Ba as m,Cc as T,Dc as S,Dd as st,Ec as D,Fa as Mt,Fb as b,Fc as ct,Ga as rt,Gb as Vt,Hc as Lt,Hd as pt,Ic as N,Kc as W,Lb as C,Mc as Pt,Nc as g,Ob as Q,Oc as Ht,Pb as Ft,Pc as w,R as xt,Ra as It,Sc as E,Tc as B,Uc as O,_b as M,ac as I,b as yt,dd as Rt,fc as p,g as bt,ga as Tt,gc as c,hc as l,ic as z,kd as v,mc as kt,nb as Nt,nc as Et,oa as St,oc as at,pa as Dt,pc as f,pd as $,q as vt,qd as At,r as ot,rd as Qt,sa as wt,sb as s,ta as y,ud as Wt,vc as _,vd as x,yb as G,yc as a,yd as lt,zc as Bt}from"./chunk-IDL4MXQM.js";import{a as gt,b as ht,g as nt,i as it}from"./chunk-57BLH6QZ.js";function De(n,o){}function we(n,o){if(n&1&&(c(0,"div",2),C(1,De,0,0,"ng-template",4),l()),n&2){let t=a(2);s(),p("ngTemplateOutlet",t.nzIcon)}}function Me(n,o){if(n&1&&(kt(0),g(1),Et()),n&2){let t=a(3);s(),w(" ",t.nzDescription," ")}}function Ie(n,o){if(n&1&&(c(0,"div",3),C(1,Me,2,1,"ng-container",5),l()),n&2){let t=a(2);s(),p("nzStringTemplateOutlet",t.nzDescription)}}function Ne(n,o){if(n&1&&(M(0,we,2,1,"div",2),M(1,Ie,2,1,"div",3)),n&2){let t=a();I(t.nzIcon?0:-1),s(),I(t.nzDescription&&t.nzShape==="square"?1:-1)}}function Ve(n,o){n&1&&(c(0,"div",2),z(1,"nz-icon",6),l())}function Fe(n,o){if(n&1){let t=f();c(0,"a",2),_("click",function(){u(t);let i=a();return m(i.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),l()}if(n&2){let t=a();W("ant-float-btn-default",t.nzType==="default"),p("target",t.nzTarget)("href",t.nzHref,Nt)("nzType",t.nzType),s(),p("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}function ke(n,o){if(n&1){let t=f();c(0,"button",4),_("click",function(){u(t);let i=a();return m(i.nzOnClick.emit(!0))}),z(1,"nz-float-button-content",3),l()}if(n&2){let t=a();W("ant-float-btn-default",t.nzType==="default"),p("nzType",t.nzType),s(),p("nzIcon",t.nzIcon)("nzDescription",t.nzDescription)("nzShape",t.nzShape)}}var Ee=["backTop"];function Be(n,o){n&1&&z(0,"nz-icon",3)}var Oe=["*"];function Le(n,o){n&1&&at(0)}function Pe(n,o){if(n&1&&C(0,Le,1,0,"ng-container",2),n&2){a();let t=N(3);p("ngTemplateOutlet",t)}}function He(n,o){n&1&&at(0)}function Re(n,o){if(n&1&&(c(0,"div",3),C(1,He,1,0,"ng-container",2),l()),n&2){a(2);let t=N(3);p("@fadeMotion",void 0),s(),p("ngTemplateOutlet",t)}}function Ae(n,o){if(n&1){let t=f();M(0,Re,2,2,"div",3),c(1,"nz-float-button",4),_("nzOnClick",function(){u(t);let i=a();return m(i.open()?i.clickCloseMenu():i.clickOpenMenu())})("mouseover",function(){u(t);let i=a();return m(i.hoverOpenMenu())}),l()}if(n&2){let t=a(),e=N(5);I(t.open()?0:-1),s(),p("nzType",t.nzType())("nzIcon",t.open()?e:t.nzIcon())("nzShape",t.nzShape())("nzDescription",t.open()?null:t.nzDescription())}}function Qe(n,o){n&1&&Ot(0)}function We(n,o){n&1&&z(0,"nz-icon",5)}var ge=(()=>{class n{nzIcon=null;nzDescription=null;nzShape="circle";static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["nz-float-button-content"]],inputs:{nzIcon:"nzIcon",nzDescription:"nzDescription",nzShape:"nzShape"},exportAs:["nzFloatButtonContent"],decls:4,vars:1,consts:[[1,"ant-float-btn-body"],[1,"ant-float-btn-content"],[1,"ant-float-btn-icon"],[1,"ant-float-btn-description"],[3,"ngTemplateOutlet"],[4,"nzStringTemplateOutlet"],["nzType","file-text","nzTheme","outline"]],template:function(e,i){e&1&&(c(0,"div",0)(1,"div",1),M(2,Ne,2,2)(3,Ve,2,0,"div",2),l()()),e&2&&(s(2),I(i.nzDescription||i.nzIcon?2:3))},dependencies:[P,L,ut,Kt],encapsulation:2,changeDetection:0})}return n})(),V=(()=>{class n{directionality=y(q);cdr=y(st);destroyRef=y(rt);nzHref=null;nzTarget=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzOnClick=new Q;dir="ltr";constructor(){this.dir=this.directionality.value}ngOnInit(){this.directionality.change?.pipe(j(this.destroyRef)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["nz-float-button"]],hostAttrs:[1,"ant-float-btn"],hostVars:6,hostBindings:function(e,i){e&2&&W("ant-float-btn-circle",i.nzShape==="circle")("ant-float-btn-square",i.nzShape==="square")("ant-float-btn-rtl",i.dir==="rtl")},inputs:{nzHref:"nzHref",nzTarget:"nzTarget",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription"},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButton"],decls:2,vars:1,consts:[["nz-button","",1,"ant-float-btn-inner",3,"target","href","nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"nzType","ant-float-btn-default"],["nz-button","",1,"ant-float-btn-inner",3,"click","target","href","nzType"],[3,"nzIcon","nzDescription","nzShape"],["nz-button","",1,"ant-float-btn-inner",3,"click","nzType"]],template:function(e,i){e&1&&M(0,Fe,2,8,"a",0)(1,ke,2,6,"button",1),e&2&&I(i.nzHref?0:1)},dependencies:[U,X,Y,te,ge],encapsulation:2,changeDetection:0})}return n})(),Ge="backTop",$e=Yt({passive:!0}),_t=(()=>{var e;let n,o=[],t=[];return e=class{nzConfigService=y(Xt);scrollSrv=y(ne);platform=y(qt);ngZone=y(Ft);cdr=y(st);directionality=y(q);destroyRef=y(rt);_nzModuleName=Ge;scrollListenerDestroy$=new bt;target=null;visible=!1;dir="ltr";nzHref=null;nzType="default";nzShape="circle";nzIcon=null;nzDescription=null;nzTemplate;nzVisibilityHeight=ot(this,o,400);nzTarget=ot(this,t);nzDuration=450;nzOnClick=new Q;set backTop(r){r&&(this.backTopClickSubscription.unsubscribe(),this.backTopClickSubscription=mt(r.nativeElement,"click").pipe(j(this.destroyRef)).subscribe(()=>{this.scrollSrv.scrollTo(this.getTarget(),0,{duration:this.nzDuration}),this.nzOnClick.observers.length&&this.ngZone.run(()=>this.nzOnClick.emit(!0))}))}doc=y(Mt);backTopClickSubscription=yt.EMPTY;constructor(){this.destroyRef.onDestroy(()=>{this.scrollListenerDestroy$.next(),this.scrollListenerDestroy$.complete()})}ngOnInit(){this.registerScrollEvent(),this.dir=this.directionality.value,this.directionality.change?.pipe(j(this.destroyRef)).subscribe(r=>{this.dir=r,this.cdr.detectChanges()})}getTarget(){return this.target||window}handleScroll(){this.visible!==this.scrollSrv.getScroll(this.getTarget())>this.nzVisibilityHeight&&(this.visible=!this.visible,this.cdr.detectChanges())}registerScrollEvent(){this.platform.isBrowser&&(this.scrollListenerDestroy$.next(),this.handleScroll(),mt(this.getTarget(),"scroll",$e).pipe(xt(50),Tt(this.scrollListenerDestroy$)).subscribe(()=>this.handleScroll()))}detectChanges(){this.cdr.detectChanges()}ngOnChanges(r){let{nzTarget:d}=r;d&&(this.target=typeof this.nzTarget=="string"?this.doc.querySelector(this.nzTarget):this.nzTarget,this.registerScrollEvent())}},(()=>{let r=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;n=[Ut()],vt(null,null,n,{kind:"field",name:"nzVisibilityHeight",static:!1,private:!1,access:{has:d=>"nzVisibilityHeight"in d,get:d=>d.nzVisibilityHeight,set:(d,h)=>{d.nzVisibilityHeight=h}},metadata:r},o,t),r&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:r})})(),nt(e,"\u0275fac",function(d){return new(d||e)}),nt(e,"\u0275cmp",b({type:e,selectors:[["nz-float-button-top"]],viewQuery:function(d,h){if(d&1&&T(Ee,5),d&2){let k;S(k=D())&&(h.backTop=k.first)}},hostAttrs:[1,"ant-float-btn","ant-float-btn-top"],hostVars:8,hostBindings:function(d,h){d&2&&W("ant-float-btn-circle",h.nzShape==="circle")("ant-float-btn-hidden",!h.visible)("ant-float-btn-square",h.nzShape==="square")("ant-float-btn-rtl",h.dir==="rtl")},inputs:{nzHref:"nzHref",nzType:"nzType",nzShape:"nzShape",nzIcon:"nzIcon",nzDescription:"nzDescription",nzTemplate:"nzTemplate",nzVisibilityHeight:[2,"nzVisibilityHeight","nzVisibilityHeight",pt],nzTarget:"nzTarget",nzDuration:[2,"nzDuration","nzDuration",pt]},outputs:{nzOnClick:"nzOnClick"},exportAs:["nzFloatButtonTop"],features:[It],decls:5,vars:6,consts:[["backTop",""],["top",""],[3,"nzIcon","nzDescription","nzHref","nzType","nzShape"],["nzType","vertical-align-top","nzTheme","outline"]],template:function(d,h){if(d&1&&(c(0,"div",null,0),z(2,"nz-float-button",2),C(3,Be,1,0,"ng-template",null,1,v),l()),d&2){let k=N(4);p("@fadeMotion",void 0),s(2),p("nzIcon",h.nzIcon||k)("nzDescription",h.nzDescription)("nzHref",h.nzHref)("nzType",h.nzType)("nzShape",h.nzShape)}},dependencies:[V,P,L],encapsulation:2,data:{animation:[dt]},changeDetection:0})),e})(),ft=(()=>{class n{nzFloatButtonComponents=lt(V);nzFloatButtonTopComponents=lt(_t);nzHref=x(null);nzTarget=x(null);nzType=x("default");nzIcon=x(null);nzDescription=x(null);nzShape=x("circle");nzTrigger=x(null);nzOpen=x(null);nzPlacement=x("top");nzOnOpenChange=Wt();dir=y(q).valueSignal;open=Qt(()=>!!this.nzOpen());isMenuMode=$(()=>!!this.nzTrigger()&&["click","hover"].includes(this.nzTrigger()));isControlledMode=$(()=>this.nzOpen()!==null);class=$(()=>{let t=this.nzShape(),e=this.dir(),i=["ant-float-btn-group",this.generateClass(t)];return this.isMenuMode()?i.push(this.generateClass(this.nzPlacement())):i.push(this.generateClass(`${t}-shadow`)),e==="rtl"&&i.push(this.generateClass(e)),i});constructor(){At(()=>{this.nzFloatButtonComponents()&&this.nzFloatButtonComponents().forEach(t=>{t.nzShape=this.nzShape()}),this.nzFloatButtonTopComponents()&&this.nzFloatButtonTopComponents().forEach(t=>{t.nzShape=this.nzShape(),t.detectChanges()})})}clickOpenMenu(){this.handleEvent("click",!0)}hoverOpenMenu(){this.handleEvent("hover",!0)}clickCloseMenu(){this.handleEvent("click",!1)}hoverCloseMenu(){this.handleEvent("hover",!1)}handleEvent(t,e){this.nzTrigger()!==t||this.isControlledMode()||this.open()===e||(this.open.set(e),this.nzOnOpenChange.emit(e))}generateClass(t){return`ant-float-btn-group-${t}`}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=b({type:n,selectors:[["nz-float-button-group"]],contentQueries:function(e,i,r){e&1&&(ct(r,i.nzFloatButtonComponents,V,4),ct(r,i.nzFloatButtonTopComponents,_t,4)),e&2&&Lt(2)},hostVars:2,hostBindings:function(e,i){e&1&&_("mouseleave",function(){return i.hoverCloseMenu()}),e&2&&Pt(i.class())},inputs:{nzHref:[1,"nzHref"],nzTarget:[1,"nzTarget"],nzType:[1,"nzType"],nzIcon:[1,"nzIcon"],nzDescription:[1,"nzDescription"],nzShape:[1,"nzShape"],nzTrigger:[1,"nzTrigger"],nzOpen:[1,"nzOpen"],nzPlacement:[1,"nzPlacement"]},outputs:{nzOnOpenChange:"nzOnOpenChange"},exportAs:["nzFloatButtonGroup"],ngContentSelectors:Oe,decls:6,vars:1,consts:[["menu",""],["close",""],[4,"ngTemplateOutlet"],[1,"ant-float-btn-group-wrap"],[1,"ant-float-btn-group-trigger",3,"nzOnClick","mouseover","nzType","nzIcon","nzShape","nzDescription"],["nzType","close","nzTheme","outline"]],template:function(e,i){e&1&&(Bt(),M(0,Pe,1,1,"ng-container")(1,Ae,2,5),C(2,Qe,1,0,"ng-template",null,0,v)(4,We,1,0,"ng-template",null,1,v)),e&2&&I(i.isMenuMode()?1:0)},dependencies:[V,P,L,ut],encapsulation:2,data:{animation:[dt]},changeDetection:0})}return n})(),he=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Vt({type:n});static \u0275inj=Dt({imports:[V,ft,_t,ge]})}return n})();var qe=["upIcon"],Ye=["downIcon"],Xe=["leftIcon"],Ue=["rightIcon"],Ze=["commentIcon"],Je=(n,o)=>({x:n,y:o});function Ke(n,o){n&1&&z(0,"nz-icon",8)}function tn(n,o){n&1&&z(0,"nz-icon",9)}function en(n,o){n&1&&z(0,"nz-icon",10)}function nn(n,o){n&1&&z(0,"nz-icon",11)}function on(n,o){n&1&&z(0,"nz-icon",12)}var H=class H{constructor(){this.dragX=0;this.dragY=0;this.smartPlacement="top";this.currentX=0;this.currentY=0;this.onAction=new Q}get currentIcon(){return{top:this.upIcon,bottom:this.downIcon,left:this.leftIcon,right:this.rightIcon}[this.smartPlacement]}onDragMove(o){let t=o.source.element.nativeElement.getBoundingClientRect();this.currentX=t.left,this.currentY=t.top,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}onDragEnd(o){this.dragX=o.source.getFreeDragPosition().x,this.dragY=o.source.getFreeDragPosition().y,this.smartPlacement=this.calculateSmartPlacement(this.currentX,this.currentY)}calculateSmartPlacement(o,t){let e=window.innerWidth,i=window.innerHeight,r=56,d=o+r/2,h=t+r/2,k=e/2,ve=i/2,Ct=d-k,zt=h-ve;return Math.abs(Ct)>Math.abs(zt)?Ct>0?"left":"right":zt>0?"top":"bottom"}openChange(o){}};H.\u0275fac=function(t){return new(t||H)},H.\u0275cmp=b({type:H,selectors:[["app-fab"]],viewQuery:function(t,e){if(t&1&&(T(qe,7),T(Ye,7),T(Xe,7),T(Ue,7),T(Ze,7)),t&2){let i;S(i=D())&&(e.upIcon=i.first),S(i=D())&&(e.downIcon=i.first),S(i=D())&&(e.leftIcon=i.first),S(i=D())&&(e.rightIcon=i.first),S(i=D())&&(e.commentIcon=i.first)}},outputs:{onAction:"onAction"},decls:13,vars:7,consts:[["upIcon",""],["downIcon",""],["leftIcon",""],["rightIcon",""],["commentIcon",""],["cdkDrag","",1,"fab-drag-anchor",3,"cdkDragEnded","cdkDragMoved","cdkDragFreeDragPosition"],["nzType","primary","nzTrigger","click",3,"nzOnOpenChange","nzIcon","nzPlacement"],[3,"click","nzIcon"],["nzType","up","nzTheme","outline"],["nzType","down","nzTheme","outline"],["nzType","left","nzTheme","outline"],["nzType","right","nzTheme","outline"],["nzType","plus","nzTheme","outline"]],template:function(t,e){if(t&1){let i=f();c(0,"div",5),_("cdkDragEnded",function(d){return u(i),m(e.onDragEnd(d))})("cdkDragMoved",function(d){return u(i),m(e.onDragMove(d))}),c(1,"nz-float-button-group",6),_("nzOnOpenChange",function(d){return u(i),m(e.openChange(d))}),c(2,"nz-float-button",7),_("click",function(){return u(i),m(e.onAction.emit("add"))}),l()(),C(3,Ke,1,0,"ng-template",null,0,v)(5,tn,1,0,"ng-template",null,1,v)(7,en,1,0,"ng-template",null,2,v)(9,nn,1,0,"ng-template",null,3,v)(11,on,1,0,"ng-template",null,4,v),l()}if(t&2){let i=N(12);p("cdkDragFreeDragPosition",Rt(4,Je,e.dragX,e.dragY)),s(),p("nzIcon",e.currentIcon)("nzPlacement",e.smartPlacement),s(),p("nzIcon",i)}},dependencies:[he,V,ft,P,L,Jt,Zt],styles:[".fab-drag-anchor[_ngcontent-%COMP%]{position:fixed;z-index:1000;right:32px;bottom:32px;cursor:grab;-webkit-user-select:none;user-select:none}.fab-drag-anchor[_ngcontent-%COMP%]:active{cursor:grabbing}nz-float-button-group[_ngcontent-%COMP%]{position:absolute}"]});var K=H;var F=class F{constructor(o){this.hubCrud=o}list(){return this.hubCrud.useCollection("hub_contract")}add(o){return this.hubCrud.add("hub_contract",o)}update(o,t){return this.hubCrud.update("hub_contract",o,t)}delete(o){return this.hubCrud.delete("hub_contract",o)}};F.\u0275fac=function(t){return new(t||F)(wt(Z))},F.\u0275prov=St({token:F,factory:F.\u0275fac,providedIn:"root"});var tt=F;function cn(n,o){if(n&1){let t=f();c(0,"div",8),_("click",function(){u(t);let i=a().$implicit,r=a();return m(r.startEdit(i.key,"client"))}),g(1),l()}if(n&2){let t=a().$implicit;s(),w(" ",t.client," ")}}function ln(n,o){if(n&1&&z(0,"nz-option",11),n&2){let t=o.$implicit;p("nzValue",t)("nzLabel",t)}}function sn(n,o){if(n&1){let t=f();c(0,"nz-select",9),O("ngModelChange",function(i){u(t);let r=a(2);return B(r.editValue,i)||(r.editValue=i),m(i)}),_("ngModelChange",function(){u(t);let i=a().$implicit,r=a();return m(r.stopEdit(i,"client"))}),C(1,ln,1,2,"nz-option",10),l()}if(n&2){let t=a(2);E("ngModel",t.editValue),p("nzOpen",!0),s(),p("ngForOf",t.clients)}}function pn(n,o){if(n&1){let t=f();c(0,"div",8),_("click",function(){u(t);let i=a().$implicit,r=a();return m(r.startEdit(i.key,"contractName"))}),g(1),l()}if(n&2){let t=a().$implicit;s(),w(" ",t.contractName," ")}}function un(n,o){if(n&1){let t=f();c(0,"input",12),O("ngModelChange",function(i){u(t);let r=a(2);return B(r.editValue,i)||(r.editValue=i),m(i)}),_("blur",function(){u(t);let i=a().$implicit,r=a();return m(r.stopEdit(i,"contractName"))}),l()}if(n&2){let t=a(2);E("ngModel",t.editValue)}}function mn(n,o){if(n&1){let t=f();c(0,"div",8),_("click",function(){u(t);let i=a().$implicit,r=a();return m(r.startEdit(i.key,"contractCode"))}),g(1),l()}if(n&2){let t=a().$implicit;s(),w(" ",t.contractCode," ")}}function dn(n,o){if(n&1){let t=f();c(0,"input",12),O("ngModelChange",function(i){u(t);let r=a(2);return B(r.editValue,i)||(r.editValue=i),m(i)}),_("blur",function(){u(t);let i=a().$implicit,r=a();return m(r.stopEdit(i,"contractCode"))}),l()}if(n&2){let t=a(2);E("ngModel",t.editValue)}}function _n(n,o){if(n&1){let t=f();c(0,"div",8),_("click",function(){u(t);let i=a().$implicit,r=a();return m(r.startEdit(i.key,"feeCode"))}),g(1),l()}if(n&2){let t=a().$implicit;s(),w(" ",t.feeCode," ")}}function fn(n,o){if(n&1){let t=f();c(0,"input",12),O("ngModelChange",function(i){u(t);let r=a(2);return B(r.editValue,i)||(r.editValue=i),m(i)}),_("blur",function(){u(t);let i=a().$implicit,r=a();return m(r.stopEdit(i,"feeCode"))}),l()}if(n&2){let t=a(2);E("ngModel",t.editValue)}}function Cn(n,o){if(n&1){let t=f();c(0,"div",8),_("click",function(){u(t);let i=a().$implicit,r=a();return m(r.startEdit(i.key,"amount"))}),g(1),l()}if(n&2){let t=a().$implicit;s(),w(" ",t.amount," ")}}function zn(n,o){if(n&1){let t=f();c(0,"input",13),O("ngModelChange",function(i){u(t);let r=a(2);return B(r.editValue,i)||(r.editValue=i),m(i)}),_("blur",function(){u(t);let i=a().$implicit,r=a();return m(r.stopEdit(i,"amount"))}),l()}if(n&2){let t=a(2);E("ngModel",t.editValue)}}function gn(n,o){if(n&1){let t=f();c(0,"tr")(1,"td"),g(2),l(),c(3,"td"),C(4,cn,2,1,"div",3)(5,sn,2,3,"nz-select",4),l(),c(6,"td"),C(7,pn,2,1,"div",3)(8,un,1,1,"input",5),l(),c(9,"td"),C(10,mn,2,1,"div",3)(11,dn,1,1,"input",5),l(),c(12,"td"),C(13,_n,2,1,"div",3)(14,fn,1,1,"input",5),l(),c(15,"td"),C(16,Cn,2,1,"div",3)(17,zn,1,1,"input",6),l(),c(18,"td")(19,"button",7),_("click",function(){let i=u(t).$implicit,r=a();return m(r.remove(i))}),g(20,"\u522A\u9664"),l()()()}if(n&2){let t=o.$implicit,e=a();s(2),Ht(t.contractSerial),s(2),p("ngIf",!(e.editId===t.key&&e.editField==="client")),s(),p("ngIf",e.editId===t.key&&e.editField==="client"),s(2),p("ngIf",!(e.editId===t.key&&e.editField==="contractName")),s(),p("ngIf",e.editId===t.key&&e.editField==="contractName"),s(2),p("ngIf",!(e.editId===t.key&&e.editField==="contractCode")),s(),p("ngIf",e.editId===t.key&&e.editField==="contractCode"),s(2),p("ngIf",!(e.editId===t.key&&e.editField==="feeCode")),s(),p("ngIf",e.editId===t.key&&e.editField==="feeCode"),s(2),p("ngIf",!(e.editId===t.key&&e.editField==="amount")),s(),p("ngIf",e.editId===t.key&&e.editField==="amount")}}var R=class R{constructor(o,t,e){this.contractService=o;this.modal=t;this.hubCrud=e;this.contracts=[];this.clients=[];this.editId=null;this.editField=null;this.editValue=""}ngOnInit(){this.refresh(),this.hubCrud.getClientsSettings().then(o=>{this.clients=o?.list||[]})}refresh(){this.contractService.list().subscribe(o=>this.contracts=o)}add(){return it(this,null,function*(){let[o,t]=yield Promise.all([this.hubCrud.getDefaultClient(),this.hubCrud.getNextContractSerial()]),e={contractSerial:t,client:o,contractName:"",contractCode:"",feeCode:"",amount:0},i=yield this.contractService.add(e);setTimeout(()=>{this.startEdit(i,"contractName")},200)})}startEdit(o,t){if(!o)return;this.editId=o,this.editField=t;let e=this.contracts.find(i=>i.key===o);this.editValue=e?e[t]:"",setTimeout(()=>{let i=document.querySelector("input[nz-input]:not([hidden])");i&&i.focus()},50)}stopEdit(o,t){return it(this,null,function*(){if(o.key&&this.editValue!==o[t]){let e=ht(gt({},o),{[t]:this.editValue});this.contracts=this.contracts.map(i=>i.key===o.key?e:i),yield this.contractService.update(o.key,{[t]:this.editValue})}this.editId=null,this.editField=null,this.editValue=""})}remove(o){o.key&&this.contractService.delete(o.key).then(()=>this.refresh())}};R.\u0275fac=function(t){return new(t||R)(G(tt),G(ee),G(Z))},R.\u0275cmp=b({type:R,selectors:[["contract-list"]],decls:20,vars:2,consts:[[3,"onAction"],["nzBordered","",3,"nzData"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["nzSize","small","style","min-width: 100px",3,"ngModel","nzOpen","ngModelChange",4,"ngIf"],["type","text","nz-input","",3,"ngModel","ngModelChange","blur",4,"ngIf"],["type","number","nz-input","",3,"ngModel","ngModelChange","blur",4,"ngIf"],["nz-button","","nzType","link",3,"click"],[3,"click"],["nzSize","small",2,"min-width","100px",3,"ngModelChange","ngModel","nzOpen"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["type","text","nz-input","",3,"ngModelChange","blur","ngModel"],["type","number","nz-input","",3,"ngModelChange","blur","ngModel"]],template:function(t,e){t&1&&(c(0,"app-fab",0),_("onAction",function(){return e.add()}),l(),c(1,"nz-table",1)(2,"thead")(3,"tr")(4,"th"),g(5,"\u5E8F\u865F"),l(),c(6,"th"),g(7,"\u696D\u4E3B"),l(),c(8,"th"),g(9,"\u5408\u7D04\u540D\u7A31"),l(),c(10,"th"),g(11,"\u5408\u7D04\u6848\u865F\u8B58\u5225\u78BC"),l(),c(12,"th"),g(13,"\u5408\u7D04\u8CBB\u7528\u8B58\u5225\u78BC"),l(),c(14,"th"),g(15,"\u5408\u7D04\u91D1\u984D"),l(),c(16,"th"),g(17,"\u64CD\u4F5C"),l()()(),c(18,"tbody"),C(19,gn,21,11,"tr",2),l()()),t&2&&(s(),p("nzData",e.contracts),s(18),p("ngForOf",e.contracts))},dependencies:[jt,Gt,$t,ce,ie,ae,oe,re,ze,_e,ue,me,Ce,de,fe,U,X,Y,pe,le,se,K],encapsulation:2});var et=R;var A=class A{};A.\u0275fac=function(t){return new(t||A)},A.\u0275cmp=b({type:A,selectors:[["hub-contract"]],decls:1,vars:0,template:function(t,e){t&1&&z(0,"contract-list")},dependencies:[et],encapsulation:2});var be=A;export{be as HubContractComponent};
